(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    262324,       6054]
NotebookOptionsPosition[    251046,       5864]
NotebookOutlinePosition[    251605,       5884]
CellTagsIndexPosition[    251562,       5881]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Definitions for linear two field transient thermomech:", "Title",
 CellChangeTimes->{{3.7227097911277695`*^9, 3.7227098092418723`*^9}, {
  3.763392097019563*^9, 3.7633920975064383`*^9}, {3.7647613439397774`*^9, 
  3.764761353568443*^9}, {3.769264969470007*^9, 
  3.7692649709773846`*^9}},ExpressionUUID->"2ed3bc56-4373-4aa9-8d94-\
26114128ebcf"],

Cell[CellGroupData[{

Cell["Define Tri3 basis functions in parent coordinates \
(\[Xi],\[Psi],\[Zeta]):", "Subsection",
 CellChangeTimes->{{3.717170430098735*^9, 3.717170455794014*^9}, {
  3.717367163060734*^9, 
  3.717367164420561*^9}},ExpressionUUID->"b53f5e04-56e9-4af4-86f0-\
0c06dbbad567"],

Cell[BoxData[
 RowBox[{
  RowBox[{"\[Phi]s", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"1", "-", "\[Xi]", "-", "\[Psi]", "-", "\[Zeta]"}], ",", "\[Xi]",
      ",", "\[Psi]", ",", "\[Zeta]"}], "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.717159762670228*^9, 3.717159772862687*^9}, 
   3.7171704577284317`*^9, {3.7173671489361877`*^9, 3.717367156764295*^9}, {
   3.9073202815381413`*^9, 3.9073202885718937`*^9}},
 CellLabel->"In[1]:=",ExpressionUUID->"9feff9b6-937f-4a33-9141-db00c5c9cbbd"]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "Define local nodal coordinate arrays, X, Y, and Z, and compute the \
position, ",
 Cell[BoxData[
  FormBox[
   RowBox[{"x", " ", "=", 
    RowBox[{"\[Sum]", 
     RowBox[{
      RowBox[{
       SubscriptBox["\[Phi]", "I"], "[", 
       RowBox[{"\[Xi]", ",", "\[Psi]", ",", "\[Zeta]"}], "]"}], 
      SubscriptBox["X", "I"]}]}]}], TraditionalForm]],ExpressionUUID->
  "9419c29e-f933-4976-be53-25bed4c16feb"],
 ", ",
 Cell[BoxData[
  FormBox[
   RowBox[{"y", " ", "=", " ", 
    RowBox[{"\[Sum]", 
     RowBox[{
      RowBox[{
       SubscriptBox["\[Phi]", "I"], "[", 
       RowBox[{"\[Xi]", ",", "\[Psi]", ",", "\[Zeta]"}], "]"}], 
      SubscriptBox["Y", "I"]}]}]}], TraditionalForm]],ExpressionUUID->
  "0a2d7ca4-2451-401d-84cc-7ff23ba1ce09"],
 ", and  ",
 Cell[BoxData[
  FormBox[
   RowBox[{"z", " ", "=", " ", 
    RowBox[{"\[Sum]", 
     RowBox[{
      RowBox[{
       SubscriptBox["\[Phi]", "I"], "[", 
       RowBox[{"\[Xi]", ",", "\[Psi]", ",", "\[Zeta]"}], "]"}], 
      RowBox[{
       SubscriptBox["Z", "I"], ":"}]}]}]}], TraditionalForm]],ExpressionUUID->
  "6fce3cc4-b4e6-42a2-9872-64dbe98f8734"]
}], "Subsection",
 CellChangeTimes->{{3.717170467034111*^9, 3.717170646080793*^9}, {
  3.7173672533732233`*^9, 3.717367296127637*^9}, {3.7173676524772353`*^9, 
  3.7173676768522606`*^9}},ExpressionUUID->"f2237484-bc41-4926-8084-\
c58d9c768107"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"X", "=", 
   RowBox[{"{", 
    RowBox[{"x1", ",", "x2", ",", "x3", ",", "x4"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Y", "=", 
   RowBox[{"{", 
    RowBox[{"y1", ",", "y2", ",", "y3", ",", "y4"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Z", "=", 
   RowBox[{"{", 
    RowBox[{"z1", ",", "z2", ",", "z3", ",", "z4"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"x", "=", 
   RowBox[{
    UnderoverscriptBox["\[Sum]", 
     RowBox[{"i", "=", "1"}], "4"], 
    RowBox[{
     RowBox[{"\[Phi]s", "[", 
      RowBox[{"[", "i", "]"}], "]"}], "*", 
     RowBox[{"X", "[", 
      RowBox[{"[", "i", "]"}], "]"}]}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"y", "=", 
   RowBox[{
    UnderoverscriptBox["\[Sum]", 
     RowBox[{"i", "=", "1"}], "4"], 
    RowBox[{
     RowBox[{"\[Phi]s", "[", 
      RowBox[{"[", "i", "]"}], "]"}], "*", 
     RowBox[{"Y", "[", 
      RowBox[{"[", "i", "]"}], "]"}]}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"z", "=", 
   RowBox[{
    UnderoverscriptBox["\[Sum]", 
     RowBox[{"i", "=", "1"}], "4"], 
    RowBox[{
     RowBox[{"\[Phi]s", "[", 
      RowBox[{"[", "i", "]"}], "]"}], "*", 
     RowBox[{"Z", "[", 
      RowBox[{"[", "i", "]"}], "]"}]}]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.716761356116639*^9, 3.71676136863325*^9}, 
   3.717159777614208*^9, {3.717367683976516*^9, 3.7173677669144773`*^9}},
 CellLabel->"In[2]:=",ExpressionUUID->"7269210c-8591-490d-a33a-ed91888b5098"]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "Define the Jacobian matrix, ",
 Cell[BoxData[
  FormBox[
   RowBox[{"J", "=", 
    RowBox[{
     SubscriptBox["dx", "i"], "/", 
     SubscriptBox["d\[Xi]", "j"]}]}], TraditionalForm]],ExpressionUUID->
  "07a33cf4-ffb4-4dfc-b2ac-80c41cab7383"],
 ":"
}], "Subsection",
 CellChangeTimes->{{3.7171706589407587`*^9, 
  3.717170706016591*^9}},ExpressionUUID->"ab9ea59b-7821-401b-a389-\
c920bff49d1c"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   RowBox[{"J", "=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"D", "[", 
         RowBox[{"x", ",", "\[Xi]"}], "]"}], ",", 
        RowBox[{"D", "[", 
         RowBox[{"x", ",", "\[Psi]"}], "]"}], ",", 
        RowBox[{"D", "[", 
         RowBox[{"x", ",", "\[Zeta]"}], "]"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"D", "[", 
         RowBox[{"y", ",", "\[Xi]"}], "]"}], ",", 
        RowBox[{"D", "[", 
         RowBox[{"y", ",", "\[Psi]"}], "]"}], ",", 
        RowBox[{"D", "[", 
         RowBox[{"y", ",", "\[Zeta]"}], "]"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"D", "[", 
         RowBox[{"z", ",", "\[Xi]"}], "]"}], ",", 
        RowBox[{"D", "[", 
         RowBox[{"z", ",", "\[Psi]"}], "]"}], ",", 
        RowBox[{"D", "[", 
         RowBox[{"z", ",", "\[Zeta]"}], "]"}]}], "}"}]}], "}"}]}], ")"}], "//",
   "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.717159400798109*^9, 3.717159402472238*^9}, {
   3.7171594670820827`*^9, 3.717159481884482*^9}, {3.717159528167789*^9, 
   3.7171595453911543`*^9}, 3.717159782011516*^9, {3.7173677887268276`*^9, 
   3.7173678325554037`*^9}},
 CellLabel->"In[8]:=",ExpressionUUID->"885f1b85-4463-47e8-8867-3ef40f684ca8"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{
       RowBox[{"-", "x1"}], "+", "x2"}], 
      RowBox[{
       RowBox[{"-", "x1"}], "+", "x3"}], 
      RowBox[{
       RowBox[{"-", "x1"}], "+", "x4"}]},
     {
      RowBox[{
       RowBox[{"-", "y1"}], "+", "y2"}], 
      RowBox[{
       RowBox[{"-", "y1"}], "+", "y3"}], 
      RowBox[{
       RowBox[{"-", "y1"}], "+", "y4"}]},
     {
      RowBox[{
       RowBox[{"-", "z1"}], "+", "z2"}], 
      RowBox[{
       RowBox[{"-", "z1"}], "+", "z3"}], 
      RowBox[{
       RowBox[{"-", "z1"}], "+", "z4"}]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.7167614354761105`*^9, 3.716765302982686*^9, 3.7171556785772953`*^9, 
   3.717157543718261*^9, 3.717159484292647*^9, 3.717159565326777*^9, 
   3.717159783432115*^9, 3.717354900932816*^9, 3.7173678516174393`*^9, 
   3.717417860423373*^9, 3.720268227067238*^9, 3.720806396391696*^9, 
   3.7209936838639107`*^9, 3.721061216314333*^9, 3.723054595524909*^9, 
   3.7230546313224325`*^9, 3.723504448044764*^9, 3.7239811360514584`*^9, {
   3.7284300552303286`*^9, 3.7284300734023075`*^9}, 3.7404279872756085`*^9, 
   3.763392391210548*^9, 3.764081528224759*^9, 3.7641637936038733`*^9, 
   3.764244461510044*^9, 3.7643520598062115`*^9, 3.7643697288044987`*^9, 
   3.764696161335455*^9, 3.764761424927881*^9, 3.7656430511298003`*^9, 
   3.769264984046386*^9, 3.7693524116435013`*^9, 3.7710839937182803`*^9, 
   3.7711572868564763`*^9, 3.7712419541455436`*^9, 3.7717767990603504`*^9, 
   3.771782160395085*^9, 3.7754855301475487`*^9, 3.8495061240339603`*^9, 
   3.850317685909593*^9, 3.9073203134816732`*^9, 3.9076127705996733`*^9, 
   3.907768847760674*^9, 3.908991053761342*^9},
 CellLabel->
  "Out[8]//MatrixForm=",ExpressionUUID->"7b15a000-9f88-4921-9cc3-\
0d127a6d10e4"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Define the determinant of the Jacobian:", "Subsection",
 CellChangeTimes->{{3.717170742514415*^9, 
  3.71717075277886*^9}},ExpressionUUID->"f2bb0bcd-f0d0-4aee-93cb-\
1dc8aeb604ac"],

Cell[BoxData[
 RowBox[{
  RowBox[{"detj", "=", 
   RowBox[{"Det", "[", "J", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{3.717157550322625*^9, 3.71741786843908*^9},
 CellLabel->"In[9]:=",ExpressionUUID->"b174d360-3f53-44a5-a6cb-33dafa50fde1"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Define the inverse of the Jacobian:", "Subsection",
 CellChangeTimes->{{3.7171707115541143`*^9, 
  3.71717072339587*^9}},ExpressionUUID->"c31e0839-bf02-47ad-b143-\
31fa0203e471"],

Cell[BoxData[
 RowBox[{
  RowBox[{"InvJ", " ", "=", " ", 
   RowBox[{"Simplify", "[", " ", 
    RowBox[{"Inverse", "[", "J", "]"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{
  3.7167614674219794`*^9, 3.716762132096217*^9, 3.717157545859642*^9, 
   3.7173678815154886`*^9, {3.7173685526975317`*^9, 3.717368591121168*^9}},
 CellLabel->"In[10]:=",ExpressionUUID->"d19eca88-c4b1-4c04-9326-0b41423a0bf0"]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "Define the derivative of the basis function wrt parent coordinates, ",
 Cell[BoxData[
  FormBox[
   RowBox[{"d\[Phi]", "/", 
    SubscriptBox["d\[Xi]", "i"]}], TraditionalForm]],ExpressionUUID->
  "a7c8fad7-773c-497d-b5dc-24e29109f009"],
 ", and wrt physical coordinates, ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"d\[Phi]", "/", 
     SubscriptBox["dx", "i"]}], "=", 
    RowBox[{"(", 
     RowBox[{"d\[Phi]", "/", 
      SubscriptBox["d\[Xi]", "k"]}]}]}], TraditionalForm]],ExpressionUUID->
  "a92cb89d-9190-4227-bc00-d06f788885ae"],
 ")( ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["d\[Xi]", "k"], "/", 
    SubscriptBox["dx", "i"]}], TraditionalForm]],ExpressionUUID->
  "a86578bb-8abe-4fb9-b85c-73dcfc5e8ba2"],
 "):"
}], "Subsection",
 CellChangeTimes->{{3.717170774772771*^9, 
  3.7171709274438047`*^9}},ExpressionUUID->"1f25cd0b-85a2-4810-aee5-\
c062610126af"],

Cell[BoxData[
 RowBox[{
  RowBox[{"D\[Phi]D\[Xi]", "=", 
   RowBox[{"Transpose", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"D", "[", 
       RowBox[{"\[Phi]s", ",", "\[Xi]"}], "]"}], ",", 
      RowBox[{"D", "[", 
       RowBox[{"\[Phi]s", ",", "\[Psi]"}], "]"}], ",", 
      RowBox[{"D", "[", 
       RowBox[{"\[Phi]s", ",", "\[Zeta]"}], "]"}]}], "}"}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.716762040827201*^9, 3.7167620550573683`*^9}, {
   3.7167622782753077`*^9, 3.7167622879320135`*^9}, {3.717159585262508*^9, 
   3.7171596049010277`*^9}, 3.717170767862856*^9, {3.7173679090158405`*^9, 
   3.7173679140631857`*^9}},
 CellLabel->"In[11]:=",ExpressionUUID->"1f380bb9-8937-41f8-9fc7-af60e4836700"],

Cell[BoxData[
 RowBox[{
  RowBox[{"D\[Phi]Dx", "=", 
   RowBox[{"Simplify", "[", 
    RowBox[{"Transpose", "[", 
     RowBox[{"D\[Phi]D\[Xi]", ".", "InvJ"}], "]"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.7167620697517557`*^9, 3.7167621221822166`*^9}, {
  3.7167623794326005`*^9, 3.7167624191349125`*^9}, {3.717159618780408*^9, 
  3.717159620088848*^9}, {3.7171599769229116`*^9, 3.717159996771841*^9}, {
  3.717170940753901*^9, 3.7171709490170727`*^9}, {3.7171709936534357`*^9, 
  3.717171005961763*^9}, {3.7173600965536957`*^9, 3.717360100742365*^9}, {
  3.7173685313367987`*^9, 3.7173685371065826`*^9}, {3.7173686082063704`*^9, 
  3.717368609587582*^9}, {3.717417891626897*^9, 3.717417893049127*^9}},
 CellLabel->"In[12]:=",ExpressionUUID->"4ea65c3a-a288-4da0-a9fa-c1cdd1fb8309"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Define the gradient matrix:", "Subsection",
 CellChangeTimes->{{3.7171710170541*^9, 
  3.717171027281568*^9}},ExpressionUUID->"2964c79a-8f87-40a9-bdf6-\
9031289eb59c"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"B", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"D\[Phi]Dx", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "[", 
        RowBox[{"[", "1", "]"}], "]"}], ",", "0", ",", "0", ",", 
       RowBox[{
        RowBox[{"D\[Phi]Dx", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "[", 
        RowBox[{"[", "2", "]"}], "]"}], ",", "0", ",", "0", ",", 
       RowBox[{
        RowBox[{"D\[Phi]Dx", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "[", 
        RowBox[{"[", "3", "]"}], "]"}], ",", "0", ",", "0", ",", 
       RowBox[{
        RowBox[{"D\[Phi]Dx", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "[", 
        RowBox[{"[", "4", "]"}], "]"}], ",", "0", ",", "0"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"0", ",", 
       RowBox[{
        RowBox[{"D\[Phi]Dx", "[", 
         RowBox[{"[", "2", "]"}], "]"}], "[", 
        RowBox[{"[", "1", "]"}], "]"}], ",", "0", ",", "0", ",", 
       RowBox[{
        RowBox[{"D\[Phi]Dx", "[", 
         RowBox[{"[", "2", "]"}], "]"}], "[", 
        RowBox[{"[", "2", "]"}], "]"}], ",", "0", ",", "0", ",", 
       RowBox[{
        RowBox[{"D\[Phi]Dx", "[", 
         RowBox[{"[", "2", "]"}], "]"}], "[", 
        RowBox[{"[", "3", "]"}], "]"}], ",", "0", ",", "0", ",", 
       RowBox[{
        RowBox[{"D\[Phi]Dx", "[", 
         RowBox[{"[", "2", "]"}], "]"}], "[", 
        RowBox[{"[", "4", "]"}], "]"}], ",", "0"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", 
       RowBox[{
        RowBox[{"D\[Phi]Dx", "[", 
         RowBox[{"[", "3", "]"}], "]"}], "[", 
        RowBox[{"[", "1", "]"}], "]"}], ",", "0", ",", "0", ",", 
       RowBox[{
        RowBox[{"D\[Phi]Dx", "[", 
         RowBox[{"[", "3", "]"}], "]"}], "[", 
        RowBox[{"[", "2", "]"}], "]"}], ",", "0", ",", "0", ",", 
       RowBox[{
        RowBox[{"D\[Phi]Dx", "[", 
         RowBox[{"[", "3", "]"}], "]"}], "[", 
        RowBox[{"[", "3", "]"}], "]"}], ",", "0", ",", "0", ",", 
       RowBox[{
        RowBox[{"D\[Phi]Dx", "[", 
         RowBox[{"[", "3", "]"}], "]"}], "[", 
        RowBox[{"[", "4", "]"}], "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"0", ",", 
       RowBox[{
        RowBox[{"D\[Phi]Dx", "[", 
         RowBox[{"[", "3", "]"}], "]"}], "[", 
        RowBox[{"[", "1", "]"}], "]"}], ",", 
       RowBox[{
        RowBox[{"D\[Phi]Dx", "[", 
         RowBox[{"[", "2", "]"}], "]"}], "[", 
        RowBox[{"[", "1", "]"}], "]"}], ",", "0", ",", 
       RowBox[{
        RowBox[{"D\[Phi]Dx", "[", 
         RowBox[{"[", "3", "]"}], "]"}], "[", 
        RowBox[{"[", "2", "]"}], "]"}], ",", 
       RowBox[{
        RowBox[{"D\[Phi]Dx", "[", 
         RowBox[{"[", "2", "]"}], "]"}], "[", 
        RowBox[{"[", "2", "]"}], "]"}], ",", "0", ",", 
       RowBox[{
        RowBox[{"D\[Phi]Dx", "[", 
         RowBox[{"[", "3", "]"}], "]"}], "[", 
        RowBox[{"[", "3", "]"}], "]"}], ",", 
       RowBox[{
        RowBox[{"D\[Phi]Dx", "[", 
         RowBox[{"[", "2", "]"}], "]"}], "[", 
        RowBox[{"[", "3", "]"}], "]"}], ",", "0", ",", 
       RowBox[{
        RowBox[{"D\[Phi]Dx", "[", 
         RowBox[{"[", "3", "]"}], "]"}], "[", 
        RowBox[{"[", "4", "]"}], "]"}], ",", 
       RowBox[{
        RowBox[{"D\[Phi]Dx", "[", 
         RowBox[{"[", "2", "]"}], "]"}], "[", 
        RowBox[{"[", "4", "]"}], "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"D\[Phi]Dx", "[", 
         RowBox[{"[", "3", "]"}], "]"}], "[", 
        RowBox[{"[", "1", "]"}], "]"}], ",", "0", ",", 
       RowBox[{
        RowBox[{"D\[Phi]Dx", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "[", 
        RowBox[{"[", "1", "]"}], "]"}], ",", 
       RowBox[{
        RowBox[{"D\[Phi]Dx", "[", 
         RowBox[{"[", "3", "]"}], "]"}], "[", 
        RowBox[{"[", "2", "]"}], "]"}], ",", "0", ",", 
       RowBox[{
        RowBox[{"D\[Phi]Dx", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "[", 
        RowBox[{"[", "2", "]"}], "]"}], ",", 
       RowBox[{
        RowBox[{"D\[Phi]Dx", "[", 
         RowBox[{"[", "3", "]"}], "]"}], "[", 
        RowBox[{"[", "3", "]"}], "]"}], ",", "0", ",", 
       RowBox[{
        RowBox[{"D\[Phi]Dx", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "[", 
        RowBox[{"[", "3", "]"}], "]"}], ",", 
       RowBox[{
        RowBox[{"D\[Phi]Dx", "[", 
         RowBox[{"[", "3", "]"}], "]"}], "[", 
        RowBox[{"[", "4", "]"}], "]"}], ",", "0", ",", 
       RowBox[{
        RowBox[{"D\[Phi]Dx", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "[", 
        RowBox[{"[", "4", "]"}], "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"D\[Phi]Dx", "[", 
         RowBox[{"[", "2", "]"}], "]"}], "[", 
        RowBox[{"[", "1", "]"}], "]"}], ",", 
       RowBox[{
        RowBox[{"D\[Phi]Dx", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "[", 
        RowBox[{"[", "1", "]"}], "]"}], ",", "0", ",", 
       RowBox[{
        RowBox[{"D\[Phi]Dx", "[", 
         RowBox[{"[", "2", "]"}], "]"}], "[", 
        RowBox[{"[", "2", "]"}], "]"}], ",", 
       RowBox[{
        RowBox[{"D\[Phi]Dx", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "[", 
        RowBox[{"[", "2", "]"}], "]"}], ",", "0", ",", 
       RowBox[{
        RowBox[{"D\[Phi]Dx", "[", 
         RowBox[{"[", "2", "]"}], "]"}], "[", 
        RowBox[{"[", "3", "]"}], "]"}], ",", 
       RowBox[{
        RowBox[{"D\[Phi]Dx", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "[", 
        RowBox[{"[", "3", "]"}], "]"}], ",", "0", ",", 
       RowBox[{
        RowBox[{"D\[Phi]Dx", "[", 
         RowBox[{"[", "2", "]"}], "]"}], "[", 
        RowBox[{"[", "4", "]"}], "]"}], ",", 
       RowBox[{
        RowBox[{"D\[Phi]Dx", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "[", 
        RowBox[{"[", "4", "]"}], "]"}], ",", "0"}], "}"}]}], 
    "\[IndentingNewLine]", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"b", "=", "D\[Phi]Dx"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"bDiv", "=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"D\[Phi]Dx", "[", 
       RowBox[{"[", "1", "]"}], "]"}], "[", 
      RowBox[{"[", "1", "]"}], "]"}], ",", 
     RowBox[{
      RowBox[{"D\[Phi]Dx", "[", 
       RowBox[{"[", "2", "]"}], "]"}], "[", 
      RowBox[{"[", "1", "]"}], "]"}], ",", 
     RowBox[{
      RowBox[{"D\[Phi]Dx", "[", 
       RowBox[{"[", "3", "]"}], "]"}], "[", 
      RowBox[{"[", "1", "]"}], "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"D\[Phi]Dx", "[", 
       RowBox[{"[", "1", "]"}], "]"}], "[", 
      RowBox[{"[", "2", "]"}], "]"}], ",", 
     RowBox[{
      RowBox[{"D\[Phi]Dx", "[", 
       RowBox[{"[", "2", "]"}], "]"}], "[", 
      RowBox[{"[", "2", "]"}], "]"}], ",", 
     RowBox[{
      RowBox[{"D\[Phi]Dx", "[", 
       RowBox[{"[", "3", "]"}], "]"}], "[", 
      RowBox[{"[", "2", "]"}], "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"D\[Phi]Dx", "[", 
       RowBox[{"[", "1", "]"}], "]"}], "[", 
      RowBox[{"[", "3", "]"}], "]"}], ",", 
     RowBox[{
      RowBox[{"D\[Phi]Dx", "[", 
       RowBox[{"[", "2", "]"}], "]"}], "[", 
      RowBox[{"[", "3", "]"}], "]"}], ",", 
     RowBox[{
      RowBox[{"D\[Phi]Dx", "[", 
       RowBox[{"[", "3", "]"}], "]"}], "[", 
      RowBox[{"[", "3", "]"}], "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"D\[Phi]Dx", "[", 
       RowBox[{"[", "1", "]"}], "]"}], "[", 
      RowBox[{"[", "4", "]"}], "]"}], ",", 
     RowBox[{
      RowBox[{"D\[Phi]Dx", "[", 
       RowBox[{"[", "2", "]"}], "]"}], "[", 
      RowBox[{"[", "4", "]"}], "]"}], ",", 
     RowBox[{
      RowBox[{"D\[Phi]Dx", "[", 
       RowBox[{"[", "3", "]"}], "]"}], "[", 
      RowBox[{"[", "4", "]"}], "]"}]}], "\[IndentingNewLine]", "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"zeros", " ", "=", " ", 
   RowBox[{"Table", "[", 
    RowBox[{"0.0", ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", "4"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Nb", "=", 
   RowBox[{"{", 
    RowBox[{
    "\[Phi]s", ",", "\[Phi]s", ",", "\[Phi]s", ",", "zeros", ",", "zeros", 
     ",", "zeros"}], "}"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.7173602746482644`*^9, 3.717360595407016*^9}, {
  3.7173679545623984`*^9, 3.717368016994071*^9}, {3.7173686738090096`*^9, 
  3.7173688008877954`*^9}, {3.717369134558451*^9, 3.7173691870734324`*^9}, {
  3.717415750201002*^9, 3.7174157973412743`*^9}, {3.7174158656066456`*^9, 
  3.717415993127372*^9}, {3.7174178972678013`*^9, 3.717417921642746*^9}, {
  3.7633923206598988`*^9, 3.7633923613791695`*^9}, {3.7633966157541084`*^9, 
  3.763396628163429*^9}, {3.7633967128971925`*^9, 3.7633967314679966`*^9}, {
  3.763398562028678*^9, 3.7633986048635654`*^9}, {3.771085492580638*^9, 
  3.7710854955244665`*^9}, {3.7710855268193264`*^9, 3.771085579818614*^9}, {
  3.7710928681860933`*^9, 3.7710929125050726`*^9}, {3.771093187354332*^9, 
  3.7710933058444386`*^9}},
 CellLabel->"In[13]:=",ExpressionUUID->"e64abb88-b189-486a-9a4f-8636f8a9bb0d"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Define a stiffness tensor:", "Subsection",
 CellChangeTimes->{{3.717171037170329*^9, 
  3.717171055154701*^9}},ExpressionUUID->"e0531742-37ee-4fb9-9b9b-\
1434a0453a0d"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"(", 
   RowBox[{"S", "=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         FractionBox["kv", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "+", "vv"}], ")"}], 
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"2", " ", "vv"}]}], ")"}]}]], 
         RowBox[{"(", 
          RowBox[{"1", "-", "vv"}], ")"}]}], ",", 
        RowBox[{
         FractionBox["kv", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "+", "vv"}], ")"}], 
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"2", " ", "vv"}]}], ")"}]}]], " ", "vv"}], ",", 
        RowBox[{
         FractionBox["kv", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "+", "vv"}], ")"}], 
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"2", " ", "vv"}]}], ")"}]}]], " ", "vv"}], ",", "0", ",",
         "0", ",", "0"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         FractionBox["kv", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "+", "vv"}], ")"}], 
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"2", " ", "vv"}]}], ")"}]}]], " ", "vv"}], ",", 
        RowBox[{
         FractionBox["kv", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "+", "vv"}], ")"}], 
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"2", " ", "vv"}]}], ")"}]}]], " ", 
         RowBox[{"(", 
          RowBox[{"1", "-", "vv"}], ")"}]}], ",", 
        RowBox[{
         FractionBox["kv", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "+", "vv"}], ")"}], 
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"2", " ", "vv"}]}], ")"}]}]], " ", "vv"}], ",", "0", ",",
         "0", ",", "0"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         FractionBox["kv", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "+", "vv"}], ")"}], 
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"2", " ", "vv"}]}], ")"}]}]], " ", "vv"}], ",", 
        RowBox[{
         FractionBox["kv", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "+", "vv"}], ")"}], 
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"2", " ", "vv"}]}], ")"}]}]], " ", "vv"}], ",", 
        RowBox[{
         FractionBox["kv", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "+", "vv"}], ")"}], 
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"2", " ", "vv"}]}], ")"}]}]], " ", 
         RowBox[{"(", 
          RowBox[{"1", "-", "vv"}], ")"}]}], ",", "0", ",", "0", ",", "0"}], 
       "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "0", ",", 
        RowBox[{
         RowBox[{"1", "/", "2"}], " ", 
         FractionBox["kv", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "+", "vv"}], ")"}], 
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"2", " ", "vv"}]}], ")"}]}]], " ", 
         RowBox[{"(", 
          RowBox[{"1", "-", 
           RowBox[{"2", " ", "vv"}]}], ")"}]}], ",", "0", ",", "0"}], "}"}], 
      ",", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", 
        RowBox[{
         RowBox[{"1", "/", "2"}], " ", 
         FractionBox["kv", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "+", "vv"}], ")"}], 
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"2", " ", "vv"}]}], ")"}]}]], " ", 
         RowBox[{"(", 
          RowBox[{"1", "-", 
           RowBox[{"2", " ", "vv"}]}], ")"}]}], ",", "0"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
        RowBox[{
         RowBox[{"1", "/", "2"}], " ", 
         FractionBox["kv", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "+", "vv"}], ")"}], 
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"2", " ", "vv"}]}], ")"}]}]], " ", 
         RowBox[{"(", 
          RowBox[{"1", "-", 
           RowBox[{"2", " ", "vv"}]}], ")"}]}]}], "}"}]}], "}"}]}], ")"}], "//",
   "MatrixForm"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(", 
   RowBox[{"s", "=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"\[Mu]", ",", "0", ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "\[Mu]", ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "\[Mu]"}], "}"}]}], "}"}]}], ")"}], "//", 
  "MatrixForm"}]}], "Input",
 CellChangeTimes->{{3.7167628480497184`*^9, 3.716762972237756*^9}, {
   3.716763132980883*^9, 3.7167631890087504`*^9}, {3.717157475771058*^9, 
   3.717157528260871*^9}, {3.7174160414866905`*^9, 3.717416148690319*^9}, 
   3.7633924265623446`*^9, 3.763392465685731*^9, {3.763393084507081*^9, 
   3.7633930846862936`*^9}},
 CellLabel->"In[18]:=",ExpressionUUID->"1904a229-808b-4bbc-bee2-eba48389eded"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      FractionBox[
       RowBox[{"kv", " ", 
        RowBox[{"(", 
         RowBox[{"1", "-", "vv"}], ")"}]}], 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "-", 
          RowBox[{"2", " ", "vv"}]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{"1", "+", "vv"}], ")"}]}]], 
      FractionBox[
       RowBox[{"kv", " ", "vv"}], 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "-", 
          RowBox[{"2", " ", "vv"}]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{"1", "+", "vv"}], ")"}]}]], 
      FractionBox[
       RowBox[{"kv", " ", "vv"}], 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "-", 
          RowBox[{"2", " ", "vv"}]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{"1", "+", "vv"}], ")"}]}]], "0", "0", "0"},
     {
      FractionBox[
       RowBox[{"kv", " ", "vv"}], 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "-", 
          RowBox[{"2", " ", "vv"}]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{"1", "+", "vv"}], ")"}]}]], 
      FractionBox[
       RowBox[{"kv", " ", 
        RowBox[{"(", 
         RowBox[{"1", "-", "vv"}], ")"}]}], 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "-", 
          RowBox[{"2", " ", "vv"}]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{"1", "+", "vv"}], ")"}]}]], 
      FractionBox[
       RowBox[{"kv", " ", "vv"}], 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "-", 
          RowBox[{"2", " ", "vv"}]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{"1", "+", "vv"}], ")"}]}]], "0", "0", "0"},
     {
      FractionBox[
       RowBox[{"kv", " ", "vv"}], 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "-", 
          RowBox[{"2", " ", "vv"}]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{"1", "+", "vv"}], ")"}]}]], 
      FractionBox[
       RowBox[{"kv", " ", "vv"}], 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "-", 
          RowBox[{"2", " ", "vv"}]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{"1", "+", "vv"}], ")"}]}]], 
      FractionBox[
       RowBox[{"kv", " ", 
        RowBox[{"(", 
         RowBox[{"1", "-", "vv"}], ")"}]}], 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "-", 
          RowBox[{"2", " ", "vv"}]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{"1", "+", "vv"}], ")"}]}]], "0", "0", "0"},
     {"0", "0", "0", 
      FractionBox["kv", 
       RowBox[{"2", " ", 
        RowBox[{"(", 
         RowBox[{"1", "+", "vv"}], ")"}]}]], "0", "0"},
     {"0", "0", "0", "0", 
      FractionBox["kv", 
       RowBox[{"2", " ", 
        RowBox[{"(", 
         RowBox[{"1", "+", "vv"}], ")"}]}]], "0"},
     {"0", "0", "0", "0", "0", 
      FractionBox["kv", 
       RowBox[{"2", " ", 
        RowBox[{"(", 
         RowBox[{"1", "+", "vv"}], ")"}]}]]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmVkYGDQAOJHV7mPa2587bjzNe8FLSCdtXVF7ksgzXE3OPwVkL5c
Fr3Fa9Nrx91TeWZnAOmrAhNrM4F02tNkq5vbXzte26PM/mDHa8cFX66UWO98
7XhpZnteDJB29BM5obn3tWN9sX8u677XjsqmZtrvgLRCUmZD1vHXjla2G277
3Hvt6Fnc+UuS643jnwNH3aWAtJZFQ0EW9xvH4M6U2ZOAdFzvi387gbRafkbn
OyDNxa2l9R1It0xf2DeN543ju08Tc7cB6Scb5j1P4XvjKLPPtthX9I2jb6C8
XAWQXpnHuuaoxBvH9sTW9JdA+tGC6H1Ckm8cU4zPPBOXeuOo0fC4WQpIX1Go
Oqul+MbRVXvpqsh1QPO7j757uv6NY3J8oON8mbeOk5RW8OrJvnX0c/rvWAWk
101ewXVe/q0jAPsHoRk=
  "],
 CellLabel->
  "Out[18]//MatrixForm=",ExpressionUUID->"b48225c4-6725-4666-bdd5-\
1b2e5b1c2716"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"\[Mu]", "0", "0"},
     {"0", "\[Mu]", "0"},
     {"0", "0", "\[Mu]"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmVkYGDQAOJHV7mPa2587bjzNe8FLSCdtXVF7ksgzXE3OPwVkL5c
Fr3Fa9Nrx91TeWZnAOmrAhNrM4F02tNkq5vbXzte26PM/mDHa8cFX66UWO98
7XhpZnteDJB29BM5obn3tWN9sX8u677XjsqmZtrvgLRCUmZD1vHXjla2G277
3Hvt6Fnc+UuS643jnwNH3aWAtJZFQ0EW9xvH4M6U2ZOAdFzvi387gbRafkbn
OyDNxa2l9R1It0xf2DeN543ju08Tc7cB6Scb5j1P4XvjKLPPtthX9I2jb6C8
XAWQXpnHuuaoxBvH9sTW9JdA+tGC6H1Ckm8cU4zPPBOXeuOo0fC4WQpIX1Go
Oqul+MbRVXvpqsh1QPO7j757uv6NY3J8oON8mbeOk5RW8OrJvnX0c/rvWAWk
Y9at4Dov/9YRAPk0oOI=
  "],
 CellLabel->
  "Out[19]//MatrixForm=",ExpressionUUID->"d90ff828-59a9-4bdd-8266-\
74540dc09edc"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Define the local stiffness matrix (Note that the absolute value of the \
Jacobian determinant is used.  The mesh from omega_h can have inside out \
elements.):\
\>", "Subsection",
 CellChangeTimes->{{3.7171710837254143`*^9, 3.717171091066893*^9}, {
  3.7174287074048176`*^9, 
  3.7174287551552706`*^9}},ExpressionUUID->"7ea9acce-18ef-49bb-840e-\
cce9f6963895"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Kmm", "[", 
    RowBox[{
    "x1_", ",", "y1_", ",", "z1_", ",", "x2_", ",", "y2_", ",", "z2_", ",", 
     "x3_", ",", "y3_", ",", "z3_", ",", "x4_", ",", "y4_", ",", "z4_", ",", 
     "kv_", ",", "vv_"}], "]"}], "=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"Transpose", "[", "B", "]"}], ".", "S", ".", "B"}], ")"}], 
    RowBox[{"Abs", "[", "detj", "]"}]}]}], " ", ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"KmmmNoDet", "[", 
    RowBox[{
    "x1_", ",", "y1_", ",", "z1_", ",", "x2_", ",", "y2_", ",", "z2_", ",", 
     "x3_", ",", "y3_", ",", "z3_", ",", "x4_", ",", "y4_", ",", "z4_", ",", 
     "kv_", ",", "vv_"}], "]"}], "=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"Transpose", "[", "B", "]"}], ".", "S", ".", "B"}], ")"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"KmmNoAbs", "[", 
    RowBox[{
    "x1_", ",", "y1_", ",", "z1_", ",", "x2_", ",", "y2_", ",", "z2_", ",", 
     "x3_", ",", "y3_", ",", "z3_", ",", "x4_", ",", "y4_", ",", "z4_", ",", 
     "kv_", ",", "vv_"}], "]"}], "=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"Transpose", "[", "B", "]"}], ".", "S", ".", "B"}], ")"}], 
    "detj"}]}], " ", ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Detj", "[", 
    RowBox[{
    "x1_", ",", "y1_", ",", "z1_", ",", "x2_", ",", "y2_", ",", "z2_", ",", 
     "x3_", ",", "y3_", ",", "z3_", ",", "x4_", ",", "y4_", ",", "z4_"}], 
    "]"}], "=", "detj"}], " ", ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Gmatrix", "[", 
    RowBox[{
    "x1_", ",", "y1_", ",", "z1_", ",", "x2_", ",", "y2_", ",", "z2_", ",", 
     "x3_", ",", "y3_", ",", "z3_", ",", "x4_", ",", "y4_", ",", "z4_"}], 
    "]"}], "=", "B"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ktt", "[", 
    RowBox[{
    "x1_", ",", "y1_", ",", "z1_", ",", "x2_", ",", "y2_", ",", "z2_", ",", 
     "x3_", ",", "y3_", ",", "z3_", ",", "x4_", ",", "y4_", ",", "z4_", ",", 
     "\[Mu]_"}], "]"}], "=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"Transpose", "[", "b", "]"}], ".", "s", ".", "b"}], ")"}], 
    RowBox[{"Abs", "[", "detj", "]"}]}]}], " ", ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"kttNoDet", "[", 
    RowBox[{
    "x1_", ",", "y1_", ",", "z1_", ",", "x2_", ",", "y2_", ",", "z2_", ",", 
     "x3_", ",", "y3_", ",", "z3_", ",", "x4_", ",", "y4_", ",", "z4_", ",", 
     "\[Mu]_"}], "]"}], "=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"Transpose", "[", "b", "]"}], ".", "s", ".", "b"}], ")"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"kttNoAbs", "[", 
    RowBox[{
    "x1_", ",", "y1_", ",", "z1_", ",", "x2_", ",", "y2_", ",", "z2_", ",", 
     "x3_", ",", "y3_", ",", "z3_", ",", "x4_", ",", "y4_", ",", "z4_", ",", 
     "\[Mu]_"}], "]"}], "=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"Transpose", "[", "b", "]"}], ".", "s", ".", "b"}], ")"}], 
    "detj"}]}], " ", ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"kmt", "[", 
    RowBox[{
    "x1_", ",", "y1_", ",", "z1_", ",", "x2_", ",", "y2_", ",", "z2_", ",", 
     "x3_", ",", "y3_", ",", "z3_", ",", "x4_", ",", "y4_", ",", "z4_", ",", 
     "\[Alpha]_", ",", "kv_", ",", "vv_"}], "]"}], "=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"Transpose", "[", "B", "]"}], ".", "S", ".", 
      RowBox[{"(", 
       RowBox[{"\[Alpha]", " ", "Nb"}], ")"}]}], ")"}], 
    RowBox[{"Abs", "[", "detj", "]"}]}]}], " ", ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"kmtNoDet", "[", 
    RowBox[{
    "x1_", ",", "y1_", ",", "z1_", ",", "x2_", ",", "y2_", ",", "z2_", ",", 
     "x3_", ",", "y3_", ",", "z3_", ",", "x4_", ",", "y4_", ",", "z4_", ",", 
     "\[Alpha]_", ",", "kv_", ",", "vv_"}], "]"}], "=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"Transpose", "[", "B", "]"}], ".", "S", ".", 
     RowBox[{"(", 
      RowBox[{"\[Alpha]", " ", "Nb"}], ")"}]}], ")"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"kmtNoAbs", "[", 
    RowBox[{
    "x1_", ",", "y1_", ",", "z1_", ",", "x2_", ",", "y2_", ",", "z2_", ",", 
     "x3_", ",", "y3_", ",", "z3_", ",", "x4_", ",", "y4_", ",", "z4_", ",", 
     "\[Alpha]_", ",", "kv_", ",", "vv_"}], "]"}], "=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"Transpose", "[", "B", "]"}], ".", "S", ".", 
      RowBox[{"(", 
       RowBox[{"\[Alpha]", " ", "Nb"}], ")"}]}], ")"}], "detj"}]}], " ", 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"gmatrix", "[", 
    RowBox[{
    "x1_", ",", "y1_", ",", "z1_", ",", "x2_", ",", "y2_", ",", "z2_", ",", 
     "x3_", ",", "y3_", ",", "z3_", ",", "x4_", ",", "y4_", ",", "z4_"}], 
    "]"}], "=", "b"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"gDivmatrix", "[", 
    RowBox[{
    "x1_", ",", "y1_", ",", "z1_", ",", "x2_", ",", "y2_", ",", "z2_", ",", 
     "x3_", ",", "y3_", ",", "z3_", ",", "x4_", ",", "y4_", ",", "z4_"}], 
    "]"}], "=", "bDiv"}], ";"}]}], "Input",
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmViYGCQB2IQ7TPxxzrNja8dvf8v3wqiZzH+PwmijTjFT4Hod98v
XgHRspXbboLolBc5sq+A9KmrU8H00eLDGiBaWEtYE0TXeavog+iAueZg2lfp
SSSINlE6EgWi34hPm5ex6bXj25n280H0JVePtkwg/fiIVBeIDgmOmJkNpPmu
7QTTYnJu0tp7XztmyLwF03XVv6xBdN/0yTYgWkjvWQyI/mQwMRZEnzBenAui
ldalFYJov/PhS0G01Nlfy8HqZzG/ZN332nGB+Ot3IPrejMnibEB62gxhCRCt
fSZdORhIP9G4ogKik+3mnfgKpP/fFDkFol0C2fWkuN44phq0m4Hob4d6XED0
EhcmTxCttXxSkDSQNjNgjQLRxbXHf4DoGx83/ALRt0Tm/wfRfprnwHTFLQEh
GSD9yE9RAkR3BRszyAJpH5tUNhD9/Oju1BzuN46371/PANF77vnkg2gd1YwC
MD9RuWIbzxvHZ8sdwXS3xpoaEG2zqqwWRKdf2JBxTOKNY1MbQxaIBgAOTvOY

  "],
 CellLabel->"In[20]:=",ExpressionUUID->"2941a37d-ac65-4083-89e8-a27577f192a2"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"nnodes", "=", "4"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"nmdofs", "=", "4"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ndims", "=", "3"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ntdofs", "=", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ndofs", "=", 
   RowBox[{"nmdofs", "+", "ntdofs"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Mmat", "[", 
    RowBox[{
    "x1_", ",", "y1_", ",", "z1_", ",", "x2_", ",", "y2_", ",", "z2_", ",", 
     "x3_", ",", "y3_", ",", "z3_", ",", "x4_", ",", "y4_", ",", "z4_", ",", 
     "\[Rho]_", ",", "Cp_"}], "]"}], "=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"Transpose", "[", 
       RowBox[{"{", "\[Phi]s", "}"}], "]"}], ".", 
      RowBox[{"(", 
       RowBox[{"\[Rho]", " ", "Cp", " ", 
        RowBox[{"{", "\[Phi]s", "}"}]}], ")"}]}], ")"}], 
    RowBox[{"Abs", "[", "detj", "]"}]}]}], " ", ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MmatNoAbs", "[", 
    RowBox[{
    "x1_", ",", "y1_", ",", "z1_", ",", "x2_", ",", "y2_", ",", "z2_", ",", 
     "x3_", ",", "y3_", ",", "z3_", ",", "x4_", ",", "y4_", ",", "z4_", ",", 
     "\[Rho]_", ",", "Cp_"}], "]"}], "=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"Transpose", "[", 
       RowBox[{"{", "\[Phi]s", "}"}], "]"}], ".", 
      RowBox[{"(", 
       RowBox[{"\[Rho]", " ", "Cp", " ", 
        RowBox[{"{", "\[Phi]s", "}"}]}], ")"}]}], ")"}], "detj"}]}], " ", 
  ";"}]}], "Input",
 CellChangeTimes->{{3.720277340993009*^9, 3.72027737961343*^9}, {
  3.7202774283513937`*^9, 3.7202774293658648`*^9}, {3.720278067092781*^9, 
  3.720278074392303*^9}, {3.764761576482154*^9, 3.7647615869027395`*^9}, {
  3.7656431414876575`*^9, 3.765643145187323*^9}, {3.7656432037814827`*^9, 
  3.7656432102505865`*^9}, {3.769265151808098*^9, 3.769265152047535*^9}, {
  3.7710921870522747`*^9, 3.7710921877669563`*^9}, {3.7717872101183257`*^9, 
  3.771787245086369*^9}, {3.907320346111364*^9, 3.907320411518299*^9}},
 CellLabel->"In[33]:=",ExpressionUUID->"23484c70-aeb6-48e3-8efa-1fbe59937941"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"gp", "=", 
   RowBox[{"{", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"1", "/", "4"}], ",", 
      RowBox[{"1", "/", "4"}], ",", 
      RowBox[{"1", "/", "4"}]}], "}"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"gw", "=", 
   RowBox[{"{", 
    RowBox[{"1", "/", "6"}], "}"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.9077785177502213`*^9, 3.9077785330565977`*^9}, {
  3.907778666595892*^9, 3.907778667172037*^9}, {3.907927771605979*^9, 
  3.907927776071334*^9}},ExpressionUUID->"e8d96bf7-5299-4eb9-ac6c-\
ac7b7f469e22"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"gp", " ", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "0.585410196624969", ",", " ", "0.138196601125011", ",", " ", 
       "0.138196601125011"}], "}"}], ",", "\n", "           ", 
     RowBox[{"{", 
      RowBox[{
      "0.138196601125011", ",", " ", "0.585410196624969", ",", " ", 
       "0.138196601125011"}], "}"}], ",", "\n", "           ", 
     RowBox[{"{", 
      RowBox[{
      "0.138196601125011", ",", " ", "0.138196601125011", ",", " ", 
       "0.585410196624969"}], "}"}], ",", "\n", "          ", 
     RowBox[{"{", 
      RowBox[{
      "0.138196601125011", ",", " ", "0.138196601125011", ",", " ", 
       "0.138196601125011"}], "}"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"gw", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"1", "/", "24"}], ",", 
     RowBox[{"1", "/", "24"}], ",", 
     RowBox[{"1", "/", "24"}], ",", 
     RowBox[{"1", "/", "24"}]}], "}"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.720277340993009*^9, 3.72027737961343*^9}, {
  3.7202774283513937`*^9, 3.7202774293658648`*^9}, {3.720278067092781*^9, 
  3.720278074392303*^9}, {3.9012095464404793`*^9, 3.901209641848001*^9}},
 CellLabel->"In[40]:=",ExpressionUUID->"16f4ca74-b82f-43c8-aefd-357357e39807"]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Define the mesh.  This mesh is produced by the build_box function in Omega_h.\
\>", "Subsection",
 CellChangeTimes->{{3.717171103353293*^9, 3.71717112863015*^9}, {
  3.7171711761508427`*^9, 
  3.717171184346429*^9}},ExpressionUUID->"ece979a0-cd8c-46e0-964f-\
a58a6156d72c"],

Cell[BoxData[
 RowBox[{
  RowBox[{"connect", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "12", ",", "3", ",", "13"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "3", ",", "4", ",", "13"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "4", ",", "1", ",", "13"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "1", ",", "10", ",", "13"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "10", ",", "9", ",", "13"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "9", ",", "12", ",", "13"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "13", ",", "4", ",", "14"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "4", ",", "5", ",", "14"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "5", ",", "2", ",", "14"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "2", ",", "11", ",", "14"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "11", ",", "10", ",", "14"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "10", ",", "13", ",", "14"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"3", ",", "15", ",", "6", ",", "16"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"3", ",", "6", ",", "7", ",", "16"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"3", ",", "7", ",", "4", ",", "16"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"3", ",", "4", ",", "13", ",", "16"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"3", ",", "13", ",", "12", ",", "16"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"3", ",", "12", ",", "15", ",", "16"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"4", ",", "16", ",", "7", ",", "17"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"4", ",", "7", ",", "8", ",", "17"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"4", ",", "8", ",", "5", ",", "17"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"4", ",", "5", ",", "14", ",", "17"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"4", ",", "14", ",", "13", ",", "17"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"4", ",", "13", ",", "16", ",", "17"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"9", ",", "21", ",", "12", ",", "22"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"9", ",", "12", ",", "13", ",", "22"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"9", ",", "13", ",", "10", ",", "22"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"9", ",", "10", ",", "19", ",", "22"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"9", ",", "19", ",", "18", ",", "22"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"9", ",", "18", ",", "21", ",", "22"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"10", ",", "22", ",", "13", ",", "23"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"10", ",", "13", ",", "14", ",", "23"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"10", ",", "14", ",", "11", ",", "23"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"10", ",", "11", ",", "20", ",", "23"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"10", ",", "20", ",", "19", ",", "23"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"10", ",", "19", ",", "22", ",", "23"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"12", ",", "24", ",", "15", ",", "25"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"12", ",", "15", ",", "16", ",", "25"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"12", ",", "16", ",", "13", ",", "25"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"12", ",", "13", ",", "22", ",", "25"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"12", ",", "22", ",", "21", ",", "25"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"12", ",", "21", ",", "24", ",", "25"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"13", ",", "25", ",", "16", ",", "26"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"13", ",", "16", ",", "17", ",", "26"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"13", ",", "17", ",", "14", ",", "26"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"13", ",", "14", ",", "23", ",", "26"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"13", ",", "23", ",", "22", ",", "26"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"13", ",", "22", ",", "25", ",", "26"}], "}"}]}], "}"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.7174169577864523`*^9, 3.7174169658023443`*^9}, 
   3.717417651397601*^9, {3.76409786087125*^9, 3.7640978639703207`*^9}, {
   3.7640978943425765`*^9, 3.7640978954822354`*^9}, {3.849008712370339*^9, 
   3.8490087306012497`*^9}},
 CellLabel->"In[42]:=",ExpressionUUID->"de8a61f1-6c53-4fb8-b681-21ddd1c8e305"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"xv", "=", 
   RowBox[{"{", 
    RowBox[{
    "0.0", ",", "0.0", ",", "0.0", ",", "0.0", ",", "0.0", ",", "0.0", ",", 
     "0.0", ",", "0.0", ",", "0.0", ",", "0.5", ",", "0.5", ",", "0.5", ",", 
     "0.5", ",", "0.5", ",", "0.5", ",", "0.5", ",", "0.5", ",", "0.5", ",", 
     "1.0", ",", "1.0", ",", "1.0", ",", "1.0", ",", "1.0", ",", "1.0", ",", 
     "1.0", ",", "1.0", ",", "1.0"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"yv", "=", 
   RowBox[{"{", 
    RowBox[{
    "0.0", ",", "0.0", ",", "0.0", ",", "0.5", ",", "0.5", ",", "0.5", ",", 
     "1.0", ",", " ", "1.0", ",", " ", "1.0", ",", "0.0", ",", " ", "0.0", 
     ",", " ", "0.0", ",", "0.5", ",", " ", "0.5", ",", " ", "0.5", ",", 
     "1.0", ",", " ", "1.0", ",", " ", "1.0", ",", "0.0", ",", " ", "0.0", 
     ",", " ", "0.0", ",", "0.5", ",", " ", "0.5", ",", " ", "0.5", ",", 
     "1.0", ",", " ", "1.0", ",", " ", "1.0"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"zv", "=", 
   RowBox[{"{", 
    RowBox[{
    "0.0", ",", " ", "0.5", ",", " ", "1.0", ",", "0.0", ",", " ", "0.5", ",",
      " ", "1.0", ",", "0.0", ",", " ", "0.5", ",", " ", "1.0", ",", "0.0", 
     ",", "0.5", ",", "1.0", ",", "0.0", ",", " ", "0.5", ",", " ", "1.0", 
     ",", "0.0", ",", " ", "0.5", ",", " ", "1.0", ",", "0.0", ",", " ", 
     "0.5", ",", " ", "1.0", ",", "0.0", ",", " ", "0.5", ",", " ", "1.0", 
     ",", "0.0", ",", " ", "0.5", ",", " ", "1.0"}], "}"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.7174174700232644`*^9, 3.7174174845856824`*^9}, {
  3.717417517163823*^9, 3.717417642288141*^9}, {3.7210467593944297`*^9, 
  3.7210467621477776`*^9}, {3.849008737603016*^9, 3.8490087975493383`*^9}, {
  3.8490394034966097`*^9, 3.849039442363715*^9}, {3.84903949928415*^9, 
  3.849039511928667*^9}, {3.849039557090678*^9, 3.84903958355398*^9}, {
  3.849040182904023*^9, 3.849040499401132*^9}, {3.849040541554579*^9, 
  3.8490405432435417`*^9}},
 CellLabel->"In[43]:=",ExpressionUUID->"99529d24-9263-4a10-b398-54da7768de89"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[Rho]v", "=", 
  RowBox[{"Table", "[", 
   RowBox[{"1.0", ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "1", ",", 
      RowBox[{"Length", "[", "xv", "]"}]}], "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.7209938116705494`*^9, 3.7209938528649826`*^9}},
 CellLabel->"In[46]:=",ExpressionUUID->"e9fc3f76-5d3f-417b-acc7-bdfaf372c654"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "1.`", ",", "1.`", ",", "1.`", ",", "1.`", ",", "1.`", ",", "1.`", ",", 
   "1.`", ",", "1.`", ",", "1.`", ",", "1.`", ",", "1.`", ",", "1.`", ",", 
   "1.`", ",", "1.`", ",", "1.`", ",", "1.`", ",", "1.`", ",", "1.`", ",", 
   "1.`", ",", "1.`", ",", "1.`", ",", "1.`", ",", "1.`", ",", "1.`", ",", 
   "1.`", ",", "1.`", ",", "1.`"}], "}"}]], "Output",
 CellChangeTimes->{3.7209938545509453`*^9, 3.7210612745209227`*^9, 
  3.723054679712879*^9, 3.72350454129504*^9, 3.7239811528858366`*^9, 
  3.7284300924333024`*^9, 3.7404280094843683`*^9, 3.7633940799093127`*^9, 
  3.764081557678941*^9, 3.7641638161742373`*^9, 3.7642444821928463`*^9, 
  3.7643520906318407`*^9, 3.764369779082593*^9, 3.764696345668995*^9, 
  3.764761606730977*^9, 3.765643088987829*^9, 3.769265172573456*^9, 
  3.769352447647868*^9, 3.771084145438262*^9, 3.7711573281644335`*^9, 
  3.7712419852074895`*^9, 3.771776842391842*^9, 3.771782193182083*^9, 
  3.7754855700323973`*^9, 3.8495061806313562`*^9, 3.850317686222375*^9, 
  3.907320423264228*^9, 3.907612792398285*^9, 3.90776884806669*^9, 
  3.90899107193762*^9},
 CellLabel->"Out[46]=",ExpressionUUID->"7ad620a9-fa06-422c-aed6-79c212c0776e"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"uv", "=", 
   RowBox[{"Table", "[", 
    RowBox[{"0.0", ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"ndofs", "*", 
        RowBox[{"Length", "[", "xv", "]"}]}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"For", "[", 
  RowBox[{
   RowBox[{"i", "=", "0"}], ",", 
   RowBox[{"i", "<", 
    RowBox[{"Length", "[", "xv", "]"}]}], ",", 
   RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"uv", "[", 
      RowBox[{"[", 
       RowBox[{
        RowBox[{"i", "*", "ndofs"}], "+", "1"}], "]"}], "]"}], "=", 
     RowBox[{"1", "*", 
      SuperscriptBox["10", 
       RowBox[{"-", "7"}]], "i"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"uv", "[", 
      RowBox[{"[", 
       RowBox[{
        RowBox[{"i", "*", "ndofs"}], "+", "2"}], "]"}], "]"}], "=", 
     RowBox[{"2", "*", 
      SuperscriptBox["10", 
       RowBox[{"-", "7"}]], "i"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"uv", "[", 
      RowBox[{"[", 
       RowBox[{
        RowBox[{"i", "*", "ndofs"}], "+", "3"}], "]"}], "]"}], "=", 
     RowBox[{"3", "*", 
      SuperscriptBox["10", 
       RowBox[{"-", "7"}]], "i"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"uv", "[", 
      RowBox[{"[", 
       RowBox[{
        RowBox[{"i", "*", "ndofs"}], "+", "4"}], "]"}], "]"}], "=", 
     RowBox[{"5", "*", 
      SuperscriptBox["10", 
       RowBox[{"-", "7"}]], "i"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"uv", "[", 
      RowBox[{"[", 
       RowBox[{
        RowBox[{"i", "*", "ndofs"}], "+", "5"}], "]"}], "]"}], "=", 
     RowBox[{"4", "*", 
      SuperscriptBox["10", 
       RowBox[{"-", "7"}]], "i"}]}], ";"}]}], "\[IndentingNewLine]", 
  "]"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.7210466573505106`*^9, 3.721046659816079*^9}, {
  3.721046777601693*^9, 3.721046848873374*^9}, {3.763394142897538*^9, 
  3.763394168547328*^9}, {3.7641026246306195`*^9, 3.7641026375151596`*^9}, {
  3.764102795449109*^9, 3.764102980220702*^9}, {3.769265186377054*^9, 
  3.7692652401206427`*^9}, {3.7692653082026725`*^9, 3.7692653101734695`*^9}, {
  3.7693481954366436`*^9, 3.769348243853516*^9}, {3.769349281849121*^9, 
  3.769349333541481*^9}, {3.7711096778946404`*^9, 3.7711096782151613`*^9}, {
  3.775486037644456*^9, 3.775486038145974*^9}, {3.775488586071459*^9, 
  3.775488586368865*^9}, {3.77550511093764*^9, 3.775505112566134*^9}, {
  3.775505187215015*^9, 3.775505195005827*^9}, {3.849530891888699*^9, 
  3.849530948420909*^9}},
 CellLabel->"In[47]:=",ExpressionUUID->"8fff26c6-f1fb-4a2e-a59f-ee82cd202746"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"nodesPerCell", "=", "4"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"numDim", "=", "3"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[CapitalPi]v", "=", 
   RowBox[{"Table", "[", 
    RowBox[{"0.0", ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"Length", "[", "connect", "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "1", ",", "nodesPerCell"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"k", ",", "1", ",", "numDim"}], "}"}]}], "]"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.7693493287791457`*^9, 3.7693493358225255`*^9}, {
  3.769350177924984*^9, 3.7693502010483575`*^9}},
 CellLabel->"In[49]:=",ExpressionUUID->"e2ac3595-0f89-4199-bfb0-55870bd56912"],

Cell[BoxData[
 RowBox[{"For", "[", 
  RowBox[{
   RowBox[{"iCell", "=", "0"}], ",", 
   RowBox[{"iCell", "<", 
    RowBox[{"Length", "[", "connect", "]"}]}], ",", 
   RowBox[{"iCell", "++"}], ",", "\[IndentingNewLine]", 
   RowBox[{"For", "[", 
    RowBox[{
     RowBox[{"iNode", "=", "0"}], ",", 
     RowBox[{"iNode", "<", "nodesPerCell"}], ",", 
     RowBox[{"iNode", "++"}], ",", "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"iDim", "=", "0"}], ",", 
       RowBox[{"iDim", "<", "numDim"}], ",", 
       RowBox[{"iDim", "++"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"\[CapitalPi]v", "[", 
            RowBox[{"[", 
             RowBox[{"iCell", "+", "1"}], "]"}], "]"}], "[", 
           RowBox[{"[", 
            RowBox[{"iNode", "+", "1"}], "]"}], "]"}], "[", 
          RowBox[{"[", 
           RowBox[{"iDim", "+", "1"}], "]"}], "]"}], "=", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"4", "*", 
            SuperscriptBox["10", 
             RowBox[{"-", "7"}]]}], ")"}], 
          RowBox[{"(", 
           RowBox[{"iNode", "+", "1"}], ")"}], 
          RowBox[{"(", 
           RowBox[{"iDim", "+", "1"}], ")"}], 
          RowBox[{"(", 
           RowBox[{"iCell", "+", "1"}], ")"}]}]}], ";"}]}], 
      "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]}], 
  "\[IndentingNewLine]", "]"}]], "Input",
 CellChangeTimes->{{3.769348264174719*^9, 3.7693483808785434`*^9}, {
  3.7693491734100585`*^9, 3.769349264173422*^9}, {3.769349318668339*^9, 
  3.7693493428868947`*^9}, {3.7693502060433273`*^9, 3.769350213962516*^9}, {
  3.775505146422883*^9, 3.775505147123475*^9}},
 CellLabel->"In[52]:=",ExpressionUUID->"2229bed7-4721-457d-8b14-a986c2a6590d"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"VoigtIdentity", "=", 
   RowBox[{"{", 
    RowBox[{"1", ",", "1", ",", "1", ",", "0", ",", "0", ",", "0"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"VoigtTrace", "[", "v_", "]"}], ":=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"v", "[", 
      RowBox[{"[", "1", "]"}], "]"}], "+", 
     RowBox[{"v", "[", 
      RowBox[{"[", "2", "]"}], "]"}], "+", 
     RowBox[{"v", "[", 
      RowBox[{"[", "3", "]"}], "]"}]}], ")"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.7692677690960507`*^9, 3.769267777428508*^9}, {
  3.769267896432599*^9, 3.7692679783114457`*^9}},
 CellLabel->"In[53]:=",ExpressionUUID->"cee8c193-3206-48ae-8405-01b1f75dcc66"],

Cell[BoxData[
 RowBox[{
  RowBox[{"matProps", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Gm", "\[Rule]", 
      FractionBox["kv", 
       RowBox[{"2", 
        RowBox[{"(", 
         RowBox[{"1", "+", "vv"}], ")"}]}]]}], ",", 
     RowBox[{"Km", "\[Rule]", 
      FractionBox["kv", 
       RowBox[{"2", 
        RowBox[{"(", 
         RowBox[{"1", "-", 
          RowBox[{"2", " ", "vv"}]}], ")"}]}]]}], ",", 
     RowBox[{"\[Alpha]", "\[Rule]", 
      RowBox[{"1", "*", 
       SuperscriptBox["10", 
        RowBox[{"-", "5"}]]}]}], ",", 
     RowBox[{"vv", "\[Rule]", 
      RowBox[{"499", "/", "1000"}]}], ",", 
     RowBox[{"kv", "\[Rule]", 
      RowBox[{"1", "*", 
       SuperscriptBox["10", "11"]}]}], ",", 
     RowBox[{"kcond", "\[Rule]", "1000"}]}], "}"}]}], ";"}]], "Input",
 CellLabel->"In[55]:=",ExpressionUUID->"a330cefd-b257-4b39-b353-396e9b586d6b"],

Cell[CellGroupData[{

Cell["Compute gp/cell quantities:", "Subsubsection",
 CellChangeTimes->{{3.7647932607829065`*^9, 3.7647932677018576`*^9}, {
  3.907684555902523*^9, 
  3.9076845691811237`*^9}},ExpressionUUID->"1ff5647c-25f8-4b41-adaa-\
bda4fc0dcd03"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"gpTemperature", "=", 
   RowBox[{"Table", "[", 
    RowBox[{"0.0", ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"Length", "[", "connect", "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"Length", "[", "gw", "]"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"gpVolStrain", "=", 
   RowBox[{"Table", "[", 
    RowBox[{"0.0", ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"Length", "[", "connect", "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "1", ",", 
       RowBox[{"Length", "[", "gw", "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"k", ",", "1", ",", "6"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"cellVolStrain", "=", 
   RowBox[{"Table", "[", 
    RowBox[{"0.0", ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"Length", "[", "connect", "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "1", ",", "6"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"gpDevStress", "=", 
   RowBox[{"Table", "[", 
    RowBox[{"0.0", ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"Length", "[", "connect", "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "1", ",", 
       RowBox[{"Length", "[", "gw", "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"k", ",", "1", ",", "6"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"cellDevStress", "=", 
   RowBox[{"Table", "[", 
    RowBox[{"0.0", ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"Length", "[", "connect", "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "1", ",", "6"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"divDevStress", "=", 
   RowBox[{"Table", "[", 
    RowBox[{"0.0", ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"Length", "[", "connect", "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "1", ",", 
       RowBox[{"numDim", " ", "nnodes"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"divPressure", "=", 
   RowBox[{"Table", "[", 
    RowBox[{"0.0", ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"Length", "[", "connect", "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "1", ",", 
       RowBox[{"nnodes", " ", "numDim"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"divCellStab", "=", 
   RowBox[{"Table", "[", 
    RowBox[{"0.0", ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"Length", "[", "connect", "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "1", ",", "nnodes"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"divFlux", "=", 
   RowBox[{"Table", "[", 
    RowBox[{"0.0", ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"Length", "[", "connect", "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "1", ",", "nnodes"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"volumeFlux", "=", 
   RowBox[{"Table", "[", 
    RowBox[{"0.0", ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"Length", "[", "connect", "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "1", ",", 
       RowBox[{"Length", "[", "gw", "]"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"projVolumeFlux", "=", 
   RowBox[{"Table", "[", 
    RowBox[{"0.0", ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"Length", "[", "connect", "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "1", ",", "nnodes"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"gpCellStab", "=", 
   RowBox[{"Table", "[", 
    RowBox[{"0.0", ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"Length", "[", "connect", "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "1", ",", 
       RowBox[{"Length", "[", "gw", "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"k", ",", "1", ",", "numDim"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"gpCellTFlux", "=", 
   RowBox[{"Table", "[", 
    RowBox[{"0.0", ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"Length", "[", "connect", "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "1", ",", 
       RowBox[{"Length", "[", "gw", "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"k", ",", "1", ",", "numDim"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"cellVolume", "=", 
   RowBox[{"Table", "[", 
    RowBox[{"0.0", ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"Length", "[", "connect", "]"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"gpThermalContent", "=", 
   RowBox[{"Table", "[", 
    RowBox[{"0.0", ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"Length", "[", "connect", "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "1", ",", 
       RowBox[{"Length", "[", "gw", "]"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"projThermalContent", "=", 
   RowBox[{"Table", "[", 
    RowBox[{"0.0", ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"Length", "[", "connect", "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "1", ",", "nnodes"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"gpCellInterpolatedPGrad", "=", 
   RowBox[{"Table", "[", 
    RowBox[{"0.0", ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"Length", "[", "connect", "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "1", ",", 
       RowBox[{"Length", "[", "gw", "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"k", ",", "1", ",", "numDim"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"gpCellPGrad", "=", 
   RowBox[{"Table", "[", 
    RowBox[{"0.0", ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"Length", "[", "connect", "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "1", ",", 
       RowBox[{"Length", "[", "gw", "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"k", ",", "1", ",", "numDim"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"gpCellTGrad", "=", 
   RowBox[{"Table", "[", 
    RowBox[{"0.0", ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"Length", "[", "connect", "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "1", ",", 
       RowBox[{"Length", "[", "gw", "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"k", ",", "1", ",", "numDim"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"divDevStressResidual", "=", 
   RowBox[{"Table", "[", 
    RowBox[{"0.0", ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"Length", "[", "connect", "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "1", ",", 
       RowBox[{"nnodes", " ", "ndofs"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"divPressureResidual", "=", 
   RowBox[{"Table", "[", 
    RowBox[{"0.0", ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"Length", "[", "connect", "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "1", ",", 
       RowBox[{"nnodes", " ", "ndofs"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"divCellStabResidual", "=", 
   RowBox[{"Table", "[", 
    RowBox[{"0.0", ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"Length", "[", "connect", "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "1", ",", 
       RowBox[{"nnodes", " ", "ndofs"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"divFluxResidual", "=", 
   RowBox[{"Table", "[", 
    RowBox[{"0.0", ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"Length", "[", "connect", "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "1", ",", 
       RowBox[{"nnodes", " ", "ndofs"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"localProjVolumeFluxResidual", "=", 
   RowBox[{"Table", "[", 
    RowBox[{"0.0", ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"Length", "[", "connect", "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "1", ",", 
       RowBox[{"nnodes", " ", "ndofs"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"localProjThermalContentResidual", "=", 
   RowBox[{"Table", "[", 
    RowBox[{"0.0", ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"Length", "[", "connect", "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "1", ",", 
       RowBox[{"nnodes", " ", "ndofs"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"For", "[", 
  RowBox[{
   RowBox[{"i", "=", "1"}], ",", " ", 
   RowBox[{"i", "\[LessEqual]", " ", 
    RowBox[{"Length", "[", "connect", "]"}]}], ",", 
   RowBox[{"i", "++"}], ",", 
   RowBox[{"Block", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"i1", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"connect", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}], "+", "1"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"i2", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"connect", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "[", 
          RowBox[{"[", "2", "]"}], "]"}], "+", "1"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"i3", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"connect", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "[", 
          RowBox[{"[", "3", "]"}], "]"}], "+", "1"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"i4", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"connect", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "[", 
          RowBox[{"[", "4", "]"}], "]"}], "+", "1"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"ids", "=", 
        RowBox[{"{", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"ndofs", " ", 
            RowBox[{"(", 
             RowBox[{"i1", "-", "1"}], ")"}]}], "+", "1"}], ",", " ", 
          RowBox[{
           RowBox[{"ndofs", 
            RowBox[{"(", " ", 
             RowBox[{"i1", "-", "1"}], ")"}]}], "+", "2"}], ",", " ", 
          RowBox[{
           RowBox[{"ndofs", 
            RowBox[{"(", " ", 
             RowBox[{"i1", "-", "1"}], ")"}]}], "+", "3"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"ndofs", 
            RowBox[{"(", " ", 
             RowBox[{"i2", "-", "1"}], ")"}]}], "+", "1"}], ",", 
          RowBox[{
           RowBox[{"ndofs", 
            RowBox[{"(", 
             RowBox[{"i2", "-", "1"}], ")"}]}], "+", "2"}], ",", " ", 
          RowBox[{
           RowBox[{"ndofs", 
            RowBox[{"(", " ", 
             RowBox[{"i2", "-", "1"}], ")"}]}], "+", "3"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"ndofs", 
            RowBox[{"(", 
             RowBox[{"i3", "-", "1"}], ")"}]}], "+", "1"}], ",", 
          RowBox[{
           RowBox[{"ndofs", " ", 
            RowBox[{"(", 
             RowBox[{"i3", "-", "1"}], ")"}]}], "+", "2"}], ",", " ", 
          RowBox[{
           RowBox[{"ndofs", 
            RowBox[{"(", " ", 
             RowBox[{"i3", "-", "1"}], ")"}]}], "+", "3"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"ndofs", 
            RowBox[{"(", 
             RowBox[{"i4", "-", "1"}], ")"}]}], "+", "1"}], ",", 
          RowBox[{
           RowBox[{"ndofs", 
            RowBox[{"(", 
             RowBox[{"i4", "-", "1"}], ")"}]}], "+", "2"}], ",", " ", 
          RowBox[{
           RowBox[{"ndofs", 
            RowBox[{"(", " ", 
             RowBox[{"i4", "-", "1"}], ")"}]}], "+", "3"}]}], 
         "\[IndentingNewLine]", "}"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"pids", "=", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"ndofs", " ", 
            RowBox[{"(", 
             RowBox[{"i1", "-", "1"}], ")"}]}], "+", "4"}], ",", " ", 
          RowBox[{
           RowBox[{"ndofs", 
            RowBox[{"(", " ", 
             RowBox[{"i2", "-", "1"}], ")"}]}], "+", "4"}], ",", 
          RowBox[{
           RowBox[{"ndofs", 
            RowBox[{"(", 
             RowBox[{"i3", "-", "1"}], ")"}]}], "+", "4"}], ",", 
          RowBox[{
           RowBox[{"ndofs", 
            RowBox[{"(", 
             RowBox[{"i4", "-", "1"}], ")"}]}], "+", "4"}]}], "}"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"tids", "=", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"ndofs", " ", 
            RowBox[{"(", 
             RowBox[{"i1", "-", "1"}], ")"}]}], "+", "5"}], ",", " ", 
          RowBox[{
           RowBox[{"ndofs", 
            RowBox[{"(", " ", 
             RowBox[{"i2", "-", "1"}], ")"}]}], "+", "5"}], ",", 
          RowBox[{
           RowBox[{"ndofs", 
            RowBox[{"(", 
             RowBox[{"i3", "-", "1"}], ")"}]}], "+", "5"}], ",", 
          RowBox[{
           RowBox[{"ndofs", 
            RowBox[{"(", 
             RowBox[{"i4", "-", "1"}], ")"}]}], "+", "5"}]}], "}"}]}]}], 
      "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Bmat", "=", 
       RowBox[{"Gmatrix", "[", 
        RowBox[{
         RowBox[{"xv", "[", 
          RowBox[{"[", "i1", "]"}], "]"}], ",", 
         RowBox[{"yv", "[", 
          RowBox[{"[", "i1", "]"}], "]"}], ",", 
         RowBox[{"zv", "[", 
          RowBox[{"[", "i1", "]"}], "]"}], ",", 
         RowBox[{"xv", "[", 
          RowBox[{"[", "i2", "]"}], "]"}], ",", 
         RowBox[{"yv", "[", 
          RowBox[{"[", "i2", "]"}], "]"}], ",", 
         RowBox[{"zv", "[", 
          RowBox[{"[", "i2", "]"}], "]"}], ",", 
         RowBox[{"xv", "[", 
          RowBox[{"[", "i3", "]"}], "]"}], ",", 
         RowBox[{"yv", "[", 
          RowBox[{"[", "i3", "]"}], "]"}], ",", 
         RowBox[{"zv", "[", 
          RowBox[{"[", "i3", "]"}], "]"}], ",", 
         RowBox[{"xv", "[", 
          RowBox[{"[", "i4", "]"}], "]"}], ",", 
         RowBox[{"yv", "[", 
          RowBox[{"[", "i4", "]"}], "]"}], ",", 
         RowBox[{"zv", "[", 
          RowBox[{"[", "i4", "]"}], "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"bmat", "=", 
       RowBox[{"gmatrix", "[", 
        RowBox[{
         RowBox[{"xv", "[", 
          RowBox[{"[", "i1", "]"}], "]"}], ",", 
         RowBox[{"yv", "[", 
          RowBox[{"[", "i1", "]"}], "]"}], ",", 
         RowBox[{"zv", "[", 
          RowBox[{"[", "i1", "]"}], "]"}], ",", 
         RowBox[{"xv", "[", 
          RowBox[{"[", "i2", "]"}], "]"}], ",", 
         RowBox[{"yv", "[", 
          RowBox[{"[", "i2", "]"}], "]"}], ",", 
         RowBox[{"zv", "[", 
          RowBox[{"[", "i2", "]"}], "]"}], ",", 
         RowBox[{"xv", "[", 
          RowBox[{"[", "i3", "]"}], "]"}], ",", 
         RowBox[{"yv", "[", 
          RowBox[{"[", "i3", "]"}], "]"}], ",", 
         RowBox[{"zv", "[", 
          RowBox[{"[", "i3", "]"}], "]"}], ",", 
         RowBox[{"xv", "[", 
          RowBox[{"[", "i4", "]"}], "]"}], ",", 
         RowBox[{"yv", "[", 
          RowBox[{"[", "i4", "]"}], "]"}], ",", 
         RowBox[{"zv", "[", 
          RowBox[{"[", "i4", "]"}], "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"cellDetJ", "=", 
       RowBox[{"Detj", "[", 
        RowBox[{
         RowBox[{"xv", "[", 
          RowBox[{"[", "i1", "]"}], "]"}], ",", 
         RowBox[{"yv", "[", 
          RowBox[{"[", "i1", "]"}], "]"}], ",", 
         RowBox[{"zv", "[", 
          RowBox[{"[", "i1", "]"}], "]"}], ",", 
         RowBox[{"xv", "[", 
          RowBox[{"[", "i2", "]"}], "]"}], ",", 
         RowBox[{"yv", "[", 
          RowBox[{"[", "i2", "]"}], "]"}], ",", 
         RowBox[{"zv", "[", 
          RowBox[{"[", "i2", "]"}], "]"}], ",", 
         RowBox[{"xv", "[", 
          RowBox[{"[", "i3", "]"}], "]"}], ",", 
         RowBox[{"yv", "[", 
          RowBox[{"[", "i3", "]"}], "]"}], ",", 
         RowBox[{"zv", "[", 
          RowBox[{"[", "i3", "]"}], "]"}], ",", 
         RowBox[{"xv", "[", 
          RowBox[{"[", "i4", "]"}], "]"}], ",", 
         RowBox[{"yv", "[", 
          RowBox[{"[", "i4", "]"}], "]"}], ",", 
         RowBox[{"zv", "[", 
          RowBox[{"[", "i4", "]"}], "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"disp", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"uv", "[", 
          RowBox[{"[", 
           RowBox[{"ids", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "]"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{"Length", "[", "ids", "]"}]}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"nodT", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"uv", "[", 
          RowBox[{"[", 
           RowBox[{"tids", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "]"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{"Length", "[", "tids", "]"}]}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"nodP", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"uv", "[", 
          RowBox[{"[", 
           RowBox[{"pids", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "]"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{"Length", "[", "pids", "]"}]}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"j", "=", "1"}], ",", 
        RowBox[{"j", "<=", 
         RowBox[{"Length", "[", "gw", "]"}]}], ",", 
        RowBox[{"j", "++"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"gaussPoint", "=", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"\[Xi]", "->", 
             RowBox[{
              RowBox[{"gp", "[", 
               RowBox[{"[", "j", "]"}], "]"}], "[", 
              RowBox[{"[", "1", "]"}], "]"}]}], ",", 
            RowBox[{"\[Psi]", "->", 
             RowBox[{
              RowBox[{"gp", "[", 
               RowBox[{"[", "j", "]"}], "]"}], "[", 
              RowBox[{"[", "2", "]"}], "]"}]}], ",", 
            RowBox[{"\[Zeta]", "->", 
             RowBox[{
              RowBox[{"gp", "[", 
               RowBox[{"[", "j", "]"}], "]"}], "[", 
              RowBox[{"[", "3", "]"}], "]"}]}]}], "}"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"strain", "=", 
          RowBox[{"Bmat", ".", "disp"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"temperature", " ", "=", " ", 
          RowBox[{
           RowBox[{"\[Phi]s", ".", "nodT"}], "/.", "gaussPoint"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"gpTemperature", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "[", 
           RowBox[{"[", "j", "]"}], "]"}], "=", "temperature"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"tstrain", "=", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
            "\[Alpha]", ",", "\[Alpha]", ",", "\[Alpha]", ",", "0", ",", "0", 
             ",", "0"}], "}"}], "*", "temperature"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"totalStrain", "=", 
          RowBox[{"strain", "-", "tstrain"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"volStrain", "=", 
          RowBox[{"VoigtIdentity", "*", 
           RowBox[{"VoigtTrace", "[", "totalStrain", "]"}]}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"gpVolStrain", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "[", 
           RowBox[{"[", "j", "]"}], "]"}], "=", 
          RowBox[{"volStrain", "/.", "matProps"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"cellVolStrain", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "+=", 
          RowBox[{"volStrain", "/.", "matProps"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"stress", "=", 
          RowBox[{"S", ".", 
           RowBox[{"(", "totalStrain", ")"}]}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"pressure", "=", 
          RowBox[{
           RowBox[{"VoigtTrace", "[", "stress", "]"}], "/", "3.0"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"devStress", "=", 
          RowBox[{"Simplify", "[", 
           RowBox[{"stress", "-", 
            RowBox[{"VoigtIdentity", " ", "pressure"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"gpDevStress", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "[", 
           RowBox[{"[", "j", "]"}], "]"}], "=", 
          RowBox[{"devStress", "/.", "matProps"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"cellDevStress", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "[", 
           RowBox[{"[", "j", "]"}], "]"}], "+=", 
          RowBox[{"devStress", "/.", "matProps"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"divDevStress", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "+=", 
          RowBox[{
           RowBox[{
            RowBox[{"gw", "[", 
             RowBox[{"[", "j", "]"}], "]"}], "cellDetJ", "*", 
            RowBox[{
             RowBox[{"Transpose", "[", "Bmat", "]"}], ".", "devStress"}]}], "/.",
            "matProps"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"divPressure", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "+=", 
          RowBox[{
           RowBox[{
            RowBox[{"gw", "[", 
             RowBox[{"[", "j", "]"}], "]"}], "cellDetJ", "*", 
            RowBox[{"Flatten", "[", 
             RowBox[{
              RowBox[{"Transpose", "[", "bmat", "]"}], 
              RowBox[{"(", 
               RowBox[{"\[Phi]s", ".", "nodP"}], ")"}]}], "]"}]}], "/.", 
           "gaussPoint"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"volumeFlux", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "[", 
           RowBox[{"[", "j", "]"}], "]"}], "=", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"VoigtTrace", "[", "strain", "]"}], "-", 
              RowBox[{
               FractionBox["1", "Km"], 
               RowBox[{"(", 
                RowBox[{"\[Phi]s", ".", "nodP"}], ")"}]}], "-", 
              RowBox[{"VoigtTrace", "[", "tstrain", "]"}]}], ")"}], "/.", 
            "gaussPoint"}], "//.", "matProps"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"projVolumeFlux", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "+=", 
          RowBox[{
           RowBox[{
            RowBox[{"gw", "[", 
             RowBox[{"[", "j", "]"}], "]"}], "cellDetJ", " ", "\[Phi]s", " ", 
            RowBox[{
             RowBox[{"volumeFlux", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "[", 
             RowBox[{"[", "j", "]"}], "]"}]}], "/.", "gaussPoint"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"\[Tau]", "=", 
          RowBox[{
           FractionBox[
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{
               RowBox[{"gw", "[", 
                RowBox[{"[", "j", "]"}], "]"}], "cellDetJ"}], ")"}], 
             RowBox[{"2", "/", "3"}]], 
            RowBox[{"2", " ", "Gm"}]], "//.", "matProps"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"gpCellStab", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "[", 
           RowBox[{"[", "j", "]"}], "]"}], "=", 
          RowBox[{"\[Tau]", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"bmat", ".", "nodP"}], "-", 
              RowBox[{"(", 
               RowBox[{"\[Phi]s", ".", 
                RowBox[{"\[CapitalPi]v", "[", 
                 RowBox[{"[", "i", "]"}], "]"}]}], ")"}]}], "/.", 
             "gaussPoint"}], ")"}]}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"divCellStab", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "+=", 
          RowBox[{
           RowBox[{"gw", "[", 
            RowBox[{"[", "j", "]"}], "]"}], "cellDetJ", " ", 
           RowBox[{
            RowBox[{"Transpose", "[", "bmat", "]"}], ".", 
            RowBox[{
             RowBox[{"gpCellStab", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "[", 
             RowBox[{"[", "j", "]"}], "]"}]}]}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"gpCellTFlux", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "[", 
           RowBox[{"[", "j", "]"}], "]"}], "=", 
          RowBox[{
           RowBox[{"kcond", " ", 
            RowBox[{"bmat", ".", "nodT"}]}], "/.", "matProps"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"divFlux", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "+=", 
          RowBox[{
           RowBox[{"gw", "[", 
            RowBox[{"[", "j", "]"}], "]"}], "cellDetJ", " ", 
           RowBox[{
            RowBox[{"Transpose", "[", "bmat", "]"}], ".", 
            RowBox[{
             RowBox[{"gpCellTFlux", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "[", 
             RowBox[{"[", "j", "]"}], "]"}]}]}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"cellVolume", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "+=", 
          RowBox[{
           RowBox[{"gw", "[", 
            RowBox[{"[", "j", "]"}], "]"}], " ", "cellDetJ"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"gpThermalContent", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "[", 
           RowBox[{"[", "j", "]"}], "]"}], "=", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"0.3", "*", " ", 
             SuperscriptBox["10", "6"]}], ")"}], 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"\[Phi]s", "/.", "gaussPoint"}], ")"}], ".", 
            RowBox[{"(", 
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{"uv", "[", 
                RowBox[{"[", 
                 RowBox[{"tids", "[", 
                  RowBox[{"[", "i", "]"}], "]"}], "]"}], "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"i", ",", "1", ",", "4"}], "}"}]}], "]"}], 
             ")"}]}]}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"projThermalContent", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "+=", 
          RowBox[{
           RowBox[{
            RowBox[{"gw", "[", 
             RowBox[{"[", "j", "]"}], "]"}], "cellDetJ", " ", "\[Phi]s", " ", 
            RowBox[{
             RowBox[{"gpThermalContent", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "[", 
             RowBox[{"[", "j", "]"}], "]"}]}], "/.", "gaussPoint"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"gpCellInterpolatedPGrad", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "[", 
           RowBox[{"[", "j", "]"}], "]"}], "=", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"\[Phi]s", ".", 
             RowBox[{"\[CapitalPi]v", "[", 
              RowBox[{"[", "i", "]"}], "]"}]}], ")"}], "/.", "gaussPoint"}]}],
          ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"gpCellPGrad", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "[", 
           RowBox[{"[", "j", "]"}], "]"}], "=", 
          RowBox[{"bmat", ".", "nodP"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"gpCellTGrad", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "[", 
           RowBox[{"[", "j", "]"}], "]"}], "=", 
          RowBox[{"bmat", ".", "nodT"}]}], ";"}]}], "\[IndentingNewLine]", 
       "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"lmids", "=", 
       RowBox[{"{", 
        RowBox[{
        "1", ",", "2", ",", "3", ",", "6", ",", "7", ",", "8", ",", "11", ",",
          "12", ",", "13", ",", "16", ",", "17", ",", "18"}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"lpids", "=", 
       RowBox[{"{", 
        RowBox[{"4", ",", "9", ",", "14", ",", "19"}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"ltids", "=", 
       RowBox[{"{", 
        RowBox[{"5", ",", "10", ",", "15", ",", "20"}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"k", "=", "1"}], ",", 
        RowBox[{"k", "\[LessEqual]", 
         RowBox[{"Length", "[", "lmids", "]"}]}], ",", 
        RowBox[{"k", "++"}], ",", 
        RowBox[{
         RowBox[{
          RowBox[{"divDevStressResidual", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "[", 
          RowBox[{"[", 
           RowBox[{"lmids", "[", 
            RowBox[{"[", "k", "]"}], "]"}], "]"}], "]"}], "=", 
         RowBox[{
          RowBox[{"divDevStress", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "[", 
          RowBox[{"[", "k", "]"}], "]"}]}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"k", "=", "1"}], ",", 
        RowBox[{"k", "\[LessEqual]", 
         RowBox[{"Length", "[", "lmids", "]"}]}], ",", 
        RowBox[{"k", "++"}], ",", 
        RowBox[{
         RowBox[{
          RowBox[{"divPressureResidual", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "[", 
          RowBox[{"[", 
           RowBox[{"lmids", "[", 
            RowBox[{"[", "k", "]"}], "]"}], "]"}], "]"}], "=", 
         RowBox[{
          RowBox[{"divPressure", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "[", 
          RowBox[{"[", "k", "]"}], "]"}]}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"k", "=", "1"}], ",", 
        RowBox[{"k", "\[LessEqual]", 
         RowBox[{"Length", "[", "lpids", "]"}]}], ",", 
        RowBox[{"k", "++"}], ",", 
        RowBox[{
         RowBox[{
          RowBox[{"divCellStabResidual", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "[", 
          RowBox[{"[", 
           RowBox[{"lpids", "[", 
            RowBox[{"[", "k", "]"}], "]"}], "]"}], "]"}], "=", 
         RowBox[{
          RowBox[{"divCellStab", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "[", 
          RowBox[{"[", "k", "]"}], "]"}]}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"k", "=", "1"}], ",", 
        RowBox[{"k", "\[LessEqual]", 
         RowBox[{"Length", "[", "ltids", "]"}]}], ",", 
        RowBox[{"k", "++"}], ",", 
        RowBox[{
         RowBox[{
          RowBox[{"divFluxResidual", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "[", 
          RowBox[{"[", 
           RowBox[{"ltids", "[", 
            RowBox[{"[", "k", "]"}], "]"}], "]"}], "]"}], "=", 
         RowBox[{
          RowBox[{"divFlux", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "[", 
          RowBox[{"[", "k", "]"}], "]"}]}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"k", "=", "1"}], ",", 
        RowBox[{"k", "\[LessEqual]", 
         RowBox[{"Length", "[", "lpids", "]"}]}], ",", 
        RowBox[{"k", "++"}], ",", 
        RowBox[{
         RowBox[{
          RowBox[{"localProjVolumeFluxResidual", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "[", 
          RowBox[{"[", 
           RowBox[{"lpids", "[", 
            RowBox[{"[", "k", "]"}], "]"}], "]"}], "]"}], "=", 
         RowBox[{
          RowBox[{"projVolumeFlux", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "[", 
          RowBox[{"[", "k", "]"}], "]"}]}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"k", "=", "1"}], ",", 
        RowBox[{"k", "\[LessEqual]", 
         RowBox[{"Length", "[", "ltids", "]"}]}], ",", 
        RowBox[{"k", "++"}], ",", 
        RowBox[{
         RowBox[{
          RowBox[{"localProjThermalContentResidual", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "[", 
          RowBox[{"[", 
           RowBox[{"ltids", "[", 
            RowBox[{"[", "k", "]"}], "]"}], "]"}], "]"}], "=", 
         RowBox[{
          RowBox[{"projThermalContent", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "[", 
          RowBox[{"[", "k", "]"}], "]"}]}]}], "]"}], ";"}]}], 
    "\[IndentingNewLine]", "]"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.7167647605597653`*^9, 3.7167647892518883`*^9}, {
   3.7167648244240847`*^9, 3.716764841539942*^9}, {3.71676488019324*^9, 
   3.7167648969754357`*^9}, {3.716765065628334*^9, 3.716765185350045*^9}, {
   3.7167652229401484`*^9, 3.7167652383100395`*^9}, {3.7167653441168547`*^9, 
   3.7167655199547443`*^9}, {3.7167655675522327`*^9, 
   3.7167655810711265`*^9}, {3.716765622284607*^9, 3.7167656290567384`*^9}, {
   3.716765757154343*^9, 3.716765792076064*^9}, {3.7167658276745405`*^9, 
   3.7167660826802125`*^9}, {3.716766195664576*^9, 3.716766242915578*^9}, {
   3.7167663310833845`*^9, 3.7167663393539863`*^9}, {3.7167664503932595`*^9, 
   3.716766450932579*^9}, {3.7167664868258085`*^9, 3.7167665635541043`*^9}, {
   3.716766627651472*^9, 3.716766643645746*^9}, {3.716766826115865*^9, 
   3.7167668360695195`*^9}, {3.716766868385886*^9, 3.7167669130203*^9}, {
   3.717155721663645*^9, 3.7171557331420517`*^9}, {3.717155769178903*^9, 
   3.7171557818205233`*^9}, {3.7171567883516493`*^9, 3.717156887869956*^9}, {
   3.717156918335051*^9, 3.717156937057849*^9}, {3.717157017416103*^9, 
   3.717157052623994*^9}, {3.717157895689323*^9, 3.717157931742132*^9}, {
   3.717166282194605*^9, 3.71716628473459*^9}, {3.71716849797501*^9, 
   3.71716852298344*^9}, {3.717168562021318*^9, 3.717168562125424*^9}, {
   3.717168843821663*^9, 3.717168857297769*^9}, {3.7171692165304537`*^9, 
   3.7171692208302*^9}, {3.717170006857576*^9, 3.717170018830927*^9}, {
   3.717171209233417*^9, 3.717171213025419*^9}, {3.7173548750864697`*^9, 
   3.717354881757492*^9}, {3.717354996753583*^9, 3.717355017245678*^9}, {
   3.717355319697336*^9, 3.7173553216726255`*^9}, {3.7173557531181636`*^9, 
   3.7173557820403166`*^9}, {3.7173558138063755`*^9, 
   3.7173558166812677`*^9}, {3.7173587645155315`*^9, 
   3.7173587704721184`*^9}, {3.7173588122062426`*^9, 
   3.7173588501286516`*^9}, {3.717359014190798*^9, 3.7173590339564075`*^9}, {
   3.7173591194571896`*^9, 3.7173591202540846`*^9}, {3.717360749384885*^9, 
   3.717360755072524*^9}, {3.7173608405541487`*^9, 3.7173608453215923`*^9}, {
   3.7174176653039513`*^9, 3.7174177502357674`*^9}, {3.717418005127076*^9, 
   3.717418022383568*^9}, {3.7174180927900662`*^9, 3.717418180868244*^9}, {
   3.717419219270834*^9, 3.7174192266613092`*^9}, {3.71741926925568*^9, 
   3.717419272755123*^9}, {3.7174241468474283`*^9, 3.7174241510843997`*^9}, {
   3.71742429898483*^9, 3.717424381678406*^9}, {3.717427960779907*^9, 
   3.7174279724352093`*^9}, {3.7174281618258095`*^9, 
   3.7174281652786007`*^9}, {3.7208066594239817`*^9, 
   3.7208066657144737`*^9}, {3.723057650960129*^9, 3.7230576545889745`*^9}, {
   3.763398626297826*^9, 3.7633986377693434`*^9}, {3.763398969492062*^9, 
   3.763399017148432*^9}, {3.7633990692779627`*^9, 3.7633990694291053`*^9}, {
   3.7633991201481476`*^9, 3.763399174570841*^9}, {3.763399415268031*^9, 
   3.76339941606513*^9}, {3.7633996474373903`*^9, 3.7633996648412056`*^9}, {
   3.7633997501291094`*^9, 3.7633999258824277`*^9}, {3.7633999725549555`*^9, 
   3.763399976702032*^9}, {3.7634000083920765`*^9, 3.76340016737781*^9}, {
   3.7634002158964863`*^9, 3.76340029196223*^9}, {3.763400323496956*^9, 
   3.7634004027149053`*^9}, {3.76340045059245*^9, 3.763400463281616*^9}, {
   3.7634005294006834`*^9, 3.763400570424802*^9}, {3.764082973996101*^9, 
   3.764082975901887*^9}, {3.764085676134435*^9, 3.7640856834202404`*^9}, {
   3.7640858472503123`*^9, 3.7640858920767965`*^9}, {3.7640894255234814`*^9, 
   3.7640894257482643`*^9}, {3.7640894615887256`*^9, 
   3.7640894620724916`*^9}, {3.7640895179586363`*^9, 
   3.7640895273283195`*^9}, {3.7640896836413865`*^9, 
   3.7640896854169707`*^9}, {3.764098322843951*^9, 3.764098324217982*^9}, {
   3.7640983820840216`*^9, 3.764098382599674*^9}, {3.764099103461434*^9, 
   3.764099173185652*^9}, {3.764101764387092*^9, 3.7641017868352966`*^9}, 
   3.764761842376623*^9, {3.76476223129729*^9, 3.764762241509314*^9}, {
   3.7647622805381107`*^9, 3.764762305230457*^9}, {3.76476236061409*^9, 
   3.7647623840555506`*^9}, {3.7647624148034487`*^9, 
   3.7647624367677865`*^9}, {3.7647629353927927`*^9, 
   3.7647629384726405`*^9}, {3.7647894121072764`*^9, 
   3.7647894567809696`*^9}, {3.7647895619002247`*^9, 
   3.7647896425467887`*^9}, {3.7647896949078503`*^9, 
   3.7647896994970655`*^9}, {3.7647899115869627`*^9, 
   3.7647899366981144`*^9}, {3.7647907620386324`*^9, 3.764790762555979*^9}, {
   3.764790859444355*^9, 3.7647909121812305`*^9}, {3.7647910437526674`*^9, 
   3.764791065929558*^9}, {3.7647911306307406`*^9, 3.764791227713051*^9}, {
   3.7647914009447327`*^9, 3.7647914078831196`*^9}, {3.76479146494147*^9, 
   3.764791471596281*^9}, {3.764791528743067*^9, 3.7647915852144847`*^9}, {
   3.7647919581623106`*^9, 3.764791958342961*^9}, {3.7647921939537992`*^9, 
   3.7647922001003637`*^9}, {3.764792557254195*^9, 3.764792592381807*^9}, {
   3.764793280270445*^9, 3.7647932827589827`*^9}, {3.76479471152559*^9, 
   3.764794903918975*^9}, {3.764795098669626*^9, 3.764795104549365*^9}, {
   3.764795265272959*^9, 3.76479539685962*^9}, {3.7692654915417233`*^9, 
   3.7692655147563086`*^9}, {3.769266609091014*^9, 3.769266610081217*^9}, {
   3.7692666402812986`*^9, 3.769266686321863*^9}, {3.7692668165842485`*^9, 
   3.7692668826166487`*^9}, {3.769266920831176*^9, 3.769266954634816*^9}, {
   3.7692669917496595`*^9, 3.7692670743215904`*^9}, {3.7692671616824856`*^9, 
   3.769267205957114*^9}, {3.769267242711638*^9, 3.769267252372937*^9}, {
   3.7692672877953825`*^9, 3.7692674254805794`*^9}, {3.769267456594332*^9, 
   3.769267484354904*^9}, {3.769267580518936*^9, 3.769267612008975*^9}, {
   3.769267646137645*^9, 3.769267717283578*^9}, {3.76926778909048*^9, 
   3.769267827975362*^9}, {3.7692679854648533`*^9, 3.7692680032396917`*^9}, {
   3.7692680349329367`*^9, 3.769268047511677*^9}, {3.769268103324236*^9, 
   3.7692681039760466`*^9}, {3.769268178879094*^9, 3.7692681941222687`*^9}, {
   3.769281293440941*^9, 3.7692812994283714`*^9}, {3.7692813312201686`*^9, 
   3.769281397118626*^9}, {3.769285168302395*^9, 3.769285214048355*^9}, {
   3.7692852862807446`*^9, 3.7692853571531754`*^9}, {3.769287140156516*^9, 
   3.7692871518345957`*^9}, {3.769287223762863*^9, 3.769287238974713*^9}, {
   3.7692872917920303`*^9, 3.7692872973304834`*^9}, {3.7692873296771994`*^9, 
   3.7692874110603237`*^9}, {3.769287669813406*^9, 3.76928771105731*^9}, {
   3.7693443377314477`*^9, 3.769344341790784*^9}, {3.7693443858089895`*^9, 
   3.7693443917835684`*^9}, {3.769344443904977*^9, 3.7693444690976424`*^9}, {
   3.769344502488573*^9, 3.7693445272632284`*^9}, {3.7693495667999096`*^9, 
   3.769349636973344*^9}, {3.769349752464275*^9, 3.769349846565425*^9}, {
   3.769349901996236*^9, 3.769349903127725*^9}, {3.769349973557214*^9, 
   3.7693499763096356`*^9}, {3.7693500125091305`*^9, 3.769350071087141*^9}, {
   3.7693502370954227`*^9, 3.7693502627595353`*^9}, {3.769350305995264*^9, 
   3.769350348530837*^9}, {3.7693503804930134`*^9, 3.769350437385868*^9}, {
   3.7693507258373995`*^9, 3.7693507449038563`*^9}, {3.769351559433146*^9, 
   3.769351569081027*^9}, {3.76935181507541*^9, 3.769351930293931*^9}, {
   3.7693519660903907`*^9, 3.769351979322859*^9}, {3.7693521811970243`*^9, 
   3.7693522008717422`*^9}, {3.769352235657698*^9, 3.769352256824642*^9}, {
   3.7693524750897884`*^9, 3.769352579129157*^9}, {3.769352618342435*^9, 
   3.7693526622116327`*^9}, {3.769353838986984*^9, 3.769353876798025*^9}, {
   3.769354308434397*^9, 3.76935430885035*^9}, {3.7693544164026976`*^9, 
   3.7693544181261587`*^9}, {3.769354510630841*^9, 3.7693545186995792`*^9}, {
   3.7693552502011104`*^9, 3.76935527388229*^9}, {3.769355767621235*^9, 
   3.7693558090980062`*^9}, {3.769356005550325*^9, 3.769356013178934*^9}, 
   3.7693560447755127`*^9, {3.769358265542241*^9, 3.7693582668328047`*^9}, {
   3.76935832938021*^9, 3.769358349346999*^9}, {3.7693583837842226`*^9, 
   3.7693584455920134`*^9}, {3.7693593194128866`*^9, 
   3.7693593264784746`*^9}, {3.769359388348181*^9, 3.76935941308883*^9}, {
   3.7693594782789116`*^9, 3.7693595026425114`*^9}, {3.769359549675559*^9, 
   3.769359586672391*^9}, {3.769361010649766*^9, 3.769361041064583*^9}, {
   3.769361652761567*^9, 3.7693616544337807`*^9}, {3.7693622011182313`*^9, 
   3.7693622195184374`*^9}, {3.769362285122402*^9, 3.7693626665472937`*^9}, {
   3.775485781555283*^9, 3.7754857829522543`*^9}, {3.775486633532365*^9, 
   3.775486648848278*^9}, {3.7754866984852123`*^9, 3.775486789602234*^9}, {
   3.849529224202313*^9, 3.849529244376565*^9}, 3.849529759866736*^9, 
   3.849529861200821*^9, {3.849530307057467*^9, 3.849530342958578*^9}, {
   3.849530564118927*^9, 3.849530565753456*^9}, {3.907320721883224*^9, 
   3.907320737467772*^9}, {3.907320768140708*^9, 3.907320837811812*^9}, {
   3.907321876874978*^9, 3.907321877605341*^9}, {3.907321911783833*^9, 
   3.9073221522653217`*^9}, 3.9073222028211937`*^9, 3.907322303558535*^9, {
   3.907336862414394*^9, 3.907336865725603*^9}, {3.907336939713032*^9, 
   3.907336942020171*^9}, {3.907337780541933*^9, 3.907337873147871*^9}, {
   3.907338856779791*^9, 3.907338930626719*^9}, {3.907338974637287*^9, 
   3.90733909612737*^9}, {3.907339342005012*^9, 3.907339428144003*^9}, {
   3.907339527318963*^9, 3.9073395745693197`*^9}, {3.907339946859627*^9, 
   3.907340087354353*^9}, {3.9073402097552156`*^9, 3.9073402470159397`*^9}, {
   3.907340277515006*^9, 3.9073403317129087`*^9}, {3.9073403693836393`*^9, 
   3.907340384520884*^9}, {3.907340436124123*^9, 3.9073405109694033`*^9}, {
   3.9073410071761312`*^9, 3.9073410664231567`*^9}, {3.90734163272558*^9, 
   3.907341636863796*^9}, {3.907612835040698*^9, 3.907612937629129*^9}, {
   3.907613902557654*^9, 3.907613912808772*^9}, {3.907679757542153*^9, 
   3.907679813758074*^9}, {3.9076803248428802`*^9, 3.907680368582727*^9}, {
   3.9076804844343243`*^9, 3.907680487539617*^9}, {3.9076807008977013`*^9, 
   3.907680703189128*^9}, {3.907680747306982*^9, 3.9076807871742907`*^9}, 
   3.9076845358593063`*^9, {3.907684909429997*^9, 3.907684952331386*^9}, {
   3.907689330394676*^9, 3.9076893323844147`*^9}, {3.907689371232476*^9, 
   3.9076893980044413`*^9}, {3.907689439791009*^9, 3.907689480899488*^9}, {
   3.907689942439073*^9, 3.9076899641818*^9}, {3.907690379234461*^9, 
   3.907690464955933*^9}, {3.907690526897909*^9, 3.907690573653043*^9}, {
   3.907690623321415*^9, 3.907690676155813*^9}, {3.9076907215342073`*^9, 
   3.907690784126731*^9}, {3.907690815492939*^9, 3.9076909593867407`*^9}, {
   3.9076911470877857`*^9, 3.907691159633033*^9}, {3.9076912458505487`*^9, 
   3.9076912471992207`*^9}, {3.907691376740975*^9, 3.907691377560116*^9}, {
   3.9076957935376787`*^9, 3.907695823651239*^9}, {3.907695899369164*^9, 
   3.907695906042644*^9}, {3.907696345798381*^9, 3.907696349871814*^9}, {
   3.907696392700856*^9, 3.9076963939904623`*^9}, {3.9076974162867393`*^9, 
   3.90769744990825*^9}, {3.907697776313837*^9, 3.907697777611301*^9}, {
   3.9076978096543913`*^9, 3.907697961192301*^9}, {3.907698062283988*^9, 
   3.907698069045183*^9}, {3.9076983215017357`*^9, 3.907698332739601*^9}, {
   3.907698899432733*^9, 3.907698902509478*^9}, {3.907698949337549*^9, 
   3.9076989504144*^9}, {3.9076989869719877`*^9, 3.907698987772873*^9}, {
   3.907699102492339*^9, 3.907699126465012*^9}, {3.907699225756481*^9, 
   3.907699235457831*^9}, {3.907700709017137*^9, 3.907700716091902*^9}, {
   3.907700961839082*^9, 3.907701070176187*^9}, {3.907704390862887*^9, 
   3.907704391760829*^9}, {3.9077044254034157`*^9, 3.90770449342691*^9}, {
   3.90775313239611*^9, 3.9077531896992483`*^9}, {3.907753240143469*^9, 
   3.9077532511425447`*^9}, {3.907753281994966*^9, 3.907753326385289*^9}, {
   3.907845705580409*^9, 3.907845765852334*^9}, {3.907845805921425*^9, 
   3.907845883866231*^9}, {3.907846031418311*^9, 3.907846234173695*^9}, {
   3.907846338384762*^9, 3.90784634372427*^9}, {3.9089978424809647`*^9, 
   3.9089978425970707`*^9}, {3.909002706384823*^9, 3.909002718455028*^9}, {
   3.909002913640045*^9, 3.909002938594466*^9}},
 CellLabel->
  "In[140]:=",ExpressionUUID->"471c15da-22d4-448e-a5e6-0fa3ac166dd5"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"divPressure", "[", 
  RowBox[{"[", "1", "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.908991433738533*^9, 3.90899143689075*^9}},
 CellLabel->"In[98]:=",ExpressionUUID->"0851ce2c-cc81-42d5-a4fb-ad25b0cae37e"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.`", ",", 
   RowBox[{"-", "1.4583333333333361`*^-7"}], ",", "0.`", ",", 
   "1.4583333333333361`*^-7", ",", "0.`", ",", 
   RowBox[{"-", "1.4583333333333361`*^-7"}], ",", 
   RowBox[{"-", "1.4583333333333361`*^-7"}], ",", "1.4583333333333361`*^-7", 
   ",", "0.`", ",", "0.`", ",", "0.`", ",", "1.4583333333333361`*^-7"}], 
  "}"}]], "Output",
 CellChangeTimes->{3.908991438112544*^9},
 CellLabel->"Out[98]=",ExpressionUUID->"0af47a08-03a5-490f-87e6-1c9c0e3b6468"]
}, Open  ]],

Cell["Test GP temperature", "Text",
 CellChangeTimes->{{3.907340623951858*^9, 3.907340628882285*^9}, {
  3.907341363607823*^9, 3.907341367981825*^9}, {3.9073422249378366`*^9, 
  3.907342227287876*^9}},ExpressionUUID->"dc1557ad-c659-49ea-9f53-\
c3cbe497b775"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"SetPrecision", "[", 
  RowBox[{
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"gpTemperature", "[", 
       RowBox[{"[", "i", "]"}], "]"}], "[", 
      RowBox[{"[", "j", "]"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "1", ",", 
       RowBox[{"Length", "[", "gw", "]"}]}], "}"}]}], "]"}], ",", "18"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.907340581228263*^9, 3.907340598559038*^9}, {
  3.90734063480271*^9, 3.90734064194847*^9}, {3.907341370888782*^9, 
  3.9073414417714663`*^9}},
 CellLabel->"In[82]:=",ExpressionUUID->"d66de46f-fc13-4f0d-8cce-26afb678a0a3"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
    "3.6944271909999210171419645187818`18.*^-6", ",", 
     "2.08445824720007252968921596103513`18.*^-6", ",", 
     "3.87331262919990465298835172203162`18.*^-6", ",", 
     "1.54780193260012310445771204631127`18.*^-6"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "1.64222912360003772000113277107491`18.*^-6", ",", 
     "1.82111456180002072057280953359948`18.*^-6", ",", 
     "3.43108350559986941978379490492124`18.*^-6", ",", 
     "1.10557280900008808301139204277597`18.*^-6"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.907340600121832*^9, 3.9073406365335617`*^9, 
  3.9073414466098757`*^9, 3.907341644353507*^9, 3.907612803656981*^9, 
  3.907768848428101*^9, 3.907846247629856*^9, 3.908991084806328*^9},
 CellLabel->"Out[82]=",ExpressionUUID->"259c834f-9162-4cf8-aefe-69842fb5a326"]
}, Open  ]],

Cell["Test GP deviatoric stress", "Text",
 CellChangeTimes->{{3.907340623951858*^9, 3.907340628882285*^9}, {
  3.907612804776881*^9, 3.907612806309651*^9}, {3.9076798589327374`*^9, 
  3.907679862931592*^9}},ExpressionUUID->"ff901ec3-7440-425d-8e54-\
938368192a9d"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"SetPrecision", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"gpDevStress", "[", 
     RowBox[{"[", "1", "]"}], "]"}], "[", 
    RowBox[{"[", "1", "]"}], "]"}], ",", "18"}], "]"}]], "Input",
 CellChangeTimes->{{3.907340581228263*^9, 3.907340598559038*^9}, {
  3.90734063480271*^9, 3.90734064194847*^9}, {3.907341415010034*^9, 
  3.90734142594523*^9}},
 CellLabel->
  "In[166]:=",ExpressionUUID->"79ba2779-b7a2-4792-999c-003927f86e6c"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "40026.684456304195919074118137359619140625`18.", ",", 
   "3.524595069045162432368659998`18.*^-9", ",", 
   RowBox[{"-", "40026.6844562965779914520680904388427734375`18."}], ",", 
   "73382.254836557709495536983013153076171875`18.", ",", 
   "186791.19412941965856589376926422119140625`18.", ",", 
   "140093.39559706472209654748439788818359375`18."}], "}"}]], "Output",
 CellChangeTimes->{3.907341426407048*^9, 3.907612809127277*^9, 
  3.907768848464509*^9, 3.9078462610491257`*^9, 3.907846350780224*^9, 
  3.9078466270265083`*^9, 3.908991086553623*^9, 3.909002733023366*^9, 
  3.909002955689101*^9},
 CellLabel->
  "Out[166]=",ExpressionUUID->"63019958-a339-4093-bebc-44fea67af83b"]
}, Open  ]],

Cell["Test projected volume strain flux", "Text",
 CellChangeTimes->{{3.907340623951858*^9, 3.907340628882285*^9}, {
  3.9073422530010777`*^9, 3.907342254641266*^9}, {3.9076798687828827`*^9, 
  3.907679876411861*^9}},ExpressionUUID->"4b6e1963-e5b3-4eb3-90c4-\
7fcce6bf0cc2"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"SetPrecision", "[", 
  RowBox[{
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"volumeFlux", "[", 
       RowBox[{"[", "i", "]"}], "]"}], "[", 
      RowBox[{"[", "j", "]"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "1", ",", 
       RowBox[{"Length", "[", "gw", "]"}]}], "}"}]}], "]"}], ",", "18"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.907340581228263*^9, 3.907340598559038*^9}, {
  3.90734063480271*^9, 3.90734064194847*^9}, {3.907341415010034*^9, 
  3.90734142594523*^9}, {3.907342424753496*^9, 3.907342503993833*^9}},
 CellLabel->"In[84]:=",ExpressionUUID->"47758c3c-0453-46c1-8a4e-3802a866a48e"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
    "3.5998891671840854845204876050202`18.*^-6", ",", 
     "3.59993746625247998125796990154246`18.*^-6", ",", 
     "3.59988380062093077572547492049004`18.*^-6", ",", 
     "3.59995356594194495467595520943327`18.*^-6"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "3.59995073312621018967231122098749`18.*^-6", ",", 
     "3.59994536656305505736082490930716`18.*^-6", ",", 
     "3.5998970674946605606233426127849`18.*^-6", ",", 
     "3.59996683281567473957382290172813`18.*^-6"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.907341426407048*^9, 3.9073424368579063`*^9, 
  3.9073425062219*^9, 3.907612811133335*^9, 3.907768848513941*^9, 
  3.907846394791806*^9, 3.908991088522715*^9},
 CellLabel->"Out[84]=",ExpressionUUID->"dcf1ae8d-eb2a-4f5f-86e6-5016685e18b6"]
}, Open  ]],

Cell["Test GP stabilization", "Text",
 CellChangeTimes->{{3.907340623951858*^9, 3.907340628882285*^9}, {
  3.9073422530010777`*^9, 3.907342254641266*^9}, {3.907342766136305*^9, 
  3.9073427715559387`*^9}, {3.907679853965824*^9, 
  3.9076798553429728`*^9}},ExpressionUUID->"4da83f35-948c-4d36-9a75-\
5f339a1d3887"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"SetPrecision", "[", 
  RowBox[{
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"gpCellStab", "[", 
       RowBox[{"[", "i", "]"}], "]"}], "[", 
      RowBox[{"[", "j", "]"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "1", ",", 
       RowBox[{"Length", "[", "gw", "]"}]}], "}"}]}], "]"}], ",", "18"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.907340581228263*^9, 3.907340598559038*^9}, {
  3.90734063480271*^9, 3.90734064194847*^9}, {3.907341415010034*^9, 
  3.90734142594523*^9}, {3.907342424753496*^9, 3.907342503993833*^9}, {
  3.907612946507737*^9, 3.907612951282711*^9}},
 CellLabel->"In[85]:=",ExpressionUUID->"03f83262-e37c-448a-a1cf-2f0465d82b5f"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "3.6435054027472688553876645996929874909715`18.*^-18", ",", 
       "5.30972974585768663535167589832732676912`18.*^-19", ",", 
       RowBox[{"-", "7.799493653333931799176178037211859576718`18.*^-19"}]}], 
      "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "3.5629349502220829974672263557436747821487`18.*^-18", ",", 
       "3.698320695353981514005063439565154192528`18.*^-19", ",", 
       RowBox[{"-", "1.0216607229089490203419825870568563337597`18.*^-18"}]}],
       "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "3.4823644976968979099187658666887032957172`18.*^-18", ",", 
       "2.086911644850278077847152319634353039917`18.*^-19", ",", 
       RowBox[{"-", "1.2633720804845046681733529316689414042499`18.*^-18"}]}],
       "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "3.724075855272453942936125088747958977403`18.*^-18", ",", 
       "6.921138796361392238180774453898462609707`18.*^-19", ",", 
       RowBox[{"-", "5.382380077578373394932530203855155815838`18.*^-19"}]}], 
      "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"3.2333881069492750305767683819507251125387`18.*^-18", ",", 
       RowBox[{"-", "2.892616170102160490434596551171161695871`18.*^-19"}], 
       ",", 
       RowBox[{"-", "2.0103012527273700321184399275819257586229`18.*^-18"}]}],
       "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"3.0722472018989048554798474038407821396757`18.*^-18", ",", 
       RowBox[{"-", "6.115434271109572177575279759122396641038`18.*^-19"}], 
       ",", 
       RowBox[{"-", "2.4937239678784813277811806168060958996033`18.*^-18"}]}],
       "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"2.9111062968485339100109486708364979444214`18.*^-18", ",", 
       RowBox[{"-", "9.338252372116978568408615902175035682267`18.*^-19"}], 
       ",", 
       RowBox[{"-", "2.9771466830295930086299101834774366517792`18.*^-18"}]}],
       "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "3.3945290119996459760456671149550093077929`18.*^-18", ",", 
       "3.30201930905249090220209983240858969321`18.*^-20", ",", 
       RowBox[{"-", "1.526878537576258351269710360910585006447`18.*^-18"}]}], 
      "}"}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.907341426407048*^9, 3.9073424368579063`*^9, 3.9073425062219*^9, 
   3.907612812786384*^9, 3.907612953033202*^9, 3.9076139287147512`*^9, 
   3.907768848549591*^9, {3.907846599604764*^9, 3.907846620840597*^9}, 
   3.9089910917344017`*^9},
 CellLabel->"Out[85]=",ExpressionUUID->"ef5dd2a7-2ca8-4e6e-b0bc-7d238ac70d99"]
}, Open  ]],

Cell["Test GP thermal flux", "Text",
 CellChangeTimes->{{3.907340623951858*^9, 3.907340628882285*^9}, {
  3.9073422530010777`*^9, 3.907342254641266*^9}, {3.907342766136305*^9, 
  3.9073427715559387`*^9}, {3.907679840973015*^9, 3.907679842553351*^9}, {
  3.907679889632491*^9, 
  3.9076798899654303`*^9}},ExpressionUUID->"b3d95142-45aa-4e81-a6ac-\
0142f986fdd9"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"SetPrecision", "[", 
  RowBox[{
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"gpCellTFlux", "[", 
       RowBox[{"[", "i", "]"}], "]"}], "[", 
      RowBox[{"[", "j", "]"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "1", ",", 
       RowBox[{"Length", "[", "gw", "]"}]}], "}"}]}], "]"}], ",", "18"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.907340581228263*^9, 3.907340598559038*^9}, {
  3.90734063480271*^9, 3.90734064194847*^9}, {3.907341415010034*^9, 
  3.90734142594523*^9}, {3.907342424753496*^9, 3.907342503993833*^9}, {
  3.907612946507737*^9, 3.907612951282711*^9}, {3.9076798950347843`*^9, 
  3.9076798978002234`*^9}},
 CellLabel->"In[86]:=",ExpressionUUID->"e15a3daa-db33-4f3f-bc8d-f40c43775b63"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "0.00719999999999999980293541312903471407`18.", ",", 
       "0.00239999999999999978975151471161098016`18.", ",", 
       "0.00080000000000000079727890955894054059`18."}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "0.00719999999999999980293541312903471407`18.", ",", 
       "0.00239999999999999978975151471161098016`18.", ",", 
       "0.00080000000000000079727890955894054059`18."}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "0.00719999999999999980293541312903471407`18.", ",", 
       "0.00239999999999999978975151471161098016`18.", ",", 
       "0.00080000000000000079727890955894054059`18."}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "0.00719999999999999980293541312903471407`18.", ",", 
       "0.00239999999999999978975151471161098016`18.", ",", 
       "0.00080000000000000079727890955894054059`18."}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "0.00720000000000000067029715111743826128`18.", ",", 
       "0.00239999999999999978975151471161098016`18.", ",", 
       "0.00079999999999999992991717157053699339`18."}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "0.00720000000000000067029715111743826128`18.", ",", 
       "0.00239999999999999978975151471161098016`18.", ",", 
       "0.00079999999999999992991717157053699339`18."}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "0.00720000000000000067029715111743826128`18.", ",", 
       "0.00239999999999999978975151471161098016`18.", ",", 
       "0.00079999999999999992991717157053699339`18."}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "0.00720000000000000067029715111743826128`18.", ",", 
       "0.00239999999999999978975151471161098016`18.", ",", 
       "0.00079999999999999992991717157053699339`18."}], "}"}]}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{3.907341426407048*^9, 3.9073424368579063`*^9, 
  3.9073425062219*^9, 3.907612812786384*^9, 3.907612953033202*^9, 
  3.9076139287147512`*^9, 3.9076799083271646`*^9, 3.90776884863373*^9, 
  3.907846624129011*^9, 3.9089910950322104`*^9},
 CellLabel->"Out[86]=",ExpressionUUID->"73dbc29c-ea58-4846-ab45-79110632bea2"]
}, Open  ]],

Cell["Test cell volume", "Text",
 CellChangeTimes->{{3.907340623951858*^9, 3.907340628882285*^9}, {
  3.9073422530010777`*^9, 3.907342254641266*^9}, {3.907342766136305*^9, 
  3.9073427715559387`*^9}, {3.907679840973015*^9, 3.907679842553351*^9}, {
  3.907679889632491*^9, 3.9076798899654303`*^9}, {3.907680381406966*^9, 
  3.907680384229189*^9}},ExpressionUUID->"9c52e7f3-6ba6-4ab5-a4ed-\
6642c87f2408"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"SetPrecision", "[", 
  RowBox[{
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"cellVolume", "[", 
      RowBox[{"[", "i", "]"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"Length", "[", "connect", "]"}]}], "}"}]}], "]"}], ",", "18"}],
   "]"}]], "Input",
 CellChangeTimes->{{3.907340581228263*^9, 3.907340598559038*^9}, {
  3.90734063480271*^9, 3.90734064194847*^9}, {3.907341415010034*^9, 
  3.90734142594523*^9}, {3.907342424753496*^9, 3.907342503993833*^9}, {
  3.907612946507737*^9, 3.907612951282711*^9}, {3.9076798950347843`*^9, 
  3.9076798978002234`*^9}, {3.907680387070554*^9, 3.9076804109029903`*^9}},
 CellLabel->"In[87]:=",ExpressionUUID->"58eab9b5-f607-4d53-8ecd-b0746d7983b9"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "0.02083333333333333217685101601546193706`18.", ",", 
   "0.02083333333333333217685101601546193706`18.", ",", 
   "0.02083333333333333217685101601546193706`18.", ",", 
   "0.02083333333333333217685101601546193706`18.", ",", 
   "0.02083333333333333217685101601546193706`18.", ",", 
   "0.02083333333333333217685101601546193706`18.", ",", 
   "0.02083333333333333217685101601546193706`18.", ",", 
   "0.02083333333333333217685101601546193706`18.", ",", 
   "0.02083333333333333217685101601546193706`18.", ",", 
   "0.02083333333333333217685101601546193706`18.", ",", 
   "0.02083333333333333217685101601546193706`18.", ",", 
   "0.02083333333333333217685101601546193706`18.", ",", 
   "0.02083333333333333217685101601546193706`18.", ",", 
   "0.02083333333333333217685101601546193706`18.", ",", 
   "0.02083333333333333217685101601546193706`18.", ",", 
   "0.02083333333333333217685101601546193706`18.", ",", 
   "0.02083333333333333217685101601546193706`18.", ",", 
   "0.02083333333333333217685101601546193706`18.", ",", 
   "0.02083333333333333217685101601546193706`18.", ",", 
   "0.02083333333333333217685101601546193706`18.", ",", 
   "0.02083333333333333217685101601546193706`18.", ",", 
   "0.02083333333333333217685101601546193706`18.", ",", 
   "0.02083333333333333217685101601546193706`18.", ",", 
   "0.02083333333333333217685101601546193706`18.", ",", 
   "0.02083333333333333217685101601546193706`18.", ",", 
   "0.02083333333333333217685101601546193706`18.", ",", 
   "0.02083333333333333217685101601546193706`18.", ",", 
   "0.02083333333333333217685101601546193706`18.", ",", 
   "0.02083333333333333217685101601546193706`18.", ",", 
   "0.02083333333333333217685101601546193706`18.", ",", 
   "0.02083333333333333217685101601546193706`18.", ",", 
   "0.02083333333333333217685101601546193706`18.", ",", 
   "0.02083333333333333217685101601546193706`18.", ",", 
   "0.02083333333333333217685101601546193706`18.", ",", 
   "0.02083333333333333217685101601546193706`18.", ",", 
   "0.02083333333333333217685101601546193706`18.", ",", 
   "0.02083333333333333217685101601546193706`18.", ",", 
   "0.02083333333333333217685101601546193706`18.", ",", 
   "0.02083333333333333217685101601546193706`18.", ",", 
   "0.02083333333333333217685101601546193706`18.", ",", 
   "0.02083333333333333217685101601546193706`18.", ",", 
   "0.02083333333333333217685101601546193706`18.", ",", 
   "0.02083333333333333217685101601546193706`18.", ",", 
   "0.02083333333333333217685101601546193706`18.", ",", 
   "0.02083333333333333217685101601546193706`18.", ",", 
   "0.02083333333333333217685101601546193706`18.", ",", 
   "0.02083333333333333217685101601546193706`18.", ",", 
   "0.02083333333333333217685101601546193706`18."}], "}"}]], "Output",
 CellChangeTimes->{
  3.907341426407048*^9, 3.9073424368579063`*^9, 3.9073425062219*^9, 
   3.907612812786384*^9, 3.907612953033202*^9, 3.9076139287147512`*^9, 
   3.9076799083271646`*^9, {3.9076804121741753`*^9, 3.907680419578867*^9}, 
   3.907680494305863*^9, 3.9077688486712103`*^9, 3.907846634693575*^9, 
   3.908991097023294*^9},
 CellLabel->"Out[87]=",ExpressionUUID->"9a6a2001-8cf3-4b0c-a265-5855d6d86bd8"]
}, Open  ]],

Cell["Test GP thermal content", "Text",
 CellChangeTimes->{{3.907340623951858*^9, 3.907340628882285*^9}, {
  3.9073422530010777`*^9, 3.907342254641266*^9}, {3.907342766136305*^9, 
  3.9073427715559387`*^9}, {3.907679840973015*^9, 3.907679842553351*^9}, {
  3.907679889632491*^9, 3.9076798899654303`*^9}, {3.907680810964127*^9, 
  3.907680812517743*^9}},ExpressionUUID->"5b832f92-e406-4ec8-95dd-\
50a014f3bd5a"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"SetPrecision", "[", 
  RowBox[{
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"gpThermalContent", "[", 
       RowBox[{"[", "i", "]"}], "]"}], "[", 
      RowBox[{"[", "j", "]"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", "8"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "1", ",", 
       RowBox[{"Length", "[", "gw", "]"}]}], "}"}]}], "]"}], ",", "18"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.907340581228263*^9, 3.907340598559038*^9}, {
  3.90734063480271*^9, 3.90734064194847*^9}, {3.907341415010034*^9, 
  3.90734142594523*^9}, {3.907342424753496*^9, 3.907342503993833*^9}, {
  3.907612946507737*^9, 3.907612951282711*^9}, {3.9076798950347843`*^9, 
  3.9076798978002234`*^9}, {3.907680815431943*^9, 3.907680840903173*^9}},
 CellLabel->"In[88]:=",ExpressionUUID->"f435389d-a367-4dc5-b9c4-2f98ce2b9c4a"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
    "1.10832815729997635756376439530868083239`18.", ",", 
     "0.62533747416002172236915157554903998971`18.", ",", 
     "1.16199378875997139104470079473685473204`18.", ",", 
     "0.46434057978003701050440099606930743903`18."}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.49266873708001129861244749008619692177`18.", ",", 
     "0.54633436854000616555993019574088975787`18.", ",", 
     "1.02932505167996080075454301550053060055`18.", ",", 
     "0.33167184270002642021424321683298330754`18."}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.51316718427000362900969321344746276736`18.", ",", 
     "0.35217028989001875061148894019424915314`18.", ",", 
     "0.99615786740995815318200357069144956768`18.", ",", 
     "0.29850465843002377264170377202390227467`18."}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.45167184270002669332910727462149225175`18.", ",", 
     "0.9346625258399811064791151693498250097`18.", ",", 
     "1.09565942021996609589962190511869266629`18.", ",", 
     "0.39800621124003171535932210645114537328`18."}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "1.06733126291999180779157541110180318356`18.", ",", 
     "1.01366563145999677431063901167362928391`18.", ",", 
     "1.22832815729997668618977968435501679778`18.", ",", 
     "0.53067494832004225013832865442964248359`18."}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "1.04683281572999953290548091899836435914`18.", ",", 
     "1.20782971010998441130368519225157797337`18.", ",", 
     "1.26149534156997944478462159167975187302`18.", ",", 
     "0.56384213259004489771086809923872351646`18."}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "1.22832815729997646414517475932370871305`18.", ",", 
     "0.74533747416002182895056193956406787038`18.", ",", 
     "1.28199378875997149762611115875188261271`18.", ",", 
     "0.58434057978003695055235766631085425615`18."}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.61266873708001123866040416032774373889`18.", ",", 
     "0.66633436854000616111903809724026359618`18.", ",", 
     "1.14932505167996090733595337951555848122`18.", ",", 
     "0.45167184270002641577335111833235714585`18."}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{
  3.907341426407048*^9, 3.9073424368579063`*^9, 3.9073425062219*^9, 
   3.907612812786384*^9, 3.907612953033202*^9, 3.9076139287147512`*^9, 
   3.9076799083271646`*^9, {3.9076808266865473`*^9, 3.907680841467409*^9}, 
   3.9076845747778187`*^9, 3.907768848718285*^9, 3.9078466392570133`*^9, 
   3.908991100385182*^9},
 CellLabel->"Out[88]=",ExpressionUUID->"3750400f-707a-487f-a0d1-9adb904e6975"]
}, Open  ]],

Cell["Test GP interpolated pressure gradient", "Text",
 CellChangeTimes->{{3.907340623951858*^9, 3.907340628882285*^9}, {
  3.9073422530010777`*^9, 3.907342254641266*^9}, {3.907342766136305*^9, 
  3.9073427715559387`*^9}, {3.907679840973015*^9, 3.907679842553351*^9}, {
  3.907679889632491*^9, 3.9076798899654303`*^9}, {3.907684978842527*^9, 
  3.9076849910429983`*^9}, {3.907689488720016*^9, 
  3.9076895009910183`*^9}},ExpressionUUID->"4faebc86-d3d8-4ea2-9f1e-\
29b6de80e9c2"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"SetPrecision", "[", 
  RowBox[{
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"gpCellInterpolatedPGrad", "[", 
       RowBox[{"[", "i", "]"}], "]"}], "[", 
      RowBox[{"[", "j", "]"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "1", ",", 
       RowBox[{"Length", "[", "gw", "]"}]}], "}"}]}], "]"}], ",", "18"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.907340581228263*^9, 3.907340598559038*^9}, {
  3.90734063480271*^9, 3.90734064194847*^9}, {3.907341415010034*^9, 
  3.90734142594523*^9}, {3.907342424753496*^9, 3.907342503993833*^9}, {
  3.907612946507737*^9, 3.907612951282711*^9}, {3.9076798950347843`*^9, 
  3.9076798978002234`*^9}, {3.9076849987815027`*^9, 3.907685001667749*^9}, {
  3.9076895199049053`*^9, 3.907689521376419*^9}},
 CellLabel->"In[89]:=",ExpressionUUID->"8262bf16-8017-4eba-a714-81c64bfd647d"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "9.1055728090000961913257591928694`18.*^-7", ",", 
       "1.82111456180001923826515183857389`18.*^-6", ",", 
       "2.73167184270002843388125413071066`18.*^-6"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "1.08944271909999283146248949538659`18.*^-6", ",", 
       "2.17888543819998566292497899077318`18.*^-6", ",", 
       "3.26832815729997849438746848615978`18.*^-6"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "1.26832815729997583203416625791116`18.*^-6", ",", 
       "2.53665631459995166406833251582231`18.*^-6", ",", 
       "3.80498447189992770786073558730855`18.*^-6"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "7.3167184270002640680266234318729`18.*^-7", ",", 
       "1.46334368540005281360532468637459`18.*^-6", ",", 
       "2.19501552810007922040798702956188`18.*^-6"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "1.82111456180001923826515183857389`18.*^-6", ",", 
       "3.64222912360003847653030367714777`18.*^-6", ",", 
       "5.46334368540005686776250826142132`18.*^-6"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "2.17888543819998566292497899077318`18.*^-6", ",", 
       "4.35777087639997132584995798154637`18.*^-6", ",", 
       "6.53665631459995698877493697231955`18.*^-6"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "2.53665631459995166406833251582231`18.*^-6", ",", 
       "5.07331262919990332813666503164463`18.*^-6", ",", 
       "7.60996894379985541572147117461711`18.*^-6"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "1.46334368540005281360532468637459`18.*^-6", ",", 
       "2.92668737080010562721064937274917`18.*^-6", ",", 
       "4.39003105620015844081597405912376`18.*^-6"}], "}"}]}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{3.907341426407048*^9, 3.9073424368579063`*^9, 
  3.9073425062219*^9, 3.907612812786384*^9, 3.907612953033202*^9, 
  3.9076139287147512`*^9, 3.9076799083271646`*^9, 3.907685004032866*^9, 
  3.907689524720643*^9, 3.907768848757469*^9, 3.9078466425593023`*^9, 
  3.908991105415745*^9},
 CellLabel->"Out[89]=",ExpressionUUID->"935ac453-1c45-4ba1-a964-ffac9349e8ce"]
}, Open  ]],

Cell["Test GP pressure gradient", "Text",
 CellChangeTimes->{{3.907340623951858*^9, 3.907340628882285*^9}, {
  3.9073422530010777`*^9, 3.907342254641266*^9}, {3.907342766136305*^9, 
  3.9073427715559387`*^9}, {3.907679840973015*^9, 3.907679842553351*^9}, {
  3.907679889632491*^9, 3.9076798899654303`*^9}, {3.907684978842527*^9, 
  3.9076849910429983`*^9}, {3.907689488720016*^9, 
  3.907689530365245*^9}},ExpressionUUID->"b31ce238-5a11-43f4-abf2-\
ded3aaa705f0"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"SetPrecision", "[", 
  RowBox[{
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"gpCellPGrad", "[", 
       RowBox[{"[", "i", "]"}], "]"}], "[", 
      RowBox[{"[", "j", "]"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "1", ",", 
       RowBox[{"Length", "[", "gw", "]"}]}], "}"}]}], "]"}], ",", "18"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.907340581228263*^9, 3.907340598559038*^9}, {
  3.90734063480271*^9, 3.90734064194847*^9}, {3.907341415010034*^9, 
  3.90734142594523*^9}, {3.907342424753496*^9, 3.907342503993833*^9}, {
  3.907612946507737*^9, 3.907612951282711*^9}, {3.9076798950347843`*^9, 
  3.9076798978002234`*^9}, {3.9076849987815027`*^9, 3.907685001667749*^9}},
 CellLabel->"In[90]:=",ExpressionUUID->"a18f641f-3cc9-48e1-91cc-3e18c14eec26"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "9.00000000000000022800771687370158`18.*^-6", ",", 
       "3.00000000000000007600257229123386`18.*^-6", ",", 
       "9.9999999999999889595692775801083`18.*^-7"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "9.00000000000000022800771687370158`18.*^-6", ",", 
       "3.00000000000000007600257229123386`18.*^-6", ",", 
       "9.9999999999999889595692775801083`18.*^-7"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "9.00000000000000022800771687370158`18.*^-6", ",", 
       "3.00000000000000007600257229123386`18.*^-6", ",", 
       "9.9999999999999889595692775801083`18.*^-7"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "9.00000000000000022800771687370158`18.*^-6", ",", 
       "3.00000000000000007600257229123386`18.*^-6", ",", 
       "9.9999999999999889595692775801083`18.*^-7"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "8.9999999999999985339418223651009`18.*^-6", ",", 
       "3.00000000000000007600257229123386`18.*^-6", ",", 
       "9.9999999999999974298987501231117`18.*^-7"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "8.9999999999999985339418223651009`18.*^-6", ",", 
       "3.00000000000000007600257229123386`18.*^-6", ",", 
       "9.9999999999999974298987501231117`18.*^-7"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "8.9999999999999985339418223651009`18.*^-6", ",", 
       "3.00000000000000007600257229123386`18.*^-6", ",", 
       "9.9999999999999974298987501231117`18.*^-7"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "8.9999999999999985339418223651009`18.*^-6", ",", 
       "3.00000000000000007600257229123386`18.*^-6", ",", 
       "9.9999999999999974298987501231117`18.*^-7"}], "}"}]}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{3.907341426407048*^9, 3.9073424368579063`*^9, 
  3.9073425062219*^9, 3.907612812786384*^9, 3.907612953033202*^9, 
  3.9076139287147512`*^9, 3.9076799083271646`*^9, 3.907685004032866*^9, 
  3.90768953382668*^9, 3.9077688487913933`*^9, 3.90784664493369*^9, 
  3.9089911100742407`*^9},
 CellLabel->"Out[90]=",ExpressionUUID->"982a92a4-1034-4dc4-ad3f-a70e6684e59b"]
}, Open  ]],

Cell["Test GP temperature gradient", "Text",
 CellChangeTimes->{{3.907340623951858*^9, 3.907340628882285*^9}, {
  3.9073422530010777`*^9, 3.907342254641266*^9}, {3.907342766136305*^9, 
  3.9073427715559387`*^9}, {3.907679840973015*^9, 3.907679842553351*^9}, {
  3.907679889632491*^9, 3.9076798899654303`*^9}, {3.907684978842527*^9, 
  3.9076849910429983`*^9}, {3.907689488720016*^9, 3.907689530365245*^9}, {
  3.907689977857646*^9, 
  3.907689978898942*^9}},ExpressionUUID->"74e472fd-2d23-4ccb-974c-\
c32845f59f00"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"SetPrecision", "[", 
  RowBox[{
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"gpCellTGrad", "[", 
       RowBox[{"[", "i", "]"}], "]"}], "[", 
      RowBox[{"[", "j", "]"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "1", ",", 
       RowBox[{"Length", "[", "gw", "]"}]}], "}"}]}], "]"}], ",", "18"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.907340581228263*^9, 3.907340598559038*^9}, {
  3.90734063480271*^9, 3.90734064194847*^9}, {3.907341415010034*^9, 
  3.90734142594523*^9}, {3.907342424753496*^9, 3.907342503993833*^9}, {
  3.907612946507737*^9, 3.907612951282711*^9}, {3.9076798950347843`*^9, 
  3.9076798978002234`*^9}, {3.9076849987815027`*^9, 3.907685001667749*^9}, {
  3.9076899818517027`*^9, 3.907689981994342*^9}},
 CellLabel->"In[91]:=",ExpressionUUID->"81471d78-6478-4a2e-8f63-6e1fb352fc28"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "7.19999999999999967418640514638106`18.*^-6", ",", 
       "2.39999999999999989139546838212702`18.*^-6", ",", 
       "8.0000000000000081083143671500935`18.*^-7"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "7.19999999999999967418640514638106`18.*^-6", ",", 
       "2.39999999999999989139546838212702`18.*^-6", ",", 
       "8.0000000000000081083143671500935`18.*^-7"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "7.19999999999999967418640514638106`18.*^-6", ",", 
       "2.39999999999999989139546838212702`18.*^-6", ",", 
       "8.0000000000000081083143671500935`18.*^-7"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "7.19999999999999967418640514638106`18.*^-6", ",", 
       "2.39999999999999989139546838212702`18.*^-6", ",", 
       "8.0000000000000081083143671500935`18.*^-7"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "7.2000000000000005212193524006814`18.*^-6", ",", 
       "2.39999999999999989139546838212702`18.*^-6", ",", 
       "7.9999999999999996379848946070901`18.*^-7"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "7.2000000000000005212193524006814`18.*^-6", ",", 
       "2.39999999999999989139546838212702`18.*^-6", ",", 
       "7.9999999999999996379848946070901`18.*^-7"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "7.2000000000000005212193524006814`18.*^-6", ",", 
       "2.39999999999999989139546838212702`18.*^-6", ",", 
       "7.9999999999999996379848946070901`18.*^-7"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "7.2000000000000005212193524006814`18.*^-6", ",", 
       "2.39999999999999989139546838212702`18.*^-6", ",", 
       "7.9999999999999996379848946070901`18.*^-7"}], "}"}]}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{3.907341426407048*^9, 3.9073424368579063`*^9, 
  3.9073425062219*^9, 3.907612812786384*^9, 3.907612953033202*^9, 
  3.9076139287147512`*^9, 3.9076799083271646`*^9, 3.907685004032866*^9, 
  3.90768953382668*^9, 3.907689983026463*^9, 3.907768848830127*^9, 
  3.907846648000866*^9, 3.908991112630313*^9},
 CellLabel->"Out[91]=",ExpressionUUID->"2e437461-0ed6-4389-8d26-76cde658a107"]
}, Open  ]],

Cell["Test stress divergence and local assembly", "Text",
 CellChangeTimes->{{3.907340623951858*^9, 3.907340628882285*^9}, {
  3.9073422530010777`*^9, 3.907342254641266*^9}, {3.907342766136305*^9, 
  3.9073427715559387`*^9}, {3.907679840973015*^9, 3.907679842553351*^9}, {
  3.907679889632491*^9, 3.9076798899654303`*^9}, {3.907684978842527*^9, 
  3.9076849910429983`*^9}, {3.907689488720016*^9, 3.907689530365245*^9}, {
  3.907689977857646*^9, 3.907689978898942*^9}, {3.907691001465877*^9, 
  3.907691028916403*^9}},ExpressionUUID->"77840097-e70c-4afc-93ff-\
9bb8f70b85ed"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"SetPrecision", "[", 
  RowBox[{
   RowBox[{"divDevStressResidual", "[", 
    RowBox[{"[", "1", "]"}], "]"}], ",", "18"}], "]"}]], "Input",
 CellChangeTimes->{{3.907340581228263*^9, 3.907340598559038*^9}, {
  3.90734063480271*^9, 3.90734064194847*^9}, {3.907341415010034*^9, 
  3.90734142594523*^9}, {3.907342424753496*^9, 3.907342503993833*^9}, {
  3.907612946507737*^9, 3.907612951282711*^9}, {3.9076798950347843`*^9, 
  3.9076798978002234`*^9}, {3.9076849987815027`*^9, 3.907685001667749*^9}, {
  3.9076899818517027`*^9, 3.907689981994342*^9}, {3.907691033885068*^9, 
  3.907691064651104*^9}, {3.9076913374424458`*^9, 3.907691338807871*^9}, {
  3.909002349553911*^9, 3.909002387763192*^9}, {3.9090027678381147`*^9, 
  3.909002768054137*^9}},
 CellLabel->
  "In[170]:=",ExpressionUUID->"cbdefdd7-ebc6-4d63-a838-f613ba767811"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"-", "5837.22481654436342068947851657867431640625`18."}], ",", 
   RowBox[{"-", "1.4685702496939832951260214833`18.*^-10"}], ",", 
   RowBox[{"-", "3057.59395152323759248247370123863220214844`18."}], ",", "0",
    ",", "0", ",", 
   RowBox[{"-", "6115.18790304644608113449066877365112304687`18."}], ",", 
   "2779.63086502112537345965392887592315673828`18.", ",", 
   "9450.74494107150894706137478351593017578125`18.", ",", "0", ",", "0", ",",
    "4169.4462975316564552485942840576171875`18.", ",", 
   RowBox[{"-", "5837.22481654421608254779130220413208007813`18."}], ",", 
   RowBox[{"-", "4725.37247053591454459819942712783813476563`18."}], ",", "0",
    ",", "0", ",", "7782.96642205915213708067312836647033691406`18.", ",", 
   "3057.59395152323759248247370123863220214844`18.", ",", 
   RowBox[{"-", "1667.77851901235726472805254161357879638672`18."}], ",", "0",
    ",", "0"}], "}"}]], "Output",
 CellChangeTimes->{
  3.908997369046962*^9, {3.909002367693549*^9, 3.909002388515628*^9}, 
   3.909002769589837*^9, 3.9090029874805393`*^9},
 CellLabel->
  "Out[170]=",ExpressionUUID->"6fb62c15-0e6d-4687-979c-3e3a02e937c5"]
}, Open  ]],

Cell["Test pressure divergence and local assembly", "Text",
 CellChangeTimes->{{3.907340623951858*^9, 3.907340628882285*^9}, {
  3.9073422530010777`*^9, 3.907342254641266*^9}, {3.907342766136305*^9, 
  3.9073427715559387`*^9}, {3.907679840973015*^9, 3.907679842553351*^9}, {
  3.907679889632491*^9, 3.9076798899654303`*^9}, {3.907684978842527*^9, 
  3.9076849910429983`*^9}, {3.907689488720016*^9, 3.907689530365245*^9}, {
  3.907689977857646*^9, 3.907689978898942*^9}, {3.907691001465877*^9, 
  3.907691028916403*^9}, {3.907695740741178*^9, 
  3.907695742018455*^9}},ExpressionUUID->"35af5375-afad-49b2-94fd-\
82c4722d8375"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"SetPrecision", "[", 
  RowBox[{
   RowBox[{"divPressureResidual", "[", 
    RowBox[{"[", "1", "]"}], "]"}], ",", "18"}], "]"}]], "Input",
 CellChangeTimes->{{3.907340581228263*^9, 3.907340598559038*^9}, {
  3.90734063480271*^9, 3.90734064194847*^9}, {3.907341415010034*^9, 
  3.90734142594523*^9}, {3.907342424753496*^9, 3.907342503993833*^9}, {
  3.907612946507737*^9, 3.907612951282711*^9}, {3.9076798950347843`*^9, 
  3.9076798978002234`*^9}, {3.9076849987815027`*^9, 3.907685001667749*^9}, {
  3.9076899818517027`*^9, 3.907689981994342*^9}, {3.907691033885068*^9, 
  3.907691064651104*^9}, {3.9076913374424458`*^9, 3.907691338807871*^9}, {
  3.907695752427248*^9, 3.907695754119646*^9}},
 CellLabel->"In[93]:=",ExpressionUUID->"3a759521-ac01-42b1-897a-bbb45c7fc68b"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0", ",", 
   RowBox[{"-", "1.4583333333333361349004532632467`18.*^-7"}], ",", "0", ",", 
   "0", ",", "0", ",", "1.4583333333333361349004532632467`18.*^-7", ",", "0", 
   ",", 
   RowBox[{"-", "1.4583333333333361349004532632467`18.*^-7"}], ",", "0", ",", 
   "0", ",", 
   RowBox[{"-", "1.4583333333333361349004532632467`18.*^-7"}], ",", 
   "1.4583333333333361349004532632467`18.*^-7", ",", "0", ",", "0", ",", "0", 
   ",", "0", ",", "0", ",", "1.4583333333333361349004532632467`18.*^-7", ",", 
   "0", ",", "0"}], "}"}]], "Output",
 CellChangeTimes->{3.907341426407048*^9, 3.9073424368579063`*^9, 
  3.9073425062219*^9, 3.907612812786384*^9, 3.907612953033202*^9, 
  3.9076139287147512`*^9, 3.9076799083271646`*^9, 3.907685004032866*^9, 
  3.90768953382668*^9, 3.907689983026463*^9, 3.9076910660668507`*^9, 
  3.907691171098186*^9, 3.9076912593437777`*^9, 3.907691340746007*^9, 
  3.907692386173781*^9, 3.9076964120209084`*^9, 3.90776884890411*^9, 
  3.907846677544037*^9, 3.908991117659494*^9},
 CellLabel->"Out[93]=",ExpressionUUID->"99cee8c1-3f98-46ce-af20-cb31a6283ac4"]
}, Open  ]],

Cell["Test stabilization divergence and local assembly", "Text",
 CellChangeTimes->{{3.907340623951858*^9, 3.907340628882285*^9}, {
  3.9073422530010777`*^9, 3.907342254641266*^9}, {3.907342766136305*^9, 
  3.9073427715559387`*^9}, {3.907679840973015*^9, 3.907679842553351*^9}, {
  3.907679889632491*^9, 3.9076798899654303`*^9}, {3.907684978842527*^9, 
  3.9076849910429983`*^9}, {3.907689488720016*^9, 3.907689530365245*^9}, {
  3.907689977857646*^9, 3.907689978898942*^9}, {3.907691001465877*^9, 
  3.907691028916403*^9}, {3.907695740741178*^9, 3.907695742018455*^9}, {
  3.907698112245817*^9, 
  3.90769811448551*^9}},ExpressionUUID->"3cc258f8-622c-4996-9fee-\
12e1cae3c899"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"SetPrecision", "[", 
  RowBox[{
   RowBox[{"divCellStabResidual", "[", 
    RowBox[{"[", "1", "]"}], "]"}], ",", "18"}], "]"}]], "Input",
 CellChangeTimes->{{3.907340581228263*^9, 3.907340598559038*^9}, {
  3.90734063480271*^9, 3.90734064194847*^9}, {3.907341415010034*^9, 
  3.90734142594523*^9}, {3.907342424753496*^9, 3.907342503993833*^9}, {
  3.907612946507737*^9, 3.907612951282711*^9}, {3.9076798950347843`*^9, 
  3.9076798978002234`*^9}, {3.9076849987815027`*^9, 3.907685001667749*^9}, {
  3.9076899818517027`*^9, 3.907689981994342*^9}, {3.907691033885068*^9, 
  3.907691064651104*^9}, {3.9076913374424458`*^9, 3.907691338807871*^9}, {
  3.907695752427248*^9, 3.907695754119646*^9}, {3.907698122534369*^9, 
  3.907698123842721*^9}, {3.907698352583418*^9, 3.907698358043908*^9}, {
  3.907698398175589*^9, 3.907698398408036*^9}},
 CellLabel->"In[94]:=",ExpressionUUID->"7f54d71a-cbd7-4ba8-9d5e-983de0c7c6ac"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0", ",", "0", ",", "0", ",", 
   RowBox[{"-", "1.87667717525243086444932069539426686701`18.*^-20"}], ",", 
   "0", ",", "0", ",", "0", ",", "0", ",", 
   "1.876677175252436461683221570798464810946`18.*^-19", ",", "0", ",", "0", 
   ",", "0", ",", "0", ",", 
   RowBox[{"-", "1.313674022676705186140514831792651082866`18.*^-19"}], ",", 
   "0", ",", "0", ",", "0", ",", "0", ",", 
   RowBox[{"-", "3.75335435050487918263876240011345205382`18.*^-20"}], ",", 
   "0"}], "}"}]], "Output",
 CellChangeTimes->{
  3.907341426407048*^9, 3.9073424368579063`*^9, 3.9073425062219*^9, 
   3.907612812786384*^9, 3.907612953033202*^9, 3.9076139287147512`*^9, 
   3.9076799083271646`*^9, 3.907685004032866*^9, 3.90768953382668*^9, 
   3.907689983026463*^9, 3.9076910660668507`*^9, 3.907691171098186*^9, 
   3.9076912593437777`*^9, 3.907691340746007*^9, 3.907692386173781*^9, 
   3.9076964120209084`*^9, 3.907698130051656*^9, {3.907698353742865*^9, 
   3.907698359150434*^9}, 3.907698398922683*^9, 3.9076992457420177`*^9, 
   3.907768848952468*^9, 3.907846681399748*^9, 3.908991287759963*^9},
 CellLabel->"Out[94]=",ExpressionUUID->"870f9dd0-85fa-4db0-8746-e2f4c2b4842c"]
}, Open  ]],

Cell["Test flux divergence and local assembly", "Text",
 CellChangeTimes->{{3.907340623951858*^9, 3.907340628882285*^9}, {
  3.9073422530010777`*^9, 3.907342254641266*^9}, {3.907342766136305*^9, 
  3.9073427715559387`*^9}, {3.907679840973015*^9, 3.907679842553351*^9}, {
  3.907679889632491*^9, 3.9076798899654303`*^9}, {3.907684978842527*^9, 
  3.9076849910429983`*^9}, {3.907689488720016*^9, 3.907689530365245*^9}, {
  3.907689977857646*^9, 3.907689978898942*^9}, {3.907691001465877*^9, 
  3.907691028916403*^9}, {3.907695740741178*^9, 3.907695742018455*^9}, {
  3.907698112245817*^9, 3.90769811448551*^9}, {3.907700668927185*^9, 
  3.90770066924117*^9}},ExpressionUUID->"abae1ec6-9f21-4cf6-a3b5-\
a2a95b353806"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"SetPrecision", "[", 
  RowBox[{
   RowBox[{"divFluxResidual", "[", 
    RowBox[{"[", "1", "]"}], "]"}], ",", "18"}], "]"}]], "Input",
 CellChangeTimes->{{3.907340581228263*^9, 3.907340598559038*^9}, {
  3.90734063480271*^9, 3.90734064194847*^9}, {3.907341415010034*^9, 
  3.90734142594523*^9}, {3.907342424753496*^9, 3.907342503993833*^9}, {
  3.907612946507737*^9, 3.907612951282711*^9}, {3.9076798950347843`*^9, 
  3.9076798978002234`*^9}, {3.9076849987815027`*^9, 3.907685001667749*^9}, {
  3.9076899818517027`*^9, 3.907689981994342*^9}, {3.907691033885068*^9, 
  3.907691064651104*^9}, {3.9076913374424458`*^9, 3.907691338807871*^9}, {
  3.907695752427248*^9, 3.907695754119646*^9}, {3.907698122534369*^9, 
  3.907698123842721*^9}, {3.907698352583418*^9, 3.907698358043908*^9}, {
  3.907698398175589*^9, 3.907698398408036*^9}, {3.9077006861886053`*^9, 
  3.907700686617344*^9}},
 CellLabel->"In[95]:=",ExpressionUUID->"e2542733-7dd8-41c2-8dc1-6d99dbfa40ed"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", 
   RowBox[{"-", "0.00009999999999999999123964644631712417`18."}], ",", "0", 
   ",", "0", ",", "0", ",", "0", ",", 
   "0.0002666666666666666252356876487539239`18.", ",", "0", ",", "0", ",", 
   "0", ",", "0", ",", 
   RowBox[{"-", "0.0002000000000000000095843472047718592`18."}], ",", "0", 
   ",", "0", ",", "0", ",", "0", ",", 
   "0.00003333333333333336203577884626625405`18."}], "}"}]], "Output",
 CellChangeTimes->{
  3.907341426407048*^9, 3.9073424368579063`*^9, 3.9073425062219*^9, 
   3.907612812786384*^9, 3.907612953033202*^9, 3.9076139287147512`*^9, 
   3.9076799083271646`*^9, 3.907685004032866*^9, 3.90768953382668*^9, 
   3.907689983026463*^9, 3.9076910660668507`*^9, 3.907691171098186*^9, 
   3.9076912593437777`*^9, 3.907691340746007*^9, 3.907692386173781*^9, 
   3.9076964120209084`*^9, 3.907698130051656*^9, {3.907698353742865*^9, 
   3.907698359150434*^9}, 3.907698398922683*^9, 3.9076992457420177`*^9, 
   3.907701082267668*^9, 3.907768848998704*^9, 3.907846684811061*^9, 
   3.9089912900312243`*^9},
 CellLabel->"Out[95]=",ExpressionUUID->"4697311c-7471-4195-99f8-fc01fc5b03f7"]
}, Open  ]],

Cell["Test projected volume flux and local assembly", "Text",
 CellChangeTimes->{{3.907340623951858*^9, 3.907340628882285*^9}, {
  3.9073422530010777`*^9, 3.907342254641266*^9}, {3.907342766136305*^9, 
  3.9073427715559387`*^9}, {3.907679840973015*^9, 3.907679842553351*^9}, {
  3.907679889632491*^9, 3.9076798899654303`*^9}, {3.907684978842527*^9, 
  3.9076849910429983`*^9}, {3.907689488720016*^9, 3.907689530365245*^9}, {
  3.907689977857646*^9, 3.907689978898942*^9}, {3.907691001465877*^9, 
  3.907691028916403*^9}, {3.907695740741178*^9, 3.907695742018455*^9}, {
  3.907698112245817*^9, 3.90769811448551*^9}, {3.907700668927185*^9, 
  3.90770066924117*^9}, {3.907704516626768*^9, 3.907704517713632*^9}, {
  3.907753461036003*^9, 
  3.907753469878878*^9}},ExpressionUUID->"9bc48efb-dd58-4c09-b60f-\
c5bc565f0356"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"SetPrecision", "[", 
  RowBox[{
   RowBox[{"localProjVolumeFluxResidual", "[", 
    RowBox[{"[", "1", "]"}], "]"}], ",", "18"}], "]"}]], "Input",
 CellChangeTimes->{{3.907340581228263*^9, 3.907340598559038*^9}, {
  3.90734063480271*^9, 3.90734064194847*^9}, {3.907341415010034*^9, 
  3.90734142594523*^9}, {3.907342424753496*^9, 3.907342503993833*^9}, {
  3.907612946507737*^9, 3.907612951282711*^9}, {3.9076798950347843`*^9, 
  3.9076798978002234`*^9}, {3.9076849987815027`*^9, 3.907685001667749*^9}, {
  3.9076899818517027`*^9, 3.907689981994342*^9}, {3.907691033885068*^9, 
  3.907691064651104*^9}, {3.9076913374424458`*^9, 3.907691338807871*^9}, {
  3.907695752427248*^9, 3.907695754119646*^9}, {3.907698122534369*^9, 
  3.907698123842721*^9}, {3.907698352583418*^9, 3.907698358043908*^9}, {
  3.907698398175589*^9, 3.907698398408036*^9}, {3.9077006861886053`*^9, 
  3.907700686617344*^9}, {3.907704520634513*^9, 3.907704547382584*^9}},
 CellLabel->"In[96]:=",ExpressionUUID->"7b9179b9-68f8-430f-8c3a-c8e7d8fca182"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "0", ",", "0", ",", "0", ",", "1.874964999999930855515194530209`18.*^-8", 
   ",", "0", ",", "0", ",", "0", ",", "0", ",", 
   "1.874949999999920449117899270454`18.*^-8", ",", "0", ",", "0", ",", "0", 
   ",", "0", ",", "1.874961249999939089981895159933`18.*^-8", ",", "0", ",", 
   "0", ",", "0", ",", "0", ",", "1.874948749999918230856457495529`18.*^-8", 
   ",", "0"}], "}"}]], "Output",
 CellChangeTimes->{
  3.907341426407048*^9, 3.9073424368579063`*^9, 3.9073425062219*^9, 
   3.907612812786384*^9, 3.907612953033202*^9, 3.9076139287147512`*^9, 
   3.9076799083271646`*^9, 3.907685004032866*^9, 3.90768953382668*^9, 
   3.907689983026463*^9, 3.9076910660668507`*^9, 3.907691171098186*^9, 
   3.9076912593437777`*^9, 3.907691340746007*^9, 3.907692386173781*^9, 
   3.9076964120209084`*^9, 3.907698130051656*^9, {3.907698353742865*^9, 
   3.907698359150434*^9}, 3.907698398922683*^9, 3.9076992457420177`*^9, 
   3.907701082267668*^9, {3.907704534613956*^9, 3.907704548295437*^9}, 
   3.907768849010758*^9, 3.9078466871003647`*^9, 3.908991292033774*^9},
 CellLabel->"Out[96]=",ExpressionUUID->"4c0861dd-2b51-42a6-86f6-5b96ed93ba20"]
}, Open  ]],

Cell["Test projected thermal content and local assembly", "Text",
 CellChangeTimes->{{3.907340623951858*^9, 3.907340628882285*^9}, {
  3.9073422530010777`*^9, 3.907342254641266*^9}, {3.907342766136305*^9, 
  3.9073427715559387`*^9}, {3.907679840973015*^9, 3.907679842553351*^9}, {
  3.907679889632491*^9, 3.9076798899654303`*^9}, {3.907684978842527*^9, 
  3.9076849910429983`*^9}, {3.907689488720016*^9, 3.907689530365245*^9}, {
  3.907689977857646*^9, 3.907689978898942*^9}, {3.907691001465877*^9, 
  3.907691028916403*^9}, {3.907695740741178*^9, 3.907695742018455*^9}, {
  3.907698112245817*^9, 3.90769811448551*^9}, {3.907700668927185*^9, 
  3.90770066924117*^9}, {3.907704516626768*^9, 3.907704517713632*^9}, {
  3.907753465007392*^9, 
  3.907753486086171*^9}},ExpressionUUID->"4cc8b2bc-b56f-4ce1-afde-\
5c3f393e2c87"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"SetPrecision", "[", 
  RowBox[{
   RowBox[{"localProjThermalContentResidual", "[", 
    RowBox[{"[", "1", "]"}], "]"}], ",", "18"}], "]"}]], "Input",
 CellChangeTimes->{{3.907340581228263*^9, 3.907340598559038*^9}, {
  3.90734063480271*^9, 3.90734064194847*^9}, {3.907341415010034*^9, 
  3.90734142594523*^9}, {3.907342424753496*^9, 3.907342503993833*^9}, {
  3.907612946507737*^9, 3.907612951282711*^9}, {3.9076798950347843`*^9, 
  3.9076798978002234`*^9}, {3.9076849987815027`*^9, 3.907685001667749*^9}, {
  3.9076899818517027`*^9, 3.907689981994342*^9}, {3.907691033885068*^9, 
  3.907691064651104*^9}, {3.9076913374424458`*^9, 3.907691338807871*^9}, {
  3.907695752427248*^9, 3.907695754119646*^9}, {3.907698122534369*^9, 
  3.907698123842721*^9}, {3.907698352583418*^9, 3.907698358043908*^9}, {
  3.907698398175589*^9, 3.907698398408036*^9}, {3.9077006861886053`*^9, 
  3.907700686617344*^9}, {3.907704520634513*^9, 3.907704547382584*^9}, {
  3.907753493384596*^9, 3.907753495436298*^9}},
 CellLabel->"In[97]:=",ExpressionUUID->"747e55c5-d744-4975-a6cd-8daf63e7b6ed"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "0", ",", "0", ",", "0", ",", "0", ",", 
   "0.00349999999999998315930449521715672745`18.", ",", "0", ",", "0", ",", 
   "0", ",", "0", ",", "0.00500000000000001658395643033827582258`18.", ",", 
   "0", ",", "0", ",", "0", ",", "0", ",", 
   "0.0038750000000000164521174461640384834`18.", ",", "0", ",", "0", ",", 
   "0", ",", "0", ",", "0.00512500000000001669497873280079147662`18."}], 
  "}"}]], "Output",
 CellChangeTimes->{
  3.907341426407048*^9, 3.9073424368579063`*^9, 3.9073425062219*^9, 
   3.907612812786384*^9, 3.907612953033202*^9, 3.9076139287147512`*^9, 
   3.9076799083271646`*^9, 3.907685004032866*^9, 3.90768953382668*^9, 
   3.907689983026463*^9, 3.9076910660668507`*^9, 3.907691171098186*^9, 
   3.9076912593437777`*^9, 3.907691340746007*^9, 3.907692386173781*^9, 
   3.9076964120209084`*^9, 3.907698130051656*^9, {3.907698353742865*^9, 
   3.907698359150434*^9}, 3.907698398922683*^9, 3.9076992457420177`*^9, 
   3.907701082267668*^9, {3.907704534613956*^9, 3.907704548295437*^9}, 
   3.907753496487938*^9, 3.907768849052919*^9, 3.907846689288123*^9, 
   3.90899129438426*^9},
 CellLabel->"Out[97]=",ExpressionUUID->"1e4ba054-881b-4efe-ac5a-95658eb7350c"]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Compute residual:", "Subsection",
 CellChangeTimes->{{3.7171711972127666`*^9, 3.71717120142911*^9}, {
  3.7209943882500362`*^9, 3.7209944015165186`*^9}, {3.721049011972142*^9, 
  3.721049018596589*^9}, {3.7210554397242594`*^9, 
  3.7210554438131027`*^9}},ExpressionUUID->"68880009-9547-4a24-954e-\
176de4ce29a1"],

Cell[BoxData[
 RowBox[{"For", "[", 
  RowBox[{
   RowBox[{"i", "=", "0"}], ",", 
   RowBox[{"i", "<", 
    RowBox[{"Length", "[", "xv", "]"}]}], ",", 
   RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"uv", "[", 
      RowBox[{"[", 
       RowBox[{
        RowBox[{"i", "*", "ndofs"}], "+", "1"}], "]"}], "]"}], "=", 
     RowBox[{"1", "*", 
      SuperscriptBox["10", 
       RowBox[{"-", "7"}]], "i"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"uv", "[", 
      RowBox[{"[", 
       RowBox[{
        RowBox[{"i", "*", "ndofs"}], "+", "2"}], "]"}], "]"}], "=", 
     RowBox[{"2", "*", 
      SuperscriptBox["10", 
       RowBox[{"-", "7"}]], "i"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"uv", "[", 
      RowBox[{"[", 
       RowBox[{
        RowBox[{"i", "*", "ndofs"}], "+", "3"}], "]"}], "]"}], "=", 
     RowBox[{"3", "*", 
      SuperscriptBox["10", 
       RowBox[{"-", "7"}]], "i"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"uv", "[", 
      RowBox[{"[", 
       RowBox[{
        RowBox[{"i", "*", "ndofs"}], "+", "4"}], "]"}], "]"}], "=", "0.0"}], 
    ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"uv", "[", 
      RowBox[{"[", 
       RowBox[{
        RowBox[{"i", "*", "ndofs"}], "+", "5"}], "]"}], "]"}], "=", 
     RowBox[{"4", "*", 
      SuperscriptBox["10", 
       RowBox[{"-", "7"}]], "i"}]}], ";"}]}], "\[IndentingNewLine]", 
  "]"}]], "Input",
 CellChangeTimes->{{3.907770210307638*^9, 3.9077702135012817`*^9}},
 CellLabel->
  "In[229]:=",ExpressionUUID->"629978f8-fc58-4714-a00e-a67182e10b53"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"residual", "=", 
   RowBox[{"Table", "[", 
    RowBox[{"0.0", ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"ndofs", " ", 
        RowBox[{"Length", "[", "xv", "]"}]}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"For", "[", 
  RowBox[{
   RowBox[{"i", "=", "1"}], ",", " ", 
   RowBox[{"i", "\[LessEqual]", " ", 
    RowBox[{"Length", "[", "connect", "]"}]}], ",", 
   RowBox[{"i", "++"}], ",", 
   RowBox[{"Block", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"i1", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"connect", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}], "+", "1"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"i2", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"connect", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "[", 
          RowBox[{"[", "2", "]"}], "]"}], "+", "1"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"i3", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"connect", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "[", 
          RowBox[{"[", "3", "]"}], "]"}], "+", "1"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"i4", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"connect", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "[", 
          RowBox[{"[", "4", "]"}], "]"}], "+", "1"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"mids", "=", 
        RowBox[{"{", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"ndofs", " ", 
            RowBox[{"(", 
             RowBox[{"i1", "-", "1"}], ")"}]}], "+", "1"}], ",", " ", 
          RowBox[{
           RowBox[{"ndofs", 
            RowBox[{"(", " ", 
             RowBox[{"i1", "-", "1"}], ")"}]}], "+", "2"}], ",", " ", 
          RowBox[{
           RowBox[{"ndofs", 
            RowBox[{"(", " ", 
             RowBox[{"i1", "-", "1"}], ")"}]}], "+", "3"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"ndofs", 
            RowBox[{"(", " ", 
             RowBox[{"i2", "-", "1"}], ")"}]}], "+", "1"}], ",", 
          RowBox[{
           RowBox[{"ndofs", 
            RowBox[{"(", 
             RowBox[{"i2", "-", "1"}], ")"}]}], "+", "2"}], ",", " ", 
          RowBox[{
           RowBox[{"ndofs", 
            RowBox[{"(", " ", 
             RowBox[{"i2", "-", "1"}], ")"}]}], "+", "3"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"ndofs", 
            RowBox[{"(", 
             RowBox[{"i3", "-", "1"}], ")"}]}], "+", "1"}], ",", 
          RowBox[{
           RowBox[{"ndofs", " ", 
            RowBox[{"(", 
             RowBox[{"i3", "-", "1"}], ")"}]}], "+", "2"}], ",", " ", 
          RowBox[{
           RowBox[{"ndofs", 
            RowBox[{"(", " ", 
             RowBox[{"i3", "-", "1"}], ")"}]}], "+", "3"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"ndofs", 
            RowBox[{"(", 
             RowBox[{"i4", "-", "1"}], ")"}]}], "+", "1"}], ",", 
          RowBox[{
           RowBox[{"ndofs", 
            RowBox[{"(", 
             RowBox[{"i4", "-", "1"}], ")"}]}], "+", "2"}], ",", " ", 
          RowBox[{
           RowBox[{"ndofs", 
            RowBox[{"(", " ", 
             RowBox[{"i4", "-", "1"}], ")"}]}], "+", "3"}]}], 
         "\[IndentingNewLine]", "}"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"pids", "=", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"ndofs", " ", 
            RowBox[{"(", 
             RowBox[{"i1", "-", "1"}], ")"}]}], "+", "4"}], ",", " ", 
          RowBox[{
           RowBox[{"ndofs", 
            RowBox[{"(", " ", 
             RowBox[{"i2", "-", "1"}], ")"}]}], "+", "4"}], ",", 
          RowBox[{
           RowBox[{"ndofs", 
            RowBox[{"(", 
             RowBox[{"i3", "-", "1"}], ")"}]}], "+", "4"}], ",", 
          RowBox[{
           RowBox[{"ndofs", 
            RowBox[{"(", 
             RowBox[{"i4", "-", "1"}], ")"}]}], "+", "4"}]}], "}"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"tids", "=", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"ndofs", " ", 
            RowBox[{"(", 
             RowBox[{"i1", "-", "1"}], ")"}]}], "+", "5"}], ",", " ", 
          RowBox[{
           RowBox[{"ndofs", 
            RowBox[{"(", " ", 
             RowBox[{"i2", "-", "1"}], ")"}]}], "+", "5"}], ",", 
          RowBox[{
           RowBox[{"ndofs", 
            RowBox[{"(", 
             RowBox[{"i3", "-", "1"}], ")"}]}], "+", "5"}], ",", 
          RowBox[{
           RowBox[{"ndofs", 
            RowBox[{"(", 
             RowBox[{"i4", "-", "1"}], ")"}]}], "+", "5"}]}], "}"}]}]}], 
      "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Bmat", "=", 
       RowBox[{"Gmatrix", "[", 
        RowBox[{
         RowBox[{"xv", "[", 
          RowBox[{"[", "i1", "]"}], "]"}], ",", 
         RowBox[{"yv", "[", 
          RowBox[{"[", "i1", "]"}], "]"}], ",", 
         RowBox[{"zv", "[", 
          RowBox[{"[", "i1", "]"}], "]"}], ",", 
         RowBox[{"xv", "[", 
          RowBox[{"[", "i2", "]"}], "]"}], ",", 
         RowBox[{"yv", "[", 
          RowBox[{"[", "i2", "]"}], "]"}], ",", 
         RowBox[{"zv", "[", 
          RowBox[{"[", "i2", "]"}], "]"}], ",", 
         RowBox[{"xv", "[", 
          RowBox[{"[", "i3", "]"}], "]"}], ",", 
         RowBox[{"yv", "[", 
          RowBox[{"[", "i3", "]"}], "]"}], ",", 
         RowBox[{"zv", "[", 
          RowBox[{"[", "i3", "]"}], "]"}], ",", 
         RowBox[{"xv", "[", 
          RowBox[{"[", "i4", "]"}], "]"}], ",", 
         RowBox[{"yv", "[", 
          RowBox[{"[", "i4", "]"}], "]"}], ",", 
         RowBox[{"zv", "[", 
          RowBox[{"[", "i4", "]"}], "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"bmat", "=", 
       RowBox[{"gmatrix", "[", 
        RowBox[{
         RowBox[{"xv", "[", 
          RowBox[{"[", "i1", "]"}], "]"}], ",", 
         RowBox[{"yv", "[", 
          RowBox[{"[", "i1", "]"}], "]"}], ",", 
         RowBox[{"zv", "[", 
          RowBox[{"[", "i1", "]"}], "]"}], ",", 
         RowBox[{"xv", "[", 
          RowBox[{"[", "i2", "]"}], "]"}], ",", 
         RowBox[{"yv", "[", 
          RowBox[{"[", "i2", "]"}], "]"}], ",", 
         RowBox[{"zv", "[", 
          RowBox[{"[", "i2", "]"}], "]"}], ",", 
         RowBox[{"xv", "[", 
          RowBox[{"[", "i3", "]"}], "]"}], ",", 
         RowBox[{"yv", "[", 
          RowBox[{"[", "i3", "]"}], "]"}], ",", 
         RowBox[{"zv", "[", 
          RowBox[{"[", "i3", "]"}], "]"}], ",", 
         RowBox[{"xv", "[", 
          RowBox[{"[", "i4", "]"}], "]"}], ",", 
         RowBox[{"yv", "[", 
          RowBox[{"[", "i4", "]"}], "]"}], ",", 
         RowBox[{"zv", "[", 
          RowBox[{"[", "i4", "]"}], "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"bDivmat", "=", 
       RowBox[{"gDivmatrix", "[", 
        RowBox[{
         RowBox[{"xv", "[", 
          RowBox[{"[", "i1", "]"}], "]"}], ",", 
         RowBox[{"yv", "[", 
          RowBox[{"[", "i1", "]"}], "]"}], ",", 
         RowBox[{"zv", "[", 
          RowBox[{"[", "i1", "]"}], "]"}], ",", 
         RowBox[{"xv", "[", 
          RowBox[{"[", "i2", "]"}], "]"}], ",", 
         RowBox[{"yv", "[", 
          RowBox[{"[", "i2", "]"}], "]"}], ",", 
         RowBox[{"zv", "[", 
          RowBox[{"[", "i2", "]"}], "]"}], ",", 
         RowBox[{"xv", "[", 
          RowBox[{"[", "i3", "]"}], "]"}], ",", 
         RowBox[{"yv", "[", 
          RowBox[{"[", "i3", "]"}], "]"}], ",", 
         RowBox[{"zv", "[", 
          RowBox[{"[", "i3", "]"}], "]"}], ",", 
         RowBox[{"xv", "[", 
          RowBox[{"[", "i4", "]"}], "]"}], ",", 
         RowBox[{"yv", "[", 
          RowBox[{"[", "i4", "]"}], "]"}], ",", 
         RowBox[{"zv", "[", 
          RowBox[{"[", "i4", "]"}], "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"myDetJ", "=", 
       RowBox[{"Detj", "[", 
        RowBox[{
         RowBox[{"xv", "[", 
          RowBox[{"[", "i1", "]"}], "]"}], ",", 
         RowBox[{"yv", "[", 
          RowBox[{"[", "i1", "]"}], "]"}], ",", 
         RowBox[{"zv", "[", 
          RowBox[{"[", "i1", "]"}], "]"}], ",", 
         RowBox[{"xv", "[", 
          RowBox[{"[", "i2", "]"}], "]"}], ",", 
         RowBox[{"yv", "[", 
          RowBox[{"[", "i2", "]"}], "]"}], ",", 
         RowBox[{"zv", "[", 
          RowBox[{"[", "i2", "]"}], "]"}], ",", 
         RowBox[{"xv", "[", 
          RowBox[{"[", "i3", "]"}], "]"}], ",", 
         RowBox[{"yv", "[", 
          RowBox[{"[", "i3", "]"}], "]"}], ",", 
         RowBox[{"zv", "[", 
          RowBox[{"[", "i3", "]"}], "]"}], ",", 
         RowBox[{"xv", "[", 
          RowBox[{"[", "i4", "]"}], "]"}], ",", 
         RowBox[{"yv", "[", 
          RowBox[{"[", "i4", "]"}], "]"}], ",", 
         RowBox[{"zv", "[", 
          RowBox[{"[", "i4", "]"}], "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"disp", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"uv", "[", 
          RowBox[{"[", 
           RowBox[{"mids", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "]"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{"Length", "[", "mids", "]"}]}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"nodT", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"uv", "[", 
          RowBox[{"[", 
           RowBox[{"tids", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "]"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{"Length", "[", "tids", "]"}]}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"nodP", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"uv", "[", 
          RowBox[{"[", 
           RowBox[{"pids", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "]"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{"Length", "[", "pids", "]"}]}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"j", "=", "1"}], ",", 
        RowBox[{"j", "<=", 
         RowBox[{"Length", "[", "gw", "]"}]}], ",", 
        RowBox[{"j", "++"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"gaussPoint", "=", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"\[Xi]", "->", 
             RowBox[{
              RowBox[{"gp", "[", 
               RowBox[{"[", "j", "]"}], "]"}], "[", 
              RowBox[{"[", "1", "]"}], "]"}]}], ",", 
            RowBox[{"\[Psi]", "->", 
             RowBox[{
              RowBox[{"gp", "[", 
               RowBox[{"[", "j", "]"}], "]"}], "[", 
              RowBox[{"[", "2", "]"}], "]"}]}], ",", 
            RowBox[{"\[Zeta]", "->", 
             RowBox[{
              RowBox[{"gp", "[", 
               RowBox[{"[", "j", "]"}], "]"}], "[", 
              RowBox[{"[", "3", "]"}], "]"}]}]}], "}"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"strain", "=", 
          RowBox[{"Bmat", ".", "disp"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"temperature", " ", "=", " ", 
          RowBox[{"\[Phi]s", ".", "nodT"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"tstrain", "=", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
            "\[Alpha]", ",", "\[Alpha]", ",", "\[Alpha]", ",", "0", ",", "0", 
             ",", "0"}], "}"}], "*", "temperature"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"totalStrain", "=", 
          RowBox[{"strain", "-", "tstrain"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"volStrain", "=", 
          RowBox[{"VoigtIdentity", "*", 
           RowBox[{"VoigtTrace", "[", "totalStrain", "]"}]}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"stress", "=", 
          RowBox[{"S", ".", 
           RowBox[{"(", "totalStrain", ")"}]}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"devStress", "=", 
          RowBox[{"stress", "-", 
           RowBox[{"VoigtIdentity", "*", 
            RowBox[{
             RowBox[{"VoigtTrace", "[", "stress", "]"}], "/", "3.0"}]}]}]}], 
         ";", "\[IndentingNewLine]", 
         RowBox[{"stressDiv", "=", 
          RowBox[{
           RowBox[{"gw", "[", 
            RowBox[{"[", "j", "]"}], "]"}], "myDetJ", "*", 
           RowBox[{
            RowBox[{"Transpose", "[", "Bmat", "]"}], ".", "devStress"}]}]}], 
         ";", "\[IndentingNewLine]", 
         RowBox[{"For", "[", 
          RowBox[{
           RowBox[{"k", "=", "1"}], ",", 
           RowBox[{"k", "\[LessEqual]", "12"}], ",", 
           RowBox[{"k", "++"}], ",", 
           RowBox[{
            RowBox[{"residual", "[", 
             RowBox[{"[", 
              RowBox[{"mids", "[", 
               RowBox[{"[", "k", "]"}], "]"}], "]"}], "]"}], "+=", 
            RowBox[{
             RowBox[{
              RowBox[{"stressDiv", "[", 
               RowBox[{"[", "k", "]"}], "]"}], "/.", "gaussPoint"}], "/.", 
             "matProps"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
         RowBox[{"pressureDiv", "=", 
          RowBox[{
           RowBox[{"gw", "[", 
            RowBox[{"[", "j", "]"}], "]"}], "myDetJ", "*", "bDivmat", 
           RowBox[{"(", 
            RowBox[{"\[Phi]s", ".", "nodP"}], ")"}]}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"For", "[", 
          RowBox[{
           RowBox[{"k", "=", "1"}], ",", 
           RowBox[{"k", "\[LessEqual]", "12"}], ",", 
           RowBox[{"k", "++"}], ",", 
           RowBox[{
            RowBox[{"residual", "[", 
             RowBox[{"[", 
              RowBox[{"mids", "[", 
               RowBox[{"[", "k", "]"}], "]"}], "]"}], "]"}], "+=", 
            RowBox[{
             RowBox[{
              RowBox[{"pressureDiv", "[", 
               RowBox[{"[", "k", "]"}], "]"}], "/.", "gaussPoint"}], "/.", 
             "matProps"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
         RowBox[{"volEqn", "=", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"VoigtTrace", "[", "strain", "]"}], "-", 
            RowBox[{
             FractionBox["1", "Km"], 
             RowBox[{"(", 
              RowBox[{"\[Phi]s", ".", "nodP"}], ")"}]}], "-", 
            RowBox[{"VoigtTrace", "[", "tstrain", "]"}]}], ")"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"volEqnProj", "=", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"gw", "[", 
             RowBox[{"[", "j", "]"}], "]"}], " ", "myDetJ", " ", "\[Phi]s", 
            " ", "volEqn"}], ")"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"\[Tau]", "=", 
          FractionBox[
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              RowBox[{"gw", "[", 
               RowBox[{"[", "j", "]"}], "]"}], "cellDetJ"}], ")"}], 
            RowBox[{"2", "/", "3"}]], 
           RowBox[{"2", " ", "Gm"}]]}], ";", "\[IndentingNewLine]", 
         RowBox[{"cellStab", "=", 
          RowBox[{"\[Tau]", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"bmat", ".", "nodP"}], "-", 
             RowBox[{"(", 
              RowBox[{"\[Phi]s", ".", 
               RowBox[{"\[CapitalPi]v", "[", 
                RowBox[{"[", "i", "]"}], "]"}]}], ")"}]}], ")"}]}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"cellStabDiv", "=", 
          RowBox[{
           RowBox[{"gw", "[", 
            RowBox[{"[", "j", "]"}], "]"}], "cellDetJ", " ", 
           RowBox[{
            RowBox[{"Transpose", "[", "bmat", "]"}], ".", "cellStab"}]}]}], 
         ";", "\[IndentingNewLine]", 
         RowBox[{"For", "[", 
          RowBox[{
           RowBox[{"k", "=", "1"}], ",", 
           RowBox[{"k", "\[LessEqual]", "4"}], ",", 
           RowBox[{"k", "++"}], ",", 
           RowBox[{
            RowBox[{"residual", "[", 
             RowBox[{"[", 
              RowBox[{"pids", "[", 
               RowBox[{"[", "k", "]"}], "]"}], "]"}], "]"}], "+=", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"volEqnProj", "[", 
                 RowBox[{"[", "k", "]"}], "]"}], "-", 
                RowBox[{"cellStabDiv", "[", 
                 RowBox[{"[", "k", "]"}], "]"}]}], ")"}], "/.", 
              "gaussPoint"}], "//.", "matProps"}]}]}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"fluxDiv", "=", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"gw", "[", 
             RowBox[{"[", "j", "]"}], "]"}], "myDetJ", "*", 
            RowBox[{
             RowBox[{"Transpose", "[", "bmat", "]"}], ".", 
             RowBox[{"(", 
              RowBox[{"kcond", " ", 
               RowBox[{"bmat", ".", "nodT"}]}], ")"}]}]}], ")"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"For", "[", 
          RowBox[{
           RowBox[{"k", "=", "1"}], ",", 
           RowBox[{"k", "\[LessEqual]", "4"}], ",", 
           RowBox[{"k", "++"}], ",", 
           RowBox[{
            RowBox[{"residual", "[", 
             RowBox[{"[", 
              RowBox[{"tids", "[", 
               RowBox[{"[", "k", "]"}], "]"}], "]"}], "]"}], "+=", 
            RowBox[{
             RowBox[{
              RowBox[{"fluxDiv", "[", 
               RowBox[{"[", "k", "]"}], "]"}], "/.", "gaussPoint"}], "/.", 
             "matProps"}]}]}], "]"}], ";"}]}], "\[IndentingNewLine]", 
       "]"}]}]}], "\[IndentingNewLine]", "]"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.7167647605597653`*^9, 3.7167647892518883`*^9}, {
   3.7167648244240847`*^9, 3.716764841539942*^9}, {3.71676488019324*^9, 
   3.7167648969754357`*^9}, {3.716765065628334*^9, 3.716765185350045*^9}, {
   3.7167652229401484`*^9, 3.7167652383100395`*^9}, {3.7167653441168547`*^9, 
   3.7167655199547443`*^9}, {3.7167655675522327`*^9, 
   3.7167655810711265`*^9}, {3.716765622284607*^9, 3.7167656290567384`*^9}, {
   3.716765757154343*^9, 3.716765792076064*^9}, {3.7167658276745405`*^9, 
   3.7167660826802125`*^9}, {3.716766195664576*^9, 3.716766242915578*^9}, {
   3.7167663310833845`*^9, 3.7167663393539863`*^9}, {3.7167664503932595`*^9, 
   3.716766450932579*^9}, {3.7167664868258085`*^9, 3.7167665635541043`*^9}, {
   3.716766627651472*^9, 3.716766643645746*^9}, {3.716766826115865*^9, 
   3.7167668360695195`*^9}, {3.716766868385886*^9, 3.7167669130203*^9}, {
   3.717155721663645*^9, 3.7171557331420517`*^9}, {3.717155769178903*^9, 
   3.7171557818205233`*^9}, {3.7171567883516493`*^9, 3.717156887869956*^9}, {
   3.717156918335051*^9, 3.717156937057849*^9}, {3.717157017416103*^9, 
   3.717157052623994*^9}, {3.717157895689323*^9, 3.717157931742132*^9}, {
   3.717166282194605*^9, 3.71716628473459*^9}, {3.71716849797501*^9, 
   3.71716852298344*^9}, {3.717168562021318*^9, 3.717168562125424*^9}, {
   3.717168843821663*^9, 3.717168857297769*^9}, {3.7171692165304537`*^9, 
   3.7171692208302*^9}, {3.717170006857576*^9, 3.717170018830927*^9}, {
   3.717171209233417*^9, 3.717171213025419*^9}, {3.7173548750864697`*^9, 
   3.717354881757492*^9}, {3.717354996753583*^9, 3.717355017245678*^9}, {
   3.717355319697336*^9, 3.7173553216726255`*^9}, {3.7173557531181636`*^9, 
   3.7173557820403166`*^9}, {3.7173558138063755`*^9, 
   3.7173558166812677`*^9}, {3.7173587645155315`*^9, 
   3.7173587704721184`*^9}, {3.7173588122062426`*^9, 
   3.7173588501286516`*^9}, {3.717359014190798*^9, 3.7173590339564075`*^9}, {
   3.7173591194571896`*^9, 3.7173591202540846`*^9}, {3.717360749384885*^9, 
   3.717360755072524*^9}, {3.7173608405541487`*^9, 3.7173608453215923`*^9}, {
   3.7174176653039513`*^9, 3.7174177502357674`*^9}, {3.717418005127076*^9, 
   3.717418022383568*^9}, {3.7174180927900662`*^9, 3.717418180868244*^9}, {
   3.717419219270834*^9, 3.7174192266613092`*^9}, {3.71741926925568*^9, 
   3.717419272755123*^9}, {3.7174241468474283`*^9, 3.7174241510843997`*^9}, {
   3.71742429898483*^9, 3.717424381678406*^9}, {3.717427960779907*^9, 
   3.7174279724352093`*^9}, {3.7174281618258095`*^9, 
   3.7174281652786007`*^9}, {3.7208066594239817`*^9, 
   3.7208066657144737`*^9}, {3.723057650960129*^9, 3.7230576545889745`*^9}, {
   3.763398626297826*^9, 3.7633986377693434`*^9}, {3.763398969492062*^9, 
   3.763399017148432*^9}, {3.7633990692779627`*^9, 3.7633990694291053`*^9}, {
   3.7633991201481476`*^9, 3.763399174570841*^9}, {3.763399415268031*^9, 
   3.76339941606513*^9}, {3.7633996474373903`*^9, 3.7633996648412056`*^9}, {
   3.7633997501291094`*^9, 3.7633999258824277`*^9}, {3.7633999725549555`*^9, 
   3.763399976702032*^9}, {3.7634000083920765`*^9, 3.76340016737781*^9}, {
   3.7634002158964863`*^9, 3.76340029196223*^9}, {3.763400323496956*^9, 
   3.7634004027149053`*^9}, {3.76340045059245*^9, 3.763400463281616*^9}, {
   3.7634005294006834`*^9, 3.763400570424802*^9}, {3.764082973996101*^9, 
   3.764082975901887*^9}, {3.764085676134435*^9, 3.7640856834202404`*^9}, {
   3.7640858472503123`*^9, 3.7640858920767965`*^9}, {3.7640894255234814`*^9, 
   3.7640894257482643`*^9}, {3.7640894615887256`*^9, 
   3.7640894620724916`*^9}, {3.7640895179586363`*^9, 
   3.7640895273283195`*^9}, {3.7640896836413865`*^9, 
   3.7640896854169707`*^9}, {3.764098322843951*^9, 3.764098324217982*^9}, {
   3.7640983820840216`*^9, 3.764098382599674*^9}, {3.764099103461434*^9, 
   3.764099173185652*^9}, {3.764101764387092*^9, 3.7641017868352966`*^9}, 
   3.764761842376623*^9, {3.76476223129729*^9, 3.764762241509314*^9}, {
   3.7647622805381107`*^9, 3.764762305230457*^9}, {3.76476236061409*^9, 
   3.7647623840555506`*^9}, {3.7647624148034487`*^9, 
   3.7647624367677865`*^9}, {3.7647629353927927`*^9, 
   3.7647629384726405`*^9}, {3.7647894121072764`*^9, 
   3.7647894567809696`*^9}, {3.7647895619002247`*^9, 
   3.7647896425467887`*^9}, {3.7647896949078503`*^9, 
   3.7647896994970655`*^9}, {3.7647899115869627`*^9, 
   3.7647899366981144`*^9}, {3.7647907620386324`*^9, 3.764790762555979*^9}, {
   3.764790859444355*^9, 3.7647909121812305`*^9}, {3.7647910437526674`*^9, 
   3.764791065929558*^9}, {3.7647911306307406`*^9, 3.764791227713051*^9}, {
   3.7647914009447327`*^9, 3.7647914078831196`*^9}, {3.76479146494147*^9, 
   3.764791471596281*^9}, {3.764791528743067*^9, 3.7647915852144847`*^9}, {
   3.7647919581623106`*^9, 3.764791958342961*^9}, {3.7647921939537992`*^9, 
   3.7647922001003637`*^9}, {3.764792557254195*^9, 3.764792592381807*^9}, {
   3.764793280270445*^9, 3.7647932827589827`*^9}, {3.76479471152559*^9, 
   3.764794903918975*^9}, {3.764795098669626*^9, 3.764795104549365*^9}, {
   3.764795265272959*^9, 3.76479539685962*^9}, {3.7692654915417233`*^9, 
   3.7692655147563086`*^9}, {3.769266609091014*^9, 3.769266610081217*^9}, {
   3.7692666402812986`*^9, 3.769266686321863*^9}, {3.7692668165842485`*^9, 
   3.7692668826166487`*^9}, {3.769266920831176*^9, 3.769266954634816*^9}, {
   3.7692669917496595`*^9, 3.7692670743215904`*^9}, {3.7692671616824856`*^9, 
   3.769267205957114*^9}, {3.769267242711638*^9, 3.769267252372937*^9}, {
   3.7692672877953825`*^9, 3.7692674254805794`*^9}, {3.769267456594332*^9, 
   3.769267484354904*^9}, {3.769267580518936*^9, 3.769267612008975*^9}, {
   3.769267646137645*^9, 3.769267717283578*^9}, {3.76926778909048*^9, 
   3.769267827975362*^9}, {3.7692679854648533`*^9, 3.7692680032396917`*^9}, {
   3.7692680349329367`*^9, 3.769268047511677*^9}, {3.769268103324236*^9, 
   3.7692681039760466`*^9}, {3.769268178879094*^9, 3.7692681941222687`*^9}, {
   3.769281293440941*^9, 3.7692812994283714`*^9}, {3.7692813312201686`*^9, 
   3.769281397118626*^9}, {3.769285168302395*^9, 3.769285214048355*^9}, {
   3.7692852862807446`*^9, 3.7692853571531754`*^9}, {3.769287140156516*^9, 
   3.7692871518345957`*^9}, {3.769287223762863*^9, 3.769287238974713*^9}, {
   3.7692872917920303`*^9, 3.7692872973304834`*^9}, {3.7692873296771994`*^9, 
   3.7692874110603237`*^9}, {3.769287669813406*^9, 3.76928771105731*^9}, {
   3.7693443377314477`*^9, 3.769344341790784*^9}, {3.7693443858089895`*^9, 
   3.7693443917835684`*^9}, {3.769344443904977*^9, 3.7693444690976424`*^9}, {
   3.769344502488573*^9, 3.7693445272632284`*^9}, {3.7693495667999096`*^9, 
   3.769349636973344*^9}, {3.769349752464275*^9, 3.769349846565425*^9}, {
   3.769349901996236*^9, 3.769349903127725*^9}, {3.769349973557214*^9, 
   3.7693499763096356`*^9}, {3.7693500125091305`*^9, 3.769350071087141*^9}, {
   3.7693502370954227`*^9, 3.7693502627595353`*^9}, {3.769350305995264*^9, 
   3.769350348530837*^9}, {3.7693503804930134`*^9, 3.769350437385868*^9}, {
   3.7693507258373995`*^9, 3.7693507449038563`*^9}, {3.769351559433146*^9, 
   3.769351569081027*^9}, {3.76935181507541*^9, 3.769351930293931*^9}, {
   3.7693519660903907`*^9, 3.769351979322859*^9}, {3.7693521811970243`*^9, 
   3.7693522008717422`*^9}, {3.769352235657698*^9, 3.769352256824642*^9}, {
   3.7693524750897884`*^9, 3.769352579129157*^9}, {3.769352618342435*^9, 
   3.7693526622116327`*^9}, {3.769353838986984*^9, 3.769353876798025*^9}, {
   3.769354308434397*^9, 3.76935430885035*^9}, {3.7693544164026976`*^9, 
   3.7693544181261587`*^9}, {3.769354510630841*^9, 3.7693545186995792`*^9}, {
   3.7693552502011104`*^9, 3.76935527388229*^9}, {3.769355767621235*^9, 
   3.7693558090980062`*^9}, {3.769356005550325*^9, 3.769356013178934*^9}, 
   3.7693560447755127`*^9, {3.769358265542241*^9, 3.7693582668328047`*^9}, {
   3.76935832938021*^9, 3.769358349346999*^9}, {3.7693583837842226`*^9, 
   3.7693584455920134`*^9}, {3.7693593194128866`*^9, 
   3.7693593264784746`*^9}, {3.769359388348181*^9, 3.76935941308883*^9}, {
   3.7693594782789116`*^9, 3.7693595026425114`*^9}, {3.769359549675559*^9, 
   3.769359586672391*^9}, {3.769361010649766*^9, 3.769361041064583*^9}, {
   3.769361652761567*^9, 3.7693616544337807`*^9}, {3.7693622011182313`*^9, 
   3.7693622195184374`*^9}, {3.769362285122402*^9, 3.7693626665472937`*^9}, {
   3.771024399743312*^9, 3.771024404541753*^9}, {3.771068642303768*^9, 
   3.771068661453328*^9}, {3.771084379254236*^9, 3.7710844054303703`*^9}, {
   3.771084472706478*^9, 3.7710844961448507`*^9}, {3.771084546770791*^9, 
   3.7710845488527765`*^9}, {3.7710846778520436`*^9, 
   3.7710846965740676`*^9}, {3.771084799702691*^9, 3.771084828064621*^9}, {
   3.7710849891535177`*^9, 3.7710850178281684`*^9}, {3.7710850582901983`*^9, 
   3.771085064424115*^9}, {3.7710851732413*^9, 3.7710851790461636`*^9}, {
   3.7710856808974533`*^9, 3.7710856903449755`*^9}, {3.7710857365051193`*^9, 
   3.7710857576560397`*^9}, {3.7710914864517207`*^9, 
   3.7710915201442847`*^9}, {3.771091748094353*^9, 3.771091749018742*^9}, {
   3.771091911683975*^9, 3.771091912938439*^9}, {3.7710919449856296`*^9, 
   3.771091997029994*^9}, {3.7710920857713685`*^9, 3.771092110304753*^9}, {
   3.7710923441859913`*^9, 3.7710923648789115`*^9}, {3.7710923978945336`*^9, 
   3.7710924828075237`*^9}, {3.7710933602207327`*^9, 
   3.7710934015606456`*^9}, {3.7710941885823803`*^9, 3.77109433085196*^9}, {
   3.771094362045571*^9, 3.7710944332638493`*^9}, {3.7710984909215064`*^9, 
   3.771098519401979*^9}, {3.7711061172993174`*^9, 3.7711062285687943`*^9}, {
   3.771109806764549*^9, 3.7711098368369913`*^9}, {3.7711099933877907`*^9, 
   3.7711100087661114`*^9}, {3.7711727255355377`*^9, 3.771172725935755*^9}, {
   3.7754880704279623`*^9, 3.775488101574194*^9}, {3.907754316281052*^9, 
   3.907754332285613*^9}, {3.9077544669913473`*^9, 3.907754490720999*^9}, {
   3.907754532302129*^9, 3.90775465122925*^9}, {3.907754745338251*^9, 
   3.9077547499924994`*^9}, {3.907754794971459*^9, 3.907754841413775*^9}, {
   3.907754955462328*^9, 3.9077550801952047`*^9}, {3.907839268177784*^9, 
   3.9078392882003117`*^9}, {3.907844734429034*^9, 3.9078447413754473`*^9}, {
   3.907846711247982*^9, 3.907846841867137*^9}, 3.907846908833446*^9},
 CellLabel->
  "In[880]:=",ExpressionUUID->"2588765e-80a2-4369-80f2-2092842678c1"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"SetPrecision", "[", 
  RowBox[{"residual", ",", "18"}], "]"}]], "Input",
 CellChangeTimes->{{3.775488619530793*^9, 3.7754886272879553`*^9}},
 CellLabel->
  "In[882]:=",ExpressionUUID->"3873e1df-8570-4c17-8be9-62b580b8b741"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"-", "30575.9395155761740170419216156005859375`18."}], ",", 
   RowBox[{"-", "17789.63753638527487055398523807525634765625`18."}], ",", 
   RowBox[{"-", "18345.56370935814265976659953594207763671875`18."}], ",", 
   "1.1249804999977087955020894557978`18.*^-7", ",", 
   RowBox[{"-", "0.00086666666666666662688367495093189063`18."}], ",", 
   RowBox[{"-", "22515.01000718139766831882297992706298828125`18."}], ",", 
   RowBox[{"-", "17511.67445001857777242548763751983642578125`18."}], ",", 
   RowBox[{"-", "32521.68112078881313209421932697296142578125`18."}], ",", 
   "1.4999712499881232071997038107075`18.*^-7", ",", 
   RowBox[{"-", "0.00119999999999999946119488836160371648`18."}], ",", 
   "8060.92950841560559638310223817825317382813`18.", ",", 
   "277.96308638760547182755544781684875488281`18.", ",", 
   RowBox[{"-", "14176.1174113473607576452195644378662109375`18."}], ",", 
   "3.749932500073084866654016407937`18.*^-8", ",", 
   RowBox[{"-", "0.00033333333333333337641229965342404284`18."}], ",", 
   RowBox[{"-", "28352.23482383007285534404218196868896484375`18."}], ",", 
   RowBox[{"-", "26684.4563043277230462990701198577880859375`18."}], ",", 
   RowBox[{"-", "18345.56370958756087929941713809967041015625`18."}], ",", 
   "1.4999624999712180409247076501994`18.*^-7", ",", 
   RowBox[{"-", "0.00100000000000000002081668171172168513`18."}], ",", 
   RowBox[{"-", "10006.67111513849340553861111402511596679687`18."}], ",", 
   RowBox[{"-", "35023.3488994535946403630077838897705078125`18."}], ",", 
   RowBox[{"-", "46697.7985324175460846163332462310791015625`18."}], ",", 
   "2.2499424999723127743917155778319`18.*^-7", ",", 
   RowBox[{"-", "0.00180000000000000016757428777935956532`18."}], ",", 
   "18345.563708691493957303464412689208984375`18.", ",", 
   RowBox[{"-", "8338.89259512587523204274475574493408203125`18."}], ",", 
   RowBox[{"-", "28352.23482270468593924306333065032958984375`18."}], ",", 
   "7.499825000213665508353187488452`18.*^-8", ",", 
   RowBox[{"-", "0.00080000000000000014675760606763788019`18."}], ",", 
   "2223.70469180874169978778809309005737304687`18.", ",", 
   RowBox[{"-", "8894.81876769259906723164021968841552734375`18."}], ",", 
   RowBox[{"-", "1.6684508959225008352653715337083`18.*^-7"}], ",", 
   "3.749895000005462147311312368775`18.*^-8", ",", 
   RowBox[{"-", "0.00013333333333333331261784382437696195`18."}], ",", 
   "12508.33889204288061591796576976776123046875`18.", ",", 
   RowBox[{"-", "17511.6744490601704455912113189697265625`18."}], ",", 
   RowBox[{"-", "14176.11741162811267713550478219985961914062`18."}], ",", 
   "7.499787500112262718027287926315`18.*^-8", ",", 
   RowBox[{"-", "0.00060000000000000005585809592645318844`18."}], ",", 
   "10284.63420021362435363698750734329223632812`18.", ",", 
   RowBox[{"-", "8616.85568138848248054273426532745361328125`18."}], ",", 
   RowBox[{"-", "14176.11741142052960640285164117813110351563`18."}], ",", 
   "3.749892500140578656465700953249`18.*^-8", ",", 
   RowBox[{"-", "0.00046666666666666677034530641421383734`18."}], ",", 
   RowBox[{"-", "40860.573716185681405477225780487060546875`18."}], ",", 
   RowBox[{"-", "9172.78185537202625710051506757736206054687`18."}], ",", 
   RowBox[{"-", "4169.44629829217319638701155781745910644531`18."}], ",", 
   "1.4999362499379577735602621629124`18.*^-7", ",", 
   RowBox[{"-", "0.00040000000000000001916869440954371839`18."}], ",", 
   RowBox[{"-", "35023.3488998293760232627391815185546875`18."}], ",", 
   RowBox[{"-", "1.43742181535344570875167846679688`18.*^-6"}], ",", 
   RowBox[{"-", "18345.56370920152767212130129337310791015625`18."}], ",", 
   "2.2499049999379073785178749858571`18.*^-7", ",", 
   RowBox[{"-", "0.00060000000000000038111874767210451864`18."}], ",", 
   "5837.22481635663370980182662606239318847656`18.", ",", 
   "9172.7818539343788870610296726226806640625`18.", ",", 
   RowBox[{"-", "14176.1174107851475127972662448883056640625`18."}], ",", 
   "7.499712500202215546748216526418`18.*^-8", ",", 
   RowBox[{"-", "0.00019999999999999971142874977125813984`18."}], ",", 
   RowBox[{"-", "46697.798532917906413786113262176513671875`18."}], ",", 
   RowBox[{"-", "18345.56370932684149011038243770599365234375`18."}], ",", 
   "10006.671112513387924991548061370849609375`18.", ",", 
   "2.2498924999012916520463973516636`18.*^-7", ",", 
   RowBox[{"-", "0.00019999999999999971142874977125813984`18."}], ",", 
   RowBox[{"-", "1.1257580531122092817978034770543`18.*^-6"}], ",", 
   RowBox[{"-", "3.7537620301009155809879302978516`18.*^-7"}], ",", 
   RowBox[{"-", "1.2536338545032776892185211181641`18.*^-7"}], ",", 
   "4.4998049999253602230801156285078`18.*^-7", ",", 
   "2.2768245622195593114156508818268775939941`18.*^-18", ",", 
   "46697.7985317923012189567089080810546875`18.", ",", 
   "18345.56370895160944201052188873291015625`18.", ",", 
   RowBox[{"-", "10006.6711123881468665786087512969970703125`18."}], ",", 
   "2.2499125000646041268179608704769`18.*^-7", ",", 
   "0.00019999999999999838328108847651520819`18.", ",", 
   RowBox[{"-", "5837.22481673194397444603964686393737792969`18."}], ",", 
   RowBox[{"-", "9172.78185357997608662117272615432739257813`18."}], ",", 
   "14176.11741080575848172884434461593627929688`18.", ",", 
   "7.499637499903699213523621718361`18.*^-8", ",", 
   "0.00020000000000000019931972738973513515`18.", ",", 
   "35023.3488987033706507645547389984130859375`18.", ",", 
   "1.81281095288553922772133673857464`18.*^-6", ",", 
   "18345.56370907667223946191370487213134765625`18.", ",", 
   "2.2499000000415001640419654285047`18.*^-7", ",", 
   "0.00059999999999999875481548894384786763`18.", ",", 
   "40860.5737154353773803450167179107666015625`18.", ",", 
   "9172.7818553928591427393257617950439453125`18.", ",", 
   "4169.44629839643494051415473222732543945313`18.", ",", 
   "1.4999337500713939811055350290886`18.*^-7", ",", 
   "0.00039999999999999963969793403961716649`18.", ",", 
   RowBox[{"-", "10284.63419985922155319713056087493896484375`18."}], ",", 
   "8616.85568120066818664781749248504638671875`18.", ",", 
   "14176.117411253784666769206523895263671875`18.", ",", 
   "3.749782499808223449659991136432`18.*^-8", ",", 
   "0.00046666666666666666192508916566339394`18.", ",", 
   RowBox[{"-", "12508.33889152158008073456585407257080078125`18."}], ",", 
   "17511.67444858100861893035471439361572265625`18.", ",", 
   "14176.1174115865796920843422412872314453125`18.", ",", 
   "7.499562499768453774838213640036`18.*^-8", ",", 
   "0.00060000000000000005585809592645318844`18.", ",", 
   RowBox[{"-", "2223.70469168350882682716473937034606933594`18."}], ",", 
   "8894.81876735895457386504858732223510742187`18.", ",", 
   "3.7510178625720550905193410168303`18.*^-7", ",", 
   "3.749779999994012381394888153846`18.*^-8", ",", 
   "0.00013333333333333320419762657582651855`18.", ",", 
   RowBox[{"-", "18345.56370796186456573195755481719970703125`18."}], ",", 
   "8338.89259500079242570791393518447875976563`18.", ",", 
   "28352.23482210075235343538224697113037109375`18.", ",", 
   "7.499524999571344202406458648649`18.*^-8", ",", 
   "0.00079999999999999938781608532778477638`18.", ",", 
   "10006.67111626426958537194877862930297851562`18.", ",", 
   "35023.3488990784608176909387111663818359375`18.", ",", 
   "46697.7985322924214415252208709716796875`18.", ",", 
   "2.2498625000070950328659208534987`18.*^-7", ",", 
   "0.00180000000000000038441472227646045212`18.", ",", 
   "28352.234824225990450941026210784912109375`18.", ",", 
   "26684.45630407780481618829071521759033203125`18.", ",", 
   "18345.5637103166445740498602390289306640625`18.", ",", 
   "1.4999075000702246157390027780226`18.*^-7", ",", 
   "0.00099999999999999871977407472911636432`18.", ",", 
   RowBox[{"-", "8060.92950816552729520481079816818237304687`18."}], ",", 
   RowBox[{"-", "277.96308607472604990107356570661067962646`18."}], ",", 
   "14176.11741078454906528349965810775756835937`18.", ",", 
   "3.749742499763117444024017300107`18.*^-8", ",", 
   "0.00033333333333333315957186515632315604`18.", ",", 
   "22515.0100077860915916971862316131591796875`18.", ",", 
   "17511.674450872917077504098415374755859375`18.", ",", 
   "32521.681120705514331348240375518798828125`18.", ",", 
   "1.4998987500572610643444953007486`18.*^-7", ",", 
   "0.00120000000000000076223749534420903728`18.", ",", 
   "30575.9395159720661467872560024261474609375`18.", ",", 
   "17789.63753696884305099956691265106201171875`18.", ",", 
   "18345.5637100042731617577373981475830078125`18.", ",", 
   "1.1249220000978347865619097738915`18.*^-7", ",", 
   "0.00086666666666666597636237145962923023`18."}], "}"}]], "Output",
 CellChangeTimes->{
  3.7754886283633966`*^9, 3.8495061976712313`*^9, 3.8503176865067*^9, 
   3.907755088200583*^9, 3.9077688492775373`*^9, 3.907770222621903*^9, 
   3.907778679438013*^9, 3.907778876915472*^9, 3.9078392932022953`*^9, {
   3.907846847911633*^9, 3.9078468775023613`*^9}, 3.907846916097479*^9},
 CellLabel->
  "Out[882]=",ExpressionUUID->"0c347aa3-3de1-4c4a-aa8e-03729700ca33"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Compute residual wrt state:", "Subsection",
 CellChangeTimes->{{3.7171711972127666`*^9, 3.71717120142911*^9}, {
  3.7209943882500362`*^9, 3.7209944015165186`*^9}, {3.721049011972142*^9, 
  3.721049018596589*^9}, {3.7210554397242594`*^9, 3.7210554438131027`*^9}, {
  3.7712421537572083`*^9, 
  3.7712421579496007`*^9}},ExpressionUUID->"4f8172c0-762e-4933-8189-\
9f0549b7f73f"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ndofsTotal", "=", 
   RowBox[{"ndofs", " ", 
    RowBox[{"Length", "[", "xv", "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"globalResidual", "=", 
   RowBox[{"Table", "[", 
    RowBox[{"0.0", ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"ndofs", " ", 
        RowBox[{"Length", "[", "xv", "]"}]}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Kglobal", "=", 
   RowBox[{"Table", "[", 
    RowBox[{"0.0", ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", "ndofsTotal"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "1", ",", "ndofsTotal"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"For", "[", 
  RowBox[{
   RowBox[{"i", "=", "1"}], ",", " ", 
   RowBox[{"i", "\[LessEqual]", " ", 
    RowBox[{"Length", "[", "connect", "]"}]}], ",", 
   RowBox[{"i", "++"}], ",", 
   RowBox[{"Block", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"i1", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"connect", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}], "+", "1"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"i2", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"connect", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "[", 
          RowBox[{"[", "2", "]"}], "]"}], "+", "1"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"i3", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"connect", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "[", 
          RowBox[{"[", "3", "]"}], "]"}], "+", "1"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"i4", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"connect", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "[", 
          RowBox[{"[", "4", "]"}], "]"}], "+", "1"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"gids", "=", 
        RowBox[{"{", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"ndofs", " ", 
            RowBox[{"(", 
             RowBox[{"i1", "-", "1"}], ")"}]}], "+", "1"}], ",", " ", 
          RowBox[{
           RowBox[{"ndofs", 
            RowBox[{"(", " ", 
             RowBox[{"i1", "-", "1"}], ")"}]}], "+", "2"}], ",", " ", 
          RowBox[{
           RowBox[{"ndofs", 
            RowBox[{"(", " ", 
             RowBox[{"i1", "-", "1"}], ")"}]}], "+", "3"}], ",", 
          RowBox[{
           RowBox[{"ndofs", 
            RowBox[{"(", " ", 
             RowBox[{"i1", "-", "1"}], ")"}]}], "+", "4"}], ",", " ", 
          RowBox[{
           RowBox[{"ndofs", 
            RowBox[{"(", " ", 
             RowBox[{"i1", "-", "1"}], ")"}]}], "+", "5"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"ndofs", 
            RowBox[{"(", " ", 
             RowBox[{"i2", "-", "1"}], ")"}]}], "+", "1"}], ",", 
          RowBox[{
           RowBox[{"ndofs", 
            RowBox[{"(", 
             RowBox[{"i2", "-", "1"}], ")"}]}], "+", "2"}], ",", " ", 
          RowBox[{
           RowBox[{"ndofs", 
            RowBox[{"(", " ", 
             RowBox[{"i2", "-", "1"}], ")"}]}], "+", "3"}], ",", 
          RowBox[{
           RowBox[{"ndofs", 
            RowBox[{"(", " ", 
             RowBox[{"i2", "-", "1"}], ")"}]}], "+", "4"}], ",", " ", 
          RowBox[{
           RowBox[{"ndofs", 
            RowBox[{"(", " ", 
             RowBox[{"i2", "-", "1"}], ")"}]}], "+", "5"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"ndofs", 
            RowBox[{"(", 
             RowBox[{"i3", "-", "1"}], ")"}]}], "+", "1"}], ",", 
          RowBox[{
           RowBox[{"ndofs", " ", 
            RowBox[{"(", 
             RowBox[{"i3", "-", "1"}], ")"}]}], "+", "2"}], ",", " ", 
          RowBox[{
           RowBox[{"ndofs", 
            RowBox[{"(", " ", 
             RowBox[{"i3", "-", "1"}], ")"}]}], "+", "3"}], ",", 
          RowBox[{
           RowBox[{"ndofs", 
            RowBox[{"(", " ", 
             RowBox[{"i3", "-", "1"}], ")"}]}], "+", "4"}], ",", " ", 
          RowBox[{
           RowBox[{"ndofs", 
            RowBox[{"(", " ", 
             RowBox[{"i3", "-", "1"}], ")"}]}], "+", "5"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"ndofs", 
            RowBox[{"(", 
             RowBox[{"i4", "-", "1"}], ")"}]}], "+", "1"}], ",", 
          RowBox[{
           RowBox[{"ndofs", 
            RowBox[{"(", 
             RowBox[{"i4", "-", "1"}], ")"}]}], "+", "2"}], ",", " ", 
          RowBox[{
           RowBox[{"ndofs", 
            RowBox[{"(", " ", 
             RowBox[{"i4", "-", "1"}], ")"}]}], "+", "3"}], ",", 
          RowBox[{
           RowBox[{"ndofs", 
            RowBox[{"(", " ", 
             RowBox[{"i4", "-", "1"}], ")"}]}], "+", "4"}], ",", " ", 
          RowBox[{
           RowBox[{"ndofs", 
            RowBox[{"(", " ", 
             RowBox[{"i4", "-", "1"}], ")"}]}], "+", "5"}]}], 
         "\[IndentingNewLine]", "}"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"mids", "=", 
        RowBox[{"{", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"ndofs", " ", 
            RowBox[{"(", 
             RowBox[{"i1", "-", "1"}], ")"}]}], "+", "1"}], ",", " ", 
          RowBox[{
           RowBox[{"ndofs", 
            RowBox[{"(", " ", 
             RowBox[{"i1", "-", "1"}], ")"}]}], "+", "2"}], ",", " ", 
          RowBox[{
           RowBox[{"ndofs", 
            RowBox[{"(", " ", 
             RowBox[{"i1", "-", "1"}], ")"}]}], "+", "3"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"ndofs", 
            RowBox[{"(", " ", 
             RowBox[{"i2", "-", "1"}], ")"}]}], "+", "1"}], ",", 
          RowBox[{
           RowBox[{"ndofs", 
            RowBox[{"(", 
             RowBox[{"i2", "-", "1"}], ")"}]}], "+", "2"}], ",", " ", 
          RowBox[{
           RowBox[{"ndofs", 
            RowBox[{"(", " ", 
             RowBox[{"i2", "-", "1"}], ")"}]}], "+", "3"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"ndofs", 
            RowBox[{"(", 
             RowBox[{"i3", "-", "1"}], ")"}]}], "+", "1"}], ",", 
          RowBox[{
           RowBox[{"ndofs", " ", 
            RowBox[{"(", 
             RowBox[{"i3", "-", "1"}], ")"}]}], "+", "2"}], ",", " ", 
          RowBox[{
           RowBox[{"ndofs", 
            RowBox[{"(", " ", 
             RowBox[{"i3", "-", "1"}], ")"}]}], "+", "3"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"ndofs", 
            RowBox[{"(", 
             RowBox[{"i4", "-", "1"}], ")"}]}], "+", "1"}], ",", 
          RowBox[{
           RowBox[{"ndofs", 
            RowBox[{"(", 
             RowBox[{"i4", "-", "1"}], ")"}]}], "+", "2"}], ",", " ", 
          RowBox[{
           RowBox[{"ndofs", 
            RowBox[{"(", " ", 
             RowBox[{"i4", "-", "1"}], ")"}]}], "+", "3"}]}], 
         "\[IndentingNewLine]", "}"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"pids", "=", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"ndofs", " ", 
            RowBox[{"(", 
             RowBox[{"i1", "-", "1"}], ")"}]}], "+", "4"}], ",", " ", 
          RowBox[{
           RowBox[{"ndofs", 
            RowBox[{"(", " ", 
             RowBox[{"i2", "-", "1"}], ")"}]}], "+", "4"}], ",", 
          RowBox[{
           RowBox[{"ndofs", 
            RowBox[{"(", 
             RowBox[{"i3", "-", "1"}], ")"}]}], "+", "4"}], ",", 
          RowBox[{
           RowBox[{"ndofs", 
            RowBox[{"(", 
             RowBox[{"i4", "-", "1"}], ")"}]}], "+", "4"}]}], "}"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"tids", "=", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"ndofs", " ", 
            RowBox[{"(", 
             RowBox[{"i1", "-", "1"}], ")"}]}], "+", "5"}], ",", " ", 
          RowBox[{
           RowBox[{"ndofs", 
            RowBox[{"(", " ", 
             RowBox[{"i2", "-", "1"}], ")"}]}], "+", "5"}], ",", 
          RowBox[{
           RowBox[{"ndofs", 
            RowBox[{"(", 
             RowBox[{"i3", "-", "1"}], ")"}]}], "+", "5"}], ",", 
          RowBox[{
           RowBox[{"ndofs", 
            RowBox[{"(", 
             RowBox[{"i4", "-", "1"}], ")"}]}], "+", "5"}]}], "}"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"lmids", "=", 
        RowBox[{"{", 
         RowBox[{
         "1", ",", "2", ",", "3", ",", "6", ",", "7", ",", "8", ",", "11", 
          ",", "12", ",", "13", ",", "16", ",", "17", ",", "18"}], "}"}]}], 
       ",", "\[IndentingNewLine]", 
       RowBox[{"lpids", "=", 
        RowBox[{"{", 
         RowBox[{"4", ",", "9", ",", "14", ",", "19"}], "}"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"ltids", "=", 
        RowBox[{"{", 
         RowBox[{"5", ",", "10", ",", "15", ",", "20"}], "}"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"dofs", "=", 
        RowBox[{"{", 
         RowBox[{
         "ux1", ",", "uy1", ",", "uz1", ",", "p1", ",", "T1", ",", "ux2", ",",
           "uy2", ",", "uz2", ",", "p2", ",", "T2", ",", "ux3", ",", "uy3", 
          ",", "uz3", ",", "p3", ",", "T3", ",", "ux4", ",", "uy4", ",", 
          "uz4", ",", "p4", ",", "T4"}], "}"}]}]}], "\[IndentingNewLine]", 
      "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Bmat", "=", 
       RowBox[{"Gmatrix", "[", 
        RowBox[{
         RowBox[{"xv", "[", 
          RowBox[{"[", "i1", "]"}], "]"}], ",", 
         RowBox[{"yv", "[", 
          RowBox[{"[", "i1", "]"}], "]"}], ",", 
         RowBox[{"zv", "[", 
          RowBox[{"[", "i1", "]"}], "]"}], ",", 
         RowBox[{"xv", "[", 
          RowBox[{"[", "i2", "]"}], "]"}], ",", 
         RowBox[{"yv", "[", 
          RowBox[{"[", "i2", "]"}], "]"}], ",", 
         RowBox[{"zv", "[", 
          RowBox[{"[", "i2", "]"}], "]"}], ",", 
         RowBox[{"xv", "[", 
          RowBox[{"[", "i3", "]"}], "]"}], ",", 
         RowBox[{"yv", "[", 
          RowBox[{"[", "i3", "]"}], "]"}], ",", 
         RowBox[{"zv", "[", 
          RowBox[{"[", "i3", "]"}], "]"}], ",", 
         RowBox[{"xv", "[", 
          RowBox[{"[", "i4", "]"}], "]"}], ",", 
         RowBox[{"yv", "[", 
          RowBox[{"[", "i4", "]"}], "]"}], ",", 
         RowBox[{"zv", "[", 
          RowBox[{"[", "i4", "]"}], "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"bmat", "=", 
       RowBox[{"gmatrix", "[", 
        RowBox[{
         RowBox[{"xv", "[", 
          RowBox[{"[", "i1", "]"}], "]"}], ",", 
         RowBox[{"yv", "[", 
          RowBox[{"[", "i1", "]"}], "]"}], ",", 
         RowBox[{"zv", "[", 
          RowBox[{"[", "i1", "]"}], "]"}], ",", 
         RowBox[{"xv", "[", 
          RowBox[{"[", "i2", "]"}], "]"}], ",", 
         RowBox[{"yv", "[", 
          RowBox[{"[", "i2", "]"}], "]"}], ",", 
         RowBox[{"zv", "[", 
          RowBox[{"[", "i2", "]"}], "]"}], ",", 
         RowBox[{"xv", "[", 
          RowBox[{"[", "i3", "]"}], "]"}], ",", 
         RowBox[{"yv", "[", 
          RowBox[{"[", "i3", "]"}], "]"}], ",", 
         RowBox[{"zv", "[", 
          RowBox[{"[", "i3", "]"}], "]"}], ",", 
         RowBox[{"xv", "[", 
          RowBox[{"[", "i4", "]"}], "]"}], ",", 
         RowBox[{"yv", "[", 
          RowBox[{"[", "i4", "]"}], "]"}], ",", 
         RowBox[{"zv", "[", 
          RowBox[{"[", "i4", "]"}], "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"bDivmat", "=", 
       RowBox[{"gDivmatrix", "[", 
        RowBox[{
         RowBox[{"xv", "[", 
          RowBox[{"[", "i1", "]"}], "]"}], ",", 
         RowBox[{"yv", "[", 
          RowBox[{"[", "i1", "]"}], "]"}], ",", 
         RowBox[{"zv", "[", 
          RowBox[{"[", "i1", "]"}], "]"}], ",", 
         RowBox[{"xv", "[", 
          RowBox[{"[", "i2", "]"}], "]"}], ",", 
         RowBox[{"yv", "[", 
          RowBox[{"[", "i2", "]"}], "]"}], ",", 
         RowBox[{"zv", "[", 
          RowBox[{"[", "i2", "]"}], "]"}], ",", 
         RowBox[{"xv", "[", 
          RowBox[{"[", "i3", "]"}], "]"}], ",", 
         RowBox[{"yv", "[", 
          RowBox[{"[", "i3", "]"}], "]"}], ",", 
         RowBox[{"zv", "[", 
          RowBox[{"[", "i3", "]"}], "]"}], ",", 
         RowBox[{"xv", "[", 
          RowBox[{"[", "i4", "]"}], "]"}], ",", 
         RowBox[{"yv", "[", 
          RowBox[{"[", "i4", "]"}], "]"}], ",", 
         RowBox[{"zv", "[", 
          RowBox[{"[", "i4", "]"}], "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"myDetJ", "=", 
       RowBox[{"Detj", "[", 
        RowBox[{
         RowBox[{"xv", "[", 
          RowBox[{"[", "i1", "]"}], "]"}], ",", 
         RowBox[{"yv", "[", 
          RowBox[{"[", "i1", "]"}], "]"}], ",", 
         RowBox[{"zv", "[", 
          RowBox[{"[", "i1", "]"}], "]"}], ",", 
         RowBox[{"xv", "[", 
          RowBox[{"[", "i2", "]"}], "]"}], ",", 
         RowBox[{"yv", "[", 
          RowBox[{"[", "i2", "]"}], "]"}], ",", 
         RowBox[{"zv", "[", 
          RowBox[{"[", "i2", "]"}], "]"}], ",", 
         RowBox[{"xv", "[", 
          RowBox[{"[", "i3", "]"}], "]"}], ",", 
         RowBox[{"yv", "[", 
          RowBox[{"[", "i3", "]"}], "]"}], ",", 
         RowBox[{"zv", "[", 
          RowBox[{"[", "i3", "]"}], "]"}], ",", 
         RowBox[{"xv", "[", 
          RowBox[{"[", "i4", "]"}], "]"}], ",", 
         RowBox[{"yv", "[", 
          RowBox[{"[", "i4", "]"}], "]"}], ",", 
         RowBox[{"zv", "[", 
          RowBox[{"[", "i4", "]"}], "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"disp", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"dofs", "[", 
          RowBox[{"[", 
           RowBox[{"lmids", "[", 
            RowBox[{"[", "k", "]"}], "]"}], "]"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"k", ",", "1", ",", 
           RowBox[{"Length", "[", "lmids", "]"}]}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"nodT", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"dofs", "[", 
          RowBox[{"[", 
           RowBox[{"ltids", "[", 
            RowBox[{"[", "k", "]"}], "]"}], "]"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"k", ",", "1", ",", 
           RowBox[{"Length", "[", "ltids", "]"}]}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"nodP", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"dofs", "[", 
          RowBox[{"[", 
           RowBox[{"lpids", "[", 
            RowBox[{"[", "k", "]"}], "]"}], "]"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"k", ",", "1", ",", 
           RowBox[{"Length", "[", "lpids", "]"}]}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"dispVals", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"disp", "[", 
           RowBox[{"[", "k", "]"}], "]"}], "\[Rule]", 
          RowBox[{"uv", "[", 
           RowBox[{"[", 
            RowBox[{"mids", "[", 
             RowBox[{"[", "k", "]"}], "]"}], "]"}], "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"k", ",", "1", ",", 
           RowBox[{"Length", "[", "mids", "]"}]}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"nodTVals", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"nodT", "[", 
           RowBox[{"[", "k", "]"}], "]"}], "\[Rule]", 
          RowBox[{"uv", "[", 
           RowBox[{"[", 
            RowBox[{"tids", "[", 
             RowBox[{"[", "k", "]"}], "]"}], "]"}], "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"k", ",", "1", ",", 
           RowBox[{"Length", "[", "tids", "]"}]}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"nodPVals", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"nodP", "[", 
           RowBox[{"[", "k", "]"}], "]"}], "\[Rule]", 
          RowBox[{"uv", "[", 
           RowBox[{"[", 
            RowBox[{"pids", "[", 
             RowBox[{"[", "k", "]"}], "]"}], "]"}], "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"k", ",", "1", ",", 
           RowBox[{"Length", "[", "pids", "]"}]}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"localResidual", "=", 
       RowBox[{"Table", "[", 
        RowBox[{"0.0", ",", 
         RowBox[{"{", 
          RowBox[{"k", ",", "1", ",", 
           RowBox[{"nnodes", " ", "ndofs"}]}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"TLocalResidual", "=", 
       RowBox[{"Table", "[", 
        RowBox[{"0.0", ",", 
         RowBox[{"{", 
          RowBox[{"k", ",", "1", ",", 
           RowBox[{"nnodes", " ", "ndofs"}]}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"j", "=", "1"}], ",", 
        RowBox[{"j", "<=", 
         RowBox[{"Length", "[", "gw", "]"}]}], ",", 
        RowBox[{"j", "++"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"gaussPoint", "=", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"\[Xi]", "->", 
             RowBox[{
              RowBox[{"gp", "[", 
               RowBox[{"[", "j", "]"}], "]"}], "[", 
              RowBox[{"[", "1", "]"}], "]"}]}], ",", 
            RowBox[{"\[Psi]", "->", 
             RowBox[{
              RowBox[{"gp", "[", 
               RowBox[{"[", "j", "]"}], "]"}], "[", 
              RowBox[{"[", "2", "]"}], "]"}]}], ",", 
            RowBox[{"\[Zeta]", "->", 
             RowBox[{
              RowBox[{"gp", "[", 
               RowBox[{"[", "j", "]"}], "]"}], "[", 
              RowBox[{"[", "3", "]"}], "]"}]}]}], "}"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"strain", "=", 
          RowBox[{"Bmat", ".", "disp"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"temperature", " ", "=", " ", 
          RowBox[{"(", 
           RowBox[{"\[Phi]s", ".", "nodT"}], ")"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"tstrain", "=", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
            "\[Alpha]", ",", "\[Alpha]", ",", "\[Alpha]", ",", "0", ",", "0", 
             ",", "0"}], "}"}], "*", "temperature"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"totalStrain", "=", 
          RowBox[{"strain", "-", "tstrain"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"stress", "=", 
          RowBox[{"S", ".", 
           RowBox[{"(", "totalStrain", ")"}]}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"pressure", "=", 
          RowBox[{
           RowBox[{"VoigtTrace", "[", "stress", "]"}], "/", "3"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"devStress", "=", 
          RowBox[{"Simplify", "[", 
           RowBox[{"stress", "-", 
            RowBox[{"VoigtIdentity", "*", "pressure"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"stressDiv", "=", 
          RowBox[{
           RowBox[{"gw", "[", 
            RowBox[{"[", "j", "]"}], "]"}], "myDetJ", "*", 
           RowBox[{
            RowBox[{"Transpose", "[", "Bmat", "]"}], ".", "devStress"}]}]}], 
         ";", "\[IndentingNewLine]", 
         RowBox[{"For", "[", 
          RowBox[{
           RowBox[{"k", "=", "1"}], ",", 
           RowBox[{"k", "\[LessEqual]", 
            RowBox[{"Length", "[", "lmids", "]"}]}], ",", 
           RowBox[{"k", "++"}], ",", 
           RowBox[{
            RowBox[{"localResidual", "[", 
             RowBox[{"[", 
              RowBox[{"lmids", "[", 
               RowBox[{"[", "k", "]"}], "]"}], "]"}], "]"}], "+=", 
            RowBox[{
             RowBox[{"stressDiv", "[", 
              RowBox[{"[", "k", "]"}], "]"}], "/.", "gaussPoint"}]}]}], "]"}],
          ";", "\[IndentingNewLine]", 
         RowBox[{"pressureDiv", "=", 
          RowBox[{
           RowBox[{"gw", "[", 
            RowBox[{"[", "j", "]"}], "]"}], "myDetJ", "*", "bDivmat", 
           RowBox[{"(", 
            RowBox[{"\[Phi]s", ".", "nodP"}], ")"}]}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"For", "[", 
          RowBox[{
           RowBox[{"k", "=", "1"}], ",", 
           RowBox[{"k", "\[LessEqual]", 
            RowBox[{"Length", "[", "lmids", "]"}]}], ",", 
           RowBox[{"k", "++"}], ",", 
           RowBox[{
            RowBox[{"localResidual", "[", 
             RowBox[{"[", 
              RowBox[{"lmids", "[", 
               RowBox[{"[", "k", "]"}], "]"}], "]"}], "]"}], "+=", 
            RowBox[{
             RowBox[{"pressureDiv", "[", 
              RowBox[{"[", "k", "]"}], "]"}], "/.", "gaussPoint"}]}]}], "]"}],
          ";", "\[IndentingNewLine]", 
         RowBox[{"volEqn", "=", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"VoigtTrace", "[", "strain", "]"}], "-", 
            RowBox[{
             FractionBox["1", "Km"], 
             RowBox[{"(", 
              RowBox[{"\[Phi]s", ".", "nodP"}], ")"}]}], "-", 
            RowBox[{"VoigtTrace", "[", "tstrain", "]"}]}], ")"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"volEqnProj", "=", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"gw", "[", 
             RowBox[{"[", "j", "]"}], "]"}], "myDetJ", " ", "\[Phi]s", " ", 
            "volEqn"}], ")"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"\[Tau]", "=", 
          FractionBox[
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              RowBox[{"gw", "[", 
               RowBox[{"[", "j", "]"}], "]"}], "cellDetJ"}], ")"}], 
            RowBox[{"2", "/", "3"}]], 
           RowBox[{"2", " ", "Gm"}]]}], ";", "\[IndentingNewLine]", 
         RowBox[{"cellStab", "=", 
          RowBox[{"\[Tau]", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"bmat", ".", "nodP"}], "-", 
             RowBox[{"(", 
              RowBox[{"\[Phi]s", ".", 
               RowBox[{"\[CapitalPi]v", "[", 
                RowBox[{"[", "i", "]"}], "]"}]}], ")"}]}], ")"}]}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"cellStabDiv", "=", 
          RowBox[{
           RowBox[{"gw", "[", 
            RowBox[{"[", "j", "]"}], "]"}], "cellDetJ", " ", 
           RowBox[{
            RowBox[{"Transpose", "[", "bmat", "]"}], ".", "cellStab"}]}]}], 
         ";", "\[IndentingNewLine]", 
         RowBox[{"For", "[", 
          RowBox[{
           RowBox[{"k", "=", "1"}], ",", 
           RowBox[{"k", "\[LessEqual]", 
            RowBox[{"Length", "[", "lpids", "]"}]}], ",", 
           RowBox[{"k", "++"}], ",", 
           RowBox[{
            RowBox[{"localResidual", "[", 
             RowBox[{"[", 
              RowBox[{"lpids", "[", 
               RowBox[{"[", "k", "]"}], "]"}], "]"}], "]"}], "+=", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"volEqnProj", "[", 
                RowBox[{"[", "k", "]"}], "]"}], "-", 
               RowBox[{"cellStabDiv", "[", 
                RowBox[{"[", "k", "]"}], "]"}]}], ")"}], "/.", 
             "gaussPoint"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
         RowBox[{"fluxDiv", "=", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"gw", "[", 
             RowBox[{"[", "j", "]"}], "]"}], "myDetJ", "*", 
            RowBox[{
             RowBox[{"Transpose", "[", "bmat", "]"}], ".", 
             RowBox[{"(", 
              RowBox[{"kcond", " ", 
               RowBox[{"bmat", ".", "nodT"}]}], ")"}]}]}], ")"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"For", "[", 
          RowBox[{
           RowBox[{"k", "=", "1"}], ",", 
           RowBox[{"k", "\[LessEqual]", 
            RowBox[{"Length", "[", "ltids", "]"}]}], ",", 
           RowBox[{"k", "++"}], ",", 
           RowBox[{
            RowBox[{"localResidual", "[", 
             RowBox[{"[", 
              RowBox[{"ltids", "[", 
               RowBox[{"[", "k", "]"}], "]"}], "]"}], "]"}], "+=", 
            RowBox[{
             RowBox[{"fluxDiv", "[", 
              RowBox[{"[", "k", "]"}], "]"}], "/.", "gaussPoint"}]}]}], "]"}],
          ";"}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"Klocal", "=", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"D", "[", 
              RowBox[{
               RowBox[{"localResidual", "[", 
                RowBox[{"[", "k", "]"}], "]"}], ",", 
               RowBox[{"dofs", "[", 
                RowBox[{"[", "l", "]"}], "]"}]}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"k", ",", "1", ",", 
               RowBox[{"Length", "[", "localResidual", "]"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"l", ",", "1", ",", 
               RowBox[{"Length", "[", "dofs", "]"}]}], "}"}]}], "]"}], "/.", 
           "dispVals"}], "/.", "nodTVals"}], "/.", "nodPVals"}], "//.", 
        "matProps"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"j", "=", "1"}], ",", 
        RowBox[{"j", "\[LessEqual]", 
         RowBox[{"ndofs", " ", "nnodes"}]}], ",", 
        RowBox[{"j", "++"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"globalResidual", "[", 
           RowBox[{"[", 
            RowBox[{"gids", "[", 
             RowBox[{"[", "j", "]"}], "]"}], "]"}], "]"}], "+=", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"localResidual", "[", 
               RowBox[{"[", "j", "]"}], "]"}], "/.", "dispVals"}], "/.", 
             "nodTVals"}], "/.", "nodPVals"}], "//.", "matProps"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"For", "[", 
          RowBox[{
           RowBox[{"k", "=", "1"}], ",", 
           RowBox[{"k", "\[LessEqual]", 
            RowBox[{"ndofs", " ", "nnodes"}]}], ",", 
           RowBox[{"k", "++"}], ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"Kglobal", "[", 
               RowBox[{"[", 
                RowBox[{"gids", "[", 
                 RowBox[{"[", "j", "]"}], "]"}], "]"}], "]"}], "[", 
              RowBox[{"[", 
               RowBox[{"gids", "[", 
                RowBox[{"[", "k", "]"}], "]"}], "]"}], "]"}], "+=", 
             RowBox[{
              RowBox[{"Klocal", "[", 
               RowBox[{"[", "j", "]"}], "]"}], "[", 
              RowBox[{"[", "k", "]"}], "]"}]}], ";"}]}], 
          "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", "]"}], 
      ";"}]}], "\[IndentingNewLine]", "]"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.7167647605597653`*^9, 3.7167647892518883`*^9}, {
   3.7167648244240847`*^9, 3.716764841539942*^9}, {3.71676488019324*^9, 
   3.7167648969754357`*^9}, {3.716765065628334*^9, 3.716765185350045*^9}, {
   3.7167652229401484`*^9, 3.7167652383100395`*^9}, {3.7167653441168547`*^9, 
   3.7167655199547443`*^9}, {3.7167655675522327`*^9, 
   3.7167655810711265`*^9}, {3.716765622284607*^9, 3.7167656290567384`*^9}, {
   3.716765757154343*^9, 3.716765792076064*^9}, {3.7167658276745405`*^9, 
   3.7167660826802125`*^9}, {3.716766195664576*^9, 3.716766242915578*^9}, {
   3.7167663310833845`*^9, 3.7167663393539863`*^9}, {3.7167664503932595`*^9, 
   3.716766450932579*^9}, {3.7167664868258085`*^9, 3.7167665635541043`*^9}, {
   3.716766627651472*^9, 3.716766643645746*^9}, {3.716766826115865*^9, 
   3.7167668360695195`*^9}, {3.716766868385886*^9, 3.7167669130203*^9}, {
   3.717155721663645*^9, 3.7171557331420517`*^9}, {3.717155769178903*^9, 
   3.7171557818205233`*^9}, {3.7171567883516493`*^9, 3.717156887869956*^9}, {
   3.717156918335051*^9, 3.717156937057849*^9}, {3.717157017416103*^9, 
   3.717157052623994*^9}, {3.717157895689323*^9, 3.717157931742132*^9}, {
   3.717166282194605*^9, 3.71716628473459*^9}, {3.71716849797501*^9, 
   3.71716852298344*^9}, {3.717168562021318*^9, 3.717168562125424*^9}, {
   3.717168843821663*^9, 3.717168857297769*^9}, {3.7171692165304537`*^9, 
   3.7171692208302*^9}, {3.717170006857576*^9, 3.717170018830927*^9}, {
   3.717171209233417*^9, 3.717171213025419*^9}, {3.7173548750864697`*^9, 
   3.717354881757492*^9}, {3.717354996753583*^9, 3.717355017245678*^9}, {
   3.717355319697336*^9, 3.7173553216726255`*^9}, {3.7173557531181636`*^9, 
   3.7173557820403166`*^9}, {3.7173558138063755`*^9, 
   3.7173558166812677`*^9}, {3.7173587645155315`*^9, 
   3.7173587704721184`*^9}, {3.7173588122062426`*^9, 
   3.7173588501286516`*^9}, {3.717359014190798*^9, 3.7173590339564075`*^9}, {
   3.7173591194571896`*^9, 3.7173591202540846`*^9}, {3.717360749384885*^9, 
   3.717360755072524*^9}, {3.7173608405541487`*^9, 3.7173608453215923`*^9}, {
   3.7174176653039513`*^9, 3.7174177502357674`*^9}, {3.717418005127076*^9, 
   3.717418022383568*^9}, {3.7174180927900662`*^9, 3.717418180868244*^9}, {
   3.717419219270834*^9, 3.7174192266613092`*^9}, {3.71741926925568*^9, 
   3.717419272755123*^9}, {3.7174241468474283`*^9, 3.7174241510843997`*^9}, {
   3.71742429898483*^9, 3.717424381678406*^9}, {3.717427960779907*^9, 
   3.7174279724352093`*^9}, {3.7174281618258095`*^9, 
   3.7174281652786007`*^9}, {3.7208066594239817`*^9, 
   3.7208066657144737`*^9}, {3.723057650960129*^9, 3.7230576545889745`*^9}, {
   3.763398626297826*^9, 3.7633986377693434`*^9}, {3.763398969492062*^9, 
   3.763399017148432*^9}, {3.7633990692779627`*^9, 3.7633990694291053`*^9}, {
   3.7633991201481476`*^9, 3.763399174570841*^9}, {3.763399415268031*^9, 
   3.76339941606513*^9}, {3.7633996474373903`*^9, 3.7633996648412056`*^9}, {
   3.7633997501291094`*^9, 3.7633999258824277`*^9}, {3.7633999725549555`*^9, 
   3.763399976702032*^9}, {3.7634000083920765`*^9, 3.76340016737781*^9}, {
   3.7634002158964863`*^9, 3.76340029196223*^9}, {3.763400323496956*^9, 
   3.7634004027149053`*^9}, {3.76340045059245*^9, 3.763400463281616*^9}, {
   3.7634005294006834`*^9, 3.763400570424802*^9}, {3.764082973996101*^9, 
   3.764082975901887*^9}, {3.764085676134435*^9, 3.7640856834202404`*^9}, {
   3.7640858472503123`*^9, 3.7640858920767965`*^9}, {3.7640894255234814`*^9, 
   3.7640894257482643`*^9}, {3.7640894615887256`*^9, 
   3.7640894620724916`*^9}, {3.7640895179586363`*^9, 
   3.7640895273283195`*^9}, {3.7640896836413865`*^9, 
   3.7640896854169707`*^9}, {3.764098322843951*^9, 3.764098324217982*^9}, {
   3.7640983820840216`*^9, 3.764098382599674*^9}, {3.764099103461434*^9, 
   3.764099173185652*^9}, {3.764101764387092*^9, 3.7641017868352966`*^9}, 
   3.764761842376623*^9, {3.76476223129729*^9, 3.764762241509314*^9}, {
   3.7647622805381107`*^9, 3.764762305230457*^9}, {3.76476236061409*^9, 
   3.7647623840555506`*^9}, {3.7647624148034487`*^9, 
   3.7647624367677865`*^9}, {3.7647629353927927`*^9, 
   3.7647629384726405`*^9}, {3.7647894121072764`*^9, 
   3.7647894567809696`*^9}, {3.7647895619002247`*^9, 
   3.7647896425467887`*^9}, {3.7647896949078503`*^9, 
   3.7647896994970655`*^9}, {3.7647899115869627`*^9, 
   3.7647899366981144`*^9}, {3.7647907620386324`*^9, 3.764790762555979*^9}, {
   3.764790859444355*^9, 3.7647909121812305`*^9}, {3.7647910437526674`*^9, 
   3.764791065929558*^9}, {3.7647911306307406`*^9, 3.764791227713051*^9}, {
   3.7647914009447327`*^9, 3.7647914078831196`*^9}, {3.76479146494147*^9, 
   3.764791471596281*^9}, {3.764791528743067*^9, 3.7647915852144847`*^9}, {
   3.7647919581623106`*^9, 3.764791958342961*^9}, {3.7647921939537992`*^9, 
   3.7647922001003637`*^9}, {3.764792557254195*^9, 3.764792592381807*^9}, {
   3.764793280270445*^9, 3.7647932827589827`*^9}, {3.76479471152559*^9, 
   3.764794903918975*^9}, {3.764795098669626*^9, 3.764795104549365*^9}, {
   3.764795265272959*^9, 3.76479539685962*^9}, {3.7692654915417233`*^9, 
   3.7692655147563086`*^9}, {3.769266609091014*^9, 3.769266610081217*^9}, {
   3.7692666402812986`*^9, 3.769266686321863*^9}, {3.7692668165842485`*^9, 
   3.7692668826166487`*^9}, {3.769266920831176*^9, 3.769266954634816*^9}, {
   3.7692669917496595`*^9, 3.7692670743215904`*^9}, {3.7692671616824856`*^9, 
   3.769267205957114*^9}, {3.769267242711638*^9, 3.769267252372937*^9}, {
   3.7692672877953825`*^9, 3.7692674254805794`*^9}, {3.769267456594332*^9, 
   3.769267484354904*^9}, {3.769267580518936*^9, 3.769267612008975*^9}, {
   3.769267646137645*^9, 3.769267717283578*^9}, {3.76926778909048*^9, 
   3.769267827975362*^9}, {3.7692679854648533`*^9, 3.7692680032396917`*^9}, {
   3.7692680349329367`*^9, 3.769268047511677*^9}, {3.769268103324236*^9, 
   3.7692681039760466`*^9}, {3.769268178879094*^9, 3.7692681941222687`*^9}, {
   3.769281293440941*^9, 3.7692812994283714`*^9}, {3.7692813312201686`*^9, 
   3.769281397118626*^9}, {3.769285168302395*^9, 3.769285214048355*^9}, {
   3.7692852862807446`*^9, 3.7692853571531754`*^9}, {3.769287140156516*^9, 
   3.7692871518345957`*^9}, {3.769287223762863*^9, 3.769287238974713*^9}, {
   3.7692872917920303`*^9, 3.7692872973304834`*^9}, {3.7692873296771994`*^9, 
   3.7692874110603237`*^9}, {3.769287669813406*^9, 3.76928771105731*^9}, {
   3.7693443377314477`*^9, 3.769344341790784*^9}, {3.7693443858089895`*^9, 
   3.7693443917835684`*^9}, {3.769344443904977*^9, 3.7693444690976424`*^9}, {
   3.769344502488573*^9, 3.7693445272632284`*^9}, {3.7693495667999096`*^9, 
   3.769349636973344*^9}, {3.769349752464275*^9, 3.769349846565425*^9}, {
   3.769349901996236*^9, 3.769349903127725*^9}, {3.769349973557214*^9, 
   3.7693499763096356`*^9}, {3.7693500125091305`*^9, 3.769350071087141*^9}, {
   3.7693502370954227`*^9, 3.7693502627595353`*^9}, {3.769350305995264*^9, 
   3.769350348530837*^9}, {3.7693503804930134`*^9, 3.769350437385868*^9}, {
   3.7693507258373995`*^9, 3.7693507449038563`*^9}, {3.769351559433146*^9, 
   3.769351569081027*^9}, {3.76935181507541*^9, 3.769351930293931*^9}, {
   3.7693519660903907`*^9, 3.769351979322859*^9}, {3.7693521811970243`*^9, 
   3.7693522008717422`*^9}, {3.769352235657698*^9, 3.769352256824642*^9}, {
   3.7693524750897884`*^9, 3.769352579129157*^9}, {3.769352618342435*^9, 
   3.7693526622116327`*^9}, {3.769353838986984*^9, 3.769353876798025*^9}, {
   3.769354308434397*^9, 3.76935430885035*^9}, {3.7693544164026976`*^9, 
   3.7693544181261587`*^9}, {3.769354510630841*^9, 3.7693545186995792`*^9}, {
   3.7693552502011104`*^9, 3.76935527388229*^9}, {3.769355767621235*^9, 
   3.7693558090980062`*^9}, {3.769356005550325*^9, 3.769356013178934*^9}, 
   3.7693560447755127`*^9, {3.769358265542241*^9, 3.7693582668328047`*^9}, {
   3.76935832938021*^9, 3.769358349346999*^9}, {3.7693583837842226`*^9, 
   3.7693584455920134`*^9}, {3.7693593194128866`*^9, 
   3.7693593264784746`*^9}, {3.769359388348181*^9, 3.76935941308883*^9}, {
   3.7693594782789116`*^9, 3.7693595026425114`*^9}, {3.769359549675559*^9, 
   3.769359586672391*^9}, {3.769361010649766*^9, 3.769361041064583*^9}, {
   3.769361652761567*^9, 3.7693616544337807`*^9}, {3.7693622011182313`*^9, 
   3.7693622195184374`*^9}, {3.769362285122402*^9, 3.7693626665472937`*^9}, {
   3.771024399743312*^9, 3.771024404541753*^9}, {3.771068642303768*^9, 
   3.771068661453328*^9}, {3.771084379254236*^9, 3.7710844054303703`*^9}, {
   3.771084472706478*^9, 3.7710844961448507`*^9}, {3.771084546770791*^9, 
   3.7710845488527765`*^9}, {3.7710846778520436`*^9, 
   3.7710846965740676`*^9}, {3.771084799702691*^9, 3.771084828064621*^9}, {
   3.7710849891535177`*^9, 3.7710850178281684`*^9}, {3.7710850582901983`*^9, 
   3.771085064424115*^9}, {3.7710851732413*^9, 3.7710851790461636`*^9}, {
   3.7710856808974533`*^9, 3.7710856903449755`*^9}, {3.7710857365051193`*^9, 
   3.7710857576560397`*^9}, {3.7710914864517207`*^9, 
   3.7710915201442847`*^9}, {3.771091748094353*^9, 3.771091749018742*^9}, {
   3.771091911683975*^9, 3.771091912938439*^9}, {3.7710919449856296`*^9, 
   3.771091997029994*^9}, {3.7710920857713685`*^9, 3.771092110304753*^9}, {
   3.7710923441859913`*^9, 3.7710923648789115`*^9}, {3.7710923978945336`*^9, 
   3.7710924828075237`*^9}, {3.7710933602207327`*^9, 
   3.7710934015606456`*^9}, {3.7710941885823803`*^9, 3.77109433085196*^9}, {
   3.771094362045571*^9, 3.7710944332638493`*^9}, {3.7710984909215064`*^9, 
   3.771098519401979*^9}, {3.7711061172993174`*^9, 3.7711062285687943`*^9}, {
   3.771109806764549*^9, 3.7711098368369913`*^9}, {3.7711099933877907`*^9, 
   3.7711100087661114`*^9}, {3.7711727255355377`*^9, 3.771172725935755*^9}, {
   3.77124217126007*^9, 3.771242271836686*^9}, {3.7712424347309237`*^9, 
   3.771242439829156*^9}, {3.77124247077703*^9, 3.771242562575446*^9}, {
   3.77124260816722*^9, 3.7712426732744308`*^9}, {3.771242757395547*^9, 
   3.7712427693974333`*^9}, {3.771242814485287*^9, 3.7712430441870136`*^9}, {
   3.771243114316436*^9, 3.7712431160543365`*^9}, {3.771243173551382*^9, 
   3.771243189002898*^9}, {3.7712432620551596`*^9, 3.771243525726542*^9}, {
   3.771243611668669*^9, 3.771243615194769*^9}, {3.771243652078536*^9, 
   3.7712436574808292`*^9}, {3.7712437221743326`*^9, 
   3.7712437222389183`*^9}, {3.7712437565948462`*^9, 3.771243848403201*^9}, {
   3.7712439317719965`*^9, 3.7712441788909607`*^9}, {3.7712442324967656`*^9, 
   3.771244327229339*^9}, {3.771244390573444*^9, 3.771244452592464*^9}, {
   3.7712445013351717`*^9, 3.7712445183425617`*^9}, {3.771244550003049*^9, 
   3.771244561782967*^9}, {3.771244598658849*^9, 3.7712447300297937`*^9}, {
   3.7712448279875684`*^9, 3.771244843335621*^9}, {3.7712449141273155`*^9, 
   3.7712450270248213`*^9}, {3.7712451015964212`*^9, 
   3.7712452257596035`*^9}, {3.7712452580445423`*^9, 3.771245258559392*^9}, {
   3.7712453517276173`*^9, 3.7712453567320404`*^9}, {3.77124542756096*^9, 
   3.7712454282180014`*^9}, {3.7712454912367525`*^9, 
   3.7712455039820595`*^9}, {3.7712456589928827`*^9, 
   3.7712457053111153`*^9}, {3.7712463579833827`*^9, 3.77124639313698*^9}, {
   3.7712464276523438`*^9, 3.771246477841072*^9}, {3.7712465164100647`*^9, 
   3.7712465271608653`*^9}, {3.7712466875242424`*^9, 
   3.7712466882512927`*^9}, {3.771246813710644*^9, 3.771246835228638*^9}, {
   3.775488963736023*^9, 3.775489024525177*^9}, {3.775497251489747*^9, 
   3.775497252399269*^9}, {3.775500075412524*^9, 3.7755000797018223`*^9}, {
   3.775500307346093*^9, 3.775500372793034*^9}, {3.7755004154326153`*^9, 
   3.7755004235901947`*^9}, {3.77550046569411*^9, 3.775500472978054*^9}, {
   3.775500838128828*^9, 3.775500867184751*^9}, {3.775500924261393*^9, 
   3.775500924821157*^9}, {3.775501043656234*^9, 3.7755010546883583`*^9}, 
   3.7755010872546387`*^9, {3.775501726336976*^9, 3.775501727010014*^9}, {
   3.775501854374704*^9, 3.7755018750041113`*^9}, {3.775501925593108*^9, 
   3.775501937291852*^9}, {3.775501976541184*^9, 3.7755020101345577`*^9}, {
   3.775503086288142*^9, 3.775503086736249*^9}, 3.775503231701137*^9, {
   3.775503284930901*^9, 3.77550334160857*^9}, {3.775503442831085*^9, 
   3.77550345024384*^9}, {3.775503489770323*^9, 3.775503540695731*^9}, {
   3.775503579947631*^9, 3.7755036255219097`*^9}, 3.775503697207168*^9, {
   3.775503749603557*^9, 3.775503753192144*^9}, {3.7755038071584587`*^9, 
   3.775503928202695*^9}, {3.775504421003419*^9, 3.775504466797221*^9}, {
   3.775504760204915*^9, 3.775504770763247*^9}, {3.7755048295851707`*^9, 
   3.7755048387985067`*^9}, {3.7755049739115257`*^9, 3.775504974090824*^9}, {
   3.907755543053207*^9, 3.9077558815283403`*^9}, {3.90775611053974*^9, 
   3.907756111769691*^9}, {3.907756605295066*^9, 3.907756606798341*^9}, {
   3.9077566666820097`*^9, 3.907756715251054*^9}, {3.907756792546739*^9, 
   3.907756802789665*^9}, {3.907757309680591*^9, 3.907757313700263*^9}, {
   3.9077573576549788`*^9, 3.907757358211089*^9}, {3.907757448264347*^9, 
   3.9077574549989967`*^9}, {3.9077576568064623`*^9, 3.907757657181591*^9}, {
   3.907757794795249*^9, 3.907757797845106*^9}, {3.907757868794697*^9, 
   3.907758015420299*^9}, {3.907758086252798*^9, 3.9077581180271063`*^9}, {
   3.9077581569337482`*^9, 3.907758157278926*^9}, {3.907758189185915*^9, 
   3.907758215535171*^9}, {3.9077582525540867`*^9, 3.907758262122181*^9}, {
   3.907767441577466*^9, 3.907767458064013*^9}, {3.907767490902276*^9, 
   3.907767522793178*^9}, {3.90776755518305*^9, 3.90776760386392*^9}, {
   3.907768247561048*^9, 3.9077682599855433`*^9}, {3.907768309777076*^9, 
   3.907768443367621*^9}, {3.907768975946951*^9, 3.9077691035811567`*^9}, {
   3.907769696072654*^9, 3.907769700342004*^9}, {3.907769767747594*^9, 
   3.907769795806623*^9}, {3.907771032242772*^9, 3.907771044760088*^9}, {
   3.9077784910238647`*^9, 3.90777849735927*^9}, {3.907778835382595*^9, 
   3.907778850572613*^9}, {3.907837426411529*^9, 3.907837455549876*^9}, {
   3.907837515026729*^9, 3.9078375391473627`*^9}, {3.907837703413762*^9, 
   3.9078378546762753`*^9}, {3.907837911654766*^9, 3.907837954434698*^9}, {
   3.907838328025639*^9, 3.907838344603112*^9}, {3.9078385450292253`*^9, 
   3.907838550087204*^9}, {3.907838580364971*^9, 3.907838580584148*^9}, {
   3.907838639306067*^9, 3.9078386644024363`*^9}, {3.907838699415596*^9, 
   3.907838705958807*^9}, {3.9078387458120747`*^9, 3.907838819041583*^9}, {
   3.907838906434842*^9, 3.90783895622363*^9}, 3.907838994490636*^9, {
   3.9078390383127117`*^9, 3.90783909432154*^9}, {3.907839574978209*^9, 
   3.907839582697591*^9}, {3.907839743379506*^9, 3.907839743641821*^9}, {
   3.9078401987159023`*^9, 3.907840198844179*^9}, {3.907840366912835*^9, 
   3.9078403789029703`*^9}, 3.9078404138069973`*^9, {3.907840451678378*^9, 
   3.907840483274042*^9}, 3.907840543050424*^9, {3.9078407368146276`*^9, 
   3.907840763214219*^9}, {3.907841007067699*^9, 3.907841131386199*^9}, {
   3.907841166117004*^9, 3.907841182062207*^9}, {3.907841524247752*^9, 
   3.907841540254326*^9}, {3.907841643889029*^9, 3.9078416481852093`*^9}, {
   3.907841688271606*^9, 3.9078418026575937`*^9}, {3.9078418455556793`*^9, 
   3.907841876304394*^9}, {3.907844155326742*^9, 3.9078441910878572`*^9}, {
   3.9078442434356213`*^9, 3.907844243738014*^9}, {3.9078444638582573`*^9, 
   3.907844469475347*^9}, {3.907844523578175*^9, 3.907844551786241*^9}, {
   3.907844594470973*^9, 3.9078445993011208`*^9}, {3.9078447945177603`*^9, 
   3.9078451379017363`*^9}, {3.90784517715921*^9, 3.907845178388541*^9}, {
   3.9078452109884253`*^9, 3.907845234576076*^9}, {3.9078456748687563`*^9, 
   3.907845676827941*^9}},ExpressionUUID->"52ec8139-983f-4847-9e3f-\
3c6b9960063a"],

Cell[CellGroupData[{

Cell[BoxData["globalResidual"], "Input",
 CellChangeTimes->{{3.907768430334152*^9, 3.907768432271315*^9}},
 CellLabel->
  "In[457]:=",ExpressionUUID->"0247c18d-7dc9-41c4-b8b3-7f37ce18f56e"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"-", "30575.93951523306`"}], ",", 
   RowBox[{"-", "17789.637536136768`"}], ",", 
   RowBox[{"-", "18345.563709140002`"}], ",", "1.1249804999928622`*^-7", ",", 
   RowBox[{"-", "0.0008666666666666666`"}], ",", 
   RowBox[{"-", "22515.010006671386`"}], ",", 
   RowBox[{"-", "17511.674449633578`"}], ",", 
   RowBox[{"-", "32521.68112074736`"}], ",", "1.4999712499814147`*^-7", ",", 
   RowBox[{"-", "0.0012`"}], ",", "8060.929508560748`", ",", 
   "277.9630865017184`", ",", 
   RowBox[{"-", "14176.117411606967`"}], ",", "3.749932500054431`*^-8", ",", 
   RowBox[{"-", "0.0003333333333333333`"}], ",", 
   RowBox[{"-", "28352.234823217514`"}], ",", 
   RowBox[{"-", "26684.456304201525`"}], ",", 
   RowBox[{"-", "18345.563709140388`"}], ",", "1.499962499965651`*^-7", ",", 
   RowBox[{"-", "0.001`"}], ",", 
   RowBox[{"-", "10006.67111408013`"}], ",", 
   RowBox[{"-", "35023.348899267556`"}], ",", 
   RowBox[{"-", "46697.79853235392`"}], ",", "2.2499424999622744`*^-7", ",", 
   RowBox[{"-", "0.0018`"}], ",", "18345.56370913748`", ",", 
   RowBox[{"-", "8338.892595063076`"}], ",", 
   RowBox[{"-", "28352.234823215484`"}], ",", "7.499825000168916`*^-8", ",", 
   RowBox[{"-", "0.0007999999999999999`"}], ",", "2223.704692016385`", ",", 
   RowBox[{"-", "8894.818768067307`"}], ",", 
   RowBox[{"-", "3.8744474295526743`*^-10"}], ",", "3.74989499999813`*^-8", 
   ",", 
   RowBox[{"-", "0.00013333333333333334`"}], ",", "12508.338892593512`", ",", 
   RowBox[{"-", "17511.674449631224`"}], ",", 
   RowBox[{"-", "14176.11741160774`"}], ",", "7.499787500078835`*^-8", ",", 
   RowBox[{"-", "0.0005999999999999998`"}], ",", "10284.63420057733`", ",", 
   RowBox[{"-", "8616.85568156539`"}], ",", 
   RowBox[{"-", "14176.117411607354`"}], ",", "3.749892500114485`*^-8", ",", 
   RowBox[{"-", "0.00046666666666666666`"}], ",", 
   RowBox[{"-", "40860.573715809514`"}], ",", 
   RowBox[{"-", "9172.781854572382`"}], ",", 
   RowBox[{"-", "4169.446297532364`"}], ",", "1.499936249935812`*^-7", ",", 
   RowBox[{"-", "0.00039999999999999996`"}], ",", 
   RowBox[{"-", "35023.34889926991`"}], ",", 
   RowBox[{"-", "1.2951204553246498`*^-9"}], ",", 
   RowBox[{"-", "18345.563709137456`"}], ",", "2.2499049999346873`*^-7", ",", 
   RowBox[{"-", "0.0006000000000000005`"}], ",", "5837.224816544169`", ",", 
   "9172.78185456785`", ",", 
   RowBox[{"-", "14176.11741160902`"}], ",", "7.499712500191436`*^-8", ",", 
   RowBox[{"-", "0.0001999999999999997`"}], ",", 
   RowBox[{"-", "46697.79853235481`"}], ",", 
   RowBox[{"-", "18345.56370913705`"}], ",", "10006.671114071964`", ",", 
   "2.249892499900344`*^-7", ",", 
   RowBox[{"-", "0.0002000000000000002`"}], ",", "2.7548594516701996`*^-9", 
   ",", 
   RowBox[{"-", "1.446096575818956`*^-9"}], ",", "1.6570993466302752`*^-9", 
   ",", "4.499804999925683`*^-7", ",", "6.505213034913027`*^-19", ",", 
   "46697.79853235666`", ",", "18345.56370914138`", ",", 
   RowBox[{"-", "10006.671114073664`"}], ",", "2.2499125000658752`*^-7", ",", 
   "0.00019999999999999955`", ",", 
   RowBox[{"-", "5837.224816544953`"}], ",", 
   RowBox[{"-", "9172.781854569415`"}], ",", "14176.117411604824`", ",", 
   "7.499637499915564`*^-8", ",", "0.0002000000000000002`", ",", 
   "35023.348899265206`", ",", "2.7398527890909463`*^-9", ",", 
   "18345.563709143327`", ",", "2.2499000000450442`*^-7", ",", 
   "0.0005999999999999993`", ",", "40860.57371580937`", ",", 
   "9172.781854569617`", ",", "4169.446297530711`", ",", 
   "1.4999337500737564`*^-7", ",", "0.0004000000000000003`", ",", 
   RowBox[{"-", "10284.634200578505`"}], ",", "8616.855681564602`", ",", 
   "14176.117411606472`", ",", "3.749782499834859`*^-8", ",", 
   "0.00046666666666666655`", ",", 
   RowBox[{"-", "12508.33889259106`"}], ",", "17511.674449629856`", ",", 
   "14176.117411609683`", ",", "7.499562499802964`*^-8", ",", 
   "0.0006000000000000001`", ",", 
   RowBox[{"-", "2223.704692016189`"}], ",", "8894.818768066913`", ",", 
   RowBox[{"-", "6.884874892421067`*^-10"}], ",", "3.749780000001885`*^-8", 
   ",", "0.00013333333333333318`", ",", 
   RowBox[{"-", "18345.56370913749`"}], ",", "8338.892595065723`", ",", 
   "28352.234823214803`", ",", "7.499524999617174`*^-8", ",", 
   "0.0007999999999999993`", ",", "10006.671114077386`", ",", 
   "35023.34889926677`", ",", "46697.79853235571`", ",", 
   "2.249862500017457`*^-7", ",", "0.0018000000000000008`", ",", 
   "28352.23482321565`", ",", "26684.456304203195`", ",", 
   "18345.563709139315`", ",", "1.499907500076008`*^-7", ",", "0.001`", ",", 
   RowBox[{"-", "8060.92950856016`"}], ",", 
   RowBox[{"-", "277.9630865035888`"}], ",", "14176.117411610685`", ",", 
   "3.749742499782314`*^-8", ",", "0.00033333333333333305`", ",", 
   "22515.010006673638`", ",", "17511.674449635746`", ",", 
   "32521.681120742083`", ",", "1.4998987500641853`*^-7", ",", 
   "0.0012000000000000005`", ",", "30575.939515234393`", ",", 
   "17789.637536135495`", ",", "18345.563709141563`", ",", 
   "1.1249220001028438`*^-7", ",", "0.0008666666666666668`"}], 
  "}"}]], "Output",
 CellChangeTimes->{{3.9077684334142113`*^9, 3.907768449038671*^9}, 
   3.907768852136898*^9, 3.907769116319729*^9, 3.907770240367489*^9, 
   3.907778548198954*^9, 3.907778699287678*^9, 3.9077788879937067`*^9, 
   3.907778934359833*^9, 3.90783867278932*^9, 3.90783897142873*^9, 
   3.907839105177617*^9, 3.907845145880044*^9, 3.9078451854750967`*^9, {
   3.9078452245088453`*^9, 3.9078452388121233`*^9}},
 CellLabel->
  "Out[457]=",ExpressionUUID->"2e6e1ca0-d217-49e3-97d0-b4440bf384fa"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Join", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"SetPrecision", "[", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Kglobal", "[", 
         RowBox[{"[", 
          RowBox[{
           RowBox[{"IntegerPart", "[", 
            RowBox[{"i", "/", "ndofs"}], "]"}], "+", "1"}], "]"}], "]"}], "[", 
        RowBox[{"[", 
         RowBox[{
          RowBox[{"ndofs", "*", "0"}], "+", 
          RowBox[{"Mod", "[", 
           RowBox[{"i", ",", "ndofs"}], "]"}], "+", "1"}], "]"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "0", ",", "24"}], "}"}]}], "]"}], ",", "18"}], 
    "]"}], ",", "\[IndentingNewLine]", 
   RowBox[{"SetPrecision", "[", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Kglobal", "[", 
         RowBox[{"[", 
          RowBox[{
           RowBox[{"IntegerPart", "[", 
            RowBox[{"i", "/", "ndofs"}], "]"}], "+", "1"}], "]"}], "]"}], "[", 
        RowBox[{"[", 
         RowBox[{
          RowBox[{"ndofs", "*", "1"}], "+", 
          RowBox[{"Mod", "[", 
           RowBox[{"i", ",", "ndofs"}], "]"}], "+", "1"}], "]"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "0", ",", "24"}], "}"}]}], "]"}], ",", "18"}], 
    "]"}], ",", "\[IndentingNewLine]", 
   RowBox[{"SetPrecision", "[", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Kglobal", "[", 
         RowBox[{"[", 
          RowBox[{
           RowBox[{"IntegerPart", "[", 
            RowBox[{"i", "/", "ndofs"}], "]"}], "+", "1"}], "]"}], "]"}], "[", 
        RowBox[{"[", 
         RowBox[{
          RowBox[{"ndofs", "*", "3"}], "+", 
          RowBox[{"Mod", "[", 
           RowBox[{"i", ",", "ndofs"}], "]"}], "+", "1"}], "]"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "0", ",", "24"}], "}"}]}], "]"}], ",", "18"}], 
    "]"}], ",", "\[IndentingNewLine]", 
   RowBox[{"SetPrecision", "[", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Kglobal", "[", 
         RowBox[{"[", 
          RowBox[{
           RowBox[{"IntegerPart", "[", 
            RowBox[{"i", "/", "ndofs"}], "]"}], "+", "1"}], "]"}], "]"}], "[", 
        RowBox[{"[", 
         RowBox[{
          RowBox[{"ndofs", "*", "4"}], "+", 
          RowBox[{"Mod", "[", 
           RowBox[{"i", ",", "ndofs"}], "]"}], "+", "1"}], "]"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "0", ",", "24"}], "}"}]}], "]"}], ",", "18"}], 
    "]"}]}], "\[IndentingNewLine]", "]"}]], "Input",
 CellChangeTimes->{{3.7641008499440265`*^9, 3.7641009191912155`*^9}, {
  3.764100982438418*^9, 3.764100994727434*^9}, {3.764101178024066*^9, 
  3.7641012178500237`*^9}, {3.771245770920061*^9, 3.771245817130376*^9}, {
  3.775489358867462*^9, 3.775489364844366*^9}, {3.775489816712109*^9, 
  3.7754898239342012`*^9}, {3.775495189811469*^9, 3.775495194578858*^9}, {
  3.775500318179763*^9, 3.7755003183693733`*^9}, {3.8495063010995417`*^9, 
  3.849506305292575*^9}, {3.850311831156353*^9, 3.850311834568668*^9}, {
  3.907758354521718*^9, 3.907758354674074*^9}, {3.90775839868598*^9, 
  3.907758418375593*^9}, {3.907779265116961*^9, 3.9077792694491167`*^9}},
 CellLabel->
  "In[458]:=",ExpressionUUID->"71dec529-953c-4148-9a58-1472c78421c7"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"1.8530872433474987030029296875`18.*^10", ",", "0", ",", "0", ",", 
   RowBox[{"-", "0.02083333333333321074620769763896532822`18."}], ",", "0", 
   ",", "0", ",", "1.8530872433474582672119140625`18.*^10", ",", "0", ",", 
   RowBox[{"-", "0.02083333333333321074620769763896532822`18."}], ",", "0", 
   ",", "0", ",", "0", ",", "1.8530872433474578857421875`18.*^10", ",", 
   RowBox[{"-", "0.02083333333333321074620769763896532822`18."}], ",", "0", 
   ",", 
   RowBox[{"-", "0.02083333333333321074620769763896532822`18."}], ",", 
   RowBox[{"-", "0.02083333333333321074620769763896532822`18."}], ",", 
   RowBox[{"-", "0.02083333333333321074620769763896532822`18."}], ",", 
   RowBox[{"-", "2.257012610302922148090374628056174399694418231`18.*^-13"}], 
   ",", 
   RowBox[{"-", "3.7499999999999715076412455314059`18.*^-7"}], ",", "0", ",", 
   "0", ",", "0", ",", "0", ",", 
   "499.99999999999994315658113919198513031006`18.", ",", 
   RowBox[{"-", "5.5592617300422496795654296875`18.*^9"}], ",", "0", ",", 
   "2.7796308650211248397827148438`18.*^9", ",", "0", ",", "0", ",", "0", ",", 
   RowBox[{"-", "5.5592617300422496795654296875`18.*^9"}], ",", 
   "2.7796308650211248397827148438`18.*^9", ",", "0", ",", "0", ",", 
   RowBox[{"-", "1.8530872433473141193389892578`18.*^9"}], ",", 
   RowBox[{"-", "1.8530872433473141193389892578`18.*^9"}], ",", 
   RowBox[{"-", "7.412348973390079498291015625`18.*^9"}], ",", 
   RowBox[{"-", "0.02083333333333337381021443945883220294`18."}], ",", "0", 
   ",", 
   RowBox[{"-", "0.01041666666666660537310384881948266411`18."}], ",", 
   RowBox[{"-", "0.01041666666666660537310384881948266411`18."}], ",", 
   "0.02083333333333321074620769763896532822`18.", ",", 
   "7.49837536767640726682698823115984426213639219`18.*^-14", ",", 
   RowBox[{"-", "6.249999999999970600418137045215`18.*^-8"}], ",", "0", ",", 
   "0", ",", "0", ",", "0", ",", 
   RowBox[{"-", "166.66666666666665719276352319866418838501`18."}], ",", 
   RowBox[{"-", "5.5592617300422496795654296875`18.*^9"}], ",", 
   "2.7796308650211248397827148438`18.*^9", ",", "0", ",", "0", ",", "0", ",", 
   RowBox[{"-", "1.8530872433474171161651611328`18.*^9"}], ",", 
   RowBox[{"-", "7.412348973390079498291015625`18.*^9"}], ",", 
   RowBox[{"-", "1.8530872433473141193389892578`18.*^9"}], ",", 
   RowBox[{"-", "0.02083333333333337381021443945883220294`18."}], ",", "0", 
   ",", "0", ",", "2.7796308650211248397827148438`18.*^9", ",", 
   RowBox[{"-", "5.5592617300422496795654296875`18.*^9"}], ",", "0", ",", "0",
    ",", 
   RowBox[{"-", "0.01041666666666660537310384881948266411`18."}], ",", 
   "0.02083333333333321074620769763896532822`18.", ",", 
   RowBox[{"-", "0.01041666666666660537310384881948266411`18."}], ",", 
   "7.49837536767640726682698823115984426213639219`18.*^-14", ",", 
   RowBox[{"-", "6.249999999999970600418137045215`18.*^-8"}], ",", "0", ",", 
   "0", ",", "0", ",", "0", ",", 
   RowBox[{"-", "166.66666666666665719276352319866418838501`18."}], ",", "0", 
   ",", "2.7796308650211248397827148438`18.*^9", ",", 
   "2.7796308650211248397827148438`18.*^9", ",", "0", ",", "0", ",", 
   RowBox[{"-", "1.8530872433473141193389892578`18.*^9"}], ",", "0", ",", 
   RowBox[{"-", "9.265436216737077236175537109`18.*^8"}], ",", 
   RowBox[{"-", "0.01041666666666668690510721972941610147`18."}], ",", "0", 
   ",", 
   RowBox[{"-", "1.8530872433473141193389892578`18.*^9"}], ",", 
   RowBox[{"-", "9.265436216737077236175537109`18.*^8"}], ",", "0", ",", 
   RowBox[{"-", "0.01041666666666668690510721972941610147`18."}], ",", "0", 
   ",", 
   RowBox[{"-", "0.02083333333333321074620769763896532822`18."}], ",", 
   "0.01041666666666660537310384881948266411`18.", ",", 
   "0.01041666666666660537310384881948266411`18.", ",", 
   RowBox[{"-", "8.33333333333329330523790684708777711030573`18.*^-17"}], ",", 
   RowBox[{"-", "6.249999999999970600418137045215`18.*^-8"}], ",", "0", ",", 
   "0", ",", "0", ",", "0", ",", "0"}], "}"}]], "Output",
 CellChangeTimes->{
  3.7641009213624554`*^9, 3.764100995781635*^9, 3.764101184303155*^9, 
   3.7641012190423956`*^9, {3.7641017730569844`*^9, 3.764101791077053*^9}, 
   3.7642444926062255`*^9, 3.7643521038190885`*^9, 3.7643697931429815`*^9, 
   3.7646963581104608`*^9, 3.7647624893150654`*^9, 3.7647629564814973`*^9, 
   3.765643267772004*^9, 3.7656458786649103`*^9, {3.765649553061717*^9, 
   3.7656496096265526`*^9}, 3.7656496656610017`*^9, {3.7656497980973516`*^9, 
   3.7656498073935776`*^9}, {3.7656502770998507`*^9, 3.765650288242176*^9}, 
   3.7656506255449963`*^9, 3.765651327975069*^9, 3.7712458228978233`*^9, 
   3.7717769641033335`*^9, 3.7717822256300383`*^9, 3.77548903930412*^9, 
   3.775489365363626*^9, 3.775489824807452*^9, 3.775495200538875*^9, 
   3.775500319363378*^9, 3.775504500202396*^9, 3.775504778685213*^9, {
   3.775504845634821*^9, 3.775504865715755*^9}, 3.77550499788201*^9, 
   3.7755052095886097`*^9, 3.849506305907291*^9, 3.850317687341036*^9, 
   3.907755897658442*^9, 3.907756116225039*^9, {3.9077570070331078`*^9, 
   3.9077570189428663`*^9}, 3.907757323957477*^9, 3.907757667574945*^9, {
   3.907757896852257*^9, 3.907757915855434*^9}, 3.90775816256217*^9, {
   3.907758332748229*^9, 3.9077583550876837`*^9}, {3.907758399659152*^9, 
   3.907758419317168*^9}, 3.907767337330514*^9, 3.907767612961502*^9, 
   3.9077688523233128`*^9, 3.9077691186107683`*^9, 3.907770243200347*^9, 
   3.907778551751534*^9, 3.907778706454217*^9, 3.907778892337616*^9, 
   3.907778937229671*^9, 3.907779270400525*^9, 3.907839118484972*^9, 
   3.907839754613735*^9, 3.907840212661661*^9, 3.907840772024599*^9, 
   3.90784456853201*^9, 3.9078452469491377`*^9},
 CellLabel->
  "Out[458]=",ExpressionUUID->"c2383920-0995-4700-b60c-11f2cdf4eb8e"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1440, 762},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
PrintingCopies->1,
PrintingPageRange->{Automatic, Automatic},
PrivateNotebookOptions->{"VersionedStylesheet"->{"Default.nb"[8.] -> False}},
Magnification:>0.75 Inherited,
FrontEndVersion->"13.3 for Linux x86 (64-bit) (June 3, 2023)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"0c9fe93e-6cd0-4cb9-ae43-b56cd8ea2f54"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 351, 5, 74, "Title",ExpressionUUID->"2ed3bc56-4373-4aa9-8d94-26114128ebcf"],
Cell[CellGroupData[{
Cell[956, 31, 272, 5, 41, "Subsection",ExpressionUUID->"b53f5e04-56e9-4af4-86f0-0c06dbbad567"],
Cell[1231, 38, 498, 10, 22, "Input",ExpressionUUID->"9feff9b6-937f-4a33-9141-db00c5c9cbbd"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1766, 53, 1373, 40, 43, "Subsection",ExpressionUUID->"f2237484-bc41-4926-8084-c58d9c768107"],
Cell[3142, 95, 1550, 48, 164, "Input",ExpressionUUID->"7269210c-8591-490d-a33a-ed91888b5098"]
}, Open  ]],
Cell[CellGroupData[{
Cell[4729, 148, 412, 13, 42, "Subsection",ExpressionUUID->"ab9ea59b-7821-401b-a389-c920bff49d1c"],
Cell[CellGroupData[{
Cell[5166, 165, 1310, 35, 22, "Input",ExpressionUUID->"885f1b85-4463-47e8-8867-3ef40f684ca8"],
Cell[6479, 202, 2170, 53, 60, "Output",ExpressionUUID->"7b15a000-9f88-4921-9cc3-0d127a6d10e4"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[8698, 261, 186, 3, 41, "Subsection",ExpressionUUID->"f2bb0bcd-f0d0-4aee-93cb-1dc8aeb604ac"],
Cell[8887, 266, 242, 5, 22, "Input",ExpressionUUID->"b174d360-3f53-44a5-a6cb-33dafa50fde1"]
}, Open  ]],
Cell[CellGroupData[{
Cell[9166, 276, 184, 3, 41, "Subsection",ExpressionUUID->"c31e0839-bf02-47ad-b143-31fa0203e471"],
Cell[9353, 281, 403, 8, 24, "Input",ExpressionUUID->"d19eca88-c4b1-4c04-9326-0b41423a0bf0"]
}, Open  ]],
Cell[CellGroupData[{
Cell[9793, 294, 910, 28, 41, "Subsection",ExpressionUUID->"1f25cd0b-85a2-4810-aee5-c062610126af"],
Cell[10706, 324, 722, 17, 22, "Input",ExpressionUUID->"1f380bb9-8937-41f8-9fc7-af60e4836700"],
Cell[11431, 343, 789, 13, 22, "Input",ExpressionUUID->"4ea65c3a-a288-4da0-a9fa-c1cdd1fb8309"]
}, Open  ]],
Cell[CellGroupData[{
Cell[12257, 361, 173, 3, 41, "Subsection",ExpressionUUID->"2964c79a-8f87-40a9-bdf6-9031289eb59c"],
Cell[12433, 366, 9222, 243, 237, "Input",ExpressionUUID->"e64abb88-b189-486a-9a4f-8636f8a9bb0d"]
}, Open  ]],
Cell[CellGroupData[{
Cell[21692, 614, 174, 3, 41, "Subsection",ExpressionUUID->"e0531742-37ee-4fb9-9b9b-1434a0453a0d"],
Cell[CellGroupData[{
Cell[21891, 621, 5293, 155, 256, "Input",ExpressionUUID->"1904a229-808b-4bbc-bee2-eba48389eded"],
Cell[27187, 778, 3882, 122, 161, "Output",ExpressionUUID->"b48225c4-6725-4666-bdd5-1b2e5b1c2716"],
Cell[31072, 902, 1113, 29, 60, "Output",ExpressionUUID->"d90ff828-59a9-4bdd-8266-74540dc09edc"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[32234, 937, 370, 8, 41, "Subsection",ExpressionUUID->"7ea9acce-18ef-49bb-840e-cce9f6963895"],
Cell[32607, 947, 5782, 152, 211, "Input",ExpressionUUID->"2941a37d-ac65-4083-89e8-a27577f192a2"],
Cell[38392, 1101, 2136, 51, 118, "Input",ExpressionUUID->"23484c70-aeb6-48e3-8efa-1fbe59937941"],
Cell[40531, 1154, 579, 16, 38, "Input",ExpressionUUID->"e8d96bf7-5299-4eb9-ac6c-ac7b7f469e22"],
Cell[41113, 1172, 1290, 32, 91, "Input",ExpressionUUID->"16f4ca74-b82f-43c8-aefd-357357e39807"]
}, Open  ]],
Cell[CellGroupData[{
Cell[42440, 1209, 283, 6, 41, "Subsection",ExpressionUUID->"ece979a0-cd8c-46e0-964f-a58a6156d72c"],
Cell[42726, 1217, 4553, 106, 68, "Input",ExpressionUUID->"de8a61f1-6c53-4fb8-b681-21ddd1c8e305"],
Cell[47282, 1325, 2062, 38, 56, "Input",ExpressionUUID->"99529d24-9263-4a10-b398-54da7768de89"],
Cell[CellGroupData[{
Cell[49369, 1367, 361, 8, 22, "Input",ExpressionUUID->"e9fc3f76-5d3f-417b-acc7-bdfaf372c654"],
Cell[49733, 1377, 1208, 19, 25, "Output",ExpressionUUID->"7ad620a9-fa06-422c-aed6-79c212c0776e"]
}, Open  ]],
Cell[50956, 1399, 2671, 69, 149, "Input",ExpressionUUID->"8fff26c6-f1fb-4a2e-a59f-ee82cd202746"],
Cell[53630, 1470, 765, 19, 53, "Input",ExpressionUUID->"e2ac3595-0f89-4199-bfb0-55870bd56912"],
Cell[54398, 1491, 1801, 45, 126, "Input",ExpressionUUID->"2229bed7-4721-457d-8b14-a986c2a6590d"],
Cell[56202, 1538, 712, 19, 38, "Input",ExpressionUUID->"cee8c193-3206-48ae-8405-01b1f75dcc66"],
Cell[56917, 1559, 872, 26, 41, "Input",ExpressionUUID->"a330cefd-b257-4b39-b353-396e9b586d6b"],
Cell[CellGroupData[{
Cell[57814, 1589, 233, 4, 34, "Subsubsection",ExpressionUUID->"1ff5647c-25f8-4b41-adaa-bda4fc0dcd03"],
Cell[58050, 1595, 45431, 1084, 1437, "Input",ExpressionUUID->"471c15da-22d4-448e-a5e6-0fa3ac166dd5"],
Cell[CellGroupData[{
Cell[103506, 2683, 231, 4, 22, "Input",ExpressionUUID->"0851ce2c-cc81-42d5-a4fb-ad25b0cae37e"],
Cell[103740, 2689, 506, 10, 27, "Output",ExpressionUUID->"0af47a08-03a5-490f-87e6-1c9c0e3b6468"]
}, Open  ]],
Cell[104261, 2702, 258, 4, 27, "Text",ExpressionUUID->"dc1557ad-c659-49ea-9f53-c3cbe497b775"],
Cell[CellGroupData[{
Cell[104544, 2710, 698, 18, 22, "Input",ExpressionUUID->"d66de46f-fc13-4f0d-8cce-26afb678a0a3"],
Cell[105245, 2730, 869, 18, 27, "Output",ExpressionUUID->"259c834f-9162-4cf8-aefe-69842fb5a326"]
}, Open  ]],
Cell[106129, 2751, 264, 4, 27, "Text",ExpressionUUID->"ff901ec3-7440-425d-8e54-938368192a9d"],
Cell[CellGroupData[{
Cell[106418, 2759, 453, 11, 22, "Input",ExpressionUUID->"79ba2779-b7a2-4792-999c-003927f86e6c"],
Cell[106874, 2772, 727, 14, 38, "Output",ExpressionUUID->"63019958-a339-4093-bebc-44fea67af83b"]
}, Open  ]],
Cell[107616, 2789, 274, 4, 27, "Text",ExpressionUUID->"4b6e1963-e5b3-4eb3-90c4-7fcce6bf0cc2"],
Cell[CellGroupData[{
Cell[107915, 2797, 738, 18, 22, "Input",ExpressionUUID->"47758c3c-0453-46c1-8a4e-3802a866a48e"],
Cell[108656, 2817, 842, 18, 27, "Output",ExpressionUUID->"dcf1ae8d-eb2a-4f5f-86e6-5016685e18b6"]
}, Open  ]],
Cell[109513, 2838, 313, 5, 27, "Text",ExpressionUUID->"4da83f35-948c-4d36-9a75-5f339a1d3887"],
Cell[CellGroupData[{
Cell[109851, 2847, 787, 19, 22, "Input",ExpressionUUID->"03f83262-e37c-448a-a1cf-2f0465d82b5f"],
Cell[110641, 2868, 2649, 60, 78, "Output",ExpressionUUID->"ef5dd2a7-2ca8-4e6e-b0bc-7d238ac70d99"]
}, Open  ]],
Cell[113305, 2931, 361, 6, 27, "Text",ExpressionUUID->"b3d95142-45aa-4e81-a6ac-0142f986fdd9"],
Cell[CellGroupData[{
Cell[113691, 2941, 841, 20, 22, "Input",ExpressionUUID->"e15a3daa-db33-4f3f-bc8d-f40c43775b63"],
Cell[114535, 2963, 2267, 52, 71, "Output",ExpressionUUID->"73dbc29c-ea58-4846-ab45-79110632bea2"]
}, Open  ]],
Cell[116817, 3018, 403, 6, 27, "Text",ExpressionUUID->"9c52e7f3-6ba6-4ab5-a4ed-6642c87f2408"],
Cell[CellGroupData[{
Cell[117245, 3028, 760, 16, 22, "Input",ExpressionUUID->"58eab9b5-f607-4d53-8ecd-b0746d7983b9"],
Cell[118008, 3046, 3202, 57, 102, "Output",ExpressionUUID->"9a6a2001-8cf3-4b0c-a265-5855d6d86bd8"]
}, Open  ]],
Cell[121225, 3106, 410, 6, 27, "Text",ExpressionUUID->"5b832f92-e406-4ec8-95dd-50a014f3bd5a"],
Cell[CellGroupData[{
Cell[121660, 3116, 892, 20, 22, "Input",ExpressionUUID->"f435389d-a367-4dc5-b9c4-2f98ce2b9c4a"],
Cell[122555, 3138, 2663, 58, 71, "Output",ExpressionUUID->"3750400f-707a-487f-a0d1-9adb904e6975"]
}, Open  ]],
Cell[125233, 3199, 478, 7, 27, "Text",ExpressionUUID->"4faebc86-d3d8-4ea2-9f1e-29b6de80e9c2"],
Cell[CellGroupData[{
Cell[125736, 3210, 952, 21, 22, "Input",ExpressionUUID->"8262bf16-8017-4eba-a714-81c64bfd647d"],
Cell[126691, 3233, 2265, 53, 78, "Output",ExpressionUUID->"935ac453-1c45-4ba1-a964-ffac9349e8ce"]
}, Open  ]],
Cell[128971, 3289, 463, 7, 27, "Text",ExpressionUUID->"b31ce238-5a11-43f4-abf2-ded3aaa705f0"],
Cell[CellGroupData[{
Cell[129459, 3300, 889, 20, 22, "Input",ExpressionUUID->"a18f641f-3cc9-48e1-91cc-3e18c14eec26"],
Cell[130351, 3322, 2255, 53, 78, "Output",ExpressionUUID->"982a92a4-1034-4dc4-ad3f-a70e6684e59b"]
}, Open  ]],
Cell[132621, 3378, 515, 8, 27, "Text",ExpressionUUID->"74e472fd-2d23-4ccb-974c-c32845f59f00"],
Cell[CellGroupData[{
Cell[133161, 3390, 940, 21, 22, "Input",ExpressionUUID->"81471d78-6478-4a2e-8f63-6e1fb352fc28"],
Cell[134104, 3413, 2274, 53, 78, "Output",ExpressionUUID->"2e437461-0ed6-4389-8d26-76cde658a107"]
}, Open  ]],
Cell[136393, 3469, 574, 8, 27, "Text",ExpressionUUID->"77840097-e70c-4afc-93ff-9bb8f70b85ed"],
Cell[CellGroupData[{
Cell[136992, 3481, 850, 15, 22, "Input",ExpressionUUID->"cbdefdd7-ebc6-4d63-a838-f613ba767811"],
Cell[137845, 3498, 1178, 21, 55, "Output",ExpressionUUID->"6fb62c15-0e6d-4687-979c-3e3a02e937c5"]
}, Open  ]],
Cell[139038, 3522, 625, 9, 27, "Text",ExpressionUUID->"35af5375-afad-49b2-94fd-82c4722d8375"],
Cell[CellGroupData[{
Cell[139688, 3535, 794, 13, 22, "Input",ExpressionUUID->"3a759521-ac01-42b1-897a-bbb45c7fc68b"],
Cell[140485, 3550, 1117, 19, 27, "Output",ExpressionUUID->"99cee8c1-3f98-46ce-af20-cb31a6283ac4"]
}, Open  ]],
Cell[141617, 3572, 678, 10, 27, "Text",ExpressionUUID->"3cc258f8-622c-4996-9fee-12e1cae3c899"],
Cell[CellGroupData[{
Cell[142320, 3586, 938, 15, 22, "Input",ExpressionUUID->"7f54d71a-cbd7-4ba8-9d5e-983de0c7c6ac"],
Cell[143261, 3603, 1195, 20, 27, "Output",ExpressionUUID->"870f9dd0-85fa-4db0-8746-e2f4c2b4842c"]
}, Open  ]],
Cell[144471, 3626, 714, 10, 27, "Text",ExpressionUUID->"abae1ec6-9f21-4cf6-a3b5-a2a95b353806"],
Cell[CellGroupData[{
Cell[145210, 3640, 985, 16, 22, "Input",ExpressionUUID->"e2542733-7dd8-41c2-8dc1-6d99dbfa40ed"],
Cell[146198, 3658, 1180, 20, 25, "Output",ExpressionUUID->"4697311c-7471-4195-99f8-fc01fc5b03f7"]
}, Open  ]],
Cell[147393, 3681, 818, 12, 27, "Text",ExpressionUUID->"9bc48efb-dd58-4c09-b60f-c5bc565f0356"],
Cell[CellGroupData[{
Cell[148236, 3697, 1043, 16, 22, "Input",ExpressionUUID->"7b9179b9-68f8-430f-8c3a-c8e7d8fca182"],
Cell[149282, 3715, 1177, 19, 27, "Output",ExpressionUUID->"4c0861dd-2b51-42a6-86f6-5b96ed93ba20"]
}, Open  ]],
Cell[150474, 3737, 822, 12, 27, "Text",ExpressionUUID->"4cc8b2bc-b56f-4ce1-afde-5c3f393e2c87"],
Cell[CellGroupData[{
Cell[151321, 3753, 1096, 17, 22, "Input",ExpressionUUID->"747e55c5-d744-4975-a6cd-8daf63e7b6ed"],
Cell[152420, 3772, 1218, 21, 25, "Output",ExpressionUUID->"1e4ba054-881b-4efe-ac5a-95658eb7350c"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[153699, 3800, 318, 5, 41, "Subsection",ExpressionUUID->"68880009-9547-4a24-954e-176de4ce29a1"],
Cell[154020, 3807, 1618, 49, 118, "Input",ExpressionUUID->"629978f8-fc58-4714-a00e-a67182e10b53"],
Cell[155641, 3858, 28108, 616, 795, "Input",ExpressionUUID->"2588765e-80a2-4369-80f2-2092842678c1"],
Cell[CellGroupData[{
Cell[183774, 4478, 247, 5, 22, "Input",ExpressionUUID->"3873e1df-8570-4c17-8be9-62b580b8b741"],
Cell[184024, 4485, 9079, 144, 285, "Output",ExpressionUUID->"0c347aa3-3de1-4c4a-aa8e-03729700ca33"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[193152, 4635, 381, 6, 41, "Subsection",ExpressionUUID->"4f8172c0-762e-4933-8189-9f0549b7f73f"],
Cell[193536, 4643, 42538, 929, 1183, "Input",ExpressionUUID->"52ec8139-983f-4847-9e3f-3c6b9960063a"],
Cell[CellGroupData[{
Cell[236099, 5576, 189, 3, 22, "Input",ExpressionUUID->"0247c18d-7dc9-41c4-b8b3-7f37ce18f56e"],
Cell[236291, 5581, 5575, 96, 147, "Output",ExpressionUUID->"2e6e1ca0-d217-49e3-97d0-b4440bf384fa"]
}, Open  ]],
Cell[CellGroupData[{
Cell[241903, 5682, 3341, 85, 99, "Input",ExpressionUUID->"71dec529-953c-4148-9a58-1472c78421c7"],
Cell[245247, 5769, 5759, 90, 147, "Output",ExpressionUUID->"c2383920-0995-4700-b60c-11f2cdf4eb8e"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}
]
*)

