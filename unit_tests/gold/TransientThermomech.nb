(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    418252,       9794]
NotebookOptionsPosition[    405832,       9578]
NotebookOutlinePosition[    406434,       9599]
CellTagsIndexPosition[    406391,       9596]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Definitions for linear transient thermomech:", "Title",
 CellChangeTimes->{{3.7227097911277695`*^9, 3.7227098092418723`*^9}, {
  3.763392097019563*^9, 3.7633920975064383`*^9}, {3.7647613439397774`*^9, 
  3.764761353568443*^9}},ExpressionUUID->"771e95de-c1e0-4cb0-b95b-\
188d71903383"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ConductionCoeff", "=", "1000.0"}], ";"}]], "Input",
 CellChangeTimes->{{3.717159762670228*^9, 3.717159772862687*^9}, 
   3.7171704577284317`*^9, {3.7173671489361877`*^9, 3.717367156764295*^9}, {
   3.906645800149747*^9, 3.9066458087790747`*^9}, 3.906730899979998*^9, {
   3.906741567745932*^9, 3.9067416067466393`*^9}, {3.9068147553469276`*^9, 
   3.9068147998511467`*^9}, {3.906823101652835*^9, 3.9068231031466703`*^9}},
 CellLabel->"In[9]:=",ExpressionUUID->"e60664fb-ad25-4fbd-8f55-21a63ccade1e"],

Cell[CellGroupData[{

Cell["Define Tri3 basis functions in parent coordinates \
(\[Xi],\[Psi],\[Zeta]):", "Subsection",
 CellChangeTimes->{{3.717170430098735*^9, 3.717170455794014*^9}, {
  3.717367163060734*^9, 
  3.717367164420561*^9}},ExpressionUUID->"4a7a747f-5137-48e0-801e-\
adfd224e3d96"],

Cell[BoxData[
 RowBox[{
  RowBox[{"\[Phi]s", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"1", "-", "\[Xi]", "-", "\[Psi]", "-", "\[Zeta]"}], ",", "\[Xi]",
      ",", "\[Psi]", ",", "\[Zeta]"}], "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.717159762670228*^9, 3.717159772862687*^9}, 
   3.7171704577284317`*^9, {3.7173671489361877`*^9, 3.717367156764295*^9}, {
   3.906645800149747*^9, 3.9066458087790747`*^9}, 3.906730899979998*^9, {
   3.9068220075060673`*^9, 3.906822015178163*^9}},
 CellLabel->"In[10]:=",ExpressionUUID->"fc9a7eb8-3e91-40c3-b7be-38c80e7f0144"]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "Define local nodal coordinate arrays, X, Y, and Z, and compute the \
position, ",
 Cell[BoxData[
  FormBox[
   RowBox[{"x", " ", "=", 
    RowBox[{"\[Sum]", 
     RowBox[{
      RowBox[{
       SubscriptBox["\[Phi]", "I"], "[", 
       RowBox[{"\[Xi]", ",", "\[Psi]", ",", "\[Zeta]"}], "]"}], 
      SubscriptBox["X", "I"]}]}]}], TraditionalForm]],ExpressionUUID->
  "bcf65a1f-7912-49ab-affd-ef186db8e0be"],
 ", ",
 Cell[BoxData[
  FormBox[
   RowBox[{"y", " ", "=", " ", 
    RowBox[{"\[Sum]", 
     RowBox[{
      RowBox[{
       SubscriptBox["\[Phi]", "I"], "[", 
       RowBox[{"\[Xi]", ",", "\[Psi]", ",", "\[Zeta]"}], "]"}], 
      SubscriptBox["Y", "I"]}]}]}], TraditionalForm]],ExpressionUUID->
  "ed56e6a3-a08d-4582-812a-9cb2f0fda38d"],
 ", and  ",
 Cell[BoxData[
  FormBox[
   RowBox[{"z", " ", "=", " ", 
    RowBox[{"\[Sum]", 
     RowBox[{
      RowBox[{
       SubscriptBox["\[Phi]", "I"], "[", 
       RowBox[{"\[Xi]", ",", "\[Psi]", ",", "\[Zeta]"}], "]"}], 
      RowBox[{
       SubscriptBox["Z", "I"], ":"}]}]}]}], TraditionalForm]],ExpressionUUID->
  "3344f89a-c9b3-4c1a-adab-861ba54d8a67"]
}], "Subsection",
 CellChangeTimes->{{3.717170467034111*^9, 3.717170646080793*^9}, {
  3.7173672533732233`*^9, 3.717367296127637*^9}, {3.7173676524772353`*^9, 
  3.7173676768522606`*^9}},ExpressionUUID->"53eada42-ca3e-42bd-b0b0-\
c31c412a1992"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"X", "=", 
   RowBox[{"{", 
    RowBox[{"x1", ",", "x2", ",", "x3", ",", "x4"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Y", "=", 
   RowBox[{"{", 
    RowBox[{"y1", ",", "y2", ",", "y3", ",", "y4"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Z", "=", 
   RowBox[{"{", 
    RowBox[{"z1", ",", "z2", ",", "z3", ",", "z4"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"x", "=", 
   RowBox[{
    UnderoverscriptBox["\[Sum]", 
     RowBox[{"i", "=", "1"}], "4"], 
    RowBox[{
     RowBox[{"\[Phi]s", "[", 
      RowBox[{"[", "i", "]"}], "]"}], "*", 
     RowBox[{"X", "[", 
      RowBox[{"[", "i", "]"}], "]"}]}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"y", "=", 
   RowBox[{
    UnderoverscriptBox["\[Sum]", 
     RowBox[{"i", "=", "1"}], "4"], 
    RowBox[{
     RowBox[{"\[Phi]s", "[", 
      RowBox[{"[", "i", "]"}], "]"}], "*", 
     RowBox[{"Y", "[", 
      RowBox[{"[", "i", "]"}], "]"}]}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"z", "=", 
   RowBox[{
    UnderoverscriptBox["\[Sum]", 
     RowBox[{"i", "=", "1"}], "4"], 
    RowBox[{
     RowBox[{"\[Phi]s", "[", 
      RowBox[{"[", "i", "]"}], "]"}], "*", 
     RowBox[{"Z", "[", 
      RowBox[{"[", "i", "]"}], "]"}]}]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.716761356116639*^9, 3.71676136863325*^9}, 
   3.717159777614208*^9, {3.717367683976516*^9, 3.7173677669144773`*^9}},
 CellLabel->"In[11]:=",ExpressionUUID->"3f927f14-3a11-4830-a6a6-d270587527ba"]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "Define the Jacobian matrix, ",
 Cell[BoxData[
  FormBox[
   RowBox[{"J", "=", 
    RowBox[{
     SubscriptBox["dx", "i"], "/", 
     SubscriptBox["d\[Xi]", "j"]}]}], TraditionalForm]],ExpressionUUID->
  "6eab70d3-d3fd-4d5f-af11-3575d29813b7"],
 ":"
}], "Subsection",
 CellChangeTimes->{{3.7171706589407587`*^9, 
  3.717170706016591*^9}},ExpressionUUID->"e3834ce3-cb36-4e14-baa8-\
6f292a0d07e4"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   RowBox[{"J", "=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"D", "[", 
         RowBox[{"x", ",", "\[Xi]"}], "]"}], ",", 
        RowBox[{"D", "[", 
         RowBox[{"x", ",", "\[Psi]"}], "]"}], ",", 
        RowBox[{"D", "[", 
         RowBox[{"x", ",", "\[Zeta]"}], "]"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"D", "[", 
         RowBox[{"y", ",", "\[Xi]"}], "]"}], ",", 
        RowBox[{"D", "[", 
         RowBox[{"y", ",", "\[Psi]"}], "]"}], ",", 
        RowBox[{"D", "[", 
         RowBox[{"y", ",", "\[Zeta]"}], "]"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"D", "[", 
         RowBox[{"z", ",", "\[Xi]"}], "]"}], ",", 
        RowBox[{"D", "[", 
         RowBox[{"z", ",", "\[Psi]"}], "]"}], ",", 
        RowBox[{"D", "[", 
         RowBox[{"z", ",", "\[Zeta]"}], "]"}]}], "}"}]}], "}"}]}], ")"}], "//",
   "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.717159400798109*^9, 3.717159402472238*^9}, {
   3.7171594670820827`*^9, 3.717159481884482*^9}, {3.717159528167789*^9, 
   3.7171595453911543`*^9}, 3.717159782011516*^9, {3.7173677887268276`*^9, 
   3.7173678325554037`*^9}},
 CellLabel->"In[17]:=",ExpressionUUID->"9af17278-f128-4f02-919c-3be62331686b"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{
       RowBox[{"-", "x1"}], "+", "x2"}], 
      RowBox[{
       RowBox[{"-", "x1"}], "+", "x3"}], 
      RowBox[{
       RowBox[{"-", "x1"}], "+", "x4"}]},
     {
      RowBox[{
       RowBox[{"-", "y1"}], "+", "y2"}], 
      RowBox[{
       RowBox[{"-", "y1"}], "+", "y3"}], 
      RowBox[{
       RowBox[{"-", "y1"}], "+", "y4"}]},
     {
      RowBox[{
       RowBox[{"-", "z1"}], "+", "z2"}], 
      RowBox[{
       RowBox[{"-", "z1"}], "+", "z3"}], 
      RowBox[{
       RowBox[{"-", "z1"}], "+", "z4"}]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.7167614354761105`*^9, 3.716765302982686*^9, 3.7171556785772953`*^9, 
   3.717157543718261*^9, 3.717159484292647*^9, 3.717159565326777*^9, 
   3.717159783432115*^9, 3.717354900932816*^9, 3.7173678516174393`*^9, 
   3.717417860423373*^9, 3.720268227067238*^9, 3.720806396391696*^9, 
   3.7209936838639107`*^9, 3.721061216314333*^9, 3.723054595524909*^9, 
   3.7230546313224325`*^9, 3.723504448044764*^9, 3.7239811360514584`*^9, {
   3.7284300552303286`*^9, 3.7284300734023075`*^9}, 3.7404279872756085`*^9, 
   3.763392391210548*^9, 3.764081528224759*^9, 3.7641637936038733`*^9, 
   3.764244461510044*^9, 3.7643520598062115`*^9, 3.7643697288044987`*^9, 
   3.764696161335455*^9, 3.764761424927881*^9, 3.7656430511298003`*^9, 
   3.799600683741807*^9, 3.799608790025474*^9, 3.849378303071576*^9, 
   3.849465046665698*^9, 3.850325887515658*^9, 3.906572973499803*^9, 
   3.9066458187551613`*^9, 3.9067401694781237`*^9, 3.9067417251912746`*^9, {
   3.906741778054851*^9, 3.906741792419693*^9}, 3.906742813134838*^9, 
   3.906810147384521*^9, 3.9068107060799627`*^9, 3.906810834861745*^9, 
   3.90681498031295*^9, 3.906815108046351*^9, 3.906815353159461*^9, 
   3.9068155085585127`*^9, 3.9068158949512157`*^9, 3.906819149318451*^9, 
   3.9068210822269363`*^9, 3.906822137503935*^9, 3.9068223944258833`*^9, 
   3.9068226626247387`*^9, 3.9068231122791357`*^9, 3.9068234596419153`*^9, 
   3.907257815484212*^9},
 CellLabel->
  "Out[17]//MatrixForm=",ExpressionUUID->"cabbda43-3ff8-4da1-84a7-\
b56d08429ee2"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Define the determinant of the Jacobian:", "Subsection",
 CellChangeTimes->{{3.717170742514415*^9, 
  3.71717075277886*^9}},ExpressionUUID->"51fac0ff-1b91-4c89-9b7c-\
96ac8b6630cb"],

Cell[BoxData[
 RowBox[{
  RowBox[{"detj", "=", 
   RowBox[{"Det", "[", "J", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{3.717157550322625*^9, 3.71741786843908*^9},
 CellLabel->"In[18]:=",ExpressionUUID->"086d4aa6-523d-463b-be06-f8ec08bff819"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Define the inverse of the Jacobian:", "Subsection",
 CellChangeTimes->{{3.7171707115541143`*^9, 
  3.71717072339587*^9}},ExpressionUUID->"54dd63dc-da38-481f-95b6-\
1bb85f47dadc"],

Cell[BoxData[
 RowBox[{
  RowBox[{"InvJ", " ", "=", " ", 
   RowBox[{"Simplify", "[", " ", 
    RowBox[{"Inverse", "[", "J", "]"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{
  3.7167614674219794`*^9, 3.716762132096217*^9, 3.717157545859642*^9, 
   3.7173678815154886`*^9, {3.7173685526975317`*^9, 3.717368591121168*^9}},
 CellLabel->"In[19]:=",ExpressionUUID->"5e63601b-e173-4e5e-9cd7-7e3741f40ed1"]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "Define the derivative of the basis function wrt parent coordinates, ",
 Cell[BoxData[
  FormBox[
   RowBox[{"d\[Phi]", "/", 
    SubscriptBox["d\[Xi]", "i"]}], TraditionalForm]],ExpressionUUID->
  "6f066d02-5c8b-42c2-bc97-bb3f2720f6ae"],
 ", and wrt physical coordinates, ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"d\[Phi]", "/", 
     SubscriptBox["dx", "i"]}], "=", 
    RowBox[{"(", 
     RowBox[{"d\[Phi]", "/", 
      SubscriptBox["d\[Xi]", "k"]}]}]}], TraditionalForm]],ExpressionUUID->
  "9d97ac46-c925-4504-b22b-519da13f70c0"],
 ")( ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["d\[Xi]", "k"], "/", 
    SubscriptBox["dx", "i"]}], TraditionalForm]],ExpressionUUID->
  "30541f9b-17f8-4195-9aea-fe4c8295c2ca"],
 "):"
}], "Subsection",
 CellChangeTimes->{{3.717170774772771*^9, 
  3.7171709274438047`*^9}},ExpressionUUID->"91f33a9d-5463-42e5-937f-\
abaa5c2812d5"],

Cell[BoxData[
 RowBox[{
  RowBox[{"D\[Phi]D\[Xi]", "=", 
   RowBox[{"Transpose", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"D", "[", 
       RowBox[{"\[Phi]s", ",", "\[Xi]"}], "]"}], ",", 
      RowBox[{"D", "[", 
       RowBox[{"\[Phi]s", ",", "\[Psi]"}], "]"}], ",", 
      RowBox[{"D", "[", 
       RowBox[{"\[Phi]s", ",", "\[Zeta]"}], "]"}]}], "}"}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.716762040827201*^9, 3.7167620550573683`*^9}, {
   3.7167622782753077`*^9, 3.7167622879320135`*^9}, {3.717159585262508*^9, 
   3.7171596049010277`*^9}, 3.717170767862856*^9, {3.7173679090158405`*^9, 
   3.7173679140631857`*^9}},
 CellLabel->"In[20]:=",ExpressionUUID->"18dc3d08-39a5-49ed-b484-e1462a1e5703"],

Cell[BoxData[
 RowBox[{
  RowBox[{"D\[Phi]Dx", "=", 
   RowBox[{"Simplify", "[", 
    RowBox[{"Transpose", "[", 
     RowBox[{"D\[Phi]D\[Xi]", ".", "InvJ"}], "]"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.7167620697517557`*^9, 3.7167621221822166`*^9}, {
  3.7167623794326005`*^9, 3.7167624191349125`*^9}, {3.717159618780408*^9, 
  3.717159620088848*^9}, {3.7171599769229116`*^9, 3.717159996771841*^9}, {
  3.717170940753901*^9, 3.7171709490170727`*^9}, {3.7171709936534357`*^9, 
  3.717171005961763*^9}, {3.7173600965536957`*^9, 3.717360100742365*^9}, {
  3.7173685313367987`*^9, 3.7173685371065826`*^9}, {3.7173686082063704`*^9, 
  3.717368609587582*^9}, {3.717417891626897*^9, 3.717417893049127*^9}},
 CellLabel->"In[21]:=",ExpressionUUID->"db5ba82c-c666-484b-990e-75c1bea963ae"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Define the gradient matrix:", "Subsection",
 CellChangeTimes->{{3.7171710170541*^9, 
  3.717171027281568*^9}},ExpressionUUID->"a4634761-5f01-4334-8928-\
a93cfab6a12e"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"B", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"D\[Phi]Dx", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "[", 
        RowBox[{"[", "1", "]"}], "]"}], ",", "0", ",", "0", ",", 
       RowBox[{
        RowBox[{"D\[Phi]Dx", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "[", 
        RowBox[{"[", "2", "]"}], "]"}], ",", "0", ",", "0", ",", 
       RowBox[{
        RowBox[{"D\[Phi]Dx", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "[", 
        RowBox[{"[", "3", "]"}], "]"}], ",", "0", ",", "0", ",", 
       RowBox[{
        RowBox[{"D\[Phi]Dx", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "[", 
        RowBox[{"[", "4", "]"}], "]"}], ",", "0", ",", "0"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"0", ",", 
       RowBox[{
        RowBox[{"D\[Phi]Dx", "[", 
         RowBox[{"[", "2", "]"}], "]"}], "[", 
        RowBox[{"[", "1", "]"}], "]"}], ",", "0", ",", "0", ",", 
       RowBox[{
        RowBox[{"D\[Phi]Dx", "[", 
         RowBox[{"[", "2", "]"}], "]"}], "[", 
        RowBox[{"[", "2", "]"}], "]"}], ",", "0", ",", "0", ",", 
       RowBox[{
        RowBox[{"D\[Phi]Dx", "[", 
         RowBox[{"[", "2", "]"}], "]"}], "[", 
        RowBox[{"[", "3", "]"}], "]"}], ",", "0", ",", "0", ",", 
       RowBox[{
        RowBox[{"D\[Phi]Dx", "[", 
         RowBox[{"[", "2", "]"}], "]"}], "[", 
        RowBox[{"[", "4", "]"}], "]"}], ",", "0"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", 
       RowBox[{
        RowBox[{"D\[Phi]Dx", "[", 
         RowBox[{"[", "3", "]"}], "]"}], "[", 
        RowBox[{"[", "1", "]"}], "]"}], ",", "0", ",", "0", ",", 
       RowBox[{
        RowBox[{"D\[Phi]Dx", "[", 
         RowBox[{"[", "3", "]"}], "]"}], "[", 
        RowBox[{"[", "2", "]"}], "]"}], ",", "0", ",", "0", ",", 
       RowBox[{
        RowBox[{"D\[Phi]Dx", "[", 
         RowBox[{"[", "3", "]"}], "]"}], "[", 
        RowBox[{"[", "3", "]"}], "]"}], ",", "0", ",", "0", ",", 
       RowBox[{
        RowBox[{"D\[Phi]Dx", "[", 
         RowBox[{"[", "3", "]"}], "]"}], "[", 
        RowBox[{"[", "4", "]"}], "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"0", ",", 
       RowBox[{
        RowBox[{"D\[Phi]Dx", "[", 
         RowBox[{"[", "3", "]"}], "]"}], "[", 
        RowBox[{"[", "1", "]"}], "]"}], ",", 
       RowBox[{
        RowBox[{"D\[Phi]Dx", "[", 
         RowBox[{"[", "2", "]"}], "]"}], "[", 
        RowBox[{"[", "1", "]"}], "]"}], ",", "0", ",", 
       RowBox[{
        RowBox[{"D\[Phi]Dx", "[", 
         RowBox[{"[", "3", "]"}], "]"}], "[", 
        RowBox[{"[", "2", "]"}], "]"}], ",", 
       RowBox[{
        RowBox[{"D\[Phi]Dx", "[", 
         RowBox[{"[", "2", "]"}], "]"}], "[", 
        RowBox[{"[", "2", "]"}], "]"}], ",", "0", ",", 
       RowBox[{
        RowBox[{"D\[Phi]Dx", "[", 
         RowBox[{"[", "3", "]"}], "]"}], "[", 
        RowBox[{"[", "3", "]"}], "]"}], ",", 
       RowBox[{
        RowBox[{"D\[Phi]Dx", "[", 
         RowBox[{"[", "2", "]"}], "]"}], "[", 
        RowBox[{"[", "3", "]"}], "]"}], ",", "0", ",", 
       RowBox[{
        RowBox[{"D\[Phi]Dx", "[", 
         RowBox[{"[", "3", "]"}], "]"}], "[", 
        RowBox[{"[", "4", "]"}], "]"}], ",", 
       RowBox[{
        RowBox[{"D\[Phi]Dx", "[", 
         RowBox[{"[", "2", "]"}], "]"}], "[", 
        RowBox[{"[", "4", "]"}], "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"D\[Phi]Dx", "[", 
         RowBox[{"[", "3", "]"}], "]"}], "[", 
        RowBox[{"[", "1", "]"}], "]"}], ",", "0", ",", 
       RowBox[{
        RowBox[{"D\[Phi]Dx", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "[", 
        RowBox[{"[", "1", "]"}], "]"}], ",", 
       RowBox[{
        RowBox[{"D\[Phi]Dx", "[", 
         RowBox[{"[", "3", "]"}], "]"}], "[", 
        RowBox[{"[", "2", "]"}], "]"}], ",", "0", ",", 
       RowBox[{
        RowBox[{"D\[Phi]Dx", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "[", 
        RowBox[{"[", "2", "]"}], "]"}], ",", 
       RowBox[{
        RowBox[{"D\[Phi]Dx", "[", 
         RowBox[{"[", "3", "]"}], "]"}], "[", 
        RowBox[{"[", "3", "]"}], "]"}], ",", "0", ",", 
       RowBox[{
        RowBox[{"D\[Phi]Dx", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "[", 
        RowBox[{"[", "3", "]"}], "]"}], ",", 
       RowBox[{
        RowBox[{"D\[Phi]Dx", "[", 
         RowBox[{"[", "3", "]"}], "]"}], "[", 
        RowBox[{"[", "4", "]"}], "]"}], ",", "0", ",", 
       RowBox[{
        RowBox[{"D\[Phi]Dx", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "[", 
        RowBox[{"[", "4", "]"}], "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"D\[Phi]Dx", "[", 
         RowBox[{"[", "2", "]"}], "]"}], "[", 
        RowBox[{"[", "1", "]"}], "]"}], ",", 
       RowBox[{
        RowBox[{"D\[Phi]Dx", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "[", 
        RowBox[{"[", "1", "]"}], "]"}], ",", "0", ",", 
       RowBox[{
        RowBox[{"D\[Phi]Dx", "[", 
         RowBox[{"[", "2", "]"}], "]"}], "[", 
        RowBox[{"[", "2", "]"}], "]"}], ",", 
       RowBox[{
        RowBox[{"D\[Phi]Dx", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "[", 
        RowBox[{"[", "2", "]"}], "]"}], ",", "0", ",", 
       RowBox[{
        RowBox[{"D\[Phi]Dx", "[", 
         RowBox[{"[", "2", "]"}], "]"}], "[", 
        RowBox[{"[", "3", "]"}], "]"}], ",", 
       RowBox[{
        RowBox[{"D\[Phi]Dx", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "[", 
        RowBox[{"[", "3", "]"}], "]"}], ",", "0", ",", 
       RowBox[{
        RowBox[{"D\[Phi]Dx", "[", 
         RowBox[{"[", "2", "]"}], "]"}], "[", 
        RowBox[{"[", "4", "]"}], "]"}], ",", 
       RowBox[{
        RowBox[{"D\[Phi]Dx", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "[", 
        RowBox[{"[", "4", "]"}], "]"}], ",", "0"}], "}"}]}], 
    "\[IndentingNewLine]", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"b", "=", "D\[Phi]Dx"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"zeros", " ", "=", " ", 
   RowBox[{"Table", "[", 
    RowBox[{"0.0", ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", "4"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Nb", "=", 
   RowBox[{"{", 
    RowBox[{
    "\[Phi]s", ",", "\[Phi]s", ",", "\[Phi]s", ",", "zeros", ",", "zeros", 
     ",", "zeros"}], "}"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.7173602746482644`*^9, 3.717360595407016*^9}, {
  3.7173679545623984`*^9, 3.717368016994071*^9}, {3.7173686738090096`*^9, 
  3.7173688008877954`*^9}, {3.717369134558451*^9, 3.7173691870734324`*^9}, {
  3.717415750201002*^9, 3.7174157973412743`*^9}, {3.7174158656066456`*^9, 
  3.717415993127372*^9}, {3.7174178972678013`*^9, 3.717417921642746*^9}, {
  3.7633923206598988`*^9, 3.7633923613791695`*^9}, {3.7633966157541084`*^9, 
  3.763396628163429*^9}, {3.7633967128971925`*^9, 3.7633967314679966`*^9}, {
  3.763398562028678*^9, 3.7633986048635654`*^9}},
 CellLabel->"In[22]:=",ExpressionUUID->"e6750456-352d-4b51-b4b9-61e222a811e1"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Define a stiffness tensor:", "Subsection",
 CellChangeTimes->{{3.717171037170329*^9, 
  3.717171055154701*^9}},ExpressionUUID->"3b966684-148f-4354-b993-\
32ea79514c3a"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"(", 
   RowBox[{"S", "=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         FractionBox["kv", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "+", "vv"}], ")"}], 
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"2", " ", "vv"}]}], ")"}]}]], 
         RowBox[{"(", 
          RowBox[{"1", "-", "vv"}], ")"}]}], ",", 
        RowBox[{
         FractionBox["kv", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "+", "vv"}], ")"}], 
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"2", " ", "vv"}]}], ")"}]}]], " ", "vv"}], ",", 
        RowBox[{
         FractionBox["kv", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "+", "vv"}], ")"}], 
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"2", " ", "vv"}]}], ")"}]}]], " ", "vv"}], ",", "0", ",",
         "0", ",", "0"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         FractionBox["kv", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "+", "vv"}], ")"}], 
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"2", " ", "vv"}]}], ")"}]}]], " ", "vv"}], ",", 
        RowBox[{
         FractionBox["kv", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "+", "vv"}], ")"}], 
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"2", " ", "vv"}]}], ")"}]}]], " ", 
         RowBox[{"(", 
          RowBox[{"1", "-", "vv"}], ")"}]}], ",", 
        RowBox[{
         FractionBox["kv", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "+", "vv"}], ")"}], 
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"2", " ", "vv"}]}], ")"}]}]], " ", "vv"}], ",", "0", ",",
         "0", ",", "0"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         FractionBox["kv", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "+", "vv"}], ")"}], 
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"2", " ", "vv"}]}], ")"}]}]], " ", "vv"}], ",", 
        RowBox[{
         FractionBox["kv", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "+", "vv"}], ")"}], 
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"2", " ", "vv"}]}], ")"}]}]], " ", "vv"}], ",", 
        RowBox[{
         FractionBox["kv", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "+", "vv"}], ")"}], 
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"2", " ", "vv"}]}], ")"}]}]], " ", 
         RowBox[{"(", 
          RowBox[{"1", "-", "vv"}], ")"}]}], ",", "0", ",", "0", ",", "0"}], 
       "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "0", ",", 
        RowBox[{
         RowBox[{"1", "/", "2"}], " ", 
         FractionBox["kv", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "+", "vv"}], ")"}], 
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"2", " ", "vv"}]}], ")"}]}]], " ", 
         RowBox[{"(", 
          RowBox[{"1", "-", 
           RowBox[{"2", " ", "vv"}]}], ")"}]}], ",", "0", ",", "0"}], "}"}], 
      ",", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", 
        RowBox[{
         RowBox[{"1", "/", "2"}], " ", 
         FractionBox["kv", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "+", "vv"}], ")"}], 
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"2", " ", "vv"}]}], ")"}]}]], " ", 
         RowBox[{"(", 
          RowBox[{"1", "-", 
           RowBox[{"2", " ", "vv"}]}], ")"}]}], ",", "0"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
        RowBox[{
         RowBox[{"1", "/", "2"}], " ", 
         FractionBox["kv", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "+", "vv"}], ")"}], 
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"2", " ", "vv"}]}], ")"}]}]], " ", 
         RowBox[{"(", 
          RowBox[{"1", "-", 
           RowBox[{"2", " ", "vv"}]}], ")"}]}]}], "}"}]}], "}"}]}], ")"}], "//",
   "MatrixForm"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(", 
   RowBox[{"s", "=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"\[Mu]", ",", "0", ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "\[Mu]", ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "\[Mu]"}], "}"}]}], "}"}]}], ")"}], "//", 
  "MatrixForm"}]}], "Input",
 CellChangeTimes->{{3.7167628480497184`*^9, 3.716762972237756*^9}, {
   3.716763132980883*^9, 3.7167631890087504`*^9}, {3.717157475771058*^9, 
   3.717157528260871*^9}, {3.7174160414866905`*^9, 3.717416148690319*^9}, 
   3.7633924265623446`*^9, 3.763392465685731*^9, {3.763393084507081*^9, 
   3.7633930846862936`*^9}, {3.9067402076754837`*^9, 3.906740207833951*^9}, {
   3.906740314163941*^9, 3.906740315492401*^9}, {3.906741768843678*^9, 
   3.906741785690715*^9}},
 CellLabel->"In[26]:=",ExpressionUUID->"56bef7e8-9c24-4c0a-bc52-38851c79f249"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      FractionBox[
       RowBox[{"kv", " ", 
        RowBox[{"(", 
         RowBox[{"1", "-", "vv"}], ")"}]}], 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "-", 
          RowBox[{"2", " ", "vv"}]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{"1", "+", "vv"}], ")"}]}]], 
      FractionBox[
       RowBox[{"kv", " ", "vv"}], 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "-", 
          RowBox[{"2", " ", "vv"}]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{"1", "+", "vv"}], ")"}]}]], 
      FractionBox[
       RowBox[{"kv", " ", "vv"}], 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "-", 
          RowBox[{"2", " ", "vv"}]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{"1", "+", "vv"}], ")"}]}]], "0", "0", "0"},
     {
      FractionBox[
       RowBox[{"kv", " ", "vv"}], 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "-", 
          RowBox[{"2", " ", "vv"}]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{"1", "+", "vv"}], ")"}]}]], 
      FractionBox[
       RowBox[{"kv", " ", 
        RowBox[{"(", 
         RowBox[{"1", "-", "vv"}], ")"}]}], 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "-", 
          RowBox[{"2", " ", "vv"}]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{"1", "+", "vv"}], ")"}]}]], 
      FractionBox[
       RowBox[{"kv", " ", "vv"}], 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "-", 
          RowBox[{"2", " ", "vv"}]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{"1", "+", "vv"}], ")"}]}]], "0", "0", "0"},
     {
      FractionBox[
       RowBox[{"kv", " ", "vv"}], 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "-", 
          RowBox[{"2", " ", "vv"}]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{"1", "+", "vv"}], ")"}]}]], 
      FractionBox[
       RowBox[{"kv", " ", "vv"}], 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "-", 
          RowBox[{"2", " ", "vv"}]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{"1", "+", "vv"}], ")"}]}]], 
      FractionBox[
       RowBox[{"kv", " ", 
        RowBox[{"(", 
         RowBox[{"1", "-", "vv"}], ")"}]}], 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "-", 
          RowBox[{"2", " ", "vv"}]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{"1", "+", "vv"}], ")"}]}]], "0", "0", "0"},
     {"0", "0", "0", 
      FractionBox["kv", 
       RowBox[{"2", " ", 
        RowBox[{"(", 
         RowBox[{"1", "+", "vv"}], ")"}]}]], "0", "0"},
     {"0", "0", "0", "0", 
      FractionBox["kv", 
       RowBox[{"2", " ", 
        RowBox[{"(", 
         RowBox[{"1", "+", "vv"}], ")"}]}]], "0"},
     {"0", "0", "0", "0", "0", 
      FractionBox["kv", 
       RowBox[{"2", " ", 
        RowBox[{"(", 
         RowBox[{"1", "+", "vv"}], ")"}]}]]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.7167631923698587`*^9, 3.7167653124350247`*^9, 3.7171556932721453`*^9, 
   3.7171575626207314`*^9, 3.717354914858255*^9, 3.7174161523932776`*^9, 
   3.7174179645333047`*^9, 3.7202682431217527`*^9, 3.7208064571168013`*^9, 
   3.7209937026548615`*^9, 3.721061236237527*^9, 3.7230546566345525`*^9, 
   3.7235044904828486`*^9, 3.7239811456939864`*^9, 3.728430083293228*^9, 
   3.740427997507474*^9, 3.763392468295323*^9, 3.7633930861798077`*^9, 
   3.764081540006856*^9, 3.764163803141763*^9, 3.7642444712672567`*^9, 
   3.764352075263568*^9, 3.7643697453138475`*^9, 3.7646961810497456`*^9, 
   3.7647614525609045`*^9, 3.765643068959093*^9, 3.799600699165503*^9, 
   3.799608805612033*^9, 3.849378316857614*^9, 3.849465060793289*^9, 
   3.850325887860385*^9, 3.9065729858169813`*^9, 3.9066458296993523`*^9, 
   3.906740169783984*^9, 3.906741725396392*^9, {3.9067417781885223`*^9, 
   3.906741792595674*^9}, 3.90674281320855*^9, 3.906810147527584*^9, 
   3.906810706188285*^9, 3.906810834939817*^9, 3.90681498058289*^9, 
   3.906815108137882*^9, 3.906815353240713*^9, 3.906815513014402*^9, 
   3.906815895258749*^9, 3.906819149665144*^9, 3.9068210825204697`*^9, 
   3.906822137999303*^9, 3.9068223945695133`*^9, 3.906822662791733*^9, 
   3.906823112438547*^9, 3.906823460597575*^9, 3.907257815663349*^9},
 CellLabel->
  "Out[26]//MatrixForm=",ExpressionUUID->"db0fefa6-3f14-48b1-9d0d-\
09c9c984185e"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"\[Mu]", "0", "0"},
     {"0", "\[Mu]", "0"},
     {"0", "0", "\[Mu]"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.7167631923698587`*^9, 3.7167653124350247`*^9, 3.7171556932721453`*^9, 
   3.7171575626207314`*^9, 3.717354914858255*^9, 3.7174161523932776`*^9, 
   3.7174179645333047`*^9, 3.7202682431217527`*^9, 3.7208064571168013`*^9, 
   3.7209937026548615`*^9, 3.721061236237527*^9, 3.7230546566345525`*^9, 
   3.7235044904828486`*^9, 3.7239811456939864`*^9, 3.728430083293228*^9, 
   3.740427997507474*^9, 3.763392468295323*^9, 3.7633930861798077`*^9, 
   3.764081540006856*^9, 3.764163803141763*^9, 3.7642444712672567`*^9, 
   3.764352075263568*^9, 3.7643697453138475`*^9, 3.7646961810497456`*^9, 
   3.7647614525609045`*^9, 3.765643068959093*^9, 3.799600699165503*^9, 
   3.799608805612033*^9, 3.849378316857614*^9, 3.849465060793289*^9, 
   3.850325887860385*^9, 3.9065729858169813`*^9, 3.9066458296993523`*^9, 
   3.906740169783984*^9, 3.906741725396392*^9, {3.9067417781885223`*^9, 
   3.906741792595674*^9}, 3.90674281320855*^9, 3.906810147527584*^9, 
   3.906810706188285*^9, 3.906810834939817*^9, 3.90681498058289*^9, 
   3.906815108137882*^9, 3.906815353240713*^9, 3.906815513014402*^9, 
   3.906815895258749*^9, 3.906819149665144*^9, 3.9068210825204697`*^9, 
   3.906822137999303*^9, 3.9068223945695133`*^9, 3.906822662791733*^9, 
   3.906823112438547*^9, 3.906823460597575*^9, 3.907257815665065*^9},
 CellLabel->
  "Out[27]//MatrixForm=",ExpressionUUID->"cf8cc942-cef3-4f01-a497-\
a634d3644b78"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Define the local stiffness matrix (Note that the absolute value of the \
Jacobian determinant is used.  The mesh from omega_h can have inside out \
elements.):\
\>", "Subsection",
 CellChangeTimes->{{3.7171710837254143`*^9, 3.717171091066893*^9}, {
  3.7174287074048176`*^9, 
  3.7174287551552706`*^9}},ExpressionUUID->"7f2325a2-777e-49ff-88ec-\
91efc948f3c4"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Kmm", "[", 
    RowBox[{
    "x1_", ",", "y1_", ",", "z1_", ",", "x2_", ",", "y2_", ",", "z2_", ",", 
     "x3_", ",", "y3_", ",", "z3_", ",", "x4_", ",", "y4_", ",", "z4_", ",", 
     "kv_", ",", "vv_"}], "]"}], "=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"Transpose", "[", "B", "]"}], ".", "S", ".", "B"}], ")"}], 
    RowBox[{"Abs", "[", "detj", "]"}]}]}], " ", ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"KmmmNoDet", "[", 
    RowBox[{
    "x1_", ",", "y1_", ",", "z1_", ",", "x2_", ",", "y2_", ",", "z2_", ",", 
     "x3_", ",", "y3_", ",", "z3_", ",", "x4_", ",", "y4_", ",", "z4_", ",", 
     "kv_", ",", "vv_"}], "]"}], "=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"Transpose", "[", "B", "]"}], ".", "S", ".", "B"}], ")"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"KmmNoAbs", "[", 
    RowBox[{
    "x1_", ",", "y1_", ",", "z1_", ",", "x2_", ",", "y2_", ",", "z2_", ",", 
     "x3_", ",", "y3_", ",", "z3_", ",", "x4_", ",", "y4_", ",", "z4_", ",", 
     "kv_", ",", "vv_"}], "]"}], "=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"Transpose", "[", "B", "]"}], ".", "S", ".", "B"}], ")"}], 
    "detj"}]}], " ", ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Detj", "[", 
    RowBox[{
    "x1_", ",", "y1_", ",", "z1_", ",", "x2_", ",", "y2_", ",", "z2_", ",", 
     "x3_", ",", "y3_", ",", "z3_", ",", "x4_", ",", "y4_", ",", "z4_"}], 
    "]"}], "=", "detj"}], " ", ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Gmatrix", "[", 
    RowBox[{
    "x1_", ",", "y1_", ",", "z1_", ",", "x2_", ",", "y2_", ",", "z2_", ",", 
     "x3_", ",", "y3_", ",", "z3_", ",", "x4_", ",", "y4_", ",", "z4_"}], 
    "]"}], "=", "B"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ktt", "[", 
    RowBox[{
    "x1_", ",", "y1_", ",", "z1_", ",", "x2_", ",", "y2_", ",", "z2_", ",", 
     "x3_", ",", "y3_", ",", "z3_", ",", "x4_", ",", "y4_", ",", "z4_", ",", 
     "\[Mu]_"}], "]"}], "=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"Transpose", "[", "b", "]"}], ".", "s", ".", "b"}], ")"}], 
    RowBox[{"Abs", "[", "detj", "]"}]}]}], " ", ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"kttNoDet", "[", 
    RowBox[{
    "x1_", ",", "y1_", ",", "z1_", ",", "x2_", ",", "y2_", ",", "z2_", ",", 
     "x3_", ",", "y3_", ",", "z3_", ",", "x4_", ",", "y4_", ",", "z4_", ",", 
     "\[Mu]_"}], "]"}], "=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"Transpose", "[", "b", "]"}], ".", "s", ".", "b"}], ")"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"kttNoAbs", "[", 
    RowBox[{
    "x1_", ",", "y1_", ",", "z1_", ",", "x2_", ",", "y2_", ",", "z2_", ",", 
     "x3_", ",", "y3_", ",", "z3_", ",", "x4_", ",", "y4_", ",", "z4_", ",", 
     "\[Mu]_"}], "]"}], "=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"Transpose", "[", "b", "]"}], ".", "s", ".", "b"}], ")"}], 
    "detj"}]}], " ", ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"kmt", "[", 
    RowBox[{
    "x1_", ",", "y1_", ",", "z1_", ",", "x2_", ",", "y2_", ",", "z2_", ",", 
     "x3_", ",", "y3_", ",", "z3_", ",", "x4_", ",", "y4_", ",", "z4_", ",", 
     "\[Alpha]_", ",", "kv_", ",", "vv_"}], "]"}], "=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"Transpose", "[", "B", "]"}], ".", "S", ".", 
      RowBox[{"(", 
       RowBox[{"\[Alpha]", " ", "Nb"}], ")"}]}], ")"}], 
    RowBox[{"Abs", "[", "detj", "]"}]}]}], " ", ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"kmtNoDet", "[", 
    RowBox[{
    "x1_", ",", "y1_", ",", "z1_", ",", "x2_", ",", "y2_", ",", "z2_", ",", 
     "x3_", ",", "y3_", ",", "z3_", ",", "x4_", ",", "y4_", ",", "z4_", ",", 
     "\[Alpha]_", ",", "kv_", ",", "vv_"}], "]"}], "=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"Transpose", "[", "B", "]"}], ".", "S", ".", 
     RowBox[{"(", 
      RowBox[{"\[Alpha]", " ", "Nb"}], ")"}]}], ")"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"kmtNoAbs", "[", 
    RowBox[{
    "x1_", ",", "y1_", ",", "z1_", ",", "x2_", ",", "y2_", ",", "z2_", ",", 
     "x3_", ",", "y3_", ",", "z3_", ",", "x4_", ",", "y4_", ",", "z4_", ",", 
     "\[Alpha]_", ",", "kv_", ",", "vv_"}], "]"}], "=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"Transpose", "[", "B", "]"}], ".", "S", ".", 
      RowBox[{"(", 
       RowBox[{"\[Alpha]", " ", "Nb"}], ")"}]}], ")"}], "detj"}]}], " ", 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"gmatrix", "[", 
    RowBox[{
    "x1_", ",", "y1_", ",", "z1_", ",", "x2_", ",", "y2_", ",", "z2_", ",", 
     "x3_", ",", "y3_", ",", "z3_", ",", "x4_", ",", "y4_", ",", "z4_"}], 
    "]"}], "=", "b"}], ";"}]}], "Input",
 CellChangeTimes->CompressedData["
1:eJwdylsoQ3EAx/Eh5JJkMm2mbNRmYiEeLDo1IrMwhcWDy5jQSIlcHimkkGu5
FFpJQlFyeWDCconmMmoKuZ0zRbm0l+P/Ow+/Pv3qG1Fuyje483i8cDKoGfhb
kq/QVDZrXoMTbuwRjPcRWOHH77kNilvX7bDytU78TrReDnPuN+3JID+aL4ed
2ZFxMHcymTNH8lQMEyUWPWQEI1PGVZpyjqdNw4v0zK4a4qNF2AMLdEXjtcSA
qw3OkPAMkWKbpoxhTs7ONlcK7B8dUsGg2OcS+KUcKIWHCbP1ULJU1Qi1Z4Xz
UHjiMnP9hMeb5w5NzQjoD+gYGxJ4EUfG+KFQcVwt1RGfZLZIWJE6dfhNZO3B
VqjO844V+jKUQdmdBH92+9RwTu2eBaPNg/kiYpLSUw+bOg7+4M3nsgveBk+z
UCs/5Wy5DQwKIz5oI0Jhjy6BJyZqVAYv+LK/aajzY6i7+2sj3HJoTDAmytjA
/TJpy7o/Qz2bKc5e2WI7VC00d8B/CNfrwA==
  "],
 CellLabel->"In[28]:=",ExpressionUUID->"fc7cdb0c-6834-415f-9be9-95db28b285b9"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"nnodes", "=", "4"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"nmdofs", "=", "3"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ntdofs", "=", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ndofs", "=", 
   RowBox[{"nmdofs", "+", "ntdofs"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.720277340993009*^9, 3.72027737961343*^9}, {
  3.7202774283513937`*^9, 3.7202774293658648`*^9}, {3.720278067092781*^9, 
  3.720278074392303*^9}, {3.764761576482154*^9, 3.7647615869027395`*^9}, {
  3.7656431414876575`*^9, 3.765643145187323*^9}, {3.7656432037814827`*^9, 
  3.7656432102505865`*^9}, {3.8494651176672707`*^9, 3.8494651193085833`*^9}, {
  3.9065730643797493`*^9, 3.906573105124484*^9}},
 CellLabel->"In[40]:=",ExpressionUUID->"a9dd6fc3-97c0-491e-8c8b-d90dc15a4001"],

Cell[CellGroupData[{

Cell["Single point Quadrature", "Subsubsection",
 CellChangeTimes->{{3.901300298846011*^9, 
  3.901300305531529*^9}},ExpressionUUID->"28e601ce-bfae-4e94-b74f-\
ec7ecd125c77"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"gp", "=", 
   RowBox[{"{", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"1", "/", "4"}], ",", 
      RowBox[{"1", "/", "4"}], ",", 
      RowBox[{"1", "/", "4"}]}], "}"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"gw", "=", 
   RowBox[{"{", 
    RowBox[{"1", "/", "6"}], "}"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.720277340993009*^9, 3.72027737961343*^9}, {
  3.7202774283513937`*^9, 3.7202774293658648`*^9}, {3.720278067092781*^9, 
  3.720278074392303*^9}, {3.9013003087402983`*^9, 3.9013003179906597`*^9}},
 CellLabel->"In[44]:=",ExpressionUUID->"36bc45a4-325a-4aa4-84ef-372a151833d7"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Four point quadrature", "Subsubsection",
 CellChangeTimes->{{3.901209491742765*^9, 
  3.901209494857337*^9}},ExpressionUUID->"4262d29f-7535-4693-9364-\
d166d121a7b6"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"gp", " ", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "0.585410196624969", ",", " ", "0.138196601125011", ",", " ", 
       "0.138196601125011"}], "}"}], ",", "\n", "           ", 
     RowBox[{"{", 
      RowBox[{
      "0.138196601125011", ",", " ", "0.585410196624969", ",", " ", 
       "0.138196601125011"}], "}"}], ",", "\n", "           ", 
     RowBox[{"{", 
      RowBox[{
      "0.138196601125011", ",", " ", "0.138196601125011", ",", " ", 
       "0.585410196624969"}], "}"}], ",", "\n", "          ", 
     RowBox[{"{", 
      RowBox[{
      "0.138196601125011", ",", " ", "0.138196601125011", ",", " ", 
       "0.138196601125011"}], "}"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"gw", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"1", "/", "24"}], ",", 
     RowBox[{"1", "/", "24"}], ",", 
     RowBox[{"1", "/", "24"}], ",", 
     RowBox[{"1", "/", "24"}]}], "}"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.720277340993009*^9, 3.72027737961343*^9}, {
  3.7202774283513937`*^9, 3.7202774293658648`*^9}, {3.720278067092781*^9, 
  3.720278074392303*^9}, {3.9012095464404793`*^9, 3.901209641848001*^9}},
 CellLabel->"In[46]:=",ExpressionUUID->"44b73894-aa8c-4485-943c-95e9a000b9a8"],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"Mmat", "[", 
      RowBox[{
      "x1_", ",", "y1_", ",", "z1_", ",", "x2_", ",", "y2_", ",", "z2_", ",", 
       "x3_", ",", "y3_", ",", "z3_", ",", "x4_", ",", "y4_", ",", "z4_", ",",
        "\[Rho]_", ",", "Cp_"}], "]"}], "=", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Transpose", "[", 
         RowBox[{"{", "\[Phi]s", "}"}], "]"}], ".", 
        RowBox[{"(", 
         RowBox[{"\[Rho]", " ", "Cp", 
          RowBox[{"{", "\[Phi]s", "}"}]}], ")"}]}], ")"}], 
      RowBox[{"Abs", "[", "detj", "]"}]}]}], " ", ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"MmatNoAbs", "[", 
      RowBox[{
      "x1_", ",", "y1_", ",", "z1_", ",", "x2_", ",", "y2_", ",", "z2_", ",", 
       "x3_", ",", "y3_", ",", "z3_", ",", "x4_", ",", "y4_", ",", "z4_", ",",
        "\[Rho]_", ",", "Cp_"}], "]"}], "=", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Transpose", "[", 
         RowBox[{"{", "\[Phi]s", "}"}], "]"}], ".", 
        RowBox[{"(", 
         RowBox[{"\[Rho]", " ", "Cp", " ", 
          RowBox[{"{", "\[Phi]s", "}"}]}], ")"}]}], ")"}], "detj"}]}], " ", 
    ";"}]}]}]], "Input",
 CellChangeTimes->{{3.9065732932127028`*^9, 3.906573322592372*^9}, {
  3.906821860648056*^9, 3.906821883264558*^9}},
 CellLabel->"In[48]:=",ExpressionUUID->"6cc1fb1f-7213-47ba-9752-e7008690a404"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Define the mesh.  This mesh is produced by the build_box function in Omega_h.\
\>", "Subsection",
 CellChangeTimes->{{3.717171103353293*^9, 3.71717112863015*^9}, {
  3.7171711761508427`*^9, 
  3.717171184346429*^9}},ExpressionUUID->"989f3063-be7b-4b8a-9a78-\
3a82814ce7c7"],

Cell[BoxData[
 RowBox[{
  RowBox[{"connect", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "12", ",", "3", ",", "13"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "3", ",", "4", ",", "13"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "4", ",", "1", ",", "13"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "1", ",", "10", ",", "13"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "10", ",", "9", ",", "13"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "9", ",", "12", ",", "13"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "13", ",", "4", ",", "14"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "4", ",", "5", ",", "14"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "5", ",", "2", ",", "14"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "2", ",", "11", ",", "14"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "11", ",", "10", ",", "14"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "10", ",", "13", ",", "14"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"3", ",", "15", ",", "6", ",", "16"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"3", ",", "6", ",", "7", ",", "16"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"3", ",", "7", ",", "4", ",", "16"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"3", ",", "4", ",", "13", ",", "16"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"3", ",", "13", ",", "12", ",", "16"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"3", ",", "12", ",", "15", ",", "16"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"4", ",", "16", ",", "7", ",", "17"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"4", ",", "7", ",", "8", ",", "17"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"4", ",", "8", ",", "5", ",", "17"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"4", ",", "5", ",", "14", ",", "17"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"4", ",", "14", ",", "13", ",", "17"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"4", ",", "13", ",", "16", ",", "17"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"9", ",", "21", ",", "12", ",", "22"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"9", ",", "12", ",", "13", ",", "22"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"9", ",", "13", ",", "10", ",", "22"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"9", ",", "10", ",", "19", ",", "22"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"9", ",", "19", ",", "18", ",", "22"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"9", ",", "18", ",", "21", ",", "22"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"10", ",", "22", ",", "13", ",", "23"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"10", ",", "13", ",", "14", ",", "23"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"10", ",", "14", ",", "11", ",", "23"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"10", ",", "11", ",", "20", ",", "23"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"10", ",", "20", ",", "19", ",", "23"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"10", ",", "19", ",", "22", ",", "23"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"12", ",", "24", ",", "15", ",", "25"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"12", ",", "15", ",", "16", ",", "25"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"12", ",", "16", ",", "13", ",", "25"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"12", ",", "13", ",", "22", ",", "25"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"12", ",", "22", ",", "21", ",", "25"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"12", ",", "21", ",", "24", ",", "25"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"13", ",", "25", ",", "16", ",", "26"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"13", ",", "16", ",", "17", ",", "26"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"13", ",", "17", ",", "14", ",", "26"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"13", ",", "14", ",", "23", ",", "26"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"13", ",", "23", ",", "22", ",", "26"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"13", ",", "22", ",", "25", ",", "26"}], "}"}]}], "}"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.7174169577864523`*^9, 3.7174169658023443`*^9}, 
   3.717417651397601*^9, {3.76409786087125*^9, 3.7640978639703207`*^9}, {
   3.7640978943425765`*^9, 3.7640978954822354`*^9}, {3.849008712370339*^9, 
   3.8490087306012497`*^9}},
 CellLabel->"In[50]:=",ExpressionUUID->"c01a37d6-773b-4d01-b998-8e2872d677f3"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"xv", "=", 
   RowBox[{"{", 
    RowBox[{
    "0.0", ",", "0.0", ",", "0.0", ",", "0.0", ",", "0.0", ",", "0.0", ",", 
     "0.0", ",", "0.0", ",", "0.0", ",", "0.5", ",", "0.5", ",", "0.5", ",", 
     "0.5", ",", "0.5", ",", "0.5", ",", "0.5", ",", "0.5", ",", "0.5", ",", 
     "1.0", ",", "1.0", ",", "1.0", ",", "1.0", ",", "1.0", ",", "1.0", ",", 
     "1.0", ",", "1.0", ",", "1.0"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"yv", "=", 
   RowBox[{"{", 
    RowBox[{
    "0.0", ",", "0.0", ",", "0.0", ",", "0.5", ",", "0.5", ",", "0.5", ",", 
     "1.0", ",", " ", "1.0", ",", " ", "1.0", ",", "0.0", ",", " ", "0.0", 
     ",", " ", "0.0", ",", "0.5", ",", " ", "0.5", ",", " ", "0.5", ",", 
     "1.0", ",", " ", "1.0", ",", " ", "1.0", ",", "0.0", ",", " ", "0.0", 
     ",", " ", "0.0", ",", "0.5", ",", " ", "0.5", ",", " ", "0.5", ",", 
     "1.0", ",", " ", "1.0", ",", " ", "1.0"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"zv", "=", 
   RowBox[{"{", 
    RowBox[{
    "0.0", ",", " ", "0.5", ",", " ", "1.0", ",", "0.0", ",", " ", "0.5", ",",
      " ", "1.0", ",", "0.0", ",", " ", "0.5", ",", " ", "1.0", ",", "0.0", 
     ",", "0.5", ",", "1.0", ",", "0.0", ",", " ", "0.5", ",", " ", "1.0", 
     ",", "0.0", ",", " ", "0.5", ",", " ", "1.0", ",", "0.0", ",", " ", 
     "0.5", ",", " ", "1.0", ",", "0.0", ",", " ", "0.5", ",", " ", "1.0", 
     ",", "0.0", ",", " ", "0.5", ",", " ", "1.0"}], "}"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.7174174700232644`*^9, 3.7174174845856824`*^9}, {
  3.717417517163823*^9, 3.717417642288141*^9}, {3.7210467593944297`*^9, 
  3.7210467621477776`*^9}, {3.849008737603016*^9, 3.8490087975493383`*^9}, {
  3.8490394034966097`*^9, 3.849039442363715*^9}, {3.84903949928415*^9, 
  3.849039511928667*^9}, {3.849039557090678*^9, 3.84903958355398*^9}, {
  3.849040182904023*^9, 3.849040499401132*^9}, {3.849040541554579*^9, 
  3.8490405432435417`*^9}},
 CellLabel->"In[51]:=",ExpressionUUID->"4c025298-5d73-48ed-a7da-0e00b826e80d"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[Rho]v", "=", 
  RowBox[{"Table", "[", 
   RowBox[{"1.0", ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "1", ",", 
      RowBox[{"Length", "[", "xv", "]"}]}], "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.7209938116705494`*^9, 3.7209938528649826`*^9}},
 CellLabel->"In[54]:=",ExpressionUUID->"0453cf91-07b9-43fa-8817-5f2de806bf71"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "1.`", ",", "1.`", ",", "1.`", ",", "1.`", ",", "1.`", ",", "1.`", ",", 
   "1.`", ",", "1.`", ",", "1.`", ",", "1.`", ",", "1.`", ",", "1.`", ",", 
   "1.`", ",", "1.`", ",", "1.`", ",", "1.`", ",", "1.`", ",", "1.`", ",", 
   "1.`", ",", "1.`", ",", "1.`", ",", "1.`", ",", "1.`", ",", "1.`", ",", 
   "1.`", ",", "1.`", ",", "1.`"}], "}"}]], "Output",
 CellChangeTimes->{
  3.7209938545509453`*^9, 3.7210612745209227`*^9, 3.723054679712879*^9, 
   3.72350454129504*^9, 3.7239811528858366`*^9, 3.7284300924333024`*^9, 
   3.7404280094843683`*^9, 3.7633940799093127`*^9, 3.764081557678941*^9, 
   3.7641638161742373`*^9, 3.7642444821928463`*^9, 3.7643520906318407`*^9, 
   3.764369779082593*^9, 3.764696345668995*^9, 3.764761606730977*^9, 
   3.765643088987829*^9, 3.799600713023966*^9, 3.799608817579533*^9, 
   3.8493783297331953`*^9, 3.849465073829815*^9, 3.850325887915607*^9, 
   3.9065733424532557`*^9, 3.906645850455201*^9, 3.9067401699066668`*^9, 
   3.906741725558256*^9, {3.906741778384643*^9, 3.906741792837133*^9}, 
   3.906742813327797*^9, 3.906810147617855*^9, 3.906810706325845*^9, 
   3.9068108350482283`*^9, 3.906814980700173*^9, 3.9068151082612677`*^9, 
   3.906815353365315*^9, 3.906815513142432*^9, 3.906815895382886*^9, 
   3.906819149812126*^9, 3.906821082812994*^9, 3.906822138552909*^9, 
   3.9068223947091722`*^9, 3.906822662924984*^9, 3.906823112561294*^9, 
   3.9068234609203568`*^9, 3.907257815730917*^9},
 CellLabel->"Out[54]=",ExpressionUUID->"c537ef6b-df38-453e-ac6e-c042f961699b"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"uv", "=", 
   RowBox[{"Table", "[", 
    RowBox[{"0.0", ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"4", "*", 
        RowBox[{"Length", "[", "xv", "]"}]}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"For", "[", 
  RowBox[{
   RowBox[{"i", "=", "0"}], ",", 
   RowBox[{"i", "<", 
    RowBox[{"Length", "[", "xv", "]"}]}], ",", 
   RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"uv", "[", 
      RowBox[{"[", 
       RowBox[{
        RowBox[{"i", "*", "4"}], "+", "1"}], "]"}], "]"}], "=", 
     RowBox[{"1.0", "*", 
      SuperscriptBox["10", 
       RowBox[{"-", "7"}]], "i"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"uv", "[", 
      RowBox[{"[", 
       RowBox[{
        RowBox[{"i", "*", "4"}], "+", "2"}], "]"}], "]"}], "=", 
     RowBox[{"2.0", "*", 
      SuperscriptBox["10", 
       RowBox[{"-", "7"}]], "i"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"uv", "[", 
      RowBox[{"[", 
       RowBox[{
        RowBox[{"i", "*", "4"}], "+", "3"}], "]"}], "]"}], "=", 
     RowBox[{"3.0", "*", 
      SuperscriptBox["10", 
       RowBox[{"-", "7"}]], "i"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"uv", "[", 
      RowBox[{"[", 
       RowBox[{
        RowBox[{"i", "*", "4"}], "+", "4"}], "]"}], "]"}], "=", 
     RowBox[{"4.0", "*", 
      SuperscriptBox["10", 
       RowBox[{"-", "7"}]], "i"}]}], ";"}]}], "\[IndentingNewLine]", 
  "]"}]}], "Input",
 CellChangeTimes->{{3.7210466573505106`*^9, 3.721046659816079*^9}, {
  3.721046777601693*^9, 3.721046848873374*^9}, {3.763394142897538*^9, 
  3.763394168547328*^9}, {3.7641026246306195`*^9, 3.7641026375151596`*^9}, {
  3.764102795449109*^9, 3.764102980220702*^9}},
 CellLabel->"In[55]:=",ExpressionUUID->"2b5fbef1-aed0-41b9-b95d-9d13cf671b8b"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"uvDot", "=", 
   RowBox[{"Table", "[", 
    RowBox[{"0.0", ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"4", "*", 
        RowBox[{"Length", "[", "xv", "]"}]}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"For", "[", 
  RowBox[{
   RowBox[{"i", "=", "0"}], ",", 
   RowBox[{"i", "<", 
    RowBox[{"Length", "[", "xv", "]"}]}], ",", 
   RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"uvDot", "[", 
      RowBox[{"[", 
       RowBox[{
        RowBox[{"i", "*", "4"}], "+", "1"}], "]"}], "]"}], "=", 
     RowBox[{"4.0", "*", 
      SuperscriptBox["10", 
       RowBox[{"-", "7"}]], "i"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"uvDot", "[", 
      RowBox[{"[", 
       RowBox[{
        RowBox[{"i", "*", "4"}], "+", "2"}], "]"}], "]"}], "=", 
     RowBox[{"3.0", "*", 
      SuperscriptBox["10", 
       RowBox[{"-", "7"}]], "i"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"uvDot", "[", 
      RowBox[{"[", 
       RowBox[{
        RowBox[{"i", "*", "4"}], "+", "3"}], "]"}], "]"}], "=", 
     RowBox[{"2.0", "*", 
      SuperscriptBox["10", 
       RowBox[{"-", "7"}]], "i"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"uvDot", "[", 
      RowBox[{"[", 
       RowBox[{
        RowBox[{"i", "*", "4"}], "+", "4"}], "]"}], "]"}], "=", 
     RowBox[{"1.0", "*", 
      SuperscriptBox["10", 
       RowBox[{"-", "7"}]], "i"}]}], ";"}]}], "\[IndentingNewLine]", 
  "]"}]}], "Input",
 CellChangeTimes->{{3.7647616334456005`*^9, 3.764761644341391*^9}, {
  3.7647925331122265`*^9, 3.764792546364756*^9}, {3.799600723762514*^9, 
  3.7996007459261312`*^9}},
 CellLabel->"In[57]:=",ExpressionUUID->"4806e59d-077e-4506-b247-bed9963cf8be"]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[StyleBox["Compute cell volume:", "Subsubsection"]], "Subsection",
 CellChangeTimes->{{3.7171711972127666`*^9, 3.71717120142911*^9}, {
  3.7235049764198055`*^9, 3.723505001764184*^9}, {3.7235116638104506`*^9, 
  3.7235116651539674`*^9}, {3.7235117226463957`*^9, 3.723511723427744*^9}, {
  3.7265184340783014`*^9, 3.726518438796838*^9}, {3.7566588833112*^9, 
  3.75665888526856*^9}, {3.7566591390943317`*^9, 3.756659143582884*^9}, {
  3.756691042483718*^9, 3.7566910512965465`*^9}, {3.8494652592930527`*^9, 
  3.849465260824358*^9}},ExpressionUUID->"09d16991-86e5-4930-8f3c-\
cee753764178"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ndofs", "=", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ndofsTotal", "=", 
   RowBox[{"ndofs", " ", 
    RowBox[{"Length", "[", "xv", "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"cellVol", "=", 
   RowBox[{"Table", "[", 
    RowBox[{"0.0", ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"Length", "[", "connect", "]"}]}], "}"}]}], "]"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.717166271741476*^9, 3.71716629726234*^9}, {
  3.717423563398694*^9, 3.717423566476555*^9}, {3.717424308471903*^9, 
  3.717424318282713*^9}, {3.7174279410435295`*^9, 3.717427953121283*^9}, {
  3.720806567996297*^9, 3.7208066398399677`*^9}, {3.7235053432057877`*^9, 
  3.7235054046120386`*^9}, {3.7235117305213585`*^9, 3.7235117319907336`*^9}, {
  3.726518443374713*^9, 3.726518462578518*^9}, {3.75665893403188*^9, 
  3.756658951568839*^9}, {3.756690716179819*^9, 3.7566907543675966`*^9}, {
  3.756729960822015*^9, 3.7567299899937677`*^9}},
 CellLabel->"In[59]:=",ExpressionUUID->"851f8080-6153-4056-98ca-c9ef3726099c"],

Cell[BoxData[
 RowBox[{"For", "[", 
  RowBox[{
   RowBox[{"i", "=", "1"}], ",", " ", 
   RowBox[{"i", "\[LessEqual]", " ", 
    RowBox[{"Length", "[", "connect", "]"}]}], ",", 
   RowBox[{"i", "++"}], ",", 
   RowBox[{"Block", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"i1", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"connect", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}], "+", "1"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"i2", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"connect", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "[", 
          RowBox[{"[", "2", "]"}], "]"}], "+", "1"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"i3", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"connect", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "[", 
          RowBox[{"[", "3", "]"}], "]"}], "+", "1"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"i4", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"connect", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "[", 
          RowBox[{"[", "4", "]"}], "]"}], "+", "1"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"ids", "=", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"ndofs", " ", 
            RowBox[{"(", 
             RowBox[{"i1", "-", "1"}], ")"}]}], "+", "1"}], ",", 
          RowBox[{
           RowBox[{"ndofs", 
            RowBox[{"(", " ", 
             RowBox[{"i2", "-", "1"}], ")"}]}], "+", "1"}], ",", 
          RowBox[{
           RowBox[{"ndofs", 
            RowBox[{"(", 
             RowBox[{"i3", "-", "1"}], ")"}]}], "+", "1"}], ",", 
          RowBox[{
           RowBox[{"ndofs", 
            RowBox[{"(", 
             RowBox[{"i4", "-", "1"}], ")"}]}], "+", "1"}]}], "}"}]}]}], 
      "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"j", "=", "1"}], ",", 
       RowBox[{"j", "<=", 
        RowBox[{"Length", "[", "gw", "]"}]}], ",", 
       RowBox[{"j", "++"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"cellVol", "[", 
          RowBox[{"[", "i", "]"}], "]"}], "+=", 
         RowBox[{
          RowBox[{"gw", "[", 
           RowBox[{"[", "j", "]"}], "]"}], " ", 
          RowBox[{"Abs", "[", 
           RowBox[{"Detj", "[", 
            RowBox[{
             RowBox[{"xv", "[", 
              RowBox[{"[", "i1", "]"}], "]"}], ",", 
             RowBox[{"yv", "[", 
              RowBox[{"[", "i1", "]"}], "]"}], ",", 
             RowBox[{"zv", "[", 
              RowBox[{"[", "i1", "]"}], "]"}], ",", 
             RowBox[{"xv", "[", 
              RowBox[{"[", "i2", "]"}], "]"}], ",", 
             RowBox[{"yv", "[", 
              RowBox[{"[", "i2", "]"}], "]"}], ",", 
             RowBox[{"zv", "[", 
              RowBox[{"[", "i2", "]"}], "]"}], ",", 
             RowBox[{"xv", "[", 
              RowBox[{"[", "i3", "]"}], "]"}], ",", 
             RowBox[{"yv", "[", 
              RowBox[{"[", "i3", "]"}], "]"}], ",", 
             RowBox[{"zv", "[", 
              RowBox[{"[", "i3", "]"}], "]"}], ",", 
             RowBox[{"xv", "[", 
              RowBox[{"[", "i4", "]"}], "]"}], ",", 
             RowBox[{"yv", "[", 
              RowBox[{"[", "i4", "]"}], "]"}], ",", 
             RowBox[{"zv", "[", 
              RowBox[{"[", "i4", "]"}], "]"}]}], "]"}], "]"}]}]}], ";"}]}], 
      "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.7167647605597653`*^9, 3.7167647892518883`*^9}, {
   3.7167648244240847`*^9, 3.716764841539942*^9}, {3.71676488019324*^9, 
   3.7167648969754357`*^9}, {3.716765065628334*^9, 3.716765185350045*^9}, {
   3.7167652229401484`*^9, 3.7167652383100395`*^9}, {3.7167653441168547`*^9, 
   3.7167655199547443`*^9}, {3.7167655675522327`*^9, 
   3.7167655810711265`*^9}, {3.716765622284607*^9, 3.7167656290567384`*^9}, {
   3.716765757154343*^9, 3.716765792076064*^9}, {3.7167658276745405`*^9, 
   3.7167660826802125`*^9}, {3.716766195664576*^9, 3.716766242915578*^9}, {
   3.7167663310833845`*^9, 3.7167663393539863`*^9}, {3.7167664503932595`*^9, 
   3.716766450932579*^9}, {3.7167664868258085`*^9, 3.7167665635541043`*^9}, {
   3.716766627651472*^9, 3.716766643645746*^9}, {3.716766826115865*^9, 
   3.7167668360695195`*^9}, {3.716766868385886*^9, 3.7167669130203*^9}, {
   3.717155721663645*^9, 3.7171557331420517`*^9}, {3.717155769178903*^9, 
   3.7171557818205233`*^9}, {3.7171567883516493`*^9, 3.717156887869956*^9}, {
   3.717156918335051*^9, 3.717156937057849*^9}, {3.717157017416103*^9, 
   3.717157052623994*^9}, {3.717157895689323*^9, 3.717157931742132*^9}, {
   3.717166282194605*^9, 3.71716628473459*^9}, {3.71716849797501*^9, 
   3.71716852298344*^9}, {3.717168562021318*^9, 3.717168562125424*^9}, {
   3.717168843821663*^9, 3.717168857297769*^9}, {3.7171692165304537`*^9, 
   3.7171692208302*^9}, {3.717170006857576*^9, 3.717170018830927*^9}, {
   3.717171209233417*^9, 3.717171213025419*^9}, {3.7173548750864697`*^9, 
   3.717354881757492*^9}, {3.717354996753583*^9, 3.717355017245678*^9}, {
   3.717355319697336*^9, 3.7173553216726255`*^9}, {3.7173557531181636`*^9, 
   3.7173557820403166`*^9}, {3.7173558138063755`*^9, 
   3.7173558166812677`*^9}, {3.7173587645155315`*^9, 
   3.7173587704721184`*^9}, {3.7173588122062426`*^9, 
   3.7173588501286516`*^9}, {3.717359014190798*^9, 3.7173590339564075`*^9}, {
   3.7173591194571896`*^9, 3.7173591202540846`*^9}, {3.717360749384885*^9, 
   3.717360755072524*^9}, {3.7173608405541487`*^9, 3.7173608453215923`*^9}, {
   3.7174176653039513`*^9, 3.7174177502357674`*^9}, {3.717418005127076*^9, 
   3.717418022383568*^9}, {3.7174180927900662`*^9, 3.717418180868244*^9}, {
   3.717419219270834*^9, 3.7174192266613092`*^9}, {3.71741926925568*^9, 
   3.717419272755123*^9}, {3.7174241468474283`*^9, 3.7174241510843997`*^9}, {
   3.71742429898483*^9, 3.717424381678406*^9}, {3.717427960779907*^9, 
   3.7174279724352093`*^9}, {3.7174281618258095`*^9, 
   3.7174281652786007`*^9}, {3.7208066594239817`*^9, 
   3.7208066657144737`*^9}, {3.723057650960129*^9, 3.7230576545889745`*^9}, {
   3.7235054152685385`*^9, 3.723505446143653*^9}, {3.723505542221841*^9, 
   3.7235055715031414`*^9}, {3.723505611190547*^9, 3.7235056388310738`*^9}, 
   3.7235057207531905`*^9, {3.723511832834532*^9, 3.7235118497876167`*^9}, {
   3.723511887365533*^9, 3.72351189056898*^9}, 3.726518499578006*^9, {
   3.726518560374749*^9, 3.7265185767658353`*^9}, {3.726519168245932*^9, 
   3.726519201792951*^9}, {3.7566587809361*^9, 3.756658784360771*^9}, {
   3.756658956620803*^9, 3.756658971527032*^9}, {3.756690778821248*^9, 
   3.756690786134622*^9}, {3.7566908236665444`*^9, 3.7566908255567884`*^9}, {
   3.756690901402877*^9, 3.7566909362161007`*^9}, {3.756729996915653*^9, 
   3.7567300368849297`*^9}, {3.7567300686980124`*^9, 
   3.7567300696353836`*^9}, {3.9065734811194277`*^9, 3.906573528050249*^9}},
 CellLabel->"In[62]:=",ExpressionUUID->"43ebea43-99df-4425-8b86-298a2464caaf"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Table", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"SetPrecision", "[", 
     RowBox[{
      RowBox[{"cellVol", "[", 
       RowBox[{"[", "i", "]"}], "]"}], ",", "16"}], "]"}], "//", 
    "MatrixForm"}], ",", 
   RowBox[{"{", 
    RowBox[{"i", ",", "1", ",", 
     RowBox[{"Length", "[", "connect", "]"}]}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.723505659409583*^9, 3.7235056624558945`*^9}, {
  3.7235057476593637`*^9, 3.7235057479091177`*^9}, {3.723506092534135*^9, 
  3.723506114956089*^9}, {3.723511860928227*^9, 3.7235118618810616`*^9}, {
  3.723511987702938*^9, 3.7235119968124857`*^9}, {3.7265192145272465`*^9, 
  3.726519217747201*^9}, {3.756658976515585*^9, 3.756658978773281*^9}, {
  3.756690802025478*^9, 3.756690806572092*^9}, {3.756730041416379*^9, 
  3.756730044932235*^9}, {3.7567300937141867`*^9, 3.7567300953393407`*^9}},
 CellLabel->"In[63]:=",ExpressionUUID->"3cad78f2-5e1c-4674-b57e-f381bb95c25f"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   TagBox["0.02083333333333333217685101601546193706`16.",
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]], ",", 
   TagBox["0.02083333333333333217685101601546193706`16.",
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]], ",", 
   TagBox["0.02083333333333333217685101601546193706`16.",
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]], ",", 
   TagBox["0.02083333333333333217685101601546193706`16.",
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]], ",", 
   TagBox["0.02083333333333333217685101601546193706`16.",
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]], ",", 
   TagBox["0.02083333333333333217685101601546193706`16.",
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]], ",", 
   TagBox["0.02083333333333333217685101601546193706`16.",
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]], ",", 
   TagBox["0.02083333333333333217685101601546193706`16.",
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]], ",", 
   TagBox["0.02083333333333333217685101601546193706`16.",
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]], ",", 
   TagBox["0.02083333333333333217685101601546193706`16.",
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]], ",", 
   TagBox["0.02083333333333333217685101601546193706`16.",
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]], ",", 
   TagBox["0.02083333333333333217685101601546193706`16.",
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]], ",", 
   TagBox["0.02083333333333333217685101601546193706`16.",
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]], ",", 
   TagBox["0.02083333333333333217685101601546193706`16.",
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]], ",", 
   TagBox["0.02083333333333333217685101601546193706`16.",
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]], ",", 
   TagBox["0.02083333333333333217685101601546193706`16.",
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]], ",", 
   TagBox["0.02083333333333333217685101601546193706`16.",
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]], ",", 
   TagBox["0.02083333333333333217685101601546193706`16.",
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]], ",", 
   TagBox["0.02083333333333333217685101601546193706`16.",
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]], ",", 
   TagBox["0.02083333333333333217685101601546193706`16.",
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]], ",", 
   TagBox["0.02083333333333333217685101601546193706`16.",
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]], ",", 
   TagBox["0.02083333333333333217685101601546193706`16.",
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]], ",", 
   TagBox["0.02083333333333333217685101601546193706`16.",
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]], ",", 
   TagBox["0.02083333333333333217685101601546193706`16.",
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]], ",", 
   TagBox["0.02083333333333333217685101601546193706`16.",
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]], ",", 
   TagBox["0.02083333333333333217685101601546193706`16.",
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]], ",", 
   TagBox["0.02083333333333333217685101601546193706`16.",
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]], ",", 
   TagBox["0.02083333333333333217685101601546193706`16.",
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]], ",", 
   TagBox["0.02083333333333333217685101601546193706`16.",
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]], ",", 
   TagBox["0.02083333333333333217685101601546193706`16.",
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]], ",", 
   TagBox["0.02083333333333333217685101601546193706`16.",
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]], ",", 
   TagBox["0.02083333333333333217685101601546193706`16.",
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]], ",", 
   TagBox["0.02083333333333333217685101601546193706`16.",
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]], ",", 
   TagBox["0.02083333333333333217685101601546193706`16.",
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]], ",", 
   TagBox["0.02083333333333333217685101601546193706`16.",
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]], ",", 
   TagBox["0.02083333333333333217685101601546193706`16.",
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]], ",", 
   TagBox["0.02083333333333333217685101601546193706`16.",
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]], ",", 
   TagBox["0.02083333333333333217685101601546193706`16.",
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]], ",", 
   TagBox["0.02083333333333333217685101601546193706`16.",
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]], ",", 
   TagBox["0.02083333333333333217685101601546193706`16.",
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]], ",", 
   TagBox["0.02083333333333333217685101601546193706`16.",
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]], ",", 
   TagBox["0.02083333333333333217685101601546193706`16.",
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]], ",", 
   TagBox["0.02083333333333333217685101601546193706`16.",
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]], ",", 
   TagBox["0.02083333333333333217685101601546193706`16.",
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]], ",", 
   TagBox["0.02083333333333333217685101601546193706`16.",
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]], ",", 
   TagBox["0.02083333333333333217685101601546193706`16.",
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]], ",", 
   TagBox["0.02083333333333333217685101601546193706`16.",
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]], ",", 
   TagBox["0.02083333333333333217685101601546193706`16.",
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]]}], "}"}]], "Output",
 CellChangeTimes->{
  3.7235056633778315`*^9, {3.7235057267213154`*^9, 3.72350574884632*^9}, 
   3.7235058719249067`*^9, 3.7235061165654483`*^9, 3.7235119033810225`*^9, 
   3.72351199906176*^9, 3.723981170104637*^9, 3.7265158705191135`*^9, 
   3.7265192194647903`*^9, 3.7284277488612876`*^9, 3.7404311039543076`*^9, 
   3.756658705675426*^9, 3.756658793117358*^9, 3.756658991732841*^9, 
   3.756690639943367*^9, 3.756690815681492*^9, 3.7566909081996827`*^9, 
   3.7566909396533284`*^9, {3.7567300738544064`*^9, 3.75673009641757*^9}, 
   3.757172243968132*^9, 3.757258507737043*^9, 3.757717931521874*^9, 
   3.849465092597186*^9, 3.84946512888405*^9, 3.850325887937471*^9, 
   3.906573547353733*^9, 3.9066458597531843`*^9, 3.9067401700044727`*^9, 
   3.906741725670095*^9, {3.9067417784983797`*^9, 3.906741792969533*^9}, 
   3.906742813401107*^9, 3.906810147676115*^9, 3.906810706446101*^9, 
   3.9068108351082897`*^9, 3.906814980761393*^9, 3.906815108320819*^9, 
   3.906815353430773*^9, 3.906815513206203*^9, 3.906815895477354*^9, 
   3.906819149915296*^9, 3.906821082911598*^9, 3.906822138649907*^9, 
   3.906822394769664*^9, 3.9068226629994926`*^9, 3.906823112659919*^9, 
   3.906823460999977*^9, 3.90725781578059*^9},
 CellLabel->"Out[63]=",ExpressionUUID->"3fb135e8-e441-456c-a550-6930a3be3ee1"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[StyleBox["Compute the temperature at the first gauss point:", \
"Subsubsection"]], "Subsection",
 CellChangeTimes->{{3.7171711972127666`*^9, 3.71717120142911*^9}, {
  3.7235049764198055`*^9, 3.723505001764184*^9}, {3.7235116638104506`*^9, 
  3.7235116651539674`*^9}, {3.7235117226463957`*^9, 3.723511723427744*^9}, {
  3.7265184340783014`*^9, 3.726518438796838*^9}, {3.7566588833112*^9, 
  3.75665888526856*^9}, {3.7566591390943317`*^9, 3.756659143582884*^9}, {
  3.7566910799220824`*^9, 3.756691086829109*^9}, {3.7566924302175407`*^9, 
  3.7566924402487907`*^9}, {3.9065735653672457`*^9, 
  3.906573568735256*^9}},ExpressionUUID->"19c11695-01af-4181-9f67-\
a648f94d389b"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ndofs", "=", "4"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"tval", "=", 
   RowBox[{"Table", "[", 
    RowBox[{"0.0", ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"Length", "[", "connect", "]"}]}], "}"}]}], "]"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.717166271741476*^9, 3.71716629726234*^9}, {
  3.717423563398694*^9, 3.717423566476555*^9}, {3.717424308471903*^9, 
  3.717424318282713*^9}, {3.7174279410435295`*^9, 3.717427953121283*^9}, {
  3.720806567996297*^9, 3.7208066398399677`*^9}, {3.7235053432057877`*^9, 
  3.7235054046120386`*^9}, {3.7235117305213585`*^9, 3.7235117319907336`*^9}, {
  3.726518443374713*^9, 3.726518462578518*^9}, {3.75665893403188*^9, 
  3.756658951568839*^9}, {3.756690716179819*^9, 3.7566907543675966`*^9}, {
  3.756690966842307*^9, 3.756690967560214*^9}, {3.756691202231859*^9, 
  3.756691215280867*^9}, {3.756692443560832*^9, 3.756692454483275*^9}, {
  3.849465603510891*^9, 3.8494656038121443`*^9}, {3.849466594155972*^9, 
  3.849466594568585*^9}},
 CellLabel->"In[64]:=",ExpressionUUID->"ec9bbd20-fef2-49e3-8f31-b872ccab3ad3"],

Cell[BoxData[
 RowBox[{"For", "[", 
  RowBox[{
   RowBox[{"i", "=", "1"}], ",", " ", 
   RowBox[{"i", "\[LessEqual]", " ", 
    RowBox[{"Length", "[", "connect", "]"}]}], ",", 
   RowBox[{"i", "++"}], ",", 
   RowBox[{"Block", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"i1", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"connect", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}], "+", "1"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"i2", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"connect", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "[", 
          RowBox[{"[", "2", "]"}], "]"}], "+", "1"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"i3", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"connect", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "[", 
          RowBox[{"[", "3", "]"}], "]"}], "+", "1"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"i4", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"connect", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "[", 
          RowBox[{"[", "4", "]"}], "]"}], "+", "1"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"ids", "=", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"ndofs", " ", 
            RowBox[{"(", 
             RowBox[{"i1", "-", "1"}], ")"}]}], "+", "ndofs"}], ",", 
          RowBox[{
           RowBox[{"ndofs", 
            RowBox[{"(", " ", 
             RowBox[{"i2", "-", "1"}], ")"}]}], "+", "ndofs"}], ",", 
          RowBox[{
           RowBox[{"ndofs", 
            RowBox[{"(", 
             RowBox[{"i3", "-", "1"}], ")"}]}], "+", "ndofs"}], ",", 
          RowBox[{
           RowBox[{"ndofs", 
            RowBox[{"(", 
             RowBox[{"i4", "-", "1"}], ")"}]}], "+", "ndofs"}]}], "}"}]}]}], 
      "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"tval", "[", 
        RowBox[{"[", "i", "]"}], "]"}], "=", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"\[Phi]s", "/.", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"\[Xi]", "\[Rule]", 
             RowBox[{
              RowBox[{"gp", "[", 
               RowBox[{"[", "1", "]"}], "]"}], "[", 
              RowBox[{"[", "1", "]"}], "]"}]}], ",", 
            RowBox[{"\[Psi]", "\[Rule]", 
             RowBox[{
              RowBox[{"gp", "[", 
               RowBox[{"[", "1", "]"}], "]"}], "[", 
              RowBox[{"[", "2", "]"}], "]"}]}], ",", 
            RowBox[{"\[Zeta]", "\[Rule]", 
             RowBox[{
              RowBox[{"gp", "[", 
               RowBox[{"[", "1", "]"}], "]"}], "[", 
              RowBox[{"[", "3", "]"}], "]"}]}]}], "}"}]}], ")"}], ".", 
        RowBox[{"(", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"uv", "[", 
            RowBox[{"[", 
             RowBox[{"ids", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "]"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "1", ",", "4"}], "}"}]}], "]"}], ")"}]}]}], 
      ";"}]}], "\[IndentingNewLine]", "]"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.7167647605597653`*^9, 3.7167647892518883`*^9}, {
   3.7167648244240847`*^9, 3.716764841539942*^9}, {3.71676488019324*^9, 
   3.7167648969754357`*^9}, {3.716765065628334*^9, 3.716765185350045*^9}, {
   3.7167652229401484`*^9, 3.7167652383100395`*^9}, {3.7167653441168547`*^9, 
   3.7167655199547443`*^9}, {3.7167655675522327`*^9, 
   3.7167655810711265`*^9}, {3.716765622284607*^9, 3.7167656290567384`*^9}, {
   3.716765757154343*^9, 3.716765792076064*^9}, {3.7167658276745405`*^9, 
   3.7167660826802125`*^9}, {3.716766195664576*^9, 3.716766242915578*^9}, {
   3.7167663310833845`*^9, 3.7167663393539863`*^9}, {3.7167664503932595`*^9, 
   3.716766450932579*^9}, {3.7167664868258085`*^9, 3.7167665635541043`*^9}, {
   3.716766627651472*^9, 3.716766643645746*^9}, {3.716766826115865*^9, 
   3.7167668360695195`*^9}, {3.716766868385886*^9, 3.7167669130203*^9}, {
   3.717155721663645*^9, 3.7171557331420517`*^9}, {3.717155769178903*^9, 
   3.7171557818205233`*^9}, {3.7171567883516493`*^9, 3.717156887869956*^9}, {
   3.717156918335051*^9, 3.717156937057849*^9}, {3.717157017416103*^9, 
   3.717157052623994*^9}, {3.717157895689323*^9, 3.717157931742132*^9}, {
   3.717166282194605*^9, 3.71716628473459*^9}, {3.71716849797501*^9, 
   3.71716852298344*^9}, {3.717168562021318*^9, 3.717168562125424*^9}, {
   3.717168843821663*^9, 3.717168857297769*^9}, {3.7171692165304537`*^9, 
   3.7171692208302*^9}, {3.717170006857576*^9, 3.717170018830927*^9}, {
   3.717171209233417*^9, 3.717171213025419*^9}, {3.7173548750864697`*^9, 
   3.717354881757492*^9}, {3.717354996753583*^9, 3.717355017245678*^9}, {
   3.717355319697336*^9, 3.7173553216726255`*^9}, {3.7173557531181636`*^9, 
   3.7173557820403166`*^9}, {3.7173558138063755`*^9, 
   3.7173558166812677`*^9}, {3.7173587645155315`*^9, 
   3.7173587704721184`*^9}, {3.7173588122062426`*^9, 
   3.7173588501286516`*^9}, {3.717359014190798*^9, 3.7173590339564075`*^9}, {
   3.7173591194571896`*^9, 3.7173591202540846`*^9}, {3.717360749384885*^9, 
   3.717360755072524*^9}, {3.7173608405541487`*^9, 3.7173608453215923`*^9}, {
   3.7174176653039513`*^9, 3.7174177502357674`*^9}, {3.717418005127076*^9, 
   3.717418022383568*^9}, {3.7174180927900662`*^9, 3.717418180868244*^9}, {
   3.717419219270834*^9, 3.7174192266613092`*^9}, {3.71741926925568*^9, 
   3.717419272755123*^9}, {3.7174241468474283`*^9, 3.7174241510843997`*^9}, {
   3.71742429898483*^9, 3.717424381678406*^9}, {3.717427960779907*^9, 
   3.7174279724352093`*^9}, {3.7174281618258095`*^9, 
   3.7174281652786007`*^9}, {3.7208066594239817`*^9, 
   3.7208066657144737`*^9}, {3.723057650960129*^9, 3.7230576545889745`*^9}, {
   3.7235054152685385`*^9, 3.723505446143653*^9}, {3.723505542221841*^9, 
   3.7235055715031414`*^9}, {3.723505611190547*^9, 3.7235056388310738`*^9}, 
   3.7235057207531905`*^9, {3.723511832834532*^9, 3.7235118497876167`*^9}, {
   3.723511887365533*^9, 3.72351189056898*^9}, 3.726518499578006*^9, {
   3.726518560374749*^9, 3.7265185767658353`*^9}, {3.726519168245932*^9, 
   3.726519201792951*^9}, {3.7566587809361*^9, 3.756658784360771*^9}, {
   3.756658956620803*^9, 3.756658971527032*^9}, {3.756690778821248*^9, 
   3.756690786134622*^9}, {3.7566908236665444`*^9, 3.7566908255567884`*^9}, {
   3.756690901402877*^9, 3.7566909362161007`*^9}, {3.756690975091991*^9, 
   3.756691003811199*^9}, {3.7566911345951447`*^9, 3.7566911981026917`*^9}, {
   3.7566912319015913`*^9, 3.756691329418736*^9}, {3.756691370403713*^9, 
   3.7566914337415667`*^9}, {3.7566924634362335`*^9, 3.756692470639288*^9}, {
   3.7566925390135813`*^9, 3.7566926370585513`*^9}, {3.849465693422215*^9, 
   3.849465719208724*^9}, {3.906572927280939*^9, 3.9065729406914597`*^9}, {
   3.906574392942524*^9, 3.9065744334978848`*^9}, {3.906629550266178*^9, 
   3.906629554351598*^9}, {3.9066295890613003`*^9, 3.906629596797122*^9}},
 CellLabel->"In[66]:=",ExpressionUUID->"e3eb67e3-02c0-4e32-951c-fa06df0766dc"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Table", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"SetPrecision", "[", 
     RowBox[{
      RowBox[{"tval", "[", 
       RowBox[{"[", "i", "]"}], "]"}], ",", "16"}], "]"}], "//", 
    "MatrixForm"}], ",", 
   RowBox[{"{", 
    RowBox[{"i", ",", "1", ",", 
     RowBox[{"Length", "[", "connect", "]"}]}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.723505659409583*^9, 3.7235056624558945`*^9}, {
  3.7235057476593637`*^9, 3.7235057479091177`*^9}, {3.723506092534135*^9, 
  3.723506114956089*^9}, {3.723511860928227*^9, 3.7235118618810616`*^9}, {
  3.723511987702938*^9, 3.7235119968124857`*^9}, {3.7265192145272465`*^9, 
  3.726519217747201*^9}, {3.756658976515585*^9, 3.756658978773281*^9}, {
  3.756690802025478*^9, 3.756690806572092*^9}, {3.7566909825291457`*^9, 
  3.7566909836078796`*^9}, {3.756691336788702*^9, 3.7566913433005276`*^9}, {
  3.756692646683525*^9, 3.756692648307948*^9}},
 CellLabel->"In[67]:=",ExpressionUUID->"8eb943eb-a033-41de-b6a6-00a7d6b52d7d"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   TagBox["3.6944271909999210171419645187818`16.*^-6",
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]], ",", 
   TagBox["1.64222912360003750824289595749983`16.*^-6",
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]], ",", 
   TagBox["1.7105572809000117005134335157468`16.*^-6",
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]], ",", 
   TagBox["1.50557280900008891194358402743081`16.*^-6",
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]], ",", 
   TagBox["3.55777087639997263260088940228787`16.*^-6",
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]], ",", 
   TagBox["3.48944271909999822857211503046582`16.*^-6",
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]], ",", 
   TagBox["4.09442719099992142255768287628648`16.*^-6",
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]], ",", 
   TagBox["2.04222912360003727838390387427925`16.*^-6",
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]], ",", 
   TagBox["2.1105572809000116824126782461013`16.*^-6",
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]], ",", 
   TagBox["1.90557280900008889384282875778531`16.*^-6",
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]], ",", 
   TagBox["3.95777087639997261450013413264237`16.*^-6",
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]], ",", 
   TagBox["3.88944271909999821047135976082032`16.*^-6",
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]], ",", 
   TagBox["4.89442719099992138635617233699548`16.*^-6",
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]], ",", 
   TagBox["2.84222912360003766569886696213842`16.*^-6",
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]], ",", 
   TagBox["2.91055728090001206972764133396048`16.*^-6",
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]], ",", 
   TagBox["2.70557280900008885764131821849432`16.*^-6",
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]], ",", 
   TagBox["4.75777087639997257829862359335138`16.*^-6",
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]], ",", 
   TagBox["4.68944271909999817426984922152933`16.*^-6",
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]], ",", 
   TagBox["5.29442719099992094473894344019982`16.*^-6",
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]], ",", 
   TagBox["3.24222912360003722408163806534276`16.*^-6",
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]], ",", 
   TagBox["3.31055728090001205162688606431498`16.*^-6",
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]], ",", 
   TagBox["3.10557280900008841602408932169865`16.*^-6",
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]], ",", 
   TagBox["5.15777087639997298371434195085605`16.*^-6",
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]], ",", 
   TagBox["5.089442719099998579685567579034`16.*^-6",
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]], ",", 
   TagBox["7.29442719099992212478458797342284`16.*^-6",
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]], ",", 
   TagBox["5.24222912360003840412728259856578`16.*^-6",
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]], ",", 
   TagBox["5.3105572809000119611231097160875`16.*^-6",
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]], ",", 
   TagBox["5.10557280900008959606973385492168`16.*^-6",
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]], ",", 
   TagBox["7.15777087639997331672703922977874`16.*^-6",
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]], ",", 
   TagBox["7.08944271909999806566531760365635`16.*^-6",
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]], ",", 
   TagBox["7.69442719099992168316735907662718`16.*^-6",
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]], ",", 
   TagBox["5.64222912360003711547710644746978`16.*^-6",
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]], ",", 
   TagBox["5.71055728090001151950588081929183`16.*^-6",
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]], ",", 
   TagBox["5.50557280900008915445250495812601`16.*^-6",
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]], ",", 
   TagBox["7.55777087639997202807686307868273`16.*^-6",
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]], ",", 
   TagBox["7.48944271909999762404808870686068`16.*^-6",
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]], ",", 
   TagBox["8.49442719099992079993290128303585`16.*^-6",
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]], ",", 
   TagBox["6.44222912360003877334149041677946`16.*^-6",
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]], ",", 
   TagBox["6.51055728090001233033731753430118`16.*^-6",
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]], ",", 
   TagBox["6.30557280900008827121804716453468`16.*^-6",
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]], ",", 
   TagBox["8.35777087639997368594124704799242`16.*^-6",
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]], ",", 
   TagBox["8.28944271909999843487952542187003`16.*^-6",
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]], ",", 
   TagBox["8.89442719099992205238156689484086`16.*^-6",
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]], ",", 
   TagBox["6.84222912360003748469131426568346`16.*^-6",
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]], ",", 
   TagBox["6.91055728090001104168714138320517`16.*^-6",
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]], ",", 
   TagBox["6.70557280900008867663376552203935`16.*^-6",
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]], ",", 
   TagBox["8.75777087639997324432401815119675`16.*^-6",
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]], ",", 
   TagBox["8.68944271909999968732819103367504`16.*^-6",
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]]}], "}"}]], "Output",
 CellChangeTimes->{
  3.7235056633778315`*^9, {3.7235057267213154`*^9, 3.72350574884632*^9}, 
   3.7235058719249067`*^9, 3.7235061165654483`*^9, 3.7235119033810225`*^9, 
   3.72351199906176*^9, 3.723981170104637*^9, 3.7265158705191135`*^9, 
   3.7265192194647903`*^9, 3.7284277488612876`*^9, 3.7404311039543076`*^9, 
   3.756658705675426*^9, 3.756658793117358*^9, 3.756658991732841*^9, 
   3.756690639943367*^9, 3.756690815681492*^9, 3.7566909081996827`*^9, 
   3.7566909396533284`*^9, 3.7566910156861467`*^9, 3.756691344534651*^9, {
   3.7566913942042413`*^9, 3.756691438835552*^9}, {3.756692666917268*^9, 
   3.7566926727605333`*^9}, 3.757172286178247*^9, 3.757258524399591*^9, 
   3.7577179608968573`*^9, 3.84946531399627*^9, 3.849465609001583*^9, 
   3.849465722764287*^9, 3.85032588795322*^9, 3.906573665009066*^9, {
   3.906574408885333*^9, 3.9065744379507513`*^9}, 3.906629598798882*^9, 
   3.906645864554557*^9, 3.906740170072513*^9, 3.9067417257469053`*^9, {
   3.906741778571253*^9, 3.9067417930407667`*^9}, 3.906742813468289*^9, 
   3.906810147742908*^9, 3.9068107064853163`*^9, 3.9068108351747932`*^9, 
   3.906814980812181*^9, 3.9068151083839006`*^9, 3.9068153534944067`*^9, 
   3.9068155132699823`*^9, 3.906815895543603*^9, 3.906819149979321*^9, 
   3.906821082969619*^9, 3.9068221387053967`*^9, 3.906822394840866*^9, 
   3.906822663039173*^9, 3.906823112717866*^9, 3.906823461059224*^9, 
   3.907257815820121*^9},
 CellLabel->"Out[67]=",ExpressionUUID->"61c63558-ab02-4283-aad7-293f1fefe6fa"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[StyleBox["Compute the thermal content at the gauss points:", \
"Subsubsection"]], "Subsection",
 CellChangeTimes->{{3.7171711972127666`*^9, 3.71717120142911*^9}, {
  3.7235049764198055`*^9, 3.723505001764184*^9}, {3.7235116638104506`*^9, 
  3.7235116651539674`*^9}, {3.7235117226463957`*^9, 3.723511723427744*^9}, {
  3.7265184340783014`*^9, 3.726518438796838*^9}, {3.7566588833112*^9, 
  3.75665888526856*^9}, {3.7566591390943317`*^9, 3.756659143582884*^9}, {
  3.7566910799220824`*^9, 3.756691086829109*^9}, {3.7566924302175407`*^9, 
  3.7566924402487907`*^9}, {3.849466546270274*^9, 
  3.849466550390472*^9}},ExpressionUUID->"8015ca1e-971e-4630-adf2-\
45cea31b08ab"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ndofs", "=", "4"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"tcont", "=", 
   RowBox[{"Table", "[", 
    RowBox[{"0.0", ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"Length", "[", "connect", "]"}]}], "}"}]}], "]"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.717166271741476*^9, 3.71716629726234*^9}, {
  3.717423563398694*^9, 3.717423566476555*^9}, {3.717424308471903*^9, 
  3.717424318282713*^9}, {3.7174279410435295`*^9, 3.717427953121283*^9}, {
  3.720806567996297*^9, 3.7208066398399677`*^9}, {3.7235053432057877`*^9, 
  3.7235054046120386`*^9}, {3.7235117305213585`*^9, 3.7235117319907336`*^9}, {
  3.726518443374713*^9, 3.726518462578518*^9}, {3.75665893403188*^9, 
  3.756658951568839*^9}, {3.756690716179819*^9, 3.7566907543675966`*^9}, {
  3.756690966842307*^9, 3.756690967560214*^9}, {3.756691202231859*^9, 
  3.756691215280867*^9}, {3.756692443560832*^9, 3.756692454483275*^9}, {
  3.849465603510891*^9, 3.8494656038121443`*^9}, {3.849466603705103*^9, 
  3.849466614512022*^9}},
 CellLabel->"In[68]:=",ExpressionUUID->"bee8cdb9-929d-4f0a-aa63-c93d3d14da84"],

Cell[BoxData[
 RowBox[{"For", "[", 
  RowBox[{
   RowBox[{"i", "=", "1"}], ",", " ", 
   RowBox[{"i", "\[LessEqual]", " ", 
    RowBox[{"Length", "[", "connect", "]"}]}], ",", 
   RowBox[{"i", "++"}], ",", 
   RowBox[{"Block", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"i1", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"connect", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}], "+", "1"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"i2", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"connect", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "[", 
          RowBox[{"[", "2", "]"}], "]"}], "+", "1"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"i3", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"connect", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "[", 
          RowBox[{"[", "3", "]"}], "]"}], "+", "1"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"i4", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"connect", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "[", 
          RowBox[{"[", "4", "]"}], "]"}], "+", "1"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"ids", "=", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"ndofs", " ", 
            RowBox[{"(", 
             RowBox[{"i1", "-", "1"}], ")"}]}], "+", "ndofs"}], ",", 
          RowBox[{
           RowBox[{"ndofs", 
            RowBox[{"(", " ", 
             RowBox[{"i2", "-", "1"}], ")"}]}], "+", "ndofs"}], ",", 
          RowBox[{
           RowBox[{"ndofs", 
            RowBox[{"(", 
             RowBox[{"i3", "-", "1"}], ")"}]}], "+", "ndofs"}], ",", 
          RowBox[{
           RowBox[{"ndofs", 
            RowBox[{"(", 
             RowBox[{"i4", "-", "1"}], ")"}]}], "+", "ndofs"}]}], "}"}]}]}], 
      "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"j", "=", "1"}], ",", 
       RowBox[{"j", "<=", 
        RowBox[{"Length", "[", "gw", "]"}]}], ",", 
       RowBox[{"j", "++"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"weight", "=", 
         RowBox[{
          RowBox[{"gw", "[", 
           RowBox[{"[", "j", "]"}], "]"}], " ", 
          RowBox[{"Abs", "[", 
           RowBox[{"Detj", "[", 
            RowBox[{
             RowBox[{"xv", "[", 
              RowBox[{"[", "i1", "]"}], "]"}], ",", 
             RowBox[{"yv", "[", 
              RowBox[{"[", "i1", "]"}], "]"}], ",", 
             RowBox[{"zv", "[", 
              RowBox[{"[", "i1", "]"}], "]"}], ",", 
             RowBox[{"xv", "[", 
              RowBox[{"[", "i2", "]"}], "]"}], ",", 
             RowBox[{"yv", "[", 
              RowBox[{"[", "i2", "]"}], "]"}], ",", 
             RowBox[{"zv", "[", 
              RowBox[{"[", "i2", "]"}], "]"}], ",", 
             RowBox[{"xv", "[", 
              RowBox[{"[", "i3", "]"}], "]"}], ",", 
             RowBox[{"yv", "[", 
              RowBox[{"[", "i3", "]"}], "]"}], ",", 
             RowBox[{"zv", "[", 
              RowBox[{"[", "i3", "]"}], "]"}], ",", 
             RowBox[{"xv", "[", 
              RowBox[{"[", "i4", "]"}], "]"}], ",", 
             RowBox[{"yv", "[", 
              RowBox[{"[", "i4", "]"}], "]"}], ",", 
             RowBox[{"zv", "[", 
              RowBox[{"[", "i4", "]"}], "]"}]}], "]"}], "]"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"tcont", "[", 
          RowBox[{"[", "i", "]"}], "]"}], "+=", 
         RowBox[{"weight", "*", 
          RowBox[{"(", 
           RowBox[{"0.3", " ", "*", " ", 
            SuperscriptBox["10", "6"]}], ")"}], 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"\[Phi]s", "/.", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"\[Xi]", "\[Rule]", 
                RowBox[{
                 RowBox[{"gp", "[", 
                  RowBox[{"[", "j", "]"}], "]"}], "[", 
                 RowBox[{"[", "1", "]"}], "]"}]}], ",", 
               RowBox[{"\[Psi]", "\[Rule]", 
                RowBox[{
                 RowBox[{"gp", "[", 
                  RowBox[{"[", "j", "]"}], "]"}], "[", 
                 RowBox[{"[", "2", "]"}], "]"}]}], ",", 
               RowBox[{"\[Zeta]", "\[Rule]", 
                RowBox[{
                 RowBox[{"gp", "[", 
                  RowBox[{"[", "j", "]"}], "]"}], "[", 
                 RowBox[{"[", "3", "]"}], "]"}]}]}], "}"}]}], ")"}], ".", 
           RowBox[{"(", 
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"uv", "[", 
               RowBox[{"[", 
                RowBox[{"ids", "[", 
                 RowBox[{"[", "i", "]"}], "]"}], "]"}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"i", ",", "1", ",", "4"}], "}"}]}], "]"}], ")"}]}]}]}],
         ";"}]}], "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
    "]"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.7167647605597653`*^9, 3.7167647892518883`*^9}, {
   3.7167648244240847`*^9, 3.716764841539942*^9}, {3.71676488019324*^9, 
   3.7167648969754357`*^9}, {3.716765065628334*^9, 3.716765185350045*^9}, {
   3.7167652229401484`*^9, 3.7167652383100395`*^9}, {3.7167653441168547`*^9, 
   3.7167655199547443`*^9}, {3.7167655675522327`*^9, 
   3.7167655810711265`*^9}, {3.716765622284607*^9, 3.7167656290567384`*^9}, {
   3.716765757154343*^9, 3.716765792076064*^9}, {3.7167658276745405`*^9, 
   3.7167660826802125`*^9}, {3.716766195664576*^9, 3.716766242915578*^9}, {
   3.7167663310833845`*^9, 3.7167663393539863`*^9}, {3.7167664503932595`*^9, 
   3.716766450932579*^9}, {3.7167664868258085`*^9, 3.7167665635541043`*^9}, {
   3.716766627651472*^9, 3.716766643645746*^9}, {3.716766826115865*^9, 
   3.7167668360695195`*^9}, {3.716766868385886*^9, 3.7167669130203*^9}, {
   3.717155721663645*^9, 3.7171557331420517`*^9}, {3.717155769178903*^9, 
   3.7171557818205233`*^9}, {3.7171567883516493`*^9, 3.717156887869956*^9}, {
   3.717156918335051*^9, 3.717156937057849*^9}, {3.717157017416103*^9, 
   3.717157052623994*^9}, {3.717157895689323*^9, 3.717157931742132*^9}, {
   3.717166282194605*^9, 3.71716628473459*^9}, {3.71716849797501*^9, 
   3.71716852298344*^9}, {3.717168562021318*^9, 3.717168562125424*^9}, {
   3.717168843821663*^9, 3.717168857297769*^9}, {3.7171692165304537`*^9, 
   3.7171692208302*^9}, {3.717170006857576*^9, 3.717170018830927*^9}, {
   3.717171209233417*^9, 3.717171213025419*^9}, {3.7173548750864697`*^9, 
   3.717354881757492*^9}, {3.717354996753583*^9, 3.717355017245678*^9}, {
   3.717355319697336*^9, 3.7173553216726255`*^9}, {3.7173557531181636`*^9, 
   3.7173557820403166`*^9}, {3.7173558138063755`*^9, 
   3.7173558166812677`*^9}, {3.7173587645155315`*^9, 
   3.7173587704721184`*^9}, {3.7173588122062426`*^9, 
   3.7173588501286516`*^9}, {3.717359014190798*^9, 3.7173590339564075`*^9}, {
   3.7173591194571896`*^9, 3.7173591202540846`*^9}, {3.717360749384885*^9, 
   3.717360755072524*^9}, {3.7173608405541487`*^9, 3.7173608453215923`*^9}, {
   3.7174176653039513`*^9, 3.7174177502357674`*^9}, {3.717418005127076*^9, 
   3.717418022383568*^9}, {3.7174180927900662`*^9, 3.717418180868244*^9}, {
   3.717419219270834*^9, 3.7174192266613092`*^9}, {3.71741926925568*^9, 
   3.717419272755123*^9}, {3.7174241468474283`*^9, 3.7174241510843997`*^9}, {
   3.71742429898483*^9, 3.717424381678406*^9}, {3.717427960779907*^9, 
   3.7174279724352093`*^9}, {3.7174281618258095`*^9, 
   3.7174281652786007`*^9}, {3.7208066594239817`*^9, 
   3.7208066657144737`*^9}, {3.723057650960129*^9, 3.7230576545889745`*^9}, {
   3.7235054152685385`*^9, 3.723505446143653*^9}, {3.723505542221841*^9, 
   3.7235055715031414`*^9}, {3.723505611190547*^9, 3.7235056388310738`*^9}, 
   3.7235057207531905`*^9, {3.723511832834532*^9, 3.7235118497876167`*^9}, {
   3.723511887365533*^9, 3.72351189056898*^9}, 3.726518499578006*^9, {
   3.726518560374749*^9, 3.7265185767658353`*^9}, {3.726519168245932*^9, 
   3.726519201792951*^9}, {3.7566587809361*^9, 3.756658784360771*^9}, {
   3.756658956620803*^9, 3.756658971527032*^9}, {3.756690778821248*^9, 
   3.756690786134622*^9}, {3.7566908236665444`*^9, 3.7566908255567884`*^9}, {
   3.756690901402877*^9, 3.7566909362161007`*^9}, {3.756690975091991*^9, 
   3.756691003811199*^9}, {3.7566911345951447`*^9, 3.7566911981026917`*^9}, {
   3.7566912319015913`*^9, 3.756691329418736*^9}, {3.756691370403713*^9, 
   3.7566914337415667`*^9}, {3.7566924634362335`*^9, 3.756692470639288*^9}, {
   3.7566925390135813`*^9, 3.7566926370585513`*^9}, {3.849465693422215*^9, 
   3.849465719208724*^9}, 3.8494665622878733`*^9, {3.84946661744228*^9, 
   3.849466617942696*^9}, {3.906647477768743*^9, 3.906647479126721*^9}, {
   3.906647579991897*^9, 3.9066476064354753`*^9}, {3.906647661027261*^9, 
   3.906647672107131*^9}, {3.906647814972437*^9, 3.906647820147995*^9}, {
   3.906647852789585*^9, 3.90664787107936*^9}},
 CellLabel->"In[70]:=",ExpressionUUID->"30824ff5-afa1-47b3-bd16-a34ceac1ad24"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Table", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"SetPrecision", "[", 
     RowBox[{
      RowBox[{"tcont", "[", 
       RowBox[{"[", "i", "]"}], "]"}], ",", "16"}], "]"}], "//", 
    "MatrixForm"}], ",", 
   RowBox[{"{", 
    RowBox[{"i", ",", "1", ",", 
     RowBox[{"Length", "[", "connect", "]"}]}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.723505659409583*^9, 3.7235056624558945`*^9}, {
  3.7235057476593637`*^9, 3.7235057479091177`*^9}, {3.723506092534135*^9, 
  3.723506114956089*^9}, {3.723511860928227*^9, 3.7235118618810616`*^9}, {
  3.723511987702938*^9, 3.7235119968124857`*^9}, {3.7265192145272465`*^9, 
  3.726519217747201*^9}, {3.756658976515585*^9, 3.756658978773281*^9}, {
  3.756690802025478*^9, 3.756690806572092*^9}, {3.7566909825291457`*^9, 
  3.7566909836078796`*^9}, {3.756691336788702*^9, 3.7566913433005276`*^9}, {
  3.756692646683525*^9, 3.756692648307948*^9}, {3.8494666202005043`*^9, 
  3.84946662069876*^9}},
 CellLabel->"In[71]:=",ExpressionUUID->"cf3f18e4-2463-4120-a70e-cbdc1690e0af"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   TagBox["0.01750000000000003289035710452026251005`16.",
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]], ",", 
   TagBox["0.01250000000000002324529457808921506512`16.",
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]], ",", 
   TagBox["0.0112500000000000221350715534640585247`16.",
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]], ",", 
   TagBox["0.0150000000000000306699110552699494292`16.",
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]], ",", 
   TagBox["0.02000000000000004204969705767780396855`16.",
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]], ",", 
   TagBox["0.02125000000000003969047313034934632014`16.",
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]], ",", 
   TagBox["0.02000000000000003164135620181696140207`16.",
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]], ",", 
   TagBox["0.01500000000000002373101715136272105156`16.",
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]], ",", 
   TagBox["0.01375000000000002262079412673756451113`16.",
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]], ",", 
   TagBox["0.01750000000000002942091015256664832123`16.",
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]], ",", 
   TagBox["0.02250000000000003733124920302088867174`16.",
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]], ",", 
   TagBox["0.02375000000000003844147222764604521217`16.",
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]], ",", 
   TagBox["0.02500000000000003608224830031758756377`16.",
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]], ",", 
   TagBox["0.0200000000000000212330153459561188356`16.",
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]], ",", 
   TagBox["0.018750000000000023592239273284576484`16.",
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]], ",", 
   TagBox["0.02250000000000002692290834716004610527`16.",
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]], ",", 
   TagBox["0.02750000000000003483324739761428645579`16.",
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]], ",", 
   TagBox["0.02875000000000004288236432614667137386`16.",
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]], ",", 
   TagBox["0.02750000000000003136380044566067226697`16.",
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]], ",", 
   TagBox["0.02250000000000001998401444325281772763`16.",
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]], ",", 
   TagBox["0.02125000000000002234323837058127537603`16.",
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]], ",", 
   TagBox["0.02500000000000002914335439641035918612`16.",
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]], ",", 
   TagBox["0.03000000000000003705369344686459953664`16.",
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]], ",", 
   TagBox["0.03125000000000004163336342344337026589`16.",
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]], ",", 
   TagBox["0.04000000000000003552713678800500929356`16.",
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]], ",", 
   TagBox["0.03500000000000003108624468950438313186`16.",
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]], ",", 
   TagBox["0.03375000000000002303712776097199821379`16.",
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]], ",", 
   TagBox["0.03750000000000003330669073875469621271`16.",
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]], ",", 
   TagBox["0.04250000000000004468647674116255075205`16.",
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]], ",", 
   TagBox["0.04375000000000003885780586188047891483`16.",
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]], ",", 
   TagBox["0.0425000000000000377475828372553223744`16.",
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]], ",", 
   TagBox["0.03750000000000001942890293094023945741`16.",
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]], ",", 
   TagBox["0.03625000000000002525757381022231129464`16.",
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]], ",", 
   TagBox["0.04000000000000002858824288409778091591`16.",
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]], ",", 
   TagBox["0.04500000000000003996802888650563545525`16.",
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]], ",", 
   TagBox["0.04625000000000004107825191113079199567`16.",
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]], ",", 
   TagBox["0.04750000000000003524958103184872015845`16.",
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]], ",", 
   TagBox["0.04250000000000002386979502944086561911`16.",
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]], ",", 
   TagBox["0.04125000000000002275957200481570907868`16.",
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]], ",", 
   TagBox["0.0450000000000000330291349825984070776`16.",
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]], ",", 
   TagBox["0.0500000000000000374700270810990332393`16.",
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]], ",", 
   TagBox["0.05125000000000004551914400963141815737`16.",
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]], ",", 
   TagBox["0.05000000000000003053113317719180486165`16.",
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]], ",", 
   TagBox["0.04500000000000001915134717478395032231`16.",
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]], ",", 
   TagBox["0.04375000000000002498001805406602215953`16.",
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]], ",", 
   TagBox["0.0475000000000000283106871279414917808`16.",
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]], ",", 
   TagBox["0.0525000000000000327515792264421179425`16.",
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]], ",", 
   TagBox["0.05375000000000004773959005888173123822`16.",
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]]}], "}"}]], "Output",
 CellChangeTimes->{
  3.7235056633778315`*^9, {3.7235057267213154`*^9, 3.72350574884632*^9}, 
   3.7235058719249067`*^9, 3.7235061165654483`*^9, 3.7235119033810225`*^9, 
   3.72351199906176*^9, 3.723981170104637*^9, 3.7265158705191135`*^9, 
   3.7265192194647903`*^9, 3.7284277488612876`*^9, 3.7404311039543076`*^9, 
   3.756658705675426*^9, 3.756658793117358*^9, 3.756658991732841*^9, 
   3.756690639943367*^9, 3.756690815681492*^9, 3.7566909081996827`*^9, 
   3.7566909396533284`*^9, 3.7566910156861467`*^9, 3.756691344534651*^9, {
   3.7566913942042413`*^9, 3.756691438835552*^9}, {3.756692666917268*^9, 
   3.7566926727605333`*^9}, 3.757172286178247*^9, 3.757258524399591*^9, 
   3.7577179608968573`*^9, 3.84946531399627*^9, 3.849465609001583*^9, 
   3.849465722764287*^9, 3.849466646702557*^9, 3.85032588796915*^9, 
   3.9066478818662148`*^9, 3.906740170164403*^9, 3.9067417258565617`*^9, {
   3.906741778691862*^9, 3.906741793160213*^9}, 3.906742813556128*^9, 
   3.906810147815102*^9, 3.906810706590877*^9, 3.906810835246393*^9, 
   3.906814980886264*^9, 3.906815108455988*^9, 3.906815353569475*^9, 
   3.90681551335695*^9, 3.906815895737074*^9, 3.9068191502973223`*^9, 
   3.906821083090558*^9, 3.90682213879418*^9, 3.906822394928422*^9, 
   3.9068226631105328`*^9, 3.906823112773184*^9, 3.906823461131885*^9, 
   3.907257815867146*^9},
 CellLabel->"Out[71]=",ExpressionUUID->"5bc27110-c776-477c-975e-fb1d9955cdd3"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ndofs", "=", "4"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"GradOp", "=", 
   RowBox[{"Table", "[", 
    RowBox[{"0.0", ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"Length", "[", "connect", "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "1", ",", "4"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"k", ",", "1", ",", "3"}], "}"}]}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.717166271741476*^9, 3.71716629726234*^9}, {
  3.717423563398694*^9, 3.717423566476555*^9}, {3.717424308471903*^9, 
  3.717424318282713*^9}, {3.7174279410435295`*^9, 3.717427953121283*^9}, {
  3.720806567996297*^9, 3.7208066398399677`*^9}, {3.7235053432057877`*^9, 
  3.7235054046120386`*^9}, {3.7235117305213585`*^9, 3.7235117319907336`*^9}, {
  3.726518443374713*^9, 3.726518462578518*^9}, {3.75665893403188*^9, 
  3.756658951568839*^9}, {3.7566907047890625`*^9, 3.7566907063040133`*^9}, {
  3.849477715702116*^9, 3.849477719786415*^9}},
 CellLabel->"In[72]:=",ExpressionUUID->"f9de8d39-051b-4f66-8aa7-1b4a42ff02b8"],

Cell[BoxData[
 RowBox[{"For", "[", 
  RowBox[{
   RowBox[{"i", "=", "1"}], ",", " ", 
   RowBox[{"i", "\[LessEqual]", " ", 
    RowBox[{"Length", "[", "connect", "]"}]}], ",", 
   RowBox[{"i", "++"}], ",", 
   RowBox[{"Block", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"i1", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"connect", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}], "+", "1"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"i2", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"connect", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "[", 
          RowBox[{"[", "2", "]"}], "]"}], "+", "1"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"i3", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"connect", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "[", 
          RowBox[{"[", "3", "]"}], "]"}], "+", "1"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"i4", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"connect", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "[", 
          RowBox[{"[", "4", "]"}], "]"}], "+", "1"}]}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"GradOp", "[", 
        RowBox[{"[", "i", "]"}], "]"}], "=", 
       RowBox[{"(", 
        RowBox[{"gmatrix", "[", 
         RowBox[{
          RowBox[{"xv", "[", 
           RowBox[{"[", "i1", "]"}], "]"}], ",", 
          RowBox[{"yv", "[", 
           RowBox[{"[", "i1", "]"}], "]"}], ",", 
          RowBox[{"zv", "[", 
           RowBox[{"[", "i1", "]"}], "]"}], ",", 
          RowBox[{"xv", "[", 
           RowBox[{"[", "i2", "]"}], "]"}], ",", 
          RowBox[{"yv", "[", 
           RowBox[{"[", "i2", "]"}], "]"}], ",", 
          RowBox[{"zv", "[", 
           RowBox[{"[", "i2", "]"}], "]"}], ",", 
          RowBox[{"xv", "[", 
           RowBox[{"[", "i3", "]"}], "]"}], ",", 
          RowBox[{"yv", "[", 
           RowBox[{"[", "i3", "]"}], "]"}], ",", 
          RowBox[{"zv", "[", 
           RowBox[{"[", "i3", "]"}], "]"}], ",", 
          RowBox[{"xv", "[", 
           RowBox[{"[", "i4", "]"}], "]"}], ",", 
          RowBox[{"yv", "[", 
           RowBox[{"[", "i4", "]"}], "]"}], ",", 
          RowBox[{"zv", "[", 
           RowBox[{"[", "i4", "]"}], "]"}]}], "]"}], ")"}]}], ";"}]}], 
    "\[IndentingNewLine]", "]"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.7167647605597653`*^9, 3.7167647892518883`*^9}, {
   3.7167648244240847`*^9, 3.716764841539942*^9}, {3.71676488019324*^9, 
   3.7167648969754357`*^9}, {3.716765065628334*^9, 3.716765185350045*^9}, {
   3.7167652229401484`*^9, 3.7167652383100395`*^9}, {3.7167653441168547`*^9, 
   3.7167655199547443`*^9}, {3.7167655675522327`*^9, 
   3.7167655810711265`*^9}, {3.716765622284607*^9, 3.7167656290567384`*^9}, {
   3.716765757154343*^9, 3.716765792076064*^9}, {3.7167658276745405`*^9, 
   3.7167660826802125`*^9}, {3.716766195664576*^9, 3.716766242915578*^9}, {
   3.7167663310833845`*^9, 3.7167663393539863`*^9}, {3.7167664503932595`*^9, 
   3.716766450932579*^9}, {3.7167664868258085`*^9, 3.7167665635541043`*^9}, {
   3.716766627651472*^9, 3.716766643645746*^9}, {3.716766826115865*^9, 
   3.7167668360695195`*^9}, {3.716766868385886*^9, 3.7167669130203*^9}, {
   3.717155721663645*^9, 3.7171557331420517`*^9}, {3.717155769178903*^9, 
   3.7171557818205233`*^9}, {3.7171567883516493`*^9, 3.717156887869956*^9}, {
   3.717156918335051*^9, 3.717156937057849*^9}, {3.717157017416103*^9, 
   3.717157052623994*^9}, {3.717157895689323*^9, 3.717157931742132*^9}, {
   3.717166282194605*^9, 3.71716628473459*^9}, {3.71716849797501*^9, 
   3.71716852298344*^9}, {3.717168562021318*^9, 3.717168562125424*^9}, {
   3.717168843821663*^9, 3.717168857297769*^9}, {3.7171692165304537`*^9, 
   3.7171692208302*^9}, {3.717170006857576*^9, 3.717170018830927*^9}, {
   3.717171209233417*^9, 3.717171213025419*^9}, {3.7173548750864697`*^9, 
   3.717354881757492*^9}, {3.717354996753583*^9, 3.717355017245678*^9}, {
   3.717355319697336*^9, 3.7173553216726255`*^9}, {3.7173557531181636`*^9, 
   3.7173557820403166`*^9}, {3.7173558138063755`*^9, 
   3.7173558166812677`*^9}, {3.7173587645155315`*^9, 
   3.7173587704721184`*^9}, {3.7173588122062426`*^9, 
   3.7173588501286516`*^9}, {3.717359014190798*^9, 3.7173590339564075`*^9}, {
   3.7173591194571896`*^9, 3.7173591202540846`*^9}, {3.717360749384885*^9, 
   3.717360755072524*^9}, {3.7173608405541487`*^9, 3.7173608453215923`*^9}, {
   3.7174176653039513`*^9, 3.7174177502357674`*^9}, {3.717418005127076*^9, 
   3.717418022383568*^9}, {3.7174180927900662`*^9, 3.717418180868244*^9}, {
   3.717419219270834*^9, 3.7174192266613092`*^9}, {3.71741926925568*^9, 
   3.717419272755123*^9}, {3.7174241468474283`*^9, 3.7174241510843997`*^9}, {
   3.71742429898483*^9, 3.717424381678406*^9}, {3.717427960779907*^9, 
   3.7174279724352093`*^9}, {3.7174281618258095`*^9, 
   3.7174281652786007`*^9}, {3.7208066594239817`*^9, 
   3.7208066657144737`*^9}, {3.723057650960129*^9, 3.7230576545889745`*^9}, {
   3.7235054152685385`*^9, 3.723505446143653*^9}, {3.723505542221841*^9, 
   3.7235055715031414`*^9}, {3.723505611190547*^9, 3.7235056388310738`*^9}, 
   3.7235057207531905`*^9, {3.723511832834532*^9, 3.7235118497876167`*^9}, {
   3.723511887365533*^9, 3.72351189056898*^9}, 3.726518499578006*^9, {
   3.726518560374749*^9, 3.7265185767658353`*^9}, {3.726519168245932*^9, 
   3.726519201792951*^9}, {3.7566587809361*^9, 3.756658784360771*^9}, {
   3.756658956620803*^9, 3.756658971527032*^9}, {3.849477836812758*^9, 
   3.849477856352066*^9}, {3.8494779451708803`*^9, 3.849477945263883*^9}},
 CellLabel->"In[74]:=",ExpressionUUID->"ce75a897-c9bf-4e52-901c-ba13cbc04188"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Table", "[", 
  RowBox[{
   RowBox[{"SetPrecision", "[", 
    RowBox[{
     RowBox[{"Transpose", "[", 
      RowBox[{"GradOp", "[", 
       RowBox[{"[", "i", "]"}], "]"}], "]"}], ",", "2"}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"i", ",", "1", ",", "6"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.723505659409583*^9, 3.7235056624558945`*^9}, {
  3.7235057476593637`*^9, 3.7235057479091177`*^9}, {3.723506092534135*^9, 
  3.723506114956089*^9}, {3.723511860928227*^9, 3.7235118618810616`*^9}, {
  3.723511987702938*^9, 3.7235119968124857`*^9}, {3.7265192145272465`*^9, 
  3.726519217747201*^9}, {3.756658976515585*^9, 3.756658978773281*^9}, {
  3.849477651117529*^9, 3.849477655919848*^9}, {3.849477703960012*^9, 
  3.849477704955153*^9}, {3.8494777539810266`*^9, 3.849477758377636*^9}, {
  3.849477884181432*^9, 3.8494778865570927`*^9}, {3.84947814156188*^9, 
  3.849478184617948*^9}, {3.84950004194213*^9, 3.849500064181696*^9}, {
  3.849500095090515*^9, 3.849500103211679*^9}},
 CellLabel->"In[75]:=",ExpressionUUID->"ff016f88-a171-401e-a033-7b7fad4b294b"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", 
       RowBox[{"-", "2.`2."}], ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"2.`2.", ",", "0", ",", 
       RowBox[{"-", "2.`2."}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "2.`2."}], ",", "2.`2.", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "2.`2."}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", 
       RowBox[{"-", "2.`2."}], ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "2.`2.", ",", 
       RowBox[{"-", "2.`2."}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "2.`2."}], ",", "0", ",", "2.`2."}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"2.`2.", ",", "0", ",", "0"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", 
       RowBox[{"-", "2.`2."}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "2.`2."}], ",", "2.`2.", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", 
       RowBox[{"-", "2.`2."}], ",", "2.`2."}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"2.`2.", ",", "0", ",", "0"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", 
       RowBox[{"-", "2.`2."}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "2.`2."}], ",", "0", ",", "2.`2."}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"2.`2.", ",", 
       RowBox[{"-", "2.`2."}], ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "2.`2.", ",", "0"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "2.`2."}], ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", 
       RowBox[{"-", "2.`2."}], ",", "2.`2."}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"2.`2.", ",", "0", ",", 
       RowBox[{"-", "2.`2."}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "2.`2.", ",", "0"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "2.`2."}], ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"2.`2.", ",", 
       RowBox[{"-", "2.`2."}], ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "2.`2.", ",", 
       RowBox[{"-", "2.`2."}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "2.`2."}], "}"}]}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{
  3.7235056633778315`*^9, {3.7235057267213154`*^9, 3.72350574884632*^9}, 
   3.7235058719249067`*^9, 3.7235061165654483`*^9, 3.7235119033810225`*^9, 
   3.72351199906176*^9, 3.723981170104637*^9, 3.7265158705191135`*^9, 
   3.7265192194647903`*^9, 3.7284277488612876`*^9, 3.7404311039543076`*^9, 
   3.756658705675426*^9, 3.756658793117358*^9, 3.756658991732841*^9, 
   3.756690639943367*^9, 3.757172238019086*^9, 3.757258501187461*^9, 
   3.7577179253336496`*^9, 3.8494776571339827`*^9, {3.849477733630015*^9, 
   3.849477758910125*^9}, 3.8494778885858097`*^9, 3.8494779504944143`*^9, {
   3.849478148197321*^9, 3.849478185127248*^9}, {3.849500049451625*^9, 
   3.849500065308144*^9}, {3.849500096940173*^9, 3.8495001041727*^9}, 
   3.8503258879885683`*^9, 3.906648169171777*^9, 3.9067401702592907`*^9, 
   3.906741725951709*^9, {3.9067417787673407`*^9, 3.9067417932432947`*^9}, 
   3.9067428136224947`*^9, 3.906810147894669*^9, 3.906810706635563*^9, 
   3.906810835308939*^9, 3.906814981114047*^9, 3.9068151085381927`*^9, 
   3.906815353649881*^9, 3.906815513439095*^9, 3.9068158958279047`*^9, 
   3.906819150365404*^9, 3.906821083182746*^9, 3.906822138886814*^9, 
   3.906822394991241*^9, 3.9068226631732683`*^9, 3.906823112836412*^9, 
   3.9068234612625303`*^9, 3.907257815910935*^9},
 CellLabel->"Out[75]=",ExpressionUUID->"c0798d8a-c247-4371-808b-348cd2c3eb8e"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[StyleBox["Compute the temperature gradient:", \
"Subsubsection"]], "Subsection",
 CellChangeTimes->{{3.7171711972127666`*^9, 3.71717120142911*^9}, {
  3.7235049764198055`*^9, 3.723505001764184*^9}, {3.7235116638104506`*^9, 
  3.7235116651539674`*^9}, {3.7235117226463957`*^9, 3.723511723427744*^9}, {
  3.7265184340783014`*^9, 3.726518438796838*^9}, {3.7566588833112*^9, 
  3.75665888526856*^9}, {3.7566591390943317`*^9, 3.756659143582884*^9}, {
  3.756691042483718*^9, 
  3.7566910512965465`*^9}},ExpressionUUID->"5860f7f5-2d1c-48b4-8888-\
7ed0fda6f20a"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ndofs", "=", "4"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"TGrad", "=", 
   RowBox[{"Table", "[", 
    RowBox[{"0.0", ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"Length", "[", "connect", "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "1", ",", "3"}], "}"}]}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.717166271741476*^9, 3.71716629726234*^9}, {
  3.717423563398694*^9, 3.717423566476555*^9}, {3.717424308471903*^9, 
  3.717424318282713*^9}, {3.7174279410435295`*^9, 3.717427953121283*^9}, {
  3.720806567996297*^9, 3.7208066398399677`*^9}, {3.7235053432057877`*^9, 
  3.7235054046120386`*^9}, {3.7235117305213585`*^9, 3.7235117319907336`*^9}, {
  3.726518443374713*^9, 3.726518462578518*^9}, {3.75665893403188*^9, 
  3.756658951568839*^9}, {3.756690716179819*^9, 3.7566907543675966`*^9}, {
  3.849500359708156*^9, 3.849500370207872*^9}},
 CellLabel->"In[76]:=",ExpressionUUID->"872f2a55-0e59-488c-8b5e-47561c639dde"],

Cell[BoxData[
 RowBox[{"For", "[", 
  RowBox[{
   RowBox[{"i", "=", "1"}], ",", " ", 
   RowBox[{"i", "\[LessEqual]", " ", 
    RowBox[{"Length", "[", "connect", "]"}]}], ",", 
   RowBox[{"i", "++"}], ",", 
   RowBox[{"Block", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"i1", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"connect", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}], "+", "1"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"i2", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"connect", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "[", 
          RowBox[{"[", "2", "]"}], "]"}], "+", "1"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"i3", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"connect", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "[", 
          RowBox[{"[", "3", "]"}], "]"}], "+", "1"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"i4", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"connect", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "[", 
          RowBox[{"[", "4", "]"}], "]"}], "+", "1"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"ids", "=", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"ndofs", " ", 
            RowBox[{"(", 
             RowBox[{"i1", "-", "1"}], ")"}]}], "+", "4"}], ",", 
          RowBox[{
           RowBox[{"ndofs", 
            RowBox[{"(", " ", 
             RowBox[{"i2", "-", "1"}], ")"}]}], "+", "4"}], ",", 
          RowBox[{
           RowBox[{"ndofs", 
            RowBox[{"(", 
             RowBox[{"i3", "-", "1"}], ")"}]}], "+", "4"}], ",", 
          RowBox[{
           RowBox[{"ndofs", 
            RowBox[{"(", 
             RowBox[{"i4", "-", "1"}], ")"}]}], "+", "4"}]}], "}"}]}]}], 
      "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"TGrad", "[", 
        RowBox[{"[", "i", "]"}], "]"}], "=", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"gmatrix", "[", 
          RowBox[{
           RowBox[{"xv", "[", 
            RowBox[{"[", "i1", "]"}], "]"}], ",", 
           RowBox[{"yv", "[", 
            RowBox[{"[", "i1", "]"}], "]"}], ",", 
           RowBox[{"zv", "[", 
            RowBox[{"[", "i1", "]"}], "]"}], ",", 
           RowBox[{"xv", "[", 
            RowBox[{"[", "i2", "]"}], "]"}], ",", 
           RowBox[{"yv", "[", 
            RowBox[{"[", "i2", "]"}], "]"}], ",", 
           RowBox[{"zv", "[", 
            RowBox[{"[", "i2", "]"}], "]"}], ",", 
           RowBox[{"xv", "[", 
            RowBox[{"[", "i3", "]"}], "]"}], ",", 
           RowBox[{"yv", "[", 
            RowBox[{"[", "i3", "]"}], "]"}], ",", 
           RowBox[{"zv", "[", 
            RowBox[{"[", "i3", "]"}], "]"}], ",", 
           RowBox[{"xv", "[", 
            RowBox[{"[", "i4", "]"}], "]"}], ",", 
           RowBox[{"yv", "[", 
            RowBox[{"[", "i4", "]"}], "]"}], ",", 
           RowBox[{"zv", "[", 
            RowBox[{"[", "i4", "]"}], "]"}]}], "]"}], ".", 
         RowBox[{"(", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"uv", "[", 
             RowBox[{"[", 
              RowBox[{"ids", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "]"}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "1", ",", "4"}], "}"}]}], "]"}], ")"}]}], 
        ")"}]}], ";"}]}], "\[IndentingNewLine]", "]"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.7167647605597653`*^9, 3.7167647892518883`*^9}, {
   3.7167648244240847`*^9, 3.716764841539942*^9}, {3.71676488019324*^9, 
   3.7167648969754357`*^9}, {3.716765065628334*^9, 3.716765185350045*^9}, {
   3.7167652229401484`*^9, 3.7167652383100395`*^9}, {3.7167653441168547`*^9, 
   3.7167655199547443`*^9}, {3.7167655675522327`*^9, 
   3.7167655810711265`*^9}, {3.716765622284607*^9, 3.7167656290567384`*^9}, {
   3.716765757154343*^9, 3.716765792076064*^9}, {3.7167658276745405`*^9, 
   3.7167660826802125`*^9}, {3.716766195664576*^9, 3.716766242915578*^9}, {
   3.7167663310833845`*^9, 3.7167663393539863`*^9}, {3.7167664503932595`*^9, 
   3.716766450932579*^9}, {3.7167664868258085`*^9, 3.7167665635541043`*^9}, {
   3.716766627651472*^9, 3.716766643645746*^9}, {3.716766826115865*^9, 
   3.7167668360695195`*^9}, {3.716766868385886*^9, 3.7167669130203*^9}, {
   3.717155721663645*^9, 3.7171557331420517`*^9}, {3.717155769178903*^9, 
   3.7171557818205233`*^9}, {3.7171567883516493`*^9, 3.717156887869956*^9}, {
   3.717156918335051*^9, 3.717156937057849*^9}, {3.717157017416103*^9, 
   3.717157052623994*^9}, {3.717157895689323*^9, 3.717157931742132*^9}, {
   3.717166282194605*^9, 3.71716628473459*^9}, {3.71716849797501*^9, 
   3.71716852298344*^9}, {3.717168562021318*^9, 3.717168562125424*^9}, {
   3.717168843821663*^9, 3.717168857297769*^9}, {3.7171692165304537`*^9, 
   3.7171692208302*^9}, {3.717170006857576*^9, 3.717170018830927*^9}, {
   3.717171209233417*^9, 3.717171213025419*^9}, {3.7173548750864697`*^9, 
   3.717354881757492*^9}, {3.717354996753583*^9, 3.717355017245678*^9}, {
   3.717355319697336*^9, 3.7173553216726255`*^9}, {3.7173557531181636`*^9, 
   3.7173557820403166`*^9}, {3.7173558138063755`*^9, 
   3.7173558166812677`*^9}, {3.7173587645155315`*^9, 
   3.7173587704721184`*^9}, {3.7173588122062426`*^9, 
   3.7173588501286516`*^9}, {3.717359014190798*^9, 3.7173590339564075`*^9}, {
   3.7173591194571896`*^9, 3.7173591202540846`*^9}, {3.717360749384885*^9, 
   3.717360755072524*^9}, {3.7173608405541487`*^9, 3.7173608453215923`*^9}, {
   3.7174176653039513`*^9, 3.7174177502357674`*^9}, {3.717418005127076*^9, 
   3.717418022383568*^9}, {3.7174180927900662`*^9, 3.717418180868244*^9}, {
   3.717419219270834*^9, 3.7174192266613092`*^9}, {3.71741926925568*^9, 
   3.717419272755123*^9}, {3.7174241468474283`*^9, 3.7174241510843997`*^9}, {
   3.71742429898483*^9, 3.717424381678406*^9}, {3.717427960779907*^9, 
   3.7174279724352093`*^9}, {3.7174281618258095`*^9, 
   3.7174281652786007`*^9}, {3.7208066594239817`*^9, 
   3.7208066657144737`*^9}, {3.723057650960129*^9, 3.7230576545889745`*^9}, {
   3.7235054152685385`*^9, 3.723505446143653*^9}, {3.723505542221841*^9, 
   3.7235055715031414`*^9}, {3.723505611190547*^9, 3.7235056388310738`*^9}, 
   3.7235057207531905`*^9, {3.723511832834532*^9, 3.7235118497876167`*^9}, {
   3.723511887365533*^9, 3.72351189056898*^9}, 3.726518499578006*^9, {
   3.726518560374749*^9, 3.7265185767658353`*^9}, {3.726519168245932*^9, 
   3.726519201792951*^9}, {3.7566587809361*^9, 3.756658784360771*^9}, {
   3.756658956620803*^9, 3.756658971527032*^9}, {3.756690778821248*^9, 
   3.756690786134622*^9}, {3.7566908236665444`*^9, 3.7566908255567884`*^9}, {
   3.756690901402877*^9, 3.7566909362161007`*^9}, {3.849500397396298*^9, 
   3.84950044573112*^9}},
 CellLabel->"In[78]:=",ExpressionUUID->"6d4057dd-1d33-4d6c-90c8-28d3276321c5"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Table", "[", 
  RowBox[{
   RowBox[{"SetPrecision", "[", 
    RowBox[{
     RowBox[{"TGrad", "[", 
      RowBox[{"[", "i", "]"}], "]"}], ",", "2"}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"i", ",", "1", ",", "4"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.723505659409583*^9, 3.7235056624558945`*^9}, {
  3.7235057476593637`*^9, 3.7235057479091177`*^9}, {3.723506092534135*^9, 
  3.723506114956089*^9}, {3.723511860928227*^9, 3.7235118618810616`*^9}, {
  3.723511987702938*^9, 3.7235119968124857`*^9}, {3.7265192145272465`*^9, 
  3.726519217747201*^9}, {3.756658976515585*^9, 3.756658978773281*^9}, {
  3.756690802025478*^9, 3.756690806572092*^9}, {3.849500454905917*^9, 
  3.849500523790513*^9}},
 CellLabel->"In[79]:=",ExpressionUUID->"9c27492e-386f-4ab0-b3cc-16819c9b77e8"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"7.2`2.*^-6", ",", "2.4`2.*^-6", ",", "8.`2.*^-7"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"7.2`2.*^-6", ",", "2.4`2.*^-6", ",", "8.`2.*^-7"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"7.2`2.*^-6", ",", "2.4`2.*^-6", ",", "8.`2.*^-7"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"7.2`2.*^-6", ",", "2.4`2.*^-6", ",", "8.`2.*^-7"}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{
  3.7235056633778315`*^9, {3.7235057267213154`*^9, 3.72350574884632*^9}, 
   3.7235058719249067`*^9, 3.7235061165654483`*^9, 3.7235119033810225`*^9, 
   3.72351199906176*^9, 3.723981170104637*^9, 3.7265158705191135`*^9, 
   3.7265192194647903`*^9, 3.7284277488612876`*^9, 3.7404311039543076`*^9, 
   3.756658705675426*^9, 3.756658793117358*^9, 3.756658991732841*^9, 
   3.756690639943367*^9, 3.756690815681492*^9, 3.7566909081996827`*^9, 
   3.7566909396533284`*^9, 3.7571722672960787`*^9, 3.75725851254243*^9, 
   3.7577179420532455`*^9, {3.849500458174811*^9, 3.849500485911908*^9}, {
   3.84950051643318*^9, 3.84950052492071*^9}, 3.850325888008675*^9, 
   3.906648176378261*^9, 3.9067401704978533`*^9, 3.9067417260333977`*^9, {
   3.906741778848461*^9, 3.906741793356833*^9}, 3.906742813703026*^9, 
   3.906810147950283*^9, 3.906810706700095*^9, 3.906810835412857*^9, 
   3.906814981198996*^9, 3.9068151085890303`*^9, 3.9068153537153263`*^9, 
   3.906815513635437*^9, 3.906815895896249*^9, 3.906819150494368*^9, 
   3.9068210832868233`*^9, 3.9068221389865932`*^9, 3.90682239505816*^9, 
   3.906822663241539*^9, 3.906823112904304*^9, 3.906823461339181*^9, 
   3.907257815956832*^9},
 CellLabel->"Out[79]=",ExpressionUUID->"3dda9842-42d1-47b6-9407-364399b7506e"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Assemble the global stiffness:", "Subsection",
 CellChangeTimes->{{3.7171711972127666`*^9, 
  3.71717120142911*^9}},ExpressionUUID->"57b92da3-4a18-4aa2-8b87-\
12b63d36cd9a"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ndofsTotal", "=", 
   RowBox[{"ndofs", " ", 
    RowBox[{"Length", "[", "xv", "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Klocal", "=", 
   RowBox[{"Table", "[", 
    RowBox[{"0.0", ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"Length", "[", "connect", "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "1", ",", 
       RowBox[{"nnodes", "*", "ndofs"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"k", ",", "1", ",", 
       RowBox[{"nnodes", "*", "ndofs"}]}], "}"}]}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.717166271741476*^9, 3.71716629726234*^9}, {
  3.717423563398694*^9, 3.717423566476555*^9}, {3.717424308471903*^9, 
  3.717424318282713*^9}, {3.7174279410435295`*^9, 3.717427953121283*^9}, {
  3.720806567996297*^9, 3.7208066398399677`*^9}, {3.7633996837483525`*^9, 
  3.763399728831224*^9}, {3.7640829218072453`*^9, 3.7640829235916023`*^9}, {
  3.7647623502230196`*^9, 3.764762353941988*^9}, {3.7656431867272067`*^9, 
  3.76564319429356*^9}, {3.799601176753293*^9, 3.7996011793300533`*^9}, {
  3.9066482077997932`*^9, 3.9066482092978783`*^9}},
 CellLabel->"In[80]:=",ExpressionUUID->"68f460db-017a-43ee-8bb2-c26c0b7a873a"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Kglobal", "=", 
   RowBox[{"Table", "[", 
    RowBox[{"0.0", ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", "ndofsTotal"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "1", ",", "ndofsTotal"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"For", "[", 
  RowBox[{
   RowBox[{"i", "=", "1"}], ",", " ", 
   RowBox[{"i", "\[LessEqual]", " ", 
    RowBox[{"Length", "[", "connect", "]"}]}], ",", 
   RowBox[{"i", "++"}], ",", 
   RowBox[{"Block", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"i1", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"connect", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}], "+", "1"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"i2", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"connect", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "[", 
          RowBox[{"[", "2", "]"}], "]"}], "+", "1"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"i3", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"connect", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "[", 
          RowBox[{"[", "3", "]"}], "]"}], "+", "1"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"i4", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"connect", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "[", 
          RowBox[{"[", "4", "]"}], "]"}], "+", "1"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"ids", "=", 
        RowBox[{"{", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"ndofs", " ", 
            RowBox[{"(", 
             RowBox[{"i1", "-", "1"}], ")"}]}], "+", "1"}], ",", " ", 
          RowBox[{
           RowBox[{"ndofs", 
            RowBox[{"(", " ", 
             RowBox[{"i1", "-", "1"}], ")"}]}], "+", "2"}], ",", " ", 
          RowBox[{
           RowBox[{"ndofs", 
            RowBox[{"(", " ", 
             RowBox[{"i1", "-", "1"}], ")"}]}], "+", "3"}], ",", " ", 
          RowBox[{
           RowBox[{"ndofs", 
            RowBox[{"(", 
             RowBox[{"i1", "-", "1"}], ")"}]}], "+", "4"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"ndofs", 
            RowBox[{"(", " ", 
             RowBox[{"i2", "-", "1"}], ")"}]}], "+", "1"}], ",", 
          RowBox[{
           RowBox[{"ndofs", 
            RowBox[{"(", 
             RowBox[{"i2", "-", "1"}], ")"}]}], "+", "2"}], ",", " ", 
          RowBox[{
           RowBox[{"ndofs", 
            RowBox[{"(", " ", 
             RowBox[{"i2", "-", "1"}], ")"}]}], "+", "3"}], ",", 
          RowBox[{
           RowBox[{"ndofs", 
            RowBox[{"(", 
             RowBox[{"i2", "-", "1"}], ")"}]}], "+", "4"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"ndofs", 
            RowBox[{"(", 
             RowBox[{"i3", "-", "1"}], ")"}]}], "+", "1"}], ",", 
          RowBox[{
           RowBox[{"ndofs", " ", 
            RowBox[{"(", 
             RowBox[{"i3", "-", "1"}], ")"}]}], "+", "2"}], ",", " ", 
          RowBox[{
           RowBox[{"ndofs", 
            RowBox[{"(", " ", 
             RowBox[{"i3", "-", "1"}], ")"}]}], "+", "3"}], ",", 
          RowBox[{
           RowBox[{"ndofs", 
            RowBox[{"(", 
             RowBox[{"i3", "-", "1"}], ")"}]}], "+", "4"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"ndofs", 
            RowBox[{"(", 
             RowBox[{"i4", "-", "1"}], ")"}]}], "+", "1"}], ",", 
          RowBox[{
           RowBox[{"ndofs", 
            RowBox[{"(", 
             RowBox[{"i4", "-", "1"}], ")"}]}], "+", "2"}], ",", " ", 
          RowBox[{
           RowBox[{"ndofs", 
            RowBox[{"(", " ", 
             RowBox[{"i4", "-", "1"}], ")"}]}], "+", "3"}], ",", 
          RowBox[{
           RowBox[{"ndofs", 
            RowBox[{"(", 
             RowBox[{"i4", "-", "1"}], ")"}]}], "+", "4"}]}], 
         "\[IndentingNewLine]", "}"}]}]}], "\[IndentingNewLine]", "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Kelmm", "=", 
       RowBox[{"Table", "[", 
        RowBox[{"0.0", ",", 
         RowBox[{"{", 
          RowBox[{"ii", ",", "1", ",", "12"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"jj", ",", "1", ",", "12"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Keltt", "=", 
       RowBox[{"Table", "[", 
        RowBox[{"0.0", ",", 
         RowBox[{"{", 
          RowBox[{"ii", ",", "1", ",", "4"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"jj", ",", "1", ",", "4"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Kelmt", "=", 
       RowBox[{"Table", "[", 
        RowBox[{"0.0", ",", 
         RowBox[{"{", 
          RowBox[{"ii", ",", "1", ",", "12"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"jj", ",", "1", ",", "4"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Mel", "=", 
       RowBox[{"Table", "[", 
        RowBox[{"0.0", ",", 
         RowBox[{"{", 
          RowBox[{"ii", ",", "1", ",", "4"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"jj", ",", "1", ",", "4"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"j", "=", "1"}], ",", 
        RowBox[{"j", "<=", 
         RowBox[{"Length", "[", "gp", "]"}]}], ",", 
        RowBox[{"j", "++"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Kelmm", "+=", 
          RowBox[{
           RowBox[{"gw", "[", 
            RowBox[{"[", "j", "]"}], "]"}], "*", 
           RowBox[{"Kmm", "[", 
            RowBox[{
             RowBox[{"xv", "[", 
              RowBox[{"[", "i1", "]"}], "]"}], ",", 
             RowBox[{"yv", "[", 
              RowBox[{"[", "i1", "]"}], "]"}], ",", 
             RowBox[{"zv", "[", 
              RowBox[{"[", "i1", "]"}], "]"}], ",", 
             RowBox[{"xv", "[", 
              RowBox[{"[", "i2", "]"}], "]"}], ",", 
             RowBox[{"yv", "[", 
              RowBox[{"[", "i2", "]"}], "]"}], ",", 
             RowBox[{"zv", "[", 
              RowBox[{"[", "i2", "]"}], "]"}], ",", 
             RowBox[{"xv", "[", 
              RowBox[{"[", "i3", "]"}], "]"}], ",", 
             RowBox[{"yv", "[", 
              RowBox[{"[", "i3", "]"}], "]"}], ",", 
             RowBox[{"zv", "[", 
              RowBox[{"[", "i3", "]"}], "]"}], ",", 
             RowBox[{"xv", "[", 
              RowBox[{"[", "i4", "]"}], "]"}], ",", 
             RowBox[{"yv", "[", 
              RowBox[{"[", "i4", "]"}], "]"}], ",", 
             RowBox[{"zv", "[", 
              RowBox[{"[", "i4", "]"}], "]"}], ",", 
             RowBox[{"1", "*", 
              SuperscriptBox["10", "11"]}], ",", "0.3"}], "]"}]}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"Keltt", "+=", 
          RowBox[{
           RowBox[{
            RowBox[{"gw", "[", 
             RowBox[{"[", "j", "]"}], "]"}], "*", 
            RowBox[{"ktt", "[", 
             RowBox[{
              RowBox[{"xv", "[", 
               RowBox[{"[", "i1", "]"}], "]"}], ",", 
              RowBox[{"yv", "[", 
               RowBox[{"[", "i1", "]"}], "]"}], ",", 
              RowBox[{"zv", "[", 
               RowBox[{"[", "i1", "]"}], "]"}], ",", 
              RowBox[{"xv", "[", 
               RowBox[{"[", "i2", "]"}], "]"}], ",", 
              RowBox[{"yv", "[", 
               RowBox[{"[", "i2", "]"}], "]"}], ",", 
              RowBox[{"zv", "[", 
               RowBox[{"[", "i2", "]"}], "]"}], ",", 
              RowBox[{"xv", "[", 
               RowBox[{"[", "i3", "]"}], "]"}], ",", 
              RowBox[{"yv", "[", 
               RowBox[{"[", "i3", "]"}], "]"}], ",", 
              RowBox[{"zv", "[", 
               RowBox[{"[", "i3", "]"}], "]"}], ",", 
              RowBox[{"xv", "[", 
               RowBox[{"[", "i4", "]"}], "]"}], ",", 
              RowBox[{"yv", "[", 
               RowBox[{"[", "i4", "]"}], "]"}], ",", 
              RowBox[{"zv", "[", 
               RowBox[{"[", "i4", "]"}], "]"}], ",", "ConductionCoeff"}], 
             "]"}]}], "/.", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"\[Xi]", "\[Rule]", 
              RowBox[{
               RowBox[{"gp", "[", 
                RowBox[{"[", "j", "]"}], "]"}], "[", 
               RowBox[{"[", "1", "]"}], "]"}]}], ",", 
             RowBox[{"\[Psi]", "\[Rule]", 
              RowBox[{
               RowBox[{"gp", "[", 
                RowBox[{"[", "j", "]"}], "]"}], "[", 
               RowBox[{"[", "2", "]"}], "]"}]}], ",", 
             RowBox[{"\[Zeta]", "\[Rule]", 
              RowBox[{
               RowBox[{"gp", "[", 
                RowBox[{"[", "j", "]"}], "]"}], "[", 
               RowBox[{"[", "3", "]"}], "]"}]}]}], "}"}]}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"Mel", "+=", 
          RowBox[{
           RowBox[{"gw", "[", 
            RowBox[{"[", "j", "]"}], "]"}], "*", 
           RowBox[{"Mmat", "[", 
            RowBox[{
             RowBox[{"xv", "[", 
              RowBox[{"[", "i1", "]"}], "]"}], ",", 
             RowBox[{"yv", "[", 
              RowBox[{"[", "i1", "]"}], "]"}], ",", 
             RowBox[{"zv", "[", 
              RowBox[{"[", "i1", "]"}], "]"}], ",", 
             RowBox[{"xv", "[", 
              RowBox[{"[", "i2", "]"}], "]"}], ",", 
             RowBox[{"yv", "[", 
              RowBox[{"[", "i2", "]"}], "]"}], ",", 
             RowBox[{"zv", "[", 
              RowBox[{"[", "i2", "]"}], "]"}], ",", 
             RowBox[{"xv", "[", 
              RowBox[{"[", "i3", "]"}], "]"}], ",", 
             RowBox[{"yv", "[", 
              RowBox[{"[", "i3", "]"}], "]"}], ",", 
             RowBox[{"zv", "[", 
              RowBox[{"[", "i3", "]"}], "]"}], ",", 
             RowBox[{"xv", "[", 
              RowBox[{"[", "i4", "]"}], "]"}], ",", 
             RowBox[{"yv", "[", 
              RowBox[{"[", "i4", "]"}], "]"}], ",", 
             RowBox[{"zv", "[", 
              RowBox[{"[", "i4", "]"}], "]"}], ",", "0.3", ",", 
             RowBox[{"1", "*", 
              SuperscriptBox["10", "6"]}]}], "]"}]}]}], ";", " ", 
         "\[IndentingNewLine]", 
         RowBox[{"Kelmt", "+=", 
          RowBox[{
           RowBox[{
            RowBox[{"gw", "[", 
             RowBox[{"[", "j", "]"}], "]"}], "*", 
            RowBox[{"kmt", "[", 
             RowBox[{
              RowBox[{"xv", "[", 
               RowBox[{"[", "i1", "]"}], "]"}], ",", 
              RowBox[{"yv", "[", 
               RowBox[{"[", "i1", "]"}], "]"}], ",", 
              RowBox[{"zv", "[", 
               RowBox[{"[", "i1", "]"}], "]"}], ",", 
              RowBox[{"xv", "[", 
               RowBox[{"[", "i2", "]"}], "]"}], ",", 
              RowBox[{"yv", "[", 
               RowBox[{"[", "i2", "]"}], "]"}], ",", 
              RowBox[{"zv", "[", 
               RowBox[{"[", "i2", "]"}], "]"}], ",", 
              RowBox[{"xv", "[", 
               RowBox[{"[", "i3", "]"}], "]"}], ",", 
              RowBox[{"yv", "[", 
               RowBox[{"[", "i3", "]"}], "]"}], ",", 
              RowBox[{"zv", "[", 
               RowBox[{"[", "i3", "]"}], "]"}], ",", 
              RowBox[{"xv", "[", 
               RowBox[{"[", "i4", "]"}], "]"}], ",", 
              RowBox[{"yv", "[", 
               RowBox[{"[", "i4", "]"}], "]"}], ",", 
              RowBox[{"zv", "[", 
               RowBox[{"[", "i4", "]"}], "]"}], ",", 
              RowBox[{"1.0", "*", 
               SuperscriptBox["10", 
                RowBox[{"-", "5"}]]}], ",", 
              RowBox[{"1", "*", 
               SuperscriptBox["10", "11"]}], ",", "0.3"}], "]"}]}], "/.", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"\[Xi]", "\[Rule]", 
              RowBox[{
               RowBox[{"gp", "[", 
                RowBox[{"[", "j", "]"}], "]"}], "[", 
               RowBox[{"[", "1", "]"}], "]"}]}], ",", 
             RowBox[{"\[Psi]", "\[Rule]", 
              RowBox[{
               RowBox[{"gp", "[", 
                RowBox[{"[", "j", "]"}], "]"}], "[", 
               RowBox[{"[", "2", "]"}], "]"}]}], ",", 
             RowBox[{"\[Zeta]", "\[Rule]", 
              RowBox[{
               RowBox[{"gp", "[", 
                RowBox[{"[", "j", "]"}], "]"}], "[", 
               RowBox[{"[", "3", "]"}], "]"}]}]}], "}"}]}]}], ";"}]}], 
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"inode", "=", "0"}], ",", 
        RowBox[{"inode", "<", "nnodes"}], ",", 
        RowBox[{"inode", "++"}], ",", "\[IndentingNewLine]", 
        RowBox[{"For", "[", 
         RowBox[{
          RowBox[{"jnode", "=", "0"}], ",", 
          RowBox[{"jnode", "<", "nnodes"}], ",", 
          RowBox[{"jnode", "++"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"For", "[", 
            RowBox[{
             RowBox[{"idof", "=", "0"}], ",", 
             RowBox[{"idof", "<", "nmdofs"}], ",", 
             RowBox[{"idof", "++"}], ",", "\[IndentingNewLine]", 
             RowBox[{"For", "[", 
              RowBox[{
               RowBox[{"jdof", "=", "0"}], ",", 
               RowBox[{"jdof", "<", "nmdofs"}], ",", 
               RowBox[{"jdof", "++"}], ",", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{"Klocal", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "[", 
                   RowBox[{"[", 
                    RowBox[{
                    RowBox[{"inode", " ", "ndofs"}], "+", "idof", "+", "1"}], 
                    "]"}], "]"}], "[", 
                  RowBox[{"[", 
                   RowBox[{
                    RowBox[{"jnode", " ", "ndofs"}], "+", "jdof", "+", "1"}], 
                   "]"}], "]"}], " ", "=", 
                 RowBox[{
                  RowBox[{"Kelmm", "[", 
                   RowBox[{"[", 
                    RowBox[{
                    RowBox[{"inode", " ", "nmdofs"}], "+", "idof", "+", "1"}],
                     "]"}], "]"}], "[", 
                  RowBox[{"[", 
                   RowBox[{
                    RowBox[{"jnode", " ", "nmdofs"}], "+", "jdof", "+", "1"}],
                    "]"}], "]"}]}], ";"}]}], "\[IndentingNewLine]", "]"}]}], 
            "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"Klocal", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "[", 
              RowBox[{"[", 
               RowBox[{
                RowBox[{"inode", " ", "ndofs"}], "+", "nmdofs", "+", "1"}], 
               "]"}], "]"}], "[", 
             RowBox[{"[", 
              RowBox[{
               RowBox[{"jnode", " ", "ndofs"}], "+", "nmdofs", "+", "1"}], 
              "]"}], "]"}], " ", "=", 
            RowBox[{
             RowBox[{"Keltt", "[", 
              RowBox[{"[", 
               RowBox[{"inode", "+", "1"}], "]"}], "]"}], "[", 
             RowBox[{"[", 
              RowBox[{"jnode", "+", "1"}], "]"}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"For", "[", 
            RowBox[{
             RowBox[{"idof", "=", "0"}], ",", 
             RowBox[{"idof", "<", "nmdofs"}], ",", 
             RowBox[{"idof", "++"}], ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"Klocal", "[", 
                  RowBox[{"[", "i", "]"}], "]"}], "[", 
                 RowBox[{"[", 
                  RowBox[{
                   RowBox[{"inode", " ", "ndofs"}], "+", "idof", "+", "1"}], 
                  "]"}], "]"}], "[", 
                RowBox[{"[", 
                 RowBox[{
                  RowBox[{"jnode", " ", "ndofs"}], "+", "nmdofs", "+", "1"}], 
                 "]"}], "]"}], " ", "=", 
               RowBox[{"-", 
                RowBox[{
                 RowBox[{"Kelmt", "[", 
                  RowBox[{"[", 
                   RowBox[{
                    RowBox[{"inode", " ", "nmdofs"}], "+", "idof", "+", "1"}],
                    "]"}], "]"}], "[", 
                 RowBox[{"[", 
                  RowBox[{"jnode", "+", "1"}], "]"}], "]"}]}]}], ";"}]}], 
            "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"j", "=", "1"}], ",", 
        RowBox[{"j", "\[LessEqual]", 
         RowBox[{"ndofs", " ", "nnodes"}]}], ",", 
        RowBox[{"j", "++"}], ",", "\[IndentingNewLine]", 
        RowBox[{"For", "[", 
         RowBox[{
          RowBox[{"k", "=", "1"}], ",", 
          RowBox[{"k", "\[LessEqual]", 
           RowBox[{"ndofs", " ", "nnodes"}]}], ",", 
          RowBox[{"k", "++"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"Kglobal", "[", 
              RowBox[{"[", 
               RowBox[{"ids", "[", 
                RowBox[{"[", "j", "]"}], "]"}], "]"}], "]"}], "[", 
             RowBox[{"[", 
              RowBox[{"ids", "[", 
               RowBox[{"[", "k", "]"}], "]"}], "]"}], "]"}], "+=", 
            RowBox[{
             RowBox[{
              RowBox[{"Klocal", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "[", 
              RowBox[{"[", "j", "]"}], "]"}], "[", 
             RowBox[{"[", "k", "]"}], "]"}]}], ";"}]}], "]"}]}], "]"}]}]}], 
    "]"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.7167647605597653`*^9, 3.7167647892518883`*^9}, {
   3.7167648244240847`*^9, 3.716764841539942*^9}, {3.71676488019324*^9, 
   3.7167648969754357`*^9}, {3.716765065628334*^9, 3.716765185350045*^9}, {
   3.7167652229401484`*^9, 3.7167652383100395`*^9}, {3.7167653441168547`*^9, 
   3.7167655199547443`*^9}, {3.7167655675522327`*^9, 
   3.7167655810711265`*^9}, {3.716765622284607*^9, 3.7167656290567384`*^9}, {
   3.716765757154343*^9, 3.716765792076064*^9}, {3.7167658276745405`*^9, 
   3.7167660826802125`*^9}, {3.716766195664576*^9, 3.716766242915578*^9}, {
   3.7167663310833845`*^9, 3.7167663393539863`*^9}, {3.7167664503932595`*^9, 
   3.716766450932579*^9}, {3.7167664868258085`*^9, 3.7167665635541043`*^9}, {
   3.716766627651472*^9, 3.716766643645746*^9}, {3.716766826115865*^9, 
   3.7167668360695195`*^9}, {3.716766868385886*^9, 3.7167669130203*^9}, {
   3.717155721663645*^9, 3.7171557331420517`*^9}, {3.717155769178903*^9, 
   3.7171557818205233`*^9}, {3.7171567883516493`*^9, 3.717156887869956*^9}, {
   3.717156918335051*^9, 3.717156937057849*^9}, {3.717157017416103*^9, 
   3.717157052623994*^9}, {3.717157895689323*^9, 3.717157931742132*^9}, {
   3.717166282194605*^9, 3.71716628473459*^9}, {3.71716849797501*^9, 
   3.71716852298344*^9}, {3.717168562021318*^9, 3.717168562125424*^9}, {
   3.717168843821663*^9, 3.717168857297769*^9}, {3.7171692165304537`*^9, 
   3.7171692208302*^9}, {3.717170006857576*^9, 3.717170018830927*^9}, {
   3.717171209233417*^9, 3.717171213025419*^9}, {3.7173548750864697`*^9, 
   3.717354881757492*^9}, {3.717354996753583*^9, 3.717355017245678*^9}, {
   3.717355319697336*^9, 3.7173553216726255`*^9}, {3.7173557531181636`*^9, 
   3.7173557820403166`*^9}, {3.7173558138063755`*^9, 
   3.7173558166812677`*^9}, {3.7173587645155315`*^9, 
   3.7173587704721184`*^9}, {3.7173588122062426`*^9, 
   3.7173588501286516`*^9}, {3.717359014190798*^9, 3.7173590339564075`*^9}, {
   3.7173591194571896`*^9, 3.7173591202540846`*^9}, {3.717360749384885*^9, 
   3.717360755072524*^9}, {3.7173608405541487`*^9, 3.7173608453215923`*^9}, {
   3.7174176653039513`*^9, 3.7174177502357674`*^9}, {3.717418005127076*^9, 
   3.717418022383568*^9}, {3.7174180927900662`*^9, 3.717418180868244*^9}, {
   3.717419219270834*^9, 3.7174192266613092`*^9}, {3.71741926925568*^9, 
   3.717419272755123*^9}, {3.7174241468474283`*^9, 3.7174241510843997`*^9}, {
   3.71742429898483*^9, 3.717424381678406*^9}, {3.717427960779907*^9, 
   3.7174279724352093`*^9}, {3.7174281618258095`*^9, 
   3.7174281652786007`*^9}, {3.7208066594239817`*^9, 
   3.7208066657144737`*^9}, {3.723057650960129*^9, 3.7230576545889745`*^9}, {
   3.763398626297826*^9, 3.7633986377693434`*^9}, {3.763398969492062*^9, 
   3.763399017148432*^9}, {3.7633990692779627`*^9, 3.7633990694291053`*^9}, {
   3.7633991201481476`*^9, 3.763399174570841*^9}, {3.763399415268031*^9, 
   3.76339941606513*^9}, {3.7633996474373903`*^9, 3.7633996648412056`*^9}, {
   3.7633997501291094`*^9, 3.7633999258824277`*^9}, {3.7633999725549555`*^9, 
   3.763399976702032*^9}, {3.7634000083920765`*^9, 3.76340016737781*^9}, {
   3.7634002158964863`*^9, 3.76340029196223*^9}, {3.763400323496956*^9, 
   3.7634004027149053`*^9}, {3.76340045059245*^9, 3.763400463281616*^9}, {
   3.7634005294006834`*^9, 3.763400570424802*^9}, {3.764082973996101*^9, 
   3.764082975901887*^9}, {3.764085676134435*^9, 3.7640856834202404`*^9}, {
   3.7640858472503123`*^9, 3.7640858920767965`*^9}, {3.7640894255234814`*^9, 
   3.7640894257482643`*^9}, {3.7640894615887256`*^9, 
   3.7640894620724916`*^9}, {3.7640895179586363`*^9, 
   3.7640895273283195`*^9}, {3.7640896836413865`*^9, 
   3.7640896854169707`*^9}, {3.764098322843951*^9, 3.764098324217982*^9}, {
   3.7640983820840216`*^9, 3.764098382599674*^9}, {3.764099103461434*^9, 
   3.764099173185652*^9}, {3.764101764387092*^9, 3.7641017868352966`*^9}, 
   3.764761842376623*^9, {3.76476223129729*^9, 3.764762241509314*^9}, {
   3.7647622805381107`*^9, 3.764762305230457*^9}, {3.76476236061409*^9, 
   3.7647623840555506`*^9}, {3.7647624148034487`*^9, 
   3.7647624367677865`*^9}, {3.7647629353927927`*^9, 
   3.7647629384726405`*^9}, {3.7656458527622604`*^9, 3.765645867227993*^9}, {
   3.7996008466200123`*^9, 3.799600874616557*^9}, 3.799601014661991*^9, {
   3.7996011422754393`*^9, 3.799601144973835*^9}, {3.7996106418248577`*^9, 
   3.79961064644775*^9}, {3.9066482792796917`*^9, 3.906648378432694*^9}, {
   3.906648409912499*^9, 3.906648433052635*^9}, {3.90664849263453*^9, 
   3.906648499619605*^9}, {3.906739684911645*^9, 3.906739695872355*^9}, {
   3.906739728577354*^9, 3.906739778468915*^9}, 3.90681482798077*^9, {
   3.906815090959786*^9, 3.906815094082206*^9}, 3.9068151659265947`*^9, 
   3.906820865260247*^9},
 CellLabel->"In[82]:=",ExpressionUUID->"7588e917-d549-496a-a98d-a702386e3173"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Join", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"SetPrecision", "[", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Kglobal", "[", 
         RowBox[{"[", 
          RowBox[{
           RowBox[{"IntegerPart", "[", 
            RowBox[{"i", "/", "4"}], "]"}], "+", "1"}], "]"}], "]"}], "[", 
        RowBox[{"[", 
         RowBox[{
          RowBox[{"4", "*", "0"}], "+", 
          RowBox[{"Mod", "[", 
           RowBox[{"i", ",", "4"}], "]"}], "+", "1"}], "]"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "0", ",", "15"}], "}"}]}], "]"}], ",", "18"}], 
    "]"}], ",", "\[IndentingNewLine]", 
   RowBox[{"SetPrecision", "[", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Kglobal", "[", 
         RowBox[{"[", 
          RowBox[{
           RowBox[{"IntegerPart", "[", 
            RowBox[{"i", "/", "4"}], "]"}], "+", "1"}], "]"}], "]"}], "[", 
        RowBox[{"[", 
         RowBox[{
          RowBox[{"4", "*", "1"}], "+", 
          RowBox[{"Mod", "[", 
           RowBox[{"i", ",", "4"}], "]"}], "+", "1"}], "]"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "0", ",", "15"}], "}"}]}], "]"}], ",", "18"}], 
    "]"}], ",", "\[IndentingNewLine]", 
   RowBox[{"SetPrecision", "[", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Kglobal", "[", 
         RowBox[{"[", 
          RowBox[{
           RowBox[{"IntegerPart", "[", 
            RowBox[{"i", "/", "4"}], "]"}], "+", "1"}], "]"}], "]"}], "[", 
        RowBox[{"[", 
         RowBox[{
          RowBox[{"4", "*", "3"}], "+", 
          RowBox[{"Mod", "[", 
           RowBox[{"i", ",", "4"}], "]"}], "+", "1"}], "]"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "0", ",", "15"}], "}"}]}], "]"}], ",", "18"}], 
    "]"}], ",", "\[IndentingNewLine]", 
   RowBox[{"SetPrecision", "[", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Kglobal", "[", 
         RowBox[{"[", 
          RowBox[{
           RowBox[{"IntegerPart", "[", 
            RowBox[{"i", "/", "4"}], "]"}], "+", "1"}], "]"}], "]"}], "[", 
        RowBox[{"[", 
         RowBox[{
          RowBox[{"4", "*", "4"}], "+", 
          RowBox[{"Mod", "[", 
           RowBox[{"i", ",", "4"}], "]"}], "+", "1"}], "]"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "0", ",", "15"}], "}"}]}], "]"}], ",", "18"}], 
    "]"}]}], "\[IndentingNewLine]", "]"}]], "Input",
 CellChangeTimes->{{3.7641008499440265`*^9, 3.7641009191912155`*^9}, {
  3.764100982438418*^9, 3.764100994727434*^9}, {3.764101178024066*^9, 
  3.7641012178500237`*^9}, {3.849378403832006*^9, 3.849378408352264*^9}, {
  3.850325825362967*^9, 3.850325829303793*^9}},
 CellLabel->"In[84]:=",ExpressionUUID->"7926ee95-92f2-4436-8d86-30cb41cf9de0"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "3.5256410256410247802734375`18.*^10", ",", "0", ",", "0", ",", 
   "52083.333333333022892475128173828125`18.", ",", "0", ",", 
   "3.5256410256410247802734375`18.*^10", ",", "0", ",", 
   "52083.333333333022892475128173828125`18.", ",", "0", ",", "0", ",", 
   "3.5256410256410247802734375`18.*^10", ",", 
   "52083.333333333022892475128173828125`18.", ",", "0", ",", "0", ",", "0", 
   ",", "499.99999999999994315658113919198513031006`18.", ",", 
   RowBox[{"-", "6.4102564102564096450805664062`18.*^9"}], ",", "0", ",", 
   "3.2051282051282048225402832031`18.*^9", ",", "0", ",", "0", ",", 
   RowBox[{"-", "6.4102564102564096450805664062`18.*^9"}], ",", 
   "3.2051282051282048225402832031`18.*^9", ",", "0", ",", 
   "4.8076923076923065185546875`18.*^9", ",", 
   "4.8076923076923065185546875`18.*^9", ",", 
   RowBox[{"-", "2.2435897435897430419921875`18.*^10"}], ",", 
   "52083.3333333334303461015224456787109375`18.", ",", "0", ",", "0", ",", 
   "0", ",", 
   RowBox[{"-", "166.66666666666665719276352319866418838501`18."}], ",", 
   RowBox[{"-", "6.4102564102564096450805664062`18.*^9"}], ",", 
   "3.2051282051282048225402832031`18.*^9", ",", "0", ",", "0", ",", 
   "4.8076923076923065185546875`18.*^9", ",", 
   RowBox[{"-", "2.2435897435897430419921875`18.*^10"}], ",", 
   "4.8076923076923065185546875`18.*^9", ",", 
   "52083.3333333334303461015224456787109375`18.", ",", "0", ",", 
   "3.2051282051282048225402832031`18.*^9", ",", 
   RowBox[{"-", "6.4102564102564096450805664062`18.*^9"}], ",", "0", ",", "0",
    ",", "0", ",", "0", ",", 
   RowBox[{"-", "166.66666666666665719276352319866418838501`18."}], ",", "0", 
   ",", "3.2051282051282048225402832031`18.*^9", ",", 
   "3.2051282051282048225402832031`18.*^9", ",", "0", ",", 
   "4.8076923076923065185546875`18.*^9", ",", "0", ",", 
   RowBox[{"-", "8.0128205128205108642578125`18.*^9"}], ",", 
   "26041.66666666671517305076122283935546875`18.", ",", 
   "4.8076923076923065185546875`18.*^9", ",", 
   RowBox[{"-", "8.0128205128205108642578125`18.*^9"}], ",", "0", ",", 
   "26041.66666666671517305076122283935546875`18.", ",", "0", ",", "0", ",", 
   "0", ",", "0"}], "}"}]], "Output",
 CellChangeTimes->{
  3.7641009213624554`*^9, 3.764100995781635*^9, 3.764101184303155*^9, 
   3.7641012190423956`*^9, {3.7641017730569844`*^9, 3.764101791077053*^9}, 
   3.7642444926062255`*^9, 3.7643521038190885`*^9, 3.7643697931429815`*^9, 
   3.7646963581104608`*^9, 3.7647624893150654`*^9, 3.7647629564814973`*^9, 
   3.765643267772004*^9, 3.7656458786649103`*^9, 3.799600985521454*^9, 
   3.799601019365479*^9, 3.79960115094287*^9, 3.799601192793695*^9, 
   3.799608902547533*^9, 3.799610652988119*^9, 3.849378413660715*^9, 
   3.85032588865777*^9, 3.9066485119170017`*^9, 3.9067401736390553`*^9, 
   3.906741729245925*^9, {3.906741781552272*^9, 3.906741796688994*^9}, 
   3.906742816361762*^9, 3.906810150951552*^9, 3.9068107094175158`*^9, 
   3.906810837970439*^9, 3.9068149841523867`*^9, 3.906815111209944*^9, 
   3.906815356482163*^9, 3.906815516454164*^9, 3.906815898697576*^9, 
   3.906819153599318*^9, 3.90682087672209*^9, 3.906821086184662*^9, 
   3.906822141796864*^9, 3.906822397818379*^9, 3.9068226659561787`*^9, 
   3.906823115665586*^9, 3.906823464109001*^9, 3.907257817737178*^9},
 CellLabel->"Out[84]=",ExpressionUUID->"a1b220bd-66f8-47c0-98ef-c71a0e5684e8"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Assemble the global stiffness (Gradient wrt state dot):", "Subsection",
 CellChangeTimes->{{3.7171711972127666`*^9, 3.71717120142911*^9}, {
  3.765649480681896*^9, 3.765649491163704*^9}, {3.799601231153427*^9, 
  3.79960123625904*^9}},ExpressionUUID->"1a00b5e1-9901-401d-87d8-\
a2fa8b5fc56d"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"ndofsTotal", "=", 
    RowBox[{"ndofs", " ", 
     RowBox[{"Length", "[", "xv", "]"}]}]}], ";"}], 
  "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.717166271741476*^9, 3.71716629726234*^9}, {
   3.717423563398694*^9, 3.717423566476555*^9}, {3.717424308471903*^9, 
   3.717424318282713*^9}, {3.7174279410435295`*^9, 3.717427953121283*^9}, {
   3.720806567996297*^9, 3.7208066398399677`*^9}, {3.7633996837483525`*^9, 
   3.763399728831224*^9}, {3.7640829218072453`*^9, 3.7640829235916023`*^9}, {
   3.7647623502230196`*^9, 3.764762353941988*^9}, {3.7656431867272067`*^9, 
   3.76564319429356*^9}, {3.7656502555803876`*^9, 3.765650262899205*^9}, {
   3.7996012119439983`*^9, 3.79960121442213*^9}, 3.906648530953014*^9, {
   3.9068209735401154`*^9, 3.906820978762*^9}, {3.906821013817603*^9, 
   3.9068210208008547`*^9}, {3.9068223166573753`*^9, 3.906822318553296*^9}},
 CellLabel->"In[85]:=",ExpressionUUID->"e573a390-9a7b-4e8e-ac74-d5c4a6746f04"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Kglobal", "=", 
   RowBox[{"Table", "[", 
    RowBox[{"0.0", ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", "ndofsTotal"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "1", ",", "ndofsTotal"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Klocal", "=", 
   RowBox[{"Table", "[", 
    RowBox[{"0.0", ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"Length", "[", "connect", "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "1", ",", 
       RowBox[{"nnodes", "*", "ndofs"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"k", ",", "1", ",", 
       RowBox[{"nnodes", "*", "ndofs"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"For", "[", 
  RowBox[{
   RowBox[{"i", "=", "1"}], ",", " ", 
   RowBox[{"i", "\[LessEqual]", " ", 
    RowBox[{"Length", "[", "connect", "]"}]}], ",", 
   RowBox[{"i", "++"}], ",", 
   RowBox[{"Block", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"i1", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"connect", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}], "+", "1"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"i2", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"connect", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "[", 
          RowBox[{"[", "2", "]"}], "]"}], "+", "1"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"i3", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"connect", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "[", 
          RowBox[{"[", "3", "]"}], "]"}], "+", "1"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"i4", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"connect", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "[", 
          RowBox[{"[", "4", "]"}], "]"}], "+", "1"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"ids", "=", 
        RowBox[{"{", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"ndofs", " ", 
            RowBox[{"(", 
             RowBox[{"i1", "-", "1"}], ")"}]}], "+", "1"}], ",", " ", 
          RowBox[{
           RowBox[{"ndofs", 
            RowBox[{"(", " ", 
             RowBox[{"i1", "-", "1"}], ")"}]}], "+", "2"}], ",", " ", 
          RowBox[{
           RowBox[{"ndofs", 
            RowBox[{"(", " ", 
             RowBox[{"i1", "-", "1"}], ")"}]}], "+", "3"}], ",", " ", 
          RowBox[{
           RowBox[{"ndofs", 
            RowBox[{"(", 
             RowBox[{"i1", "-", "1"}], ")"}]}], "+", "4"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"ndofs", 
            RowBox[{"(", " ", 
             RowBox[{"i2", "-", "1"}], ")"}]}], "+", "1"}], ",", 
          RowBox[{
           RowBox[{"ndofs", 
            RowBox[{"(", 
             RowBox[{"i2", "-", "1"}], ")"}]}], "+", "2"}], ",", " ", 
          RowBox[{
           RowBox[{"ndofs", 
            RowBox[{"(", " ", 
             RowBox[{"i2", "-", "1"}], ")"}]}], "+", "3"}], ",", 
          RowBox[{
           RowBox[{"ndofs", 
            RowBox[{"(", 
             RowBox[{"i2", "-", "1"}], ")"}]}], "+", "4"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"ndofs", 
            RowBox[{"(", 
             RowBox[{"i3", "-", "1"}], ")"}]}], "+", "1"}], ",", 
          RowBox[{
           RowBox[{"ndofs", " ", 
            RowBox[{"(", 
             RowBox[{"i3", "-", "1"}], ")"}]}], "+", "2"}], ",", " ", 
          RowBox[{
           RowBox[{"ndofs", 
            RowBox[{"(", " ", 
             RowBox[{"i3", "-", "1"}], ")"}]}], "+", "3"}], ",", 
          RowBox[{
           RowBox[{"ndofs", 
            RowBox[{"(", 
             RowBox[{"i3", "-", "1"}], ")"}]}], "+", "4"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"ndofs", 
            RowBox[{"(", 
             RowBox[{"i4", "-", "1"}], ")"}]}], "+", "1"}], ",", 
          RowBox[{
           RowBox[{"ndofs", 
            RowBox[{"(", 
             RowBox[{"i4", "-", "1"}], ")"}]}], "+", "2"}], ",", " ", 
          RowBox[{
           RowBox[{"ndofs", 
            RowBox[{"(", " ", 
             RowBox[{"i4", "-", "1"}], ")"}]}], "+", "3"}], ",", 
          RowBox[{
           RowBox[{"ndofs", 
            RowBox[{"(", 
             RowBox[{"i4", "-", "1"}], ")"}]}], "+", "4"}]}], 
         "\[IndentingNewLine]", "}"}]}]}], "\[IndentingNewLine]", "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Keltt", "=", 
       RowBox[{"Table", "[", 
        RowBox[{"0.0", ",", 
         RowBox[{"{", 
          RowBox[{"ii", ",", "1", ",", "4"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"jj", ",", "1", ",", "4"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Mel", "=", 
       RowBox[{"Table", "[", 
        RowBox[{"0.0", ",", 
         RowBox[{"{", 
          RowBox[{"ii", ",", "1", ",", "4"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"jj", ",", "1", ",", "4"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"j", "=", "1"}], ",", 
        RowBox[{"j", "<=", 
         RowBox[{"Length", "[", "gp", "]"}]}], ",", 
        RowBox[{"j", "++"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Keltt", "+=", 
          RowBox[{
           RowBox[{
            RowBox[{"gw", "[", 
             RowBox[{"[", "j", "]"}], "]"}], "*", 
            RowBox[{"ktt", "[", 
             RowBox[{
              RowBox[{"xv", "[", 
               RowBox[{"[", "i1", "]"}], "]"}], ",", 
              RowBox[{"yv", "[", 
               RowBox[{"[", "i1", "]"}], "]"}], ",", 
              RowBox[{"zv", "[", 
               RowBox[{"[", "i1", "]"}], "]"}], ",", 
              RowBox[{"xv", "[", 
               RowBox[{"[", "i2", "]"}], "]"}], ",", 
              RowBox[{"yv", "[", 
               RowBox[{"[", "i2", "]"}], "]"}], ",", 
              RowBox[{"zv", "[", 
               RowBox[{"[", "i2", "]"}], "]"}], ",", 
              RowBox[{"xv", "[", 
               RowBox[{"[", "i3", "]"}], "]"}], ",", 
              RowBox[{"yv", "[", 
               RowBox[{"[", "i3", "]"}], "]"}], ",", 
              RowBox[{"zv", "[", 
               RowBox[{"[", "i3", "]"}], "]"}], ",", 
              RowBox[{"xv", "[", 
               RowBox[{"[", "i4", "]"}], "]"}], ",", 
              RowBox[{"yv", "[", 
               RowBox[{"[", "i4", "]"}], "]"}], ",", 
              RowBox[{"zv", "[", 
               RowBox[{"[", "i4", "]"}], "]"}], ",", "ConductionCoeff"}], 
             "]"}]}], "/.", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"\[Xi]", "\[Rule]", 
              RowBox[{
               RowBox[{"gp", "[", 
                RowBox[{"[", "j", "]"}], "]"}], "[", 
               RowBox[{"[", "1", "]"}], "]"}]}], ",", 
             RowBox[{"\[Psi]", "\[Rule]", 
              RowBox[{
               RowBox[{"gp", "[", 
                RowBox[{"[", "j", "]"}], "]"}], "[", 
               RowBox[{"[", "2", "]"}], "]"}]}], ",", 
             RowBox[{"\[Zeta]", "\[Rule]", 
              RowBox[{
               RowBox[{"gp", "[", 
                RowBox[{"[", "j", "]"}], "]"}], "[", 
               RowBox[{"[", "3", "]"}], "]"}]}]}], "}"}]}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"Mel", "+=", 
          RowBox[{
           RowBox[{
            RowBox[{"gw", "[", 
             RowBox[{"[", "j", "]"}], "]"}], "*", 
            RowBox[{"Mmat", "[", 
             RowBox[{
              RowBox[{"xv", "[", 
               RowBox[{"[", "i1", "]"}], "]"}], ",", 
              RowBox[{"yv", "[", 
               RowBox[{"[", "i1", "]"}], "]"}], ",", 
              RowBox[{"zv", "[", 
               RowBox[{"[", "i1", "]"}], "]"}], ",", 
              RowBox[{"xv", "[", 
               RowBox[{"[", "i2", "]"}], "]"}], ",", 
              RowBox[{"yv", "[", 
               RowBox[{"[", "i2", "]"}], "]"}], ",", 
              RowBox[{"zv", "[", 
               RowBox[{"[", "i2", "]"}], "]"}], ",", 
              RowBox[{"xv", "[", 
               RowBox[{"[", "i3", "]"}], "]"}], ",", 
              RowBox[{"yv", "[", 
               RowBox[{"[", "i3", "]"}], "]"}], ",", 
              RowBox[{"zv", "[", 
               RowBox[{"[", "i3", "]"}], "]"}], ",", 
              RowBox[{"xv", "[", 
               RowBox[{"[", "i4", "]"}], "]"}], ",", 
              RowBox[{"yv", "[", 
               RowBox[{"[", "i4", "]"}], "]"}], ",", 
              RowBox[{"zv", "[", 
               RowBox[{"[", "i4", "]"}], "]"}], ",", "0.3", ",", 
              RowBox[{"1", "*", 
               SuperscriptBox["10", "6"]}]}], "]"}]}], "/.", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"\[Xi]", "\[Rule]", 
              RowBox[{
               RowBox[{"gp", "[", 
                RowBox[{"[", "j", "]"}], "]"}], "[", 
               RowBox[{"[", "1", "]"}], "]"}]}], ",", 
             RowBox[{"\[Psi]", "\[Rule]", 
              RowBox[{
               RowBox[{"gp", "[", 
                RowBox[{"[", "j", "]"}], "]"}], "[", 
               RowBox[{"[", "2", "]"}], "]"}]}], ",", 
             RowBox[{"\[Zeta]", "\[Rule]", 
              RowBox[{
               RowBox[{"gp", "[", 
                RowBox[{"[", "j", "]"}], "]"}], "[", 
               RowBox[{"[", "3", "]"}], "]"}]}]}], "}"}]}]}], ";"}]}], 
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"inode", "=", "0"}], ",", 
        RowBox[{"inode", "<", "nnodes"}], ",", 
        RowBox[{"inode", "++"}], ",", "\[IndentingNewLine]", 
        RowBox[{"For", "[", 
         RowBox[{
          RowBox[{"jnode", "=", "0"}], ",", 
          RowBox[{"jnode", "<", "nnodes"}], ",", 
          RowBox[{"jnode", "++"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"Klocal", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "[", 
              RowBox[{"[", 
               RowBox[{
                RowBox[{"inode", " ", "ndofs"}], "+", "nmdofs", "+", "1"}], 
               "]"}], "]"}], "[", 
             RowBox[{"[", 
              RowBox[{
               RowBox[{"jnode", " ", "ndofs"}], "+", "nmdofs", "+", "1"}], 
              "]"}], "]"}], " ", "=", 
            RowBox[{
             RowBox[{"Mel", "[", 
              RowBox[{"[", 
               RowBox[{"inode", "+", "1"}], "]"}], "]"}], "[", 
             RowBox[{"[", 
              RowBox[{"jnode", "+", "1"}], "]"}], "]"}]}], ";"}]}], 
         "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"j", "=", "1"}], ",", 
        RowBox[{"j", "\[LessEqual]", 
         RowBox[{"ndofs", " ", "nnodes"}]}], ",", 
        RowBox[{"j", "++"}], ",", "\[IndentingNewLine]", 
        RowBox[{"For", "[", 
         RowBox[{
          RowBox[{"k", "=", "1"}], ",", 
          RowBox[{"k", "\[LessEqual]", 
           RowBox[{"ndofs", " ", "nnodes"}]}], ",", 
          RowBox[{"k", "++"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"Kglobal", "[", 
              RowBox[{"[", 
               RowBox[{"ids", "[", 
                RowBox[{"[", "j", "]"}], "]"}], "]"}], "]"}], "[", 
             RowBox[{"[", 
              RowBox[{"ids", "[", 
               RowBox[{"[", "k", "]"}], "]"}], "]"}], "]"}], "+=", 
            RowBox[{
             RowBox[{
              RowBox[{"Klocal", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "[", 
              RowBox[{"[", "j", "]"}], "]"}], "[", 
             RowBox[{"[", "k", "]"}], "]"}]}], ";"}]}], "\[IndentingNewLine]",
          "]"}]}], "\[IndentingNewLine]", "]"}], ";"}]}], 
    "\[IndentingNewLine]", "]"}]}], "]"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.7167647605597653`*^9, 3.7167647892518883`*^9}, {
   3.7167648244240847`*^9, 3.716764841539942*^9}, {3.71676488019324*^9, 
   3.7167648969754357`*^9}, {3.716765065628334*^9, 3.716765185350045*^9}, {
   3.7167652229401484`*^9, 3.7167652383100395`*^9}, {3.7167653441168547`*^9, 
   3.7167655199547443`*^9}, {3.7167655675522327`*^9, 
   3.7167655810711265`*^9}, {3.716765622284607*^9, 3.7167656290567384`*^9}, {
   3.716765757154343*^9, 3.716765792076064*^9}, {3.7167658276745405`*^9, 
   3.7167660826802125`*^9}, {3.716766195664576*^9, 3.716766242915578*^9}, {
   3.7167663310833845`*^9, 3.7167663393539863`*^9}, {3.7167664503932595`*^9, 
   3.716766450932579*^9}, {3.7167664868258085`*^9, 3.7167665635541043`*^9}, {
   3.716766627651472*^9, 3.716766643645746*^9}, {3.716766826115865*^9, 
   3.7167668360695195`*^9}, {3.716766868385886*^9, 3.7167669130203*^9}, {
   3.717155721663645*^9, 3.7171557331420517`*^9}, {3.717155769178903*^9, 
   3.7171557818205233`*^9}, {3.7171567883516493`*^9, 3.717156887869956*^9}, {
   3.717156918335051*^9, 3.717156937057849*^9}, {3.717157017416103*^9, 
   3.717157052623994*^9}, {3.717157895689323*^9, 3.717157931742132*^9}, {
   3.717166282194605*^9, 3.71716628473459*^9}, {3.71716849797501*^9, 
   3.71716852298344*^9}, {3.717168562021318*^9, 3.717168562125424*^9}, {
   3.717168843821663*^9, 3.717168857297769*^9}, {3.7171692165304537`*^9, 
   3.7171692208302*^9}, {3.717170006857576*^9, 3.717170018830927*^9}, {
   3.717171209233417*^9, 3.717171213025419*^9}, {3.7173548750864697`*^9, 
   3.717354881757492*^9}, {3.717354996753583*^9, 3.717355017245678*^9}, {
   3.717355319697336*^9, 3.7173553216726255`*^9}, {3.7173557531181636`*^9, 
   3.7173557820403166`*^9}, {3.7173558138063755`*^9, 
   3.7173558166812677`*^9}, {3.7173587645155315`*^9, 
   3.7173587704721184`*^9}, {3.7173588122062426`*^9, 
   3.7173588501286516`*^9}, {3.717359014190798*^9, 3.7173590339564075`*^9}, {
   3.7173591194571896`*^9, 3.7173591202540846`*^9}, {3.717360749384885*^9, 
   3.717360755072524*^9}, {3.7173608405541487`*^9, 3.7173608453215923`*^9}, {
   3.7174176653039513`*^9, 3.7174177502357674`*^9}, {3.717418005127076*^9, 
   3.717418022383568*^9}, {3.7174180927900662`*^9, 3.717418180868244*^9}, {
   3.717419219270834*^9, 3.7174192266613092`*^9}, {3.71741926925568*^9, 
   3.717419272755123*^9}, {3.7174241468474283`*^9, 3.7174241510843997`*^9}, {
   3.71742429898483*^9, 3.717424381678406*^9}, {3.717427960779907*^9, 
   3.7174279724352093`*^9}, {3.7174281618258095`*^9, 
   3.7174281652786007`*^9}, {3.7208066594239817`*^9, 
   3.7208066657144737`*^9}, {3.723057650960129*^9, 3.7230576545889745`*^9}, {
   3.763398626297826*^9, 3.7633986377693434`*^9}, {3.763398969492062*^9, 
   3.763399017148432*^9}, {3.7633990692779627`*^9, 3.7633990694291053`*^9}, {
   3.7633991201481476`*^9, 3.763399174570841*^9}, {3.763399415268031*^9, 
   3.76339941606513*^9}, {3.7633996474373903`*^9, 3.7633996648412056`*^9}, {
   3.7633997501291094`*^9, 3.7633999258824277`*^9}, {3.7633999725549555`*^9, 
   3.763399976702032*^9}, {3.7634000083920765`*^9, 3.76340016737781*^9}, {
   3.7634002158964863`*^9, 3.76340029196223*^9}, {3.763400323496956*^9, 
   3.7634004027149053`*^9}, {3.76340045059245*^9, 3.763400463281616*^9}, {
   3.7634005294006834`*^9, 3.763400570424802*^9}, {3.764082973996101*^9, 
   3.764082975901887*^9}, {3.764085676134435*^9, 3.7640856834202404`*^9}, {
   3.7640858472503123`*^9, 3.7640858920767965`*^9}, {3.7640894255234814`*^9, 
   3.7640894257482643`*^9}, {3.7640894615887256`*^9, 
   3.7640894620724916`*^9}, {3.7640895179586363`*^9, 
   3.7640895273283195`*^9}, {3.7640896836413865`*^9, 
   3.7640896854169707`*^9}, {3.764098322843951*^9, 3.764098324217982*^9}, {
   3.7640983820840216`*^9, 3.764098382599674*^9}, {3.764099103461434*^9, 
   3.764099173185652*^9}, {3.764101764387092*^9, 3.7641017868352966`*^9}, 
   3.764761842376623*^9, {3.76476223129729*^9, 3.764762241509314*^9}, {
   3.7647622805381107`*^9, 3.764762305230457*^9}, {3.76476236061409*^9, 
   3.7647623840555506`*^9}, {3.7647624148034487`*^9, 
   3.7647624367677865`*^9}, {3.7647629353927927`*^9, 
   3.7647629384726405`*^9}, {3.7656458527622604`*^9, 3.765645867227993*^9}, {
   3.7656495238352633`*^9, 3.765649541164837*^9}, 3.7656495759257193`*^9, {
   3.7656496491111546`*^9, 3.7656496835415196`*^9}, 3.7656497948592167`*^9, {
   3.765649841267525*^9, 3.7656498513650036`*^9}, {3.7656500041858664`*^9, 
   3.765650011102272*^9}, {3.7656501294865913`*^9, 3.76565013159778*^9}, {
   3.765650258639913*^9, 3.7656503016985903`*^9}, {3.7656505022961674`*^9, 
   3.7656505031463037`*^9}, {3.7656505830581017`*^9, 3.765650620791353*^9}, {
   3.7656512645686326`*^9, 3.7656513235480328`*^9}, {3.799601245837529*^9, 
   3.799601248895832*^9}, {3.799601478088224*^9, 3.79960149323707*^9}, {
   3.90664856436169*^9, 3.906648673814809*^9}, 3.906814838746813*^9, {
   3.9068210249152203`*^9, 3.906821033658078*^9}, {3.906822322398645*^9, 
   3.906822326668*^9}},
 CellLabel->"In[86]:=",ExpressionUUID->"eeecd4b6-94c2-4ba2-adaf-b5dce8509318"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"Join", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"SetPrecision", "[", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Kglobal", "[", 
           RowBox[{"[", 
            RowBox[{
             RowBox[{"IntegerPart", "[", 
              RowBox[{"i", "/", "4"}], "]"}], "+", "1"}], "]"}], "]"}], "[", 
          RowBox[{"[", 
           RowBox[{
            RowBox[{"4", "*", "0"}], "+", 
            RowBox[{"Mod", "[", 
             RowBox[{"i", ",", "4"}], "]"}], "+", "1"}], "]"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "0", ",", "15"}], "}"}]}], "]"}], ",", "18"}], 
      "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{"SetPrecision", "[", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Kglobal", "[", 
           RowBox[{"[", 
            RowBox[{
             RowBox[{"IntegerPart", "[", 
              RowBox[{"i", "/", "4"}], "]"}], "+", "1"}], "]"}], "]"}], "[", 
          RowBox[{"[", 
           RowBox[{
            RowBox[{"4", "*", "1"}], "+", 
            RowBox[{"Mod", "[", 
             RowBox[{"i", ",", "4"}], "]"}], "+", "1"}], "]"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "0", ",", "15"}], "}"}]}], "]"}], ",", "18"}], 
      "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{"SetPrecision", "[", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Kglobal", "[", 
           RowBox[{"[", 
            RowBox[{
             RowBox[{"IntegerPart", "[", 
              RowBox[{"i", "/", "4"}], "]"}], "+", "1"}], "]"}], "]"}], "[", 
          RowBox[{"[", 
           RowBox[{
            RowBox[{"4", "*", "3"}], "+", 
            RowBox[{"Mod", "[", 
             RowBox[{"i", ",", "4"}], "]"}], "+", "1"}], "]"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "0", ",", "15"}], "}"}]}], "]"}], ",", "18"}], 
      "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{"SetPrecision", "[", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Kglobal", "[", 
           RowBox[{"[", 
            RowBox[{
             RowBox[{"IntegerPart", "[", 
              RowBox[{"i", "/", "4"}], "]"}], "+", "1"}], "]"}], "]"}], "[", 
          RowBox[{"[", 
           RowBox[{
            RowBox[{"4", "*", "4"}], "+", 
            RowBox[{"Mod", "[", 
             RowBox[{"i", ",", "4"}], "]"}], "+", "1"}], "]"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "0", ",", "15"}], "}"}]}], "]"}], ",", "18"}], 
      "]"}]}], "\[IndentingNewLine]", "]"}], 
   "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.7641008499440265`*^9, 3.7641009191912155`*^9}, {
  3.764100982438418*^9, 3.764100994727434*^9}, {3.764101178024066*^9, 
  3.7641012178500237`*^9}, {3.849378431586198*^9, 3.849378436143215*^9}, {
  3.8503258384962*^9, 3.850325840796566*^9}, {3.906821037561861*^9, 
  3.906821045416554*^9}, {3.906822329281859*^9, 3.906822331625304*^9}},
 CellLabel->"In[89]:=",ExpressionUUID->"378e4713-a8c0-4cc5-bb6a-c448a09a26a9"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
   ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
   "3749.99999999997226041159592568874359130859`18.", ",", "0", ",", "0", ",",
    "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0",
    ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
   "624.99999999999704414221923798322677612305`18.", ",", "0", ",", "0", ",", 
   "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
   ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
   "624.99999999999704414221923798322677612305`18.", ",", "0", ",", "0", ",", 
   "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
   ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
   "624.99999999999704414221923798322677612305`18."}], "}"}]], "Output",
 CellChangeTimes->{{3.9068223455541277`*^9, 3.9068223529092493`*^9}, 
   3.9068223985406218`*^9, 3.90682266666398*^9, 3.9068231163911448`*^9, 
   3.906823464953156*^9, 3.9072578182357597`*^9},
 CellLabel->"Out[89]=",ExpressionUUID->"de838bbb-ef95-4d7b-8056-36488475c2bc"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Compute residual:", "Subsection",
 CellChangeTimes->{{3.7171711972127666`*^9, 3.71717120142911*^9}, {
  3.7209943882500362`*^9, 3.7209944015165186`*^9}, {3.721049011972142*^9, 
  3.721049018596589*^9}, {3.7210554397242594`*^9, 
  3.7210554438131027`*^9}},ExpressionUUID->"1c35546a-ed60-4e5e-954b-\
f646316d618d"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"cellResidual", "=", 
   RowBox[{"Table", "[", 
    RowBox[{"0.0", ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"Length", "[", "connect", "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "1", ",", "16"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Klocal", "=", 
   RowBox[{"Table", "[", 
    RowBox[{"0.0", ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"Length", "[", "connect", "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "1", ",", 
       RowBox[{"nnodes", "*", "ndofs"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"k", ",", "1", ",", 
       RowBox[{"nnodes", "*", "ndofs"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"KlocalDot", "=", 
   RowBox[{"Table", "[", 
    RowBox[{"0.0", ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"Length", "[", "connect", "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "1", ",", 
       RowBox[{"nnodes", "*", "ndofs"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"k", ",", "1", ",", 
       RowBox[{"nnodes", "*", "ndofs"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"residual", "=", 
   RowBox[{"Table", "[", 
    RowBox[{"0.0", ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"ndofs", " ", 
        RowBox[{"Length", "[", "xv", "]"}]}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"For", "[", 
  RowBox[{
   RowBox[{"i", "=", "1"}], ",", " ", 
   RowBox[{"i", "\[LessEqual]", " ", 
    RowBox[{"Length", "[", "connect", "]"}]}], ",", 
   RowBox[{"i", "++"}], ",", 
   RowBox[{"Block", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"i1", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"connect", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}], "+", "1"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"i2", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"connect", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "[", 
          RowBox[{"[", "2", "]"}], "]"}], "+", "1"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"i3", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"connect", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "[", 
          RowBox[{"[", "3", "]"}], "]"}], "+", "1"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"i4", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"connect", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "[", 
          RowBox[{"[", "4", "]"}], "]"}], "+", "1"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"ids", "=", 
        RowBox[{"{", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"ndofs", " ", 
            RowBox[{"(", 
             RowBox[{"i1", "-", "1"}], ")"}]}], "+", "1"}], ",", " ", 
          RowBox[{
           RowBox[{"ndofs", 
            RowBox[{"(", " ", 
             RowBox[{"i1", "-", "1"}], ")"}]}], "+", "2"}], ",", " ", 
          RowBox[{
           RowBox[{"ndofs", 
            RowBox[{"(", " ", 
             RowBox[{"i1", "-", "1"}], ")"}]}], "+", "3"}], ",", " ", 
          RowBox[{
           RowBox[{"ndofs", 
            RowBox[{"(", 
             RowBox[{"i1", "-", "1"}], ")"}]}], "+", "4"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"ndofs", 
            RowBox[{"(", " ", 
             RowBox[{"i2", "-", "1"}], ")"}]}], "+", "1"}], ",", 
          RowBox[{
           RowBox[{"ndofs", 
            RowBox[{"(", 
             RowBox[{"i2", "-", "1"}], ")"}]}], "+", "2"}], ",", " ", 
          RowBox[{
           RowBox[{"ndofs", 
            RowBox[{"(", " ", 
             RowBox[{"i2", "-", "1"}], ")"}]}], "+", "3"}], ",", 
          RowBox[{
           RowBox[{"ndofs", 
            RowBox[{"(", 
             RowBox[{"i2", "-", "1"}], ")"}]}], "+", "4"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"ndofs", 
            RowBox[{"(", 
             RowBox[{"i3", "-", "1"}], ")"}]}], "+", "1"}], ",", 
          RowBox[{
           RowBox[{"ndofs", " ", 
            RowBox[{"(", 
             RowBox[{"i3", "-", "1"}], ")"}]}], "+", "2"}], ",", " ", 
          RowBox[{
           RowBox[{"ndofs", 
            RowBox[{"(", " ", 
             RowBox[{"i3", "-", "1"}], ")"}]}], "+", "3"}], ",", 
          RowBox[{
           RowBox[{"ndofs", 
            RowBox[{"(", 
             RowBox[{"i3", "-", "1"}], ")"}]}], "+", "4"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"ndofs", 
            RowBox[{"(", 
             RowBox[{"i4", "-", "1"}], ")"}]}], "+", "1"}], ",", 
          RowBox[{
           RowBox[{"ndofs", 
            RowBox[{"(", 
             RowBox[{"i4", "-", "1"}], ")"}]}], "+", "2"}], ",", " ", 
          RowBox[{
           RowBox[{"ndofs", 
            RowBox[{"(", " ", 
             RowBox[{"i4", "-", "1"}], ")"}]}], "+", "3"}], ",", 
          RowBox[{
           RowBox[{"ndofs", 
            RowBox[{"(", 
             RowBox[{"i4", "-", "1"}], ")"}]}], "+", "4"}]}], 
         "\[IndentingNewLine]", "}"}]}]}], "\[IndentingNewLine]", "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Kelmm", "=", 
       RowBox[{"Table", "[", 
        RowBox[{"0.0", ",", 
         RowBox[{"{", 
          RowBox[{"ii", ",", "1", ",", "12"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"jj", ",", "1", ",", "12"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Keltt", "=", 
       RowBox[{"Table", "[", 
        RowBox[{"0.0", ",", 
         RowBox[{"{", 
          RowBox[{"ii", ",", "1", ",", "4"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"jj", ",", "1", ",", "4"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Kelmt", "=", 
       RowBox[{"Table", "[", 
        RowBox[{"0.0", ",", 
         RowBox[{"{", 
          RowBox[{"ii", ",", "1", ",", "12"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"jj", ",", "1", ",", "4"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Mel", "=", 
       RowBox[{"Table", "[", 
        RowBox[{"0.0", ",", 
         RowBox[{"{", 
          RowBox[{"ii", ",", "1", ",", "4"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"jj", ",", "1", ",", "4"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"j", "=", "1"}], ",", 
        RowBox[{"j", "<=", 
         RowBox[{"Length", "[", "gp", "]"}]}], ",", 
        RowBox[{"j", "++"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Kelmm", "+=", 
          RowBox[{
           RowBox[{"gw", "[", 
            RowBox[{"[", "j", "]"}], "]"}], "*", 
           RowBox[{"KmmNoAbs", "[", 
            RowBox[{
             RowBox[{"xv", "[", 
              RowBox[{"[", "i1", "]"}], "]"}], ",", 
             RowBox[{"yv", "[", 
              RowBox[{"[", "i1", "]"}], "]"}], ",", 
             RowBox[{"zv", "[", 
              RowBox[{"[", "i1", "]"}], "]"}], ",", 
             RowBox[{"xv", "[", 
              RowBox[{"[", "i2", "]"}], "]"}], ",", 
             RowBox[{"yv", "[", 
              RowBox[{"[", "i2", "]"}], "]"}], ",", 
             RowBox[{"zv", "[", 
              RowBox[{"[", "i2", "]"}], "]"}], ",", 
             RowBox[{"xv", "[", 
              RowBox[{"[", "i3", "]"}], "]"}], ",", 
             RowBox[{"yv", "[", 
              RowBox[{"[", "i3", "]"}], "]"}], ",", 
             RowBox[{"zv", "[", 
              RowBox[{"[", "i3", "]"}], "]"}], ",", 
             RowBox[{"xv", "[", 
              RowBox[{"[", "i4", "]"}], "]"}], ",", 
             RowBox[{"yv", "[", 
              RowBox[{"[", "i4", "]"}], "]"}], ",", 
             RowBox[{"zv", "[", 
              RowBox[{"[", "i4", "]"}], "]"}], ",", 
             RowBox[{"1", "*", 
              SuperscriptBox["10", "11"]}], ",", "0.3"}], "]"}]}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"Keltt", "+=", 
          RowBox[{
           RowBox[{"gw", "[", 
            RowBox[{"[", "j", "]"}], "]"}], "*", 
           RowBox[{"kttNoAbs", "[", 
            RowBox[{
             RowBox[{"xv", "[", 
              RowBox[{"[", "i1", "]"}], "]"}], ",", 
             RowBox[{"yv", "[", 
              RowBox[{"[", "i1", "]"}], "]"}], ",", 
             RowBox[{"zv", "[", 
              RowBox[{"[", "i1", "]"}], "]"}], ",", 
             RowBox[{"xv", "[", 
              RowBox[{"[", "i2", "]"}], "]"}], ",", 
             RowBox[{"yv", "[", 
              RowBox[{"[", "i2", "]"}], "]"}], ",", 
             RowBox[{"zv", "[", 
              RowBox[{"[", "i2", "]"}], "]"}], ",", 
             RowBox[{"xv", "[", 
              RowBox[{"[", "i3", "]"}], "]"}], ",", 
             RowBox[{"yv", "[", 
              RowBox[{"[", "i3", "]"}], "]"}], ",", 
             RowBox[{"zv", "[", 
              RowBox[{"[", "i3", "]"}], "]"}], ",", 
             RowBox[{"xv", "[", 
              RowBox[{"[", "i4", "]"}], "]"}], ",", 
             RowBox[{"yv", "[", 
              RowBox[{"[", "i4", "]"}], "]"}], ",", 
             RowBox[{"zv", "[", 
              RowBox[{"[", "i4", "]"}], "]"}], ",", "ConductionCoeff"}], 
            "]"}]}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"Mel", "+=", 
          RowBox[{
           RowBox[{
            RowBox[{"gw", "[", 
             RowBox[{"[", "j", "]"}], "]"}], "*", 
            RowBox[{"MmatNoAbs", "[", 
             RowBox[{
              RowBox[{"xv", "[", 
               RowBox[{"[", "i1", "]"}], "]"}], ",", 
              RowBox[{"yv", "[", 
               RowBox[{"[", "i1", "]"}], "]"}], ",", 
              RowBox[{"zv", "[", 
               RowBox[{"[", "i1", "]"}], "]"}], ",", 
              RowBox[{"xv", "[", 
               RowBox[{"[", "i2", "]"}], "]"}], ",", 
              RowBox[{"yv", "[", 
               RowBox[{"[", "i2", "]"}], "]"}], ",", 
              RowBox[{"zv", "[", 
               RowBox[{"[", "i2", "]"}], "]"}], ",", 
              RowBox[{"xv", "[", 
               RowBox[{"[", "i3", "]"}], "]"}], ",", 
              RowBox[{"yv", "[", 
               RowBox[{"[", "i3", "]"}], "]"}], ",", 
              RowBox[{"zv", "[", 
               RowBox[{"[", "i3", "]"}], "]"}], ",", 
              RowBox[{"xv", "[", 
               RowBox[{"[", "i4", "]"}], "]"}], ",", 
              RowBox[{"yv", "[", 
               RowBox[{"[", "i4", "]"}], "]"}], ",", 
              RowBox[{"zv", "[", 
               RowBox[{"[", "i4", "]"}], "]"}], ",", "0.3", ",", 
              RowBox[{"1", "*", 
               SuperscriptBox["10", "6"]}]}], "]"}]}], "/.", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"\[Xi]", "\[Rule]", 
              RowBox[{
               RowBox[{"gp", "[", 
                RowBox[{"[", "j", "]"}], "]"}], "[", 
               RowBox[{"[", "1", "]"}], "]"}]}], ",", 
             RowBox[{"\[Psi]", "\[Rule]", 
              RowBox[{
               RowBox[{"gp", "[", 
                RowBox[{"[", "j", "]"}], "]"}], "[", 
               RowBox[{"[", "2", "]"}], "]"}]}], ",", 
             RowBox[{"\[Zeta]", "\[Rule]", 
              RowBox[{
               RowBox[{"gp", "[", 
                RowBox[{"[", "j", "]"}], "]"}], "[", 
               RowBox[{"[", "3", "]"}], "]"}]}]}], "}"}]}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"Kelmt", "+=", 
          RowBox[{
           RowBox[{
            RowBox[{"gw", "[", 
             RowBox[{"[", "j", "]"}], "]"}], "*", 
            RowBox[{"kmtNoAbs", "[", 
             RowBox[{
              RowBox[{"xv", "[", 
               RowBox[{"[", "i1", "]"}], "]"}], ",", 
              RowBox[{"yv", "[", 
               RowBox[{"[", "i1", "]"}], "]"}], ",", 
              RowBox[{"zv", "[", 
               RowBox[{"[", "i1", "]"}], "]"}], ",", 
              RowBox[{"xv", "[", 
               RowBox[{"[", "i2", "]"}], "]"}], ",", 
              RowBox[{"yv", "[", 
               RowBox[{"[", "i2", "]"}], "]"}], ",", 
              RowBox[{"zv", "[", 
               RowBox[{"[", "i2", "]"}], "]"}], ",", 
              RowBox[{"xv", "[", 
               RowBox[{"[", "i3", "]"}], "]"}], ",", 
              RowBox[{"yv", "[", 
               RowBox[{"[", "i3", "]"}], "]"}], ",", 
              RowBox[{"zv", "[", 
               RowBox[{"[", "i3", "]"}], "]"}], ",", 
              RowBox[{"xv", "[", 
               RowBox[{"[", "i4", "]"}], "]"}], ",", 
              RowBox[{"yv", "[", 
               RowBox[{"[", "i4", "]"}], "]"}], ",", 
              RowBox[{"zv", "[", 
               RowBox[{"[", "i4", "]"}], "]"}], ",", 
              RowBox[{"1.0", "*", 
               SuperscriptBox["10", 
                RowBox[{"-", "5"}]]}], ",", 
              RowBox[{"1", "*", 
               SuperscriptBox["10", "11"]}], ",", "0.3"}], "]"}]}], "/.", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"\[Xi]", "\[Rule]", 
              RowBox[{
               RowBox[{"gp", "[", 
                RowBox[{"[", "j", "]"}], "]"}], "[", 
               RowBox[{"[", "1", "]"}], "]"}]}], ",", 
             RowBox[{"\[Psi]", "\[Rule]", 
              RowBox[{
               RowBox[{"gp", "[", 
                RowBox[{"[", "j", "]"}], "]"}], "[", 
               RowBox[{"[", "2", "]"}], "]"}]}], ",", 
             RowBox[{"\[Zeta]", "\[Rule]", 
              RowBox[{
               RowBox[{"gp", "[", 
                RowBox[{"[", "j", "]"}], "]"}], "[", 
               RowBox[{"[", "3", "]"}], "]"}]}]}], "}"}]}]}], ";"}]}], 
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"inode", "=", "0"}], ",", 
        RowBox[{"inode", "<", "nnodes"}], ",", 
        RowBox[{"inode", "++"}], ",", "\[IndentingNewLine]", 
        RowBox[{"For", "[", 
         RowBox[{
          RowBox[{"jnode", "=", "0"}], ",", 
          RowBox[{"jnode", "<", "nnodes"}], ",", 
          RowBox[{"jnode", "++"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"For", "[", 
            RowBox[{
             RowBox[{"idof", "=", "0"}], ",", 
             RowBox[{"idof", "<", "nmdofs"}], ",", 
             RowBox[{"idof", "++"}], ",", "\[IndentingNewLine]", 
             RowBox[{"For", "[", 
              RowBox[{
               RowBox[{"jdof", "=", "0"}], ",", 
               RowBox[{"jdof", "<", "nmdofs"}], ",", 
               RowBox[{"jdof", "++"}], ",", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{"Klocal", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "[", 
                   RowBox[{"[", 
                    RowBox[{
                    RowBox[{"inode", " ", "ndofs"}], "+", "idof", "+", "1"}], 
                    "]"}], "]"}], "[", 
                  RowBox[{"[", 
                   RowBox[{
                    RowBox[{"jnode", " ", "ndofs"}], "+", "jdof", "+", "1"}], 
                   "]"}], "]"}], " ", "=", 
                 RowBox[{
                  RowBox[{"Kelmm", "[", 
                   RowBox[{"[", 
                    RowBox[{
                    RowBox[{"inode", " ", "nmdofs"}], "+", "idof", "+", "1"}],
                     "]"}], "]"}], "[", 
                  RowBox[{"[", 
                   RowBox[{
                    RowBox[{"jnode", " ", "nmdofs"}], "+", "jdof", "+", "1"}],
                    "]"}], "]"}]}], ";"}]}], "\[IndentingNewLine]", "]"}]}], 
            "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"Klocal", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "[", 
              RowBox[{"[", 
               RowBox[{
                RowBox[{"inode", " ", "ndofs"}], "+", "nmdofs", "+", "1"}], 
               "]"}], "]"}], "[", 
             RowBox[{"[", 
              RowBox[{
               RowBox[{"jnode", " ", "ndofs"}], "+", "nmdofs", "+", "1"}], 
              "]"}], "]"}], " ", "=", 
            RowBox[{
             RowBox[{"Keltt", "[", 
              RowBox[{"[", 
               RowBox[{"inode", "+", "1"}], "]"}], "]"}], "[", 
             RowBox[{"[", 
              RowBox[{"jnode", "+", "1"}], "]"}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"For", "[", 
            RowBox[{
             RowBox[{"idof", "=", "0"}], ",", 
             RowBox[{"idof", "<", "nmdofs"}], ",", 
             RowBox[{"idof", "++"}], ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"Klocal", "[", 
                  RowBox[{"[", "i", "]"}], "]"}], "[", 
                 RowBox[{"[", 
                  RowBox[{
                   RowBox[{"inode", " ", "ndofs"}], "+", "idof", "+", "1"}], 
                  "]"}], "]"}], "[", 
                RowBox[{"[", 
                 RowBox[{
                  RowBox[{"jnode", " ", "ndofs"}], "+", "nmdofs", "+", "1"}], 
                 "]"}], "]"}], " ", "=", 
               RowBox[{"-", 
                RowBox[{
                 RowBox[{"Kelmt", "[", 
                  RowBox[{"[", 
                   RowBox[{
                    RowBox[{"inode", " ", "nmdofs"}], "+", "idof", "+", "1"}],
                    "]"}], "]"}], "[", 
                 RowBox[{"[", 
                  RowBox[{"jnode", "+", "1"}], "]"}], "]"}]}]}], ";"}]}], 
            "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"inode", "=", "0"}], ",", 
        RowBox[{"inode", "<", "nnodes"}], ",", 
        RowBox[{"inode", "++"}], ",", "\[IndentingNewLine]", 
        RowBox[{"For", "[", 
         RowBox[{
          RowBox[{"jnode", "=", "0"}], ",", 
          RowBox[{"jnode", "<", "nnodes"}], ",", 
          RowBox[{"jnode", "++"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"KlocalDot", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "[", 
              RowBox[{"[", 
               RowBox[{
                RowBox[{"inode", " ", "ndofs"}], "+", "nmdofs", "+", "1"}], 
               "]"}], "]"}], "[", 
             RowBox[{"[", 
              RowBox[{
               RowBox[{"jnode", " ", "ndofs"}], "+", "nmdofs", "+", "1"}], 
              "]"}], "]"}], " ", "=", 
            RowBox[{
             RowBox[{"Mel", "[", 
              RowBox[{"[", 
               RowBox[{"inode", "+", "1"}], "]"}], "]"}], "[", 
             RowBox[{"[", 
              RowBox[{"jnode", "+", "1"}], "]"}], "]"}]}], ";"}]}], 
         "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"disp", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"uv", "[", 
          RowBox[{"[", 
           RowBox[{"ids", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "]"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", "16"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"dispDot", "=", " ", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"uvDot", "[", 
          RowBox[{"[", 
           RowBox[{"ids", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "]"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", "16"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"resid", "=", " ", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Klocal", "[", 
           RowBox[{"[", "i", "]"}], "]"}], ".", "disp"}], ")"}], "+", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"KlocalDot", "[", 
           RowBox[{"[", "i", "]"}], "]"}], ".", "dispDot"}], ")"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"cellResidual", "[", 
        RowBox[{"[", "i", "]"}], "]"}], "=", "resid"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Detj", "[", 
          RowBox[{
           RowBox[{"xv", "[", 
            RowBox[{"[", "i1", "]"}], "]"}], ",", 
           RowBox[{"yv", "[", 
            RowBox[{"[", "i1", "]"}], "]"}], ",", 
           RowBox[{"zv", "[", 
            RowBox[{"[", "i1", "]"}], "]"}], ",", 
           RowBox[{"xv", "[", 
            RowBox[{"[", "i2", "]"}], "]"}], ",", 
           RowBox[{"yv", "[", 
            RowBox[{"[", "i2", "]"}], "]"}], ",", 
           RowBox[{"zv", "[", 
            RowBox[{"[", "i2", "]"}], "]"}], ",", 
           RowBox[{"xv", "[", 
            RowBox[{"[", "i3", "]"}], "]"}], ",", 
           RowBox[{"yv", "[", 
            RowBox[{"[", "i3", "]"}], "]"}], ",", 
           RowBox[{"zv", "[", 
            RowBox[{"[", "i3", "]"}], "]"}], ",", 
           RowBox[{"xv", "[", 
            RowBox[{"[", "i4", "]"}], "]"}], ",", 
           RowBox[{"yv", "[", 
            RowBox[{"[", "i4", "]"}], "]"}], ",", 
           RowBox[{"zv", "[", 
            RowBox[{"[", "i4", "]"}], "]"}]}], "]"}], "\[GreaterEqual]", 
         "0.0"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"For", "[", 
          RowBox[{
           RowBox[{"j", "=", "1"}], ",", 
           RowBox[{"j", "\[LessEqual]", "16"}], ",", 
           RowBox[{"j", "++"}], ",", 
           RowBox[{
            RowBox[{"residual", "[", 
             RowBox[{"[", 
              RowBox[{"ids", "[", 
               RowBox[{"[", "j", "]"}], "]"}], "]"}], "]"}], "+=", 
            RowBox[{"resid", "[", 
             RowBox[{"[", "j", "]"}], "]"}]}]}], "]"}], ";"}], ",", 
        RowBox[{
         RowBox[{"For", "[", 
          RowBox[{
           RowBox[{"j", "=", "1"}], ",", 
           RowBox[{"j", "\[LessEqual]", "16"}], ",", 
           RowBox[{"j", "++"}], ",", 
           RowBox[{
            RowBox[{"residual", "[", 
             RowBox[{"[", 
              RowBox[{"ids", "[", 
               RowBox[{"[", "j", "]"}], "]"}], "]"}], "]"}], "-=", 
            RowBox[{"resid", "[", 
             RowBox[{"[", "j", "]"}], "]"}]}]}], "]"}], ";"}]}], "]"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.7167647605597653`*^9, 3.7167647892518883`*^9}, {
   3.7167648244240847`*^9, 3.716764841539942*^9}, {3.71676488019324*^9, 
   3.7167648969754357`*^9}, {3.716765065628334*^9, 3.716765185350045*^9}, {
   3.7167652229401484`*^9, 3.7167652383100395`*^9}, {3.7167653441168547`*^9, 
   3.7167655199547443`*^9}, {3.7167655675522327`*^9, 
   3.7167655810711265`*^9}, {3.716765622284607*^9, 3.7167656290567384`*^9}, {
   3.716765757154343*^9, 3.716765792076064*^9}, {3.7167658276745405`*^9, 
   3.7167660826802125`*^9}, {3.716766195664576*^9, 3.716766242915578*^9}, {
   3.7167663310833845`*^9, 3.7167663393539863`*^9}, {3.7167664503932595`*^9, 
   3.716766450932579*^9}, {3.7167664868258085`*^9, 3.7167665635541043`*^9}, {
   3.716766627651472*^9, 3.716766643645746*^9}, {3.716766826115865*^9, 
   3.7167668360695195`*^9}, {3.716766868385886*^9, 3.7167669130203*^9}, {
   3.717155721663645*^9, 3.7171557331420517`*^9}, {3.717155769178903*^9, 
   3.7171557818205233`*^9}, {3.7171567883516493`*^9, 3.717156887869956*^9}, {
   3.717156918335051*^9, 3.717156937057849*^9}, {3.717157017416103*^9, 
   3.717157052623994*^9}, {3.717157895689323*^9, 3.717157931742132*^9}, {
   3.717166282194605*^9, 3.71716628473459*^9}, {3.71716849797501*^9, 
   3.71716852298344*^9}, {3.717168562021318*^9, 3.717168562125424*^9}, {
   3.717168843821663*^9, 3.717168857297769*^9}, {3.7171692165304537`*^9, 
   3.7171692208302*^9}, {3.717170006857576*^9, 3.717170018830927*^9}, {
   3.717171209233417*^9, 3.717171213025419*^9}, {3.7173548750864697`*^9, 
   3.717354881757492*^9}, {3.717354996753583*^9, 3.717355017245678*^9}, {
   3.717355319697336*^9, 3.7173553216726255`*^9}, {3.7173557531181636`*^9, 
   3.7173557820403166`*^9}, {3.7173558138063755`*^9, 
   3.7173558166812677`*^9}, {3.7173587645155315`*^9, 
   3.7173587704721184`*^9}, {3.7173588122062426`*^9, 
   3.7173588501286516`*^9}, {3.717359014190798*^9, 3.7173590339564075`*^9}, {
   3.7173591194571896`*^9, 3.7173591202540846`*^9}, {3.717360749384885*^9, 
   3.717360755072524*^9}, {3.7173608405541487`*^9, 3.7173608453215923`*^9}, {
   3.7174176653039513`*^9, 3.7174177502357674`*^9}, {3.717418005127076*^9, 
   3.717418022383568*^9}, {3.7174180927900662`*^9, 3.717418180868244*^9}, {
   3.717419219270834*^9, 3.7174192266613092`*^9}, {3.71741926925568*^9, 
   3.717419272755123*^9}, {3.7174241468474283`*^9, 3.7174241510843997`*^9}, {
   3.71742429898483*^9, 3.717424381678406*^9}, {3.717427960779907*^9, 
   3.7174279724352093`*^9}, {3.7174281618258095`*^9, 
   3.7174281652786007`*^9}, {3.7208066594239817`*^9, 
   3.7208066657144737`*^9}, {3.720994042619423*^9, 3.7209941465012307`*^9}, {
   3.7209941931469326`*^9, 3.7209942823899403`*^9}, {3.7209945149606404`*^9, 
   3.7209945361169796`*^9}, {3.7209946799116*^9, 3.720994978291444*^9}, {
   3.7210470008455043`*^9, 3.7210470020792093`*^9}, {3.721055446475813*^9, 
   3.7210554769975753`*^9}, {3.7210555442260976`*^9, 3.721055585763404*^9}, {
   3.7230547784118013`*^9, 3.7230547844740324`*^9}, {3.7230580841467104`*^9, 
   3.7230581803982973`*^9}, {3.7230585213381877`*^9, 3.723058522399741*^9}, {
   3.723515313727868*^9, 3.7235153825857706`*^9}, {3.7236621698838377`*^9, 
   3.7236621717519226`*^9}, {3.7236622124923797`*^9, 3.723662227510171*^9}, 
   3.7236622603736763`*^9, {3.723662501164076*^9, 3.7236625138790245`*^9}, 
   3.7236636246400113`*^9, {3.7236636643397217`*^9, 3.7236636653317575`*^9}, {
   3.723664443286131*^9, 3.723664465914736*^9}, {3.7236645478013163`*^9, 
   3.723664550184022*^9}, {3.7236649087859735`*^9, 3.723664911863844*^9}, {
   3.7642548499337397`*^9, 3.7642548561514874`*^9}, {3.7642548909189143`*^9, 
   3.7642549502424526`*^9}, {3.764255000130916*^9, 3.764255033148587*^9}, {
   3.7643520295878253`*^9, 3.7643520409484105`*^9}, {3.7643521412661023`*^9, 
   3.764352149703657*^9}, {3.7644887503812428`*^9, 3.7644887514710517`*^9}, {
   3.7656472087494864`*^9, 3.7656472112899885`*^9}, {3.7656472871591763`*^9, 
   3.7656473509384537`*^9}, {3.765648196616994*^9, 3.765648233320232*^9}, {
   3.7656482645664015`*^9, 3.7656483210250745`*^9}, {3.765648595128484*^9, 
   3.765648603301129*^9}, {3.799601531041374*^9, 3.799601561927186*^9}, {
   3.7996020035054092`*^9, 3.799602070787779*^9}, {3.799602501173689*^9, 
   3.7996025079463243`*^9}, {3.7996025481081753`*^9, 3.799602552371449*^9}, {
   3.799602632178194*^9, 3.799602640681169*^9}, {3.799602703818664*^9, 
   3.7996027141776543`*^9}, {3.799602783728685*^9, 3.799602807262837*^9}, {
   3.906648758594949*^9, 3.9066488507192698`*^9}, 3.906648898585758*^9, {
   3.906649567714838*^9, 3.9066495679938707`*^9}, 3.9066498948714952`*^9, {
   3.906650276135096*^9, 3.906650280193389*^9}, {3.906810648135714*^9, 
   3.906810651328809*^9}, 3.906814901574376*^9, 3.906815313825522*^9},
 CellLabel->"In[90]:=",ExpressionUUID->"7d0d04f0-a55d-4e39-a92c-9b0e1a1bb5f8"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"SetPrecision", "[", 
  RowBox[{"residual", ",", "16"}], "]"}]], "Input",
 CellChangeTimes->{{3.7209949856957116`*^9, 3.7209949866369324`*^9}, {
  3.720995044627005*^9, 3.720995050464894*^9}, {3.7210555900106316`*^9, 
  3.7210555918891406`*^9}},
 CellLabel->"In[95]:=",ExpressionUUID->"28d23028-aa6b-4960-9054-22d9805ea509"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"-", "60255.72275641025044023990631103515625`16."}], ",", 
   RowBox[{"-", "45512.3205128205008804798126220703125`16."}], ",", 
   RowBox[{"-", "46153.408653846141532994806766510009765625`16."}], ",", 
   "0.00400833333333330994741050545826510643`16.", ",", 
   RowBox[{"-", "63460.5176282051033922471106052398681640625`16."}], ",", 
   RowBox[{"-", "57691.536858974330243654549121856689453125`16."}], ",", 
   RowBox[{"-", "37499.9166666666642413474619388580322265625`16."}], ",", 
   "0.00598749999999997808280971511862844636`16.", ",", 
   RowBox[{"-", "3204.8365384615390212275087833404541015625`16."}], ",", 
   RowBox[{"-", "12179.2580128205081564374268054962158203125`16."}], ",", 
   "8653.32532051281668827868998050689697265625`16.", ",", 
   "0.00135416666666667365181986326660990017`16.", ",", 
   RowBox[{"-", "70191.078525641016312874853610992431640625`16."}], ",", 
   RowBox[{"-", "30768.9807692307585966773331165313720703125`16."}], ",", 
   RowBox[{"-", "58652.950320512798498384654521942138671875`16."}], ",", 
   "0.00837499999999996580513084154517855495`16.", ",", 
   RowBox[{"-", "86536.3365384615026414394378662109375`16."}], ",", 
   RowBox[{"-", "40384.240384615375660359859466552734375`16."}], ",", 
   RowBox[{"-", "53846.028846153829363174736499786376953125`16."}], ",", 
   "0.01257499999999997508659532741148723289`16.", ",", 
   RowBox[{"-", "16345.25801282050451845861971378326416015625`16."}], ",", 
   RowBox[{"-", "9615.25961538460796873550862073898315429688`16."}], ",", 
   "4806.67147435897913965163752436637878417969`16.", ",", 
   "0.00357500000000001479788513947255523817`16.", ",", 
   RowBox[{"-", "9935.48076923076951061375439167022705078125`16."}], ",", 
   "14742.83974358973864582367241382598876953125`16.", ",", 
   RowBox[{"-", "12499.66666666666060336865484714508056640625`16."}], ",", 
   "0.00249166666666667587642924885926731804`16.", ",", 
   RowBox[{"-", "23075.81891025638833525590598583221435546875`16."}], ",", 
   "17306.54647435896913520991802215576171875`16.", ",", 
   RowBox[{"-", "16346.112179487172397784888744354248046875`16."}], ",", 
   "0.00471250000000001702249452506521265605`16.", ",", 
   RowBox[{"-", "13140.29647435896549723111093044281005859375`16."}], ",", 
   "2563.74839743589654972311109304428100585938`16.", ",", 
   RowBox[{"-", "3846.52884615383754862705245614051818847656`16."}], ",", 
   "0.00222083333333334114606527620594533801`16.", ",", 
   RowBox[{"-", "47114.63461538459523580968379974365234375`16."}], ",", 
   RowBox[{"-", "48075.3189102563992491923272609710693359375`16."}], ",", 
   RowBox[{"-", "42306.171474358954583294689655303955078125`16."}], ",", 
   "0.01553749999999993504362638674365371116`16.", ",", 
   RowBox[{"-", "40383.4903846153974882327020168304443359375`16."}], ",", 
   RowBox[{"-", "74997.124999999956344254314899444580078125`16."}], ",", 
   RowBox[{"-", "21153.72115384612334310077130794525146484375`16."}], ",", 
   "0.02314999999999995880517467128356656758`16.", ",", 
   "6731.14423076924413180677220225334167480469`16.", ",", 
   RowBox[{"-", "26921.80608974355345708318054676055908203125`16."}], ",", 
   "21152.2003205128057743422687053680419921875`16.", ",", 
   "0.00698750000000002147171329625052749179`16.", ",", 
   RowBox[{"-", "53845.0288461538148112595081329345703125`16."}], ",", 
   RowBox[{"-", "21153.47115384614517097361385822296142578125`16."}], ",", 
   RowBox[{"-", "63458.413461538424598984420299530029296875`16."}], ",", 
   "0.0266749999999999418132112793955457164`16.", ",", 
   "2.24999999996907718013972043991088867187`16.", ",", 
   "0.7500000000363797880709171295166015625`16.", ",", 
   "0.25000000004729372449219226837158203125`16.", ",", 
   "0.04874999999999998778754672912327805534`16.", ",", 
   "53847.278846153873018920421600341796875`16.", ",", 
   "21154.22115384614517097361385822296142578125`16.", ",", 
   "63458.1634615384609787724912166595458984375`16.", ",", 
   "0.02207500000000006332157020949580328306`16.", ",", 
   RowBox[{"-", "6730.39423076921593747101724147796630859375`16."}], ",", 
   "26921.09775641029045800678431987762451171875`16.", ",", 
   RowBox[{"-", "21152.2419871794409118592739105224609375`16."}], ",", 
   "0.00926250000000002592093206743584232754`16.", ",", 
   "40385.740384615375660359859466552734375`16.", ",", "74996.375`16.", ",", 
   "21153.97115384620337863452732563018798828125`16.", ",", 
   "0.02560000000000006714628852932946756482`16.", ",", 
   "47116.134615384609787724912166595458984375`16.", ",", 
   "48075.27724358972045592963695526123046875`16.", ",", 
   "42305.963141025611548684537410736083984375`16.", ",", 
   "0.0169625000000000435151914501830106019`16.", ",", 
   "13139.58814102563155756797641515731811523437`16.", ",", 
   RowBox[{"-", "2563.37339743588472629198804497718811035156`16."}], ",", 
   "3846.86217948719695414183661341667175292969`16.", ",", 
   "0.00590416666666668255025740563723957166`16.", ",", 
   "23074.77724358976047369651496410369873046875`16.", ",", 
   RowBox[{"-", "17305.588141025626100599765777587890625`16."}], ",", 
   "16346.19551282052452734205871820449829101562`16.", ",", 
   "0.01153750000000003037015083862115716329`16.", ",", 
   "9935.23076923076951061375439167022705078125`16.", ",", 
   RowBox[{"-", "14742.1730769230562145821750164031982421875`16."}], ",", 
   "12499.25000000001091393642127513885498046875`16.", ",", 
   "0.00563333333333334781989343298391759163`16.", ",", 
   "16343.799679487172397784888744354248046875`16.", ",", 
   "9615.50961538461342570371925830841064453125`16.", ",", 
   RowBox[{"-", "4805.4631410255751688964664936065673828125`16."}], ",", 
   "0.01267500000000002999267501024860393954`16.", ",", 
   "86534.0865384615608491003513336181640625`16.", ",", 
   "40384.990384615448419936001300811767578125`16.", ",", 
   "53846.2788461538220872171223163604736328125`16.", ",", 
   "0.03617500000000009596767824859853135422`16.", ",", 
   "70190.286858974301139824092388153076171875`16.", ",", 
   "30769.48076923078042455017566680908203125`16.", ",", 
   "58651.4919871794772916473448276519775390625`16.", ",", 
   "0.02412500000000005612177389480166311841`16.", ",", 
   "3204.33653846154356870101764798164367675781`16.", ",", 
   "12178.63301282050633744802325963973999023438`16.", ",", 
   RowBox[{"-", "8652.20032051280759333167225122451782226562`16."}], ",", 
   "0.0067708333333333491771410805881714623`16.", ",", 
   "63459.3092948718040133826434612274169921875`16.", ",", 
   "57689.828525641001760959625244140625`16.", ",", 
   "37500.08333333340124227106571197509765625`16.", ",", 
   "0.02651250000000006379341499496149481274`16.", ",", 
   "60254.931089743578922934830188751220703125`16.", ",", 
   "45511.153846153829363174736499786376953125`16.", ",", 
   "46152.116987179455463774502277374267578125`16.", ",", 
   "0.02036666666666671343666195070909452625`16."}], "}"}]], "Output",
 CellChangeTimes->{3.906650296213449*^9, 3.906740176936627*^9, 
  3.9067417324304256`*^9, 3.906741800214596*^9, 3.9067428191488857`*^9, 
  3.906810153670218*^9, 3.906810712291624*^9, 3.906810840719602*^9, 
  3.906814987034905*^9, 3.906815114042837*^9, 3.906815359337031*^9, 
  3.906815519429631*^9, 3.9068159016303473`*^9, 3.906819156525222*^9, 
  3.9068210884665127`*^9, 3.906822144112707*^9, 3.9068224008197536`*^9, 
  3.906822668875349*^9, 3.9068231186238728`*^9, 3.9068234672369204`*^9, 
  3.9072578199027843`*^9},
 CellLabel->"Out[95]=",ExpressionUUID->"dcde3ae9-1968-425c-9751-e9ee8dcc405c"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Compute residual gradient wrt control:", "Subsection",
 CellChangeTimes->{{3.7171711972127666`*^9, 3.71717120142911*^9}, {
  3.7209943882500362`*^9, 3.7209944015165186`*^9}, {3.721049011972142*^9, 
  3.721049018596589*^9}, {3.7210554397242594`*^9, 3.7210554438131027`*^9}, {
  3.721059980929894*^9, 
  3.72105998715461*^9}},ExpressionUUID->"67096089-1c8f-45bf-b9c7-\
112140cf8b33"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Klocal", "=", 
   RowBox[{"Table", "[", 
    RowBox[{"0.0", ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"Length", "[", "connect", "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "1", ",", 
       RowBox[{"nnodes", "*", "ndofs"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"k", ",", "1", ",", 
       RowBox[{"nnodes", "*", "ndofs"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"KlocalDot", "=", 
   RowBox[{"Table", "[", 
    RowBox[{"0.0", ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"Length", "[", "connect", "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "1", ",", 
       RowBox[{"nnodes", "*", "ndofs"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"k", ",", "1", ",", 
       RowBox[{"nnodes", "*", "ndofs"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"residualGradient", "=", 
   RowBox[{"Table", "[", 
    RowBox[{"0.0", ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"4", 
        RowBox[{"Length", "[", "xv", "]"}]}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "1", ",", 
       RowBox[{"Length", "[", "xv", "]"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"For", "[", 
  RowBox[{
   RowBox[{"i", "=", "1"}], ",", " ", 
   RowBox[{"i", "\[LessEqual]", " ", 
    RowBox[{"Length", "[", "connect", "]"}]}], ",", 
   RowBox[{"i", "++"}], ",", 
   RowBox[{"Block", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"i1", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"connect", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}], "+", "1"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"i2", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"connect", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "[", 
          RowBox[{"[", "2", "]"}], "]"}], "+", "1"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"i3", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"connect", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "[", 
          RowBox[{"[", "3", "]"}], "]"}], "+", "1"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"i4", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"connect", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "[", 
          RowBox[{"[", "4", "]"}], "]"}], "+", "1"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"nids", "=", 
        RowBox[{"{", 
         RowBox[{"i1", ",", "i2", ",", "i3", ",", "i4"}], "}"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"ids", "=", 
        RowBox[{"{", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"ndofs", " ", 
            RowBox[{"(", 
             RowBox[{"i1", "-", "1"}], ")"}]}], "+", "1"}], ",", " ", 
          RowBox[{
           RowBox[{"ndofs", 
            RowBox[{"(", " ", 
             RowBox[{"i1", "-", "1"}], ")"}]}], "+", "2"}], ",", " ", 
          RowBox[{
           RowBox[{"ndofs", 
            RowBox[{"(", " ", 
             RowBox[{"i1", "-", "1"}], ")"}]}], "+", "3"}], ",", " ", 
          RowBox[{
           RowBox[{"ndofs", 
            RowBox[{"(", 
             RowBox[{"i1", "-", "1"}], ")"}]}], "+", "4"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"ndofs", 
            RowBox[{"(", " ", 
             RowBox[{"i2", "-", "1"}], ")"}]}], "+", "1"}], ",", 
          RowBox[{
           RowBox[{"ndofs", 
            RowBox[{"(", 
             RowBox[{"i2", "-", "1"}], ")"}]}], "+", "2"}], ",", " ", 
          RowBox[{
           RowBox[{"ndofs", 
            RowBox[{"(", " ", 
             RowBox[{"i2", "-", "1"}], ")"}]}], "+", "3"}], ",", 
          RowBox[{
           RowBox[{"ndofs", 
            RowBox[{"(", 
             RowBox[{"i2", "-", "1"}], ")"}]}], "+", "4"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"ndofs", 
            RowBox[{"(", 
             RowBox[{"i3", "-", "1"}], ")"}]}], "+", "1"}], ",", 
          RowBox[{
           RowBox[{"ndofs", " ", 
            RowBox[{"(", 
             RowBox[{"i3", "-", "1"}], ")"}]}], "+", "2"}], ",", " ", 
          RowBox[{
           RowBox[{"ndofs", 
            RowBox[{"(", " ", 
             RowBox[{"i3", "-", "1"}], ")"}]}], "+", "3"}], ",", 
          RowBox[{
           RowBox[{"ndofs", 
            RowBox[{"(", 
             RowBox[{"i3", "-", "1"}], ")"}]}], "+", "4"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"ndofs", 
            RowBox[{"(", 
             RowBox[{"i4", "-", "1"}], ")"}]}], "+", "1"}], ",", 
          RowBox[{
           RowBox[{"ndofs", 
            RowBox[{"(", 
             RowBox[{"i4", "-", "1"}], ")"}]}], "+", "2"}], ",", " ", 
          RowBox[{
           RowBox[{"ndofs", 
            RowBox[{"(", " ", 
             RowBox[{"i4", "-", "1"}], ")"}]}], "+", "3"}], ",", 
          RowBox[{
           RowBox[{"ndofs", 
            RowBox[{"(", 
             RowBox[{"i4", "-", "1"}], ")"}]}], "+", "4"}]}], 
         "\[IndentingNewLine]", "}"}]}]}], "\[IndentingNewLine]", "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Kelmm", "=", 
       RowBox[{"Table", "[", 
        RowBox[{"0.0", ",", 
         RowBox[{"{", 
          RowBox[{"ii", ",", "1", ",", "12"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"jj", ",", "1", ",", "12"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Keltt", "=", 
       RowBox[{"Table", "[", 
        RowBox[{"0.0", ",", 
         RowBox[{"{", 
          RowBox[{"ii", ",", "1", ",", "4"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"jj", ",", "1", ",", "4"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Kelmt", "=", 
       RowBox[{"Table", "[", 
        RowBox[{"0.0", ",", 
         RowBox[{"{", 
          RowBox[{"ii", ",", "1", ",", "12"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"jj", ",", "1", ",", "4"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Mel", "=", 
       RowBox[{"Table", "[", 
        RowBox[{"0.0", ",", 
         RowBox[{"{", 
          RowBox[{"ii", ",", "1", ",", "4"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"jj", ",", "1", ",", "4"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"j", "=", "1"}], ",", 
        RowBox[{"j", "<=", 
         RowBox[{"Length", "[", "gp", "]"}]}], ",", 
        RowBox[{"j", "++"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Kelmm", "+=", 
          RowBox[{
           RowBox[{
            RowBox[{"gw", "[", 
             RowBox[{"[", "j", "]"}], "]"}], 
            RowBox[{"(", 
             RowBox[{"\[Phi]s", ".", 
              RowBox[{"{", 
               RowBox[{
               "\[Rho]1", ",", "\[Rho]2", ",", "\[Rho]3", ",", "\[Rho]4"}], 
               "}"}]}], ")"}], "*", 
            RowBox[{"Kmm", "[", 
             RowBox[{
              RowBox[{"xv", "[", 
               RowBox[{"[", "i1", "]"}], "]"}], ",", 
              RowBox[{"yv", "[", 
               RowBox[{"[", "i1", "]"}], "]"}], ",", 
              RowBox[{"zv", "[", 
               RowBox[{"[", "i1", "]"}], "]"}], ",", 
              RowBox[{"xv", "[", 
               RowBox[{"[", "i2", "]"}], "]"}], ",", 
              RowBox[{"yv", "[", 
               RowBox[{"[", "i2", "]"}], "]"}], ",", 
              RowBox[{"zv", "[", 
               RowBox[{"[", "i2", "]"}], "]"}], ",", 
              RowBox[{"xv", "[", 
               RowBox[{"[", "i3", "]"}], "]"}], ",", 
              RowBox[{"yv", "[", 
               RowBox[{"[", "i3", "]"}], "]"}], ",", 
              RowBox[{"zv", "[", 
               RowBox[{"[", "i3", "]"}], "]"}], ",", 
              RowBox[{"xv", "[", 
               RowBox[{"[", "i4", "]"}], "]"}], ",", 
              RowBox[{"yv", "[", 
               RowBox[{"[", "i4", "]"}], "]"}], ",", 
              RowBox[{"zv", "[", 
               RowBox[{"[", "i4", "]"}], "]"}], ",", 
              RowBox[{"1", "*", 
               SuperscriptBox["10", "11"]}], ",", "0.3"}], "]"}]}], "/.", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"\[Xi]", "\[Rule]", 
              RowBox[{
               RowBox[{"gp", "[", 
                RowBox[{"[", "j", "]"}], "]"}], "[", 
               RowBox[{"[", "1", "]"}], "]"}]}], ",", 
             RowBox[{"\[Psi]", "\[Rule]", 
              RowBox[{
               RowBox[{"gp", "[", 
                RowBox[{"[", "j", "]"}], "]"}], "[", 
               RowBox[{"[", "2", "]"}], "]"}]}], ",", 
             RowBox[{"\[Zeta]", "\[Rule]", 
              RowBox[{
               RowBox[{"gp", "[", 
                RowBox[{"[", "j", "]"}], "]"}], "[", 
               RowBox[{"[", "3", "]"}], "]"}]}]}], "}"}]}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"Keltt", "+=", 
          RowBox[{
           RowBox[{
            RowBox[{"gw", "[", 
             RowBox[{"[", "j", "]"}], "]"}], 
            RowBox[{"(", 
             RowBox[{"\[Phi]s", ".", 
              RowBox[{"{", 
               RowBox[{
               "\[Rho]1", ",", "\[Rho]2", ",", "\[Rho]3", ",", "\[Rho]4"}], 
               "}"}]}], ")"}], "*", 
            RowBox[{"ktt", "[", 
             RowBox[{
              RowBox[{"xv", "[", 
               RowBox[{"[", "i1", "]"}], "]"}], ",", 
              RowBox[{"yv", "[", 
               RowBox[{"[", "i1", "]"}], "]"}], ",", 
              RowBox[{"zv", "[", 
               RowBox[{"[", "i1", "]"}], "]"}], ",", 
              RowBox[{"xv", "[", 
               RowBox[{"[", "i2", "]"}], "]"}], ",", 
              RowBox[{"yv", "[", 
               RowBox[{"[", "i2", "]"}], "]"}], ",", 
              RowBox[{"zv", "[", 
               RowBox[{"[", "i2", "]"}], "]"}], ",", 
              RowBox[{"xv", "[", 
               RowBox[{"[", "i3", "]"}], "]"}], ",", 
              RowBox[{"yv", "[", 
               RowBox[{"[", "i3", "]"}], "]"}], ",", 
              RowBox[{"zv", "[", 
               RowBox[{"[", "i3", "]"}], "]"}], ",", 
              RowBox[{"xv", "[", 
               RowBox[{"[", "i4", "]"}], "]"}], ",", 
              RowBox[{"yv", "[", 
               RowBox[{"[", "i4", "]"}], "]"}], ",", 
              RowBox[{"zv", "[", 
               RowBox[{"[", "i4", "]"}], "]"}], ",", "ConductionCoeff"}], 
             "]"}]}], "/.", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"\[Xi]", "\[Rule]", 
              RowBox[{
               RowBox[{"gp", "[", 
                RowBox[{"[", "j", "]"}], "]"}], "[", 
               RowBox[{"[", "1", "]"}], "]"}]}], ",", 
             RowBox[{"\[Psi]", "\[Rule]", 
              RowBox[{
               RowBox[{"gp", "[", 
                RowBox[{"[", "j", "]"}], "]"}], "[", 
               RowBox[{"[", "2", "]"}], "]"}]}], ",", 
             RowBox[{"\[Zeta]", "\[Rule]", 
              RowBox[{
               RowBox[{"gp", "[", 
                RowBox[{"[", "j", "]"}], "]"}], "[", 
               RowBox[{"[", "3", "]"}], "]"}]}]}], "}"}]}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"Mel", "+=", 
          RowBox[{
           RowBox[{
            RowBox[{"gw", "[", 
             RowBox[{"[", "j", "]"}], "]"}], 
            RowBox[{"(", 
             RowBox[{"\[Phi]s", ".", 
              RowBox[{"{", 
               RowBox[{
               "\[Rho]1", ",", "\[Rho]2", ",", "\[Rho]3", ",", "\[Rho]4"}], 
               "}"}]}], ")"}], "*", 
            RowBox[{"Mmat", "[", 
             RowBox[{
              RowBox[{"xv", "[", 
               RowBox[{"[", "i1", "]"}], "]"}], ",", 
              RowBox[{"yv", "[", 
               RowBox[{"[", "i1", "]"}], "]"}], ",", 
              RowBox[{"zv", "[", 
               RowBox[{"[", "i1", "]"}], "]"}], ",", 
              RowBox[{"xv", "[", 
               RowBox[{"[", "i2", "]"}], "]"}], ",", 
              RowBox[{"yv", "[", 
               RowBox[{"[", "i2", "]"}], "]"}], ",", 
              RowBox[{"zv", "[", 
               RowBox[{"[", "i2", "]"}], "]"}], ",", 
              RowBox[{"xv", "[", 
               RowBox[{"[", "i3", "]"}], "]"}], ",", 
              RowBox[{"yv", "[", 
               RowBox[{"[", "i3", "]"}], "]"}], ",", 
              RowBox[{"zv", "[", 
               RowBox[{"[", "i3", "]"}], "]"}], ",", 
              RowBox[{"xv", "[", 
               RowBox[{"[", "i4", "]"}], "]"}], ",", 
              RowBox[{"yv", "[", 
               RowBox[{"[", "i4", "]"}], "]"}], ",", 
              RowBox[{"zv", "[", 
               RowBox[{"[", "i4", "]"}], "]"}], ",", "0.3", ",", 
              RowBox[{"1", "*", 
               SuperscriptBox["10", "6"]}]}], "]"}]}], "/.", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"\[Xi]", "\[Rule]", 
              RowBox[{
               RowBox[{"gp", "[", 
                RowBox[{"[", "j", "]"}], "]"}], "[", 
               RowBox[{"[", "1", "]"}], "]"}]}], ",", 
             RowBox[{"\[Psi]", "\[Rule]", 
              RowBox[{
               RowBox[{"gp", "[", 
                RowBox[{"[", "j", "]"}], "]"}], "[", 
               RowBox[{"[", "2", "]"}], "]"}]}], ",", 
             RowBox[{"\[Zeta]", "\[Rule]", 
              RowBox[{
               RowBox[{"gp", "[", 
                RowBox[{"[", "j", "]"}], "]"}], "[", 
               RowBox[{"[", "3", "]"}], "]"}]}]}], "}"}]}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"Kelmt", "+=", 
          RowBox[{
           RowBox[{
            RowBox[{"gw", "[", 
             RowBox[{"[", "j", "]"}], "]"}], 
            RowBox[{"(", 
             RowBox[{"\[Phi]s", ".", 
              RowBox[{"{", 
               RowBox[{
               "\[Rho]1", ",", "\[Rho]2", ",", "\[Rho]3", ",", "\[Rho]4"}], 
               "}"}]}], ")"}], "*", 
            RowBox[{"kmt", "[", 
             RowBox[{
              RowBox[{"xv", "[", 
               RowBox[{"[", "i1", "]"}], "]"}], ",", 
              RowBox[{"yv", "[", 
               RowBox[{"[", "i1", "]"}], "]"}], ",", 
              RowBox[{"zv", "[", 
               RowBox[{"[", "i1", "]"}], "]"}], ",", 
              RowBox[{"xv", "[", 
               RowBox[{"[", "i2", "]"}], "]"}], ",", 
              RowBox[{"yv", "[", 
               RowBox[{"[", "i2", "]"}], "]"}], ",", 
              RowBox[{"zv", "[", 
               RowBox[{"[", "i2", "]"}], "]"}], ",", 
              RowBox[{"xv", "[", 
               RowBox[{"[", "i3", "]"}], "]"}], ",", 
              RowBox[{"yv", "[", 
               RowBox[{"[", "i3", "]"}], "]"}], ",", 
              RowBox[{"zv", "[", 
               RowBox[{"[", "i3", "]"}], "]"}], ",", 
              RowBox[{"xv", "[", 
               RowBox[{"[", "i4", "]"}], "]"}], ",", 
              RowBox[{"yv", "[", 
               RowBox[{"[", "i4", "]"}], "]"}], ",", 
              RowBox[{"zv", "[", 
               RowBox[{"[", "i4", "]"}], "]"}], ",", 
              RowBox[{"1.0", "*", 
               SuperscriptBox["10", 
                RowBox[{"-", "5"}]]}], ",", 
              RowBox[{"1", "*", 
               SuperscriptBox["10", "11"]}], ",", "0.3"}], "]"}]}], "/.", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"\[Xi]", "\[Rule]", 
              RowBox[{
               RowBox[{"gp", "[", 
                RowBox[{"[", "j", "]"}], "]"}], "[", 
               RowBox[{"[", "1", "]"}], "]"}]}], ",", 
             RowBox[{"\[Psi]", "\[Rule]", 
              RowBox[{
               RowBox[{"gp", "[", 
                RowBox[{"[", "j", "]"}], "]"}], "[", 
               RowBox[{"[", "2", "]"}], "]"}]}], ",", 
             RowBox[{"\[Zeta]", "\[Rule]", 
              RowBox[{
               RowBox[{"gp", "[", 
                RowBox[{"[", "j", "]"}], "]"}], "[", 
               RowBox[{"[", "3", "]"}], "]"}]}]}], "}"}]}]}], ";"}]}], 
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"inode", "=", "0"}], ",", 
        RowBox[{"inode", "<", "nnodes"}], ",", 
        RowBox[{"inode", "++"}], ",", "\[IndentingNewLine]", 
        RowBox[{"For", "[", 
         RowBox[{
          RowBox[{"jnode", "=", "0"}], ",", 
          RowBox[{"jnode", "<", "nnodes"}], ",", 
          RowBox[{"jnode", "++"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"For", "[", 
            RowBox[{
             RowBox[{"idof", "=", "0"}], ",", 
             RowBox[{"idof", "<", "nmdofs"}], ",", 
             RowBox[{"idof", "++"}], ",", "\[IndentingNewLine]", 
             RowBox[{"For", "[", 
              RowBox[{
               RowBox[{"jdof", "=", "0"}], ",", 
               RowBox[{"jdof", "<", "nmdofs"}], ",", 
               RowBox[{"jdof", "++"}], ",", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{"Klocal", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "[", 
                   RowBox[{"[", 
                    RowBox[{
                    RowBox[{"inode", " ", "ndofs"}], "+", "idof", "+", "1"}], 
                    "]"}], "]"}], "[", 
                  RowBox[{"[", 
                   RowBox[{
                    RowBox[{"jnode", " ", "ndofs"}], "+", "jdof", "+", "1"}], 
                   "]"}], "]"}], " ", "=", 
                 RowBox[{
                  RowBox[{"Kelmm", "[", 
                   RowBox[{"[", 
                    RowBox[{
                    RowBox[{"inode", " ", "nmdofs"}], "+", "idof", "+", "1"}],
                     "]"}], "]"}], "[", 
                  RowBox[{"[", 
                   RowBox[{
                    RowBox[{"jnode", " ", "nmdofs"}], "+", "jdof", "+", "1"}],
                    "]"}], "]"}]}], ";"}]}], "\[IndentingNewLine]", "]"}]}], 
            "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"Klocal", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "[", 
              RowBox[{"[", 
               RowBox[{
                RowBox[{"inode", " ", "ndofs"}], "+", "nmdofs", "+", "1"}], 
               "]"}], "]"}], "[", 
             RowBox[{"[", 
              RowBox[{
               RowBox[{"jnode", " ", "ndofs"}], "+", "nmdofs", "+", "1"}], 
              "]"}], "]"}], " ", "=", 
            RowBox[{
             RowBox[{"Keltt", "[", 
              RowBox[{"[", 
               RowBox[{"inode", "+", "1"}], "]"}], "]"}], "[", 
             RowBox[{"[", 
              RowBox[{"jnode", "+", "1"}], "]"}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"For", "[", 
            RowBox[{
             RowBox[{"idof", "=", "0"}], ",", 
             RowBox[{"idof", "<", "nmdofs"}], ",", 
             RowBox[{"idof", "++"}], ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"Klocal", "[", 
                  RowBox[{"[", "i", "]"}], "]"}], "[", 
                 RowBox[{"[", 
                  RowBox[{
                   RowBox[{"inode", " ", "ndofs"}], "+", "idof", "+", "1"}], 
                  "]"}], "]"}], "[", 
                RowBox[{"[", 
                 RowBox[{
                  RowBox[{"jnode", " ", "ndofs"}], "+", "nmdofs", "+", "1"}], 
                 "]"}], "]"}], " ", "=", 
               RowBox[{"-", 
                RowBox[{
                 RowBox[{"Kelmt", "[", 
                  RowBox[{"[", 
                   RowBox[{
                    RowBox[{"inode", " ", "nmdofs"}], "+", "idof", "+", "1"}],
                    "]"}], "]"}], "[", 
                 RowBox[{"[", 
                  RowBox[{"jnode", "+", "1"}], "]"}], "]"}]}]}], ";"}]}], 
            "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"inode", "=", "0"}], ",", 
        RowBox[{"inode", "<", "nnodes"}], ",", 
        RowBox[{"inode", "++"}], ",", "\[IndentingNewLine]", 
        RowBox[{"For", "[", 
         RowBox[{
          RowBox[{"jnode", "=", "0"}], ",", 
          RowBox[{"jnode", "<", "nnodes"}], ",", 
          RowBox[{"jnode", "++"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"KlocalDot", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "[", 
              RowBox[{"[", 
               RowBox[{
                RowBox[{"inode", " ", "ndofs"}], "+", "nmdofs", "+", "1"}], 
               "]"}], "]"}], "[", 
             RowBox[{"[", 
              RowBox[{
               RowBox[{"jnode", " ", "ndofs"}], "+", "nmdofs", "+", "1"}], 
              "]"}], "]"}], " ", "=", 
            RowBox[{
             RowBox[{"Mel", "[", 
              RowBox[{"[", 
               RowBox[{"inode", "+", "1"}], "]"}], "]"}], "[", 
             RowBox[{"[", 
              RowBox[{"jnode", "+", "1"}], "]"}], "]"}]}], ";"}]}], 
         "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"disp", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"uv", "[", 
          RowBox[{"[", 
           RowBox[{"ids", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "]"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", "16"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"dispDot", "=", " ", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"uvDot", "[", 
          RowBox[{"[", 
           RowBox[{"ids", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "]"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", "16"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"resid", "=", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Klocal", "[", 
            RowBox[{"[", "i", "]"}], "]"}], ".", "disp"}], ")"}], "+", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"KlocalDot", "[", 
            RowBox[{"[", "i", "]"}], "]"}], ".", "dispDot"}], ")"}]}], 
        ")"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"d\[Rho]", "=", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"D", "[", 
            RowBox[{"resid", ",", "\[Rho]1"}], "]"}], ",", 
           RowBox[{"D", "[", 
            RowBox[{"resid", ",", "\[Rho]2"}], "]"}], ",", 
           RowBox[{"D", "[", 
            RowBox[{"resid", ",", "\[Rho]3"}], "]"}], ",", 
           RowBox[{"D", "[", 
            RowBox[{"resid", ",", "\[Rho]4"}], "]"}]}], "}"}], "/.", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"\[Rho]1", "\[Rule]", "1.0"}], ",", 
           RowBox[{"\[Rho]2", "\[Rule]", "1.0"}], ",", 
           RowBox[{"\[Rho]3", "\[Rule]", "1.0"}], ",", 
           RowBox[{"\[Rho]4", "\[Rule]", "1.0"}]}], "}"}]}], ")"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"Iv", "=", "1"}], ",", 
        RowBox[{"Iv", "\[LessEqual]", "16"}], ",", 
        RowBox[{"Iv", "++"}], ",", "\[IndentingNewLine]", 
        RowBox[{"For", "[", 
         RowBox[{
          RowBox[{"Jv", "=", "1"}], ",", 
          RowBox[{"Jv", "\[LessEqual]", "4"}], ",", 
          RowBox[{"Jv", "++"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"residualGradient", "[", 
              RowBox[{"[", 
               RowBox[{"ids", "[", 
                RowBox[{"[", "Iv", "]"}], "]"}], "]"}], "]"}], "[", 
             RowBox[{"[", 
              RowBox[{"nids", "[", 
               RowBox[{"[", "Jv", "]"}], "]"}], "]"}], "]"}], "+=", 
            RowBox[{
             RowBox[{"d\[Rho]", "[", 
              RowBox[{"[", "Jv", "]"}], "]"}], "[", 
             RowBox[{"[", "Iv", "]"}], "]"}]}], ";"}]}], 
         "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}], 
      ";"}]}], "\[IndentingNewLine]", "]"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.7167647605597653`*^9, 3.7167647892518883`*^9}, {
   3.7167648244240847`*^9, 3.716764841539942*^9}, {3.71676488019324*^9, 
   3.7167648969754357`*^9}, {3.716765065628334*^9, 3.716765185350045*^9}, {
   3.7167652229401484`*^9, 3.7167652383100395`*^9}, {3.7167653441168547`*^9, 
   3.7167655199547443`*^9}, {3.7167655675522327`*^9, 
   3.7167655810711265`*^9}, {3.716765622284607*^9, 3.7167656290567384`*^9}, {
   3.716765757154343*^9, 3.716765792076064*^9}, {3.7167658276745405`*^9, 
   3.7167660826802125`*^9}, {3.716766195664576*^9, 3.716766242915578*^9}, {
   3.7167663310833845`*^9, 3.7167663393539863`*^9}, {3.7167664503932595`*^9, 
   3.716766450932579*^9}, {3.7167664868258085`*^9, 3.7167665635541043`*^9}, {
   3.716766627651472*^9, 3.716766643645746*^9}, {3.716766826115865*^9, 
   3.7167668360695195`*^9}, {3.716766868385886*^9, 3.7167669130203*^9}, {
   3.717155721663645*^9, 3.7171557331420517`*^9}, {3.717155769178903*^9, 
   3.7171557818205233`*^9}, {3.7171567883516493`*^9, 3.717156887869956*^9}, {
   3.717156918335051*^9, 3.717156937057849*^9}, {3.717157017416103*^9, 
   3.717157052623994*^9}, {3.717157895689323*^9, 3.717157931742132*^9}, {
   3.717166282194605*^9, 3.71716628473459*^9}, {3.71716849797501*^9, 
   3.71716852298344*^9}, {3.717168562021318*^9, 3.717168562125424*^9}, {
   3.717168843821663*^9, 3.717168857297769*^9}, {3.7171692165304537`*^9, 
   3.7171692208302*^9}, {3.717170006857576*^9, 3.717170018830927*^9}, {
   3.717171209233417*^9, 3.717171213025419*^9}, {3.7173548750864697`*^9, 
   3.717354881757492*^9}, {3.717354996753583*^9, 3.717355017245678*^9}, {
   3.717355319697336*^9, 3.7173553216726255`*^9}, {3.7173557531181636`*^9, 
   3.7173557820403166`*^9}, {3.7173558138063755`*^9, 
   3.7173558166812677`*^9}, {3.7173587645155315`*^9, 
   3.7173587704721184`*^9}, {3.7173588122062426`*^9, 
   3.7173588501286516`*^9}, {3.717359014190798*^9, 3.7173590339564075`*^9}, {
   3.7173591194571896`*^9, 3.7173591202540846`*^9}, {3.717360749384885*^9, 
   3.717360755072524*^9}, {3.7173608405541487`*^9, 3.7173608453215923`*^9}, {
   3.7174176653039513`*^9, 3.7174177502357674`*^9}, {3.717418005127076*^9, 
   3.717418022383568*^9}, {3.7174180927900662`*^9, 3.717418180868244*^9}, {
   3.717419219270834*^9, 3.7174192266613092`*^9}, {3.71741926925568*^9, 
   3.717419272755123*^9}, {3.7174241468474283`*^9, 3.7174241510843997`*^9}, {
   3.71742429898483*^9, 3.717424381678406*^9}, {3.717427960779907*^9, 
   3.7174279724352093`*^9}, {3.7174281618258095`*^9, 
   3.7174281652786007`*^9}, {3.7208066594239817`*^9, 
   3.7208066657144737`*^9}, {3.720994042619423*^9, 3.7209941465012307`*^9}, {
   3.7209941931469326`*^9, 3.7209942823899403`*^9}, {3.7209945149606404`*^9, 
   3.7209945361169796`*^9}, {3.7209946799116*^9, 3.720994978291444*^9}, {
   3.7210470008455043`*^9, 3.7210470020792093`*^9}, {3.721055446475813*^9, 
   3.7210554769975753`*^9}, {3.7210555442260976`*^9, 3.721055585763404*^9}, {
   3.7230547784118013`*^9, 3.7230547844740324`*^9}, {3.7230580841467104`*^9, 
   3.7230581803982973`*^9}, {3.7230585213381877`*^9, 3.723058522399741*^9}, {
   3.723515313727868*^9, 3.7235153825857706`*^9}, {3.7236621698838377`*^9, 
   3.7236621717519226`*^9}, {3.7236622124923797`*^9, 3.723662227510171*^9}, 
   3.7236622603736763`*^9, {3.723662501164076*^9, 3.7236625138790245`*^9}, 
   3.7236636246400113`*^9, {3.7236636643397217`*^9, 3.7236636653317575`*^9}, {
   3.723664443286131*^9, 3.723664465914736*^9}, {3.7236645478013163`*^9, 
   3.723664550184022*^9}, {3.7236649087859735`*^9, 3.723664911863844*^9}, {
   3.7642548499337397`*^9, 3.7642548561514874`*^9}, {3.7642548909189143`*^9, 
   3.7642549502424526`*^9}, {3.764255000130916*^9, 3.764255033148587*^9}, {
   3.7643520295878253`*^9, 3.7643520409484105`*^9}, {3.7643521412661023`*^9, 
   3.764352149703657*^9}, {3.7644887503812428`*^9, 3.7644887514710517`*^9}, {
   3.7656472087494864`*^9, 3.7656472112899885`*^9}, {3.7656472871591763`*^9, 
   3.7656473509384537`*^9}, {3.765648196616994*^9, 3.765648233320232*^9}, {
   3.7656482645664015`*^9, 3.7656483210250745`*^9}, {3.765648595128484*^9, 
   3.765648603301129*^9}, {3.765652663335536*^9, 3.7656527058447275`*^9}, {
   3.76565275945973*^9, 3.765652831166088*^9}, {3.765652864859234*^9, 
   3.7656528678792305`*^9}, {3.7656529925188694`*^9, 
   3.7656529930502205`*^9}, {3.7656530870940113`*^9, 
   3.7656530900439177`*^9}, {3.7996016011076202`*^9, 3.799601618859434*^9}, {
   3.799609254914246*^9, 3.799609298957262*^9}, {3.799611036966049*^9, 
   3.799611042061433*^9}, {3.799611249898497*^9, 3.799611255707486*^9}, {
   3.799611352617154*^9, 3.799611358072629*^9}, {3.799611418606784*^9, 
   3.799611418829158*^9}, {3.9067421450954943`*^9, 3.90674220389749*^9}, {
   3.906742257527223*^9, 3.90674228259123*^9}, {3.9068098572339*^9, 
   3.90680990453303*^9}, 3.906809941806726*^9, {3.906809988092721*^9, 
   3.906810001069584*^9}, {3.906810073555271*^9, 3.906810099792748*^9}, {
   3.906810799578771*^9, 3.906810801287949*^9}, 3.906814895928446*^9, {
   3.906822519798854*^9, 3.9068225245421267`*^9}},
 CellLabel->"In[96]:=",ExpressionUUID->"79bdf52c-4e6a-4b5d-b66a-eb57b393b808"],

Cell[BoxData[
 RowBox[{
  RowBox[{"transposeResidGrad", "=", 
   RowBox[{"Transpose", "[", "residualGradient", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.7643672034117346`*^9, 3.764367234235589*^9}},
 CellLabel->
  "In[100]:=",ExpressionUUID->"3956f888-77ef-45eb-90f5-1c691aa3fb44"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Join", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"SetPrecision", "[", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"transposeResidGrad", "[", 
        RowBox[{"[", 
         RowBox[{"1", ",", 
          RowBox[{
           RowBox[{"4", "*", "0"}], "+", "i"}]}], "]"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "4"}], "}"}]}], "]"}], ",", "18"}], "]"}],
    ",", "\[IndentingNewLine]", 
   RowBox[{"SetPrecision", "[", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"transposeResidGrad", "[", 
        RowBox[{"[", 
         RowBox[{"1", ",", 
          RowBox[{
           RowBox[{"4", "*", "1"}], "+", "i"}]}], "]"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "4"}], "}"}]}], "]"}], ",", "18"}], "]"}],
    ",", "\[IndentingNewLine]", 
   RowBox[{"SetPrecision", "[", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"transposeResidGrad", "[", 
        RowBox[{"[", 
         RowBox[{"1", ",", 
          RowBox[{
           RowBox[{"4", "*", "3"}], "+", "i"}]}], "]"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "4"}], "}"}]}], "]"}], ",", "18"}], "]"}],
    ",", "\[IndentingNewLine]", 
   RowBox[{"SetPrecision", "[", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"transposeResidGrad", "[", 
        RowBox[{"[", 
         RowBox[{"1", ",", 
          RowBox[{
           RowBox[{"4", "*", "4"}], "+", "i"}]}], "]"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "4"}], "}"}]}], "]"}], ",", "18"}], 
    "]"}]}], "\[IndentingNewLine]", "]"}]], "Input",
 CellChangeTimes->{{3.7643531514936028`*^9, 3.7643531558462763`*^9}, {
   3.764353198654197*^9, 3.7643532501028695`*^9}, {3.7643602313882027`*^9, 
   3.764360302960787*^9}, 3.7643666855513444`*^9, 3.7643667533077087`*^9, {
   3.764367240159917*^9, 3.764367331564372*^9}, {3.764367379889902*^9, 
   3.764367551594491*^9}, {3.764367812262062*^9, 3.764367821166567*^9}, {
   3.849378569044209*^9, 3.849378575182293*^9}, {3.8503258501597424`*^9, 
   3.8503258545999403`*^9}},
 CellLabel->
  "In[101]:=",ExpressionUUID->"b0592e7e-8d14-4787-b139-86a2775b4a67"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"-", "15063.96506410247457097284495830535888671875`18."}], ",", 
   RowBox[{"-", "11378.10512820505937270354479551315307617188`18."}], ",", 
   RowBox[{"-", "11538.37403846146662544924765825271606445312`18."}], ",", 
   "0.00133893754857553797313340915309254342`18.", ",", 
   RowBox[{"-", "801.23205128204517677659168839454650878906`18."}], ",", 
   RowBox[{"-", "3044.83429487177545524900779128074645996094`18."}], ",", 
   "2163.37403846152392361545935273170471191406`18.", ",", 
   "0.00016273743474869140340083317752828407`18.", ",", 
   RowBox[{"-", "2483.91602564101003736141137778759002685547`18."}], ",", 
   "3685.79743589741201503784395754337310791016`18.", ",", 
   RowBox[{"-", "3124.9583333333139307796955108642578125`18."}], ",", 
   "0.00026393107853384741197377838517468263`18.", ",", 
   RowBox[{"-", "3285.17724358972327536321245133876800537109`18."}], ",", 
   "640.98814102563665073830634355545043945312`18.", ",", 
   RowBox[{"-", "961.58012820512408325157593935728073120117`18."}], ",", 
   "0.00013270325169661073083995916910282631`18."}], "}"}]], "Output",
 CellChangeTimes->{
  3.76435329567939*^9, 3.764360304676647*^9, 3.764366754822819*^9, 
   3.764366861476902*^9, {3.764367529712575*^9, 3.7643675526795163`*^9}, 
   3.764367822471277*^9, 3.764369814616887*^9, 3.7656528907938385`*^9, 
   3.765653096443327*^9, 3.7996016299472427`*^9, 3.799608960215411*^9, 
   3.79961108354156*^9, 3.79961127519025*^9, 3.799611368018132*^9, 
   3.799611425705665*^9, 3.849378576061516*^9, 3.850325890099204*^9, 
   3.906740178593627*^9, 3.906741734091484*^9, 3.906741801866364*^9, 
   3.906742821828779*^9, 3.9068101567969*^9, 3.906810715637231*^9, 
   3.9068108438808937`*^9, 3.906814990095467*^9, 3.9068151171319942`*^9, 
   3.906815362829701*^9, 3.906815522561714*^9, 3.906815904823895*^9, 
   3.906819159552167*^9, 3.9068210915968018`*^9, 3.9068221474420958`*^9, 
   3.906822404353163*^9, 3.906822608064942*^9, 3.90682267176404*^9, 
   3.90682312160609*^9, 3.906823470140215*^9, 3.907257821755327*^9},
 CellLabel->
  "Out[101]=",ExpressionUUID->"4cf14b84-16b3-4df0-8962-3a698fd53393"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Compute residual gradient wrt config:", "Subsection",
 CellChangeTimes->{{3.7171711972127666`*^9, 3.71717120142911*^9}, {
  3.7209943882500362`*^9, 3.7209944015165186`*^9}, {3.721049011972142*^9, 
  3.721049018596589*^9}, {3.7210490655350704`*^9, 3.7210490675964766`*^9}, {
  3.7230551164809313`*^9, 3.7230551185900598`*^9}, {3.72391300931705*^9, 
  3.7239130109421873`*^9}},ExpressionUUID->"41c3a2d8-57a1-4802-ab6b-\
52ea4c1b5d2b"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ndims", "=", "3"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Klocal", "=", 
   RowBox[{"Table", "[", 
    RowBox[{"0.0", ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"Length", "[", "connect", "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "1", ",", 
       RowBox[{"nnodes", "*", "ndofs"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"k", ",", "1", ",", 
       RowBox[{"nnodes", "*", "ndofs"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"residualGradientX", "=", 
   RowBox[{"Table", "[", 
    RowBox[{"0.0", ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"ndofs", " ", 
        RowBox[{"Length", "[", "xv", "]"}]}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "1", ",", 
       RowBox[{"ndims", " ", 
        RowBox[{"Length", "[", "xv", "]"}]}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"For", "[", 
  RowBox[{
   RowBox[{"i", "=", "1"}], ",", " ", 
   RowBox[{"i", "\[LessEqual]", 
    RowBox[{"Length", "[", "connect", "]"}]}], ",", 
   RowBox[{"i", "++"}], ",", 
   RowBox[{"Block", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"i1", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"connect", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}], "+", "1"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"i2", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"connect", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "[", 
          RowBox[{"[", "2", "]"}], "]"}], "+", "1"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"i3", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"connect", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "[", 
          RowBox[{"[", "3", "]"}], "]"}], "+", "1"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"i4", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"connect", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "[", 
          RowBox[{"[", "4", "]"}], "]"}], "+", "1"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"nids", "=", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"ndims", " ", 
            RowBox[{"(", 
             RowBox[{"i1", "-", "1"}], ")"}]}], "+", "1"}], ",", " ", 
          RowBox[{
           RowBox[{"ndims", 
            RowBox[{"(", " ", 
             RowBox[{"i1", "-", "1"}], ")"}]}], "+", "2"}], ",", " ", 
          RowBox[{
           RowBox[{"ndims", 
            RowBox[{"(", " ", 
             RowBox[{"i1", "-", "1"}], ")"}]}], "+", "3"}], ",", 
          RowBox[{
           RowBox[{"ndims", 
            RowBox[{"(", " ", 
             RowBox[{"i2", "-", "1"}], ")"}]}], "+", "1"}], ",", 
          RowBox[{
           RowBox[{"ndims", 
            RowBox[{"(", 
             RowBox[{"i2", "-", "1"}], ")"}]}], "+", "2"}], ",", " ", 
          RowBox[{
           RowBox[{"ndims", 
            RowBox[{"(", " ", 
             RowBox[{"i2", "-", "1"}], ")"}]}], "+", "3"}], ",", 
          RowBox[{
           RowBox[{"ndims", 
            RowBox[{"(", 
             RowBox[{"i3", "-", "1"}], ")"}]}], "+", "1"}], ",", 
          RowBox[{
           RowBox[{"ndims", " ", 
            RowBox[{"(", 
             RowBox[{"i3", "-", "1"}], ")"}]}], "+", "2"}], ",", " ", 
          RowBox[{
           RowBox[{"ndims", 
            RowBox[{"(", " ", 
             RowBox[{"i3", "-", "1"}], ")"}]}], "+", "3"}], ",", 
          RowBox[{
           RowBox[{"ndims", 
            RowBox[{"(", 
             RowBox[{"i4", "-", "1"}], ")"}]}], "+", "1"}], ",", 
          RowBox[{
           RowBox[{"ndims", 
            RowBox[{"(", 
             RowBox[{"i4", "-", "1"}], ")"}]}], "+", "2"}], ",", " ", 
          RowBox[{
           RowBox[{"ndims", 
            RowBox[{"(", " ", 
             RowBox[{"i4", "-", "1"}], ")"}]}], "+", "3"}]}], "}"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"ids", "=", 
        RowBox[{"{", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"ndofs", " ", 
            RowBox[{"(", 
             RowBox[{"i1", "-", "1"}], ")"}]}], "+", "1"}], ",", " ", 
          RowBox[{
           RowBox[{"ndofs", 
            RowBox[{"(", " ", 
             RowBox[{"i1", "-", "1"}], ")"}]}], "+", "2"}], ",", " ", 
          RowBox[{
           RowBox[{"ndofs", 
            RowBox[{"(", " ", 
             RowBox[{"i1", "-", "1"}], ")"}]}], "+", "3"}], ",", " ", 
          RowBox[{
           RowBox[{"ndofs", 
            RowBox[{"(", 
             RowBox[{"i1", "-", "1"}], ")"}]}], "+", "4"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"ndofs", 
            RowBox[{"(", " ", 
             RowBox[{"i2", "-", "1"}], ")"}]}], "+", "1"}], ",", 
          RowBox[{
           RowBox[{"ndofs", 
            RowBox[{"(", 
             RowBox[{"i2", "-", "1"}], ")"}]}], "+", "2"}], ",", " ", 
          RowBox[{
           RowBox[{"ndofs", 
            RowBox[{"(", " ", 
             RowBox[{"i2", "-", "1"}], ")"}]}], "+", "3"}], ",", 
          RowBox[{
           RowBox[{"ndofs", 
            RowBox[{"(", 
             RowBox[{"i2", "-", "1"}], ")"}]}], "+", "4"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"ndofs", 
            RowBox[{"(", 
             RowBox[{"i3", "-", "1"}], ")"}]}], "+", "1"}], ",", 
          RowBox[{
           RowBox[{"ndofs", " ", 
            RowBox[{"(", 
             RowBox[{"i3", "-", "1"}], ")"}]}], "+", "2"}], ",", " ", 
          RowBox[{
           RowBox[{"ndofs", 
            RowBox[{"(", " ", 
             RowBox[{"i3", "-", "1"}], ")"}]}], "+", "3"}], ",", 
          RowBox[{
           RowBox[{"ndofs", 
            RowBox[{"(", 
             RowBox[{"i3", "-", "1"}], ")"}]}], "+", "4"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"ndofs", 
            RowBox[{"(", 
             RowBox[{"i4", "-", "1"}], ")"}]}], "+", "1"}], ",", 
          RowBox[{
           RowBox[{"ndofs", 
            RowBox[{"(", 
             RowBox[{"i4", "-", "1"}], ")"}]}], "+", "2"}], ",", " ", 
          RowBox[{
           RowBox[{"ndofs", 
            RowBox[{"(", " ", 
             RowBox[{"i4", "-", "1"}], ")"}]}], "+", "3"}], ",", 
          RowBox[{
           RowBox[{"ndofs", 
            RowBox[{"(", 
             RowBox[{"i4", "-", "1"}], ")"}]}], "+", "4"}]}], 
         "\[IndentingNewLine]", "}"}]}]}], "\[IndentingNewLine]", "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Kelmm", "=", 
       RowBox[{"Table", "[", 
        RowBox[{"0.0", ",", 
         RowBox[{"{", 
          RowBox[{"ii", ",", "1", ",", "12"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"jj", ",", "1", ",", "12"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Keltt", "=", 
       RowBox[{"Table", "[", 
        RowBox[{"0.0", ",", 
         RowBox[{"{", 
          RowBox[{"ii", ",", "1", ",", "4"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"jj", ",", "1", ",", "4"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Kelmt", "=", 
       RowBox[{"Table", "[", 
        RowBox[{"0.0", ",", 
         RowBox[{"{", 
          RowBox[{"ii", ",", "1", ",", "12"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"jj", ",", "1", ",", "4"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Mel", "=", 
       RowBox[{"Table", "[", 
        RowBox[{"0.0", ",", 
         RowBox[{"{", 
          RowBox[{"ii", ",", "1", ",", "4"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"jj", ",", "1", ",", "4"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"j", "=", "1"}], ",", 
        RowBox[{"j", "<=", 
         RowBox[{"Length", "[", "gp", "]"}]}], ",", 
        RowBox[{"j", "++"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Kelmm", "+=", 
          RowBox[{
           RowBox[{
            RowBox[{"gw", "[", 
             RowBox[{"[", "j", "]"}], "]"}], "*", 
            RowBox[{"KmmNoAbs", "[", 
             RowBox[{
             "x1", ",", "x2", ",", "x3", ",", "x4", ",", "x5", ",", "x6", ",",
               "x7", ",", "x8", ",", "x9", ",", "x10", ",", "x11", ",", "x12",
               ",", 
              RowBox[{"1", "*", 
               SuperscriptBox["10", "11"]}], ",", "0.3"}], "]"}]}], "/.", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"\[Xi]", "\[Rule]", 
              RowBox[{
               RowBox[{"gp", "[", 
                RowBox[{"[", "j", "]"}], "]"}], "[", 
               RowBox[{"[", "1", "]"}], "]"}]}], ",", 
             RowBox[{"\[Psi]", "\[Rule]", 
              RowBox[{
               RowBox[{"gp", "[", 
                RowBox[{"[", "j", "]"}], "]"}], "[", 
               RowBox[{"[", "2", "]"}], "]"}]}], ",", 
             RowBox[{"\[Zeta]", "\[Rule]", 
              RowBox[{
               RowBox[{"gp", "[", 
                RowBox[{"[", "j", "]"}], "]"}], "[", 
               RowBox[{"[", "3", "]"}], "]"}]}]}], "}"}]}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"Keltt", "+=", 
          RowBox[{
           RowBox[{
            RowBox[{"gw", "[", 
             RowBox[{"[", "j", "]"}], "]"}], "*", 
            RowBox[{"kttNoAbs", "[", 
             RowBox[{
             "x1", ",", "x2", ",", "x3", ",", "x4", ",", "x5", ",", "x6", ",",
               "x7", ",", "x8", ",", "x9", ",", "x10", ",", "x11", ",", "x12",
               ",", "ConductionCoeff"}], "]"}]}], "/.", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"\[Xi]", "\[Rule]", 
              RowBox[{
               RowBox[{"gp", "[", 
                RowBox[{"[", "j", "]"}], "]"}], "[", 
               RowBox[{"[", "1", "]"}], "]"}]}], ",", 
             RowBox[{"\[Psi]", "\[Rule]", 
              RowBox[{
               RowBox[{"gp", "[", 
                RowBox[{"[", "j", "]"}], "]"}], "[", 
               RowBox[{"[", "2", "]"}], "]"}]}], ",", 
             RowBox[{"\[Zeta]", "\[Rule]", 
              RowBox[{
               RowBox[{"gp", "[", 
                RowBox[{"[", "j", "]"}], "]"}], "[", 
               RowBox[{"[", "3", "]"}], "]"}]}]}], "}"}]}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"Mel", "+=", 
          RowBox[{
           RowBox[{
            RowBox[{"gw", "[", 
             RowBox[{"[", "j", "]"}], "]"}], "*", 
            RowBox[{"MmatNoAbs", "[", 
             RowBox[{
             "x1", ",", "x2", ",", "x3", ",", "x4", ",", "x5", ",", "x6", ",",
               "x7", ",", "x8", ",", "x9", ",", "x10", ",", "x11", ",", "x12",
               ",", "0.3", ",", 
              RowBox[{"1", "*", 
               SuperscriptBox["10", "6"]}]}], "]"}]}], "/.", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"\[Xi]", "\[Rule]", 
              RowBox[{
               RowBox[{"gp", "[", 
                RowBox[{"[", "j", "]"}], "]"}], "[", 
               RowBox[{"[", "1", "]"}], "]"}]}], ",", 
             RowBox[{"\[Psi]", "\[Rule]", 
              RowBox[{
               RowBox[{"gp", "[", 
                RowBox[{"[", "j", "]"}], "]"}], "[", 
               RowBox[{"[", "2", "]"}], "]"}]}], ",", 
             RowBox[{"\[Zeta]", "\[Rule]", 
              RowBox[{
               RowBox[{"gp", "[", 
                RowBox[{"[", "j", "]"}], "]"}], "[", 
               RowBox[{"[", "3", "]"}], "]"}]}]}], "}"}]}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"Kelmt", "+=", 
          RowBox[{
           RowBox[{
            RowBox[{"gw", "[", 
             RowBox[{"[", "j", "]"}], "]"}], "*", 
            RowBox[{"kmtNoAbs", "[", 
             RowBox[{
             "x1", ",", "x2", ",", "x3", ",", "x4", ",", "x5", ",", "x6", ",",
               "x7", ",", "x8", ",", "x9", ",", "x10", ",", "x11", ",", "x12",
               ",", 
              RowBox[{"1.0", "*", 
               SuperscriptBox["10", 
                RowBox[{"-", "5"}]]}], ",", 
              RowBox[{"1", "*", 
               SuperscriptBox["10", "11"]}], ",", "0.3"}], "]"}]}], "/.", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"\[Xi]", "\[Rule]", 
              RowBox[{
               RowBox[{"gp", "[", 
                RowBox[{"[", "j", "]"}], "]"}], "[", 
               RowBox[{"[", "1", "]"}], "]"}]}], ",", 
             RowBox[{"\[Psi]", "\[Rule]", 
              RowBox[{
               RowBox[{"gp", "[", 
                RowBox[{"[", "j", "]"}], "]"}], "[", 
               RowBox[{"[", "2", "]"}], "]"}]}], ",", 
             RowBox[{"\[Zeta]", "\[Rule]", 
              RowBox[{
               RowBox[{"gp", "[", 
                RowBox[{"[", "j", "]"}], "]"}], "[", 
               RowBox[{"[", "3", "]"}], "]"}]}]}], "}"}]}]}], ";"}]}], 
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"inode", "=", "0"}], ",", 
        RowBox[{"inode", "<", "nnodes"}], ",", 
        RowBox[{"inode", "++"}], ",", "\[IndentingNewLine]", 
        RowBox[{"For", "[", 
         RowBox[{
          RowBox[{"jnode", "=", "0"}], ",", 
          RowBox[{"jnode", "<", "nnodes"}], ",", 
          RowBox[{"jnode", "++"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"For", "[", 
            RowBox[{
             RowBox[{"idof", "=", "0"}], ",", 
             RowBox[{"idof", "<", "nmdofs"}], ",", 
             RowBox[{"idof", "++"}], ",", "\[IndentingNewLine]", 
             RowBox[{"For", "[", 
              RowBox[{
               RowBox[{"jdof", "=", "0"}], ",", 
               RowBox[{"jdof", "<", "nmdofs"}], ",", 
               RowBox[{"jdof", "++"}], ",", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{"Klocal", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "[", 
                   RowBox[{"[", 
                    RowBox[{
                    RowBox[{"inode", " ", "ndofs"}], "+", "idof", "+", "1"}], 
                    "]"}], "]"}], "[", 
                  RowBox[{"[", 
                   RowBox[{
                    RowBox[{"jnode", " ", "ndofs"}], "+", "jdof", "+", "1"}], 
                   "]"}], "]"}], " ", "=", 
                 RowBox[{
                  RowBox[{"Kelmm", "[", 
                   RowBox[{"[", 
                    RowBox[{
                    RowBox[{"inode", " ", "nmdofs"}], "+", "idof", "+", "1"}],
                     "]"}], "]"}], "[", 
                  RowBox[{"[", 
                   RowBox[{
                    RowBox[{"jnode", " ", "nmdofs"}], "+", "jdof", "+", "1"}],
                    "]"}], "]"}]}], ";"}]}], "\[IndentingNewLine]", "]"}]}], 
            "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"Klocal", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "[", 
              RowBox[{"[", 
               RowBox[{
                RowBox[{"inode", " ", "ndofs"}], "+", "nmdofs", "+", "1"}], 
               "]"}], "]"}], "[", 
             RowBox[{"[", 
              RowBox[{
               RowBox[{"jnode", " ", "ndofs"}], "+", "nmdofs", "+", "1"}], 
              "]"}], "]"}], " ", "=", 
            RowBox[{
             RowBox[{"Keltt", "[", 
              RowBox[{"[", 
               RowBox[{"inode", "+", "1"}], "]"}], "]"}], "[", 
             RowBox[{"[", 
              RowBox[{"jnode", "+", "1"}], "]"}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"For", "[", 
            RowBox[{
             RowBox[{"idof", "=", "0"}], ",", 
             RowBox[{"idof", "<", "nmdofs"}], ",", 
             RowBox[{"idof", "++"}], ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"Klocal", "[", 
                  RowBox[{"[", "i", "]"}], "]"}], "[", 
                 RowBox[{"[", 
                  RowBox[{
                   RowBox[{"inode", " ", "ndofs"}], "+", "idof", "+", "1"}], 
                  "]"}], "]"}], "[", 
                RowBox[{"[", 
                 RowBox[{
                  RowBox[{"jnode", " ", "ndofs"}], "+", "nmdofs", "+", "1"}], 
                 "]"}], "]"}], " ", "=", 
               RowBox[{"-", 
                RowBox[{
                 RowBox[{"Kelmt", "[", 
                  RowBox[{"[", 
                   RowBox[{
                    RowBox[{"inode", " ", "nmdofs"}], "+", "idof", "+", "1"}],
                    "]"}], "]"}], "[", 
                 RowBox[{"[", 
                  RowBox[{"jnode", "+", "1"}], "]"}], "]"}]}]}], ";"}]}], 
            "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"inode", "=", "0"}], ",", 
        RowBox[{"inode", "<", "nnodes"}], ",", 
        RowBox[{"inode", "++"}], ",", "\[IndentingNewLine]", 
        RowBox[{"For", "[", 
         RowBox[{
          RowBox[{"jnode", "=", "0"}], ",", 
          RowBox[{"jnode", "<", "nnodes"}], ",", 
          RowBox[{"jnode", "++"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"KlocalDot", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "[", 
              RowBox[{"[", 
               RowBox[{
                RowBox[{"inode", " ", "ndofs"}], "+", "nmdofs", "+", "1"}], 
               "]"}], "]"}], "[", 
             RowBox[{"[", 
              RowBox[{
               RowBox[{"jnode", " ", "ndofs"}], "+", "nmdofs", "+", "1"}], 
              "]"}], "]"}], " ", "=", 
            RowBox[{
             RowBox[{"Mel", "[", 
              RowBox[{"[", 
               RowBox[{"inode", "+", "1"}], "]"}], "]"}], "[", 
             RowBox[{"[", 
              RowBox[{"jnode", "+", "1"}], "]"}], "]"}]}], ";"}]}], 
         "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"disp", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"uv", "[", 
          RowBox[{"[", 
           RowBox[{"ids", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "]"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", "16"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"dispDot", "=", " ", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"uvDot", "[", 
          RowBox[{"[", 
           RowBox[{"ids", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "]"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", "16"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"energyInc", "=", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Klocal", "[", 
           RowBox[{"[", "i", "]"}], "]"}], ".", "disp"}], ")"}], "+", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"KlocalDot", "[", 
           RowBox[{"[", "i", "]"}], "]"}], ".", "dispDot"}], ")"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"du", "=", 
       RowBox[{"Transpose", "[", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"D", "[", 
             RowBox[{"energyInc", ",", "x1"}], "]"}], ",", 
            RowBox[{"D", "[", 
             RowBox[{"energyInc", ",", "x2"}], "]"}], ",", 
            RowBox[{"D", "[", 
             RowBox[{"energyInc", ",", "x3"}], "]"}], ",", 
            RowBox[{"D", "[", 
             RowBox[{"energyInc", ",", "x4"}], "]"}], ",", 
            RowBox[{"D", "[", 
             RowBox[{"energyInc", ",", "x5"}], "]"}], ",", 
            RowBox[{"D", "[", 
             RowBox[{"energyInc", ",", "x6"}], "]"}], ",", 
            RowBox[{"D", "[", 
             RowBox[{"energyInc", ",", "x7"}], "]"}], ",", 
            RowBox[{"D", "[", 
             RowBox[{"energyInc", ",", "x8"}], "]"}], ",", 
            RowBox[{"D", "[", 
             RowBox[{"energyInc", ",", "x9"}], "]"}], ",", 
            RowBox[{"D", "[", 
             RowBox[{"energyInc", ",", "x10"}], "]"}], ",", 
            RowBox[{"D", "[", 
             RowBox[{"energyInc", ",", "x11"}], "]"}], ",", 
            RowBox[{"D", "[", 
             RowBox[{"energyInc", ",", "x12"}], "]"}]}], "}"}], "/.", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"x1", "\[Rule]", 
             RowBox[{"xv", "[", 
              RowBox[{"[", "i1", "]"}], "]"}]}], ",", 
            RowBox[{"x2", "\[Rule]", 
             RowBox[{"yv", "[", 
              RowBox[{"[", "i1", "]"}], "]"}]}], ",", 
            RowBox[{"x3", "\[Rule]", 
             RowBox[{"zv", "[", 
              RowBox[{"[", "i1", "]"}], "]"}]}], ",", 
            RowBox[{"x4", "\[Rule]", 
             RowBox[{"xv", "[", 
              RowBox[{"[", "i2", "]"}], "]"}]}], ",", 
            RowBox[{"x5", "\[Rule]", 
             RowBox[{"yv", "[", 
              RowBox[{"[", "i2", "]"}], "]"}]}], ",", 
            RowBox[{"x6", "\[Rule]", 
             RowBox[{"zv", "[", 
              RowBox[{"[", "i2", "]"}], "]"}]}], ",", 
            RowBox[{"x7", "\[Rule]", 
             RowBox[{"xv", "[", 
              RowBox[{"[", "i3", "]"}], "]"}]}], ",", 
            RowBox[{"x8", "\[Rule]", 
             RowBox[{"yv", "[", 
              RowBox[{"[", "i3", "]"}], "]"}]}], ",", 
            RowBox[{"x9", "\[Rule]", 
             RowBox[{"zv", "[", 
              RowBox[{"[", "i3", "]"}], "]"}]}], ",", 
            RowBox[{"x10", "\[Rule]", 
             RowBox[{"xv", "[", 
              RowBox[{"[", "i4", "]"}], "]"}]}], ",", 
            RowBox[{"x11", "\[Rule]", 
             RowBox[{"yv", "[", 
              RowBox[{"[", "i4", "]"}], "]"}]}], ",", 
            RowBox[{"x12", "\[Rule]", 
             RowBox[{"zv", "[", 
              RowBox[{"[", "i4", "]"}], "]"}]}]}], "}"}]}], ")"}], "]"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Detj", "[", 
          RowBox[{
           RowBox[{"xv", "[", 
            RowBox[{"[", "i1", "]"}], "]"}], ",", 
           RowBox[{"yv", "[", 
            RowBox[{"[", "i1", "]"}], "]"}], ",", 
           RowBox[{"zv", "[", 
            RowBox[{"[", "i1", "]"}], "]"}], ",", 
           RowBox[{"xv", "[", 
            RowBox[{"[", "i2", "]"}], "]"}], ",", 
           RowBox[{"yv", "[", 
            RowBox[{"[", "i2", "]"}], "]"}], ",", 
           RowBox[{"zv", "[", 
            RowBox[{"[", "i2", "]"}], "]"}], ",", 
           RowBox[{"xv", "[", 
            RowBox[{"[", "i3", "]"}], "]"}], ",", 
           RowBox[{"yv", "[", 
            RowBox[{"[", "i3", "]"}], "]"}], ",", 
           RowBox[{"zv", "[", 
            RowBox[{"[", "i3", "]"}], "]"}], ",", 
           RowBox[{"xv", "[", 
            RowBox[{"[", "i4", "]"}], "]"}], ",", 
           RowBox[{"yv", "[", 
            RowBox[{"[", "i4", "]"}], "]"}], ",", 
           RowBox[{"zv", "[", 
            RowBox[{"[", "i4", "]"}], "]"}]}], "]"}], "\[GreaterEqual]", 
         "0.0"}], ",", "\[IndentingNewLine]", 
        RowBox[{"For", "[", 
         RowBox[{
          RowBox[{"j", "=", "1"}], ",", 
          RowBox[{"j", "\[LessEqual]", "16"}], ",", 
          RowBox[{"j", "++"}], ",", "\[IndentingNewLine]", 
          RowBox[{"For", "[", 
           RowBox[{
            RowBox[{"k", "=", "1"}], ",", 
            RowBox[{"k", "\[LessEqual]", "12"}], ",", 
            RowBox[{"k", "++"}], ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"residualGradientX", "[", 
                RowBox[{"[", 
                 RowBox[{"ids", "[", 
                  RowBox[{"[", "j", "]"}], "]"}], "]"}], "]"}], "[", 
               RowBox[{"[", 
                RowBox[{"nids", "[", 
                 RowBox[{"[", "k", "]"}], "]"}], "]"}], "]"}], "+=", 
              RowBox[{
               RowBox[{"du", "[", 
                RowBox[{"[", "j", "]"}], "]"}], "[", 
               RowBox[{"[", "k", "]"}], "]"}]}], ";"}]}], 
           "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"For", "[", 
         RowBox[{
          RowBox[{"j", "=", "1"}], ",", 
          RowBox[{"j", "\[LessEqual]", "16"}], ",", 
          RowBox[{"j", "++"}], ",", "\[IndentingNewLine]", 
          RowBox[{"For", "[", 
           RowBox[{
            RowBox[{"k", "=", "1"}], ",", 
            RowBox[{"k", "\[LessEqual]", "12"}], ",", 
            RowBox[{"k", "++"}], ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"residualGradientX", "[", 
                RowBox[{"[", 
                 RowBox[{"ids", "[", 
                  RowBox[{"[", "j", "]"}], "]"}], "]"}], "]"}], "[", 
               RowBox[{"[", 
                RowBox[{"nids", "[", 
                 RowBox[{"[", "k", "]"}], "]"}], "]"}], "]"}], "-=", 
              RowBox[{
               RowBox[{"du", "[", 
                RowBox[{"[", "j", "]"}], "]"}], "[", 
               RowBox[{"[", "k", "]"}], "]"}]}], ";"}]}], 
           "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]}], 
       "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
  "]"}]}], "Input",
 CellChangeTimes->{{3.7167647605597653`*^9, 3.7167647892518883`*^9}, {
   3.7167648244240847`*^9, 3.716764841539942*^9}, {3.71676488019324*^9, 
   3.7167648969754357`*^9}, {3.716765065628334*^9, 3.716765185350045*^9}, {
   3.7167652229401484`*^9, 3.7167652383100395`*^9}, {3.7167653441168547`*^9, 
   3.7167655199547443`*^9}, {3.7167655675522327`*^9, 
   3.7167655810711265`*^9}, {3.716765622284607*^9, 3.7167656290567384`*^9}, {
   3.716765757154343*^9, 3.716765792076064*^9}, {3.7167658276745405`*^9, 
   3.7167660826802125`*^9}, {3.716766195664576*^9, 3.716766242915578*^9}, {
   3.7167663310833845`*^9, 3.7167663393539863`*^9}, {3.7167664503932595`*^9, 
   3.716766450932579*^9}, {3.7167664868258085`*^9, 3.7167665635541043`*^9}, {
   3.716766627651472*^9, 3.716766643645746*^9}, {3.716766826115865*^9, 
   3.7167668360695195`*^9}, {3.716766868385886*^9, 3.7167669130203*^9}, {
   3.717155721663645*^9, 3.7171557331420517`*^9}, {3.717155769178903*^9, 
   3.7171557818205233`*^9}, {3.7171567883516493`*^9, 3.717156887869956*^9}, {
   3.717156918335051*^9, 3.717156937057849*^9}, {3.717157017416103*^9, 
   3.717157052623994*^9}, {3.717157895689323*^9, 3.717157931742132*^9}, {
   3.717166282194605*^9, 3.71716628473459*^9}, {3.71716849797501*^9, 
   3.71716852298344*^9}, {3.717168562021318*^9, 3.717168562125424*^9}, {
   3.717168843821663*^9, 3.717168857297769*^9}, {3.7171692165304537`*^9, 
   3.7171692208302*^9}, {3.717170006857576*^9, 3.717170018830927*^9}, {
   3.717171209233417*^9, 3.717171213025419*^9}, {3.7173548750864697`*^9, 
   3.717354881757492*^9}, {3.717354996753583*^9, 3.717355017245678*^9}, {
   3.717355319697336*^9, 3.7173553216726255`*^9}, {3.7173557531181636`*^9, 
   3.7173557820403166`*^9}, {3.7173558138063755`*^9, 
   3.7173558166812677`*^9}, {3.7173587645155315`*^9, 
   3.7173587704721184`*^9}, {3.7173588122062426`*^9, 
   3.7173588501286516`*^9}, {3.717359014190798*^9, 3.7173590339564075`*^9}, {
   3.7173591194571896`*^9, 3.7173591202540846`*^9}, {3.717360749384885*^9, 
   3.717360755072524*^9}, {3.7173608405541487`*^9, 3.7173608453215923`*^9}, {
   3.7174176653039513`*^9, 3.7174177502357674`*^9}, {3.717418005127076*^9, 
   3.717418022383568*^9}, {3.7174180927900662`*^9, 3.717418180868244*^9}, {
   3.717419219270834*^9, 3.7174192266613092`*^9}, {3.71741926925568*^9, 
   3.717419272755123*^9}, {3.7174241468474283`*^9, 3.7174241510843997`*^9}, {
   3.71742429898483*^9, 3.717424381678406*^9}, {3.717427960779907*^9, 
   3.7174279724352093`*^9}, {3.7174281618258095`*^9, 
   3.7174281652786007`*^9}, {3.7208066594239817`*^9, 
   3.7208066657144737`*^9}, {3.720994042619423*^9, 3.7209941465012307`*^9}, {
   3.7209941931469326`*^9, 3.7209942823899403`*^9}, {3.7209945149606404`*^9, 
   3.7209945361169796`*^9}, {3.7209946799116*^9, 3.720994978291444*^9}, {
   3.7210470008455043`*^9, 3.7210470020792093`*^9}, {3.7210490923010983`*^9, 
   3.7210491222796535`*^9}, {3.7210491757545376`*^9, 
   3.7210493138722425`*^9}, {3.721049409321796*^9, 3.721049640653741*^9}, 
   3.721049765856733*^9, {3.723055124450037*^9, 3.723055129574788*^9}, {
   3.723055292912021*^9, 3.7230553309253855`*^9}, {3.7230553941804533`*^9, 
   3.7230554578048472`*^9}, {3.723055525200883*^9, 3.723055731450719*^9}, {
   3.723055828378682*^9, 3.7230558285355997`*^9}, {3.7230559085505037`*^9, 
   3.7230559544567056`*^9}, {3.723056073457146*^9, 3.723056217017265*^9}, {
   3.723056712834525*^9, 3.7230568061937404`*^9}, {3.7230570373170767`*^9, 
   3.723057041598381*^9}, {3.7230574604717684`*^9, 3.7230574691597023`*^9}, {
   3.7230576687082634`*^9, 3.723057672733388*^9}, {3.723057739783541*^9, 
   3.7230577772921667`*^9}, {3.723057872614895*^9, 3.7230578808186064`*^9}, {
   3.7230582312110176`*^9, 3.723058233179638*^9}, {3.7230582693977594`*^9, 
   3.7230583084759116`*^9}, {3.723058342960322*^9, 3.7230583468666005`*^9}, {
   3.7230585527283564`*^9, 3.723058554150366*^9}, {3.7237578674536314`*^9, 
   3.7237579530367565`*^9}, {3.723758026886219*^9, 3.7237580298343897`*^9}, {
   3.723758446116063*^9, 3.723758490487317*^9}, {3.723758534943349*^9, 
   3.7237586467179585`*^9}, {3.723758714374293*^9, 3.723758764328038*^9}, {
   3.7238390044561663`*^9, 3.7238390130181665`*^9}, 3.7240064066196632`*^9, {
   3.7643699495811386`*^9, 3.7643700097311172`*^9}, {3.7643700923307257`*^9, 
   3.7643701215110984`*^9}, {3.764370151609213*^9, 3.764370166796838*^9}, {
   3.7643702106485834`*^9, 3.764370256220153*^9}, {3.7643703518034716`*^9, 
   3.7643704077886024`*^9}, {3.7643704667596483`*^9, 
   3.7643705262711377`*^9}, {3.764370689802438*^9, 3.76437076794914*^9}, {
   3.765653428571865*^9, 3.765653499820777*^9}, {3.765653551162318*^9, 
   3.765653578420888*^9}, {3.765653989984025*^9, 3.7656539936026535`*^9}, {
   3.7656540611304274`*^9, 3.765654063999241*^9}, {3.799601658089122*^9, 
   3.799601696383093*^9}, {3.799609004167205*^9, 3.799609095505765*^9}, {
   3.7996091416203747`*^9, 3.799609169239743*^9}, {3.7996092198293247`*^9, 
   3.799609221564313*^9}, {3.9068112343786087`*^9, 3.906811264071282*^9}, {
   3.906811337661552*^9, 3.906811375738092*^9}, {3.9068148437162533`*^9, 
   3.906814848129779*^9}, {3.906815616287158*^9, 3.906815751312673*^9}},
 CellLabel->
  "In[102]:=",ExpressionUUID->"729b7cf2-3b50-4314-a343-ff8d4a04eb50"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Join", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"SetPrecision", "[", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Transpose", "[", "residualGradientX", "]"}], "[", 
        RowBox[{"[", 
         RowBox[{
          RowBox[{
           RowBox[{"IntegerPart", "[", 
            RowBox[{"i", "/", "4"}], "]"}], "+", "1"}], ",", 
          RowBox[{
           RowBox[{"4", "*", "0"}], "+", 
           RowBox[{"Mod", "[", 
            RowBox[{"i", ",", "4"}], "]"}], "+", "1"}]}], "]"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "0", ",", "11"}], "}"}]}], "]"}], ",", "18"}], 
    "]"}], ",", "\[IndentingNewLine]", 
   RowBox[{"SetPrecision", "[", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Transpose", "[", "residualGradientX", "]"}], "[", 
        RowBox[{"[", 
         RowBox[{
          RowBox[{
           RowBox[{"IntegerPart", "[", 
            RowBox[{"i", "/", "4"}], "]"}], "+", "1"}], ",", 
          RowBox[{
           RowBox[{"4", "*", "1"}], "+", 
           RowBox[{"Mod", "[", 
            RowBox[{"i", ",", "4"}], "]"}], "+", "1"}]}], "]"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "0", ",", "11"}], "}"}]}], "]"}], ",", "18"}], 
    "]"}], ",", "\[IndentingNewLine]", 
   RowBox[{"SetPrecision", "[", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Transpose", "[", "residualGradientX", "]"}], "[", 
        RowBox[{"[", 
         RowBox[{
          RowBox[{
           RowBox[{"IntegerPart", "[", 
            RowBox[{"i", "/", "4"}], "]"}], "+", "1"}], ",", 
          RowBox[{
           RowBox[{"4", "*", "3"}], "+", 
           RowBox[{"Mod", "[", 
            RowBox[{"i", ",", "4"}], "]"}], "+", "1"}]}], "]"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "0", ",", "11"}], "}"}]}], "]"}], ",", "18"}], 
    "]"}], ",", "\[IndentingNewLine]", 
   RowBox[{"SetPrecision", "[", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Transpose", "[", "residualGradientX", "]"}], "[", 
        RowBox[{"[", 
         RowBox[{
          RowBox[{
           RowBox[{"IntegerPart", "[", 
            RowBox[{"i", "/", "4"}], "]"}], "+", "1"}], ",", 
          RowBox[{
           RowBox[{"4", "*", "4"}], "+", 
           RowBox[{"Mod", "[", 
            RowBox[{"i", ",", "4"}], "]"}], "+", "1"}]}], "]"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "0", ",", "11"}], "}"}]}], "]"}], ",", "18"}], 
    "]"}]}], "\[IndentingNewLine]", "]"}]], "Input",
 CellChangeTimes->{{3.7404286333582754`*^9, 3.740428654853368*^9}, {
  3.7404290520183735`*^9, 3.740429084241135*^9}, {3.7404292209383698`*^9, 
  3.740429228261795*^9}, {3.740429300039175*^9, 3.740429335051546*^9}, {
  3.7404293828669925`*^9, 3.7404293919072895`*^9}, {3.7404294284083185`*^9, 
  3.740429432373372*^9}, {3.740429572932371*^9, 3.7404295929812984`*^9}, {
  3.7404296738800697`*^9, 3.74042969494425*^9}, {3.7404297512884207`*^9, 
  3.740429830968625*^9}, {3.7643705788999863`*^9, 3.764370604630294*^9}, {
  3.7643709839642286`*^9, 3.764371000964297*^9}, {3.764371055053582*^9, 
  3.7643710963249793`*^9}, {3.7643711690829134`*^9, 3.764371174572526*^9}, {
  3.764371212195264*^9, 3.764371237128933*^9}, {3.7643714163597193`*^9, 
  3.7643715060322227`*^9}, {3.8493785928432007`*^9, 3.8493785997291737`*^9}, {
  3.8503258622185163`*^9, 3.850325864811792*^9}},
 CellLabel->
  "In[106]:=",ExpressionUUID->"3d3d99c0-d4ba-4488-9545-7606b0076acc"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"-", "63461.538461538453702814877033233642578125`18."}], ",", 
   RowBox[{"-", "126923.076923076878301799297332763671875`18."}], ",", 
   RowBox[{"-", "190384.61538461534655652940273284912109375`18."}], ",", 
   RowBox[{"-", "0.00772499999999997841171328616383107146`18."}], ",", 
   RowBox[{"-", "21153.84615384614517097361385822296142578125`18."}], ",", 
   RowBox[{"-", "42307.6923076922903419472277164459228515625`18."}], ",", 
   RowBox[{"-", "63461.5384615384391508996486663818359375`18."}], ",", 
   RowBox[{"-", "0.00419999999999998412797408420260580897`18."}], ",", 
   RowBox[{"-", "7051.282051282047177664935588836669921875`18."}], ",", 
   RowBox[{"-", "14102.56410256409435532987117767333984375`18."}], ",", 
   RowBox[{"-", "21153.84615384615244693122804164886474609375`18."}], ",", 
   RowBox[{"-", "0.00302499999999998690075608820393426868`18."}], ",", 
   RowBox[{"-", "32371.79487179486386594362556934356689453125`18."}], ",", 
   RowBox[{"-", "9935.89743589743193297181278467178344726563`18."}], ",", 
   "82692.80769230765872634947299957275390625`18.", ",", 
   "0.00113333333333333319790925397541059283`18.", ",", 
   RowBox[{"-", "22756.41025641025407821871340274810791015625`18."}], ",", 
   RowBox[{"-", "8012.82051282050997542683035135269165039062`18."}], ",", 
   "13461.91346153844460786785930395126342773437`18.", ",", 
   "0.00033333333333333315957186515632315604`18.", ",", 
   "40704.6282051281887106597423553466796875`18.", ",", 
   "38140.650641025626100599765777587890625`18.", ",", 
   "36538.4615384615390212275087833404541015625`18.", ",", 
   RowBox[{"-", "0.00181666666666667952698133170486016752`18."}], ",", 
   RowBox[{"-", "19230.76923076922321342863142490386962890625`18."}], ",", 
   "32692.8910256410090369172394275665283203125`18.", ",", 
   "10256.41025641026135417632758617401123046875`18.", ",", 
   "0.00099999999999999980397624721462079833`18.", ",", 
   "44871.21153846153174526989459991455078125`18.", ",", 
   "39743.589743589735007844865322113037109375`18.", ",", 
   "44871.3782051281959866173565387725830078125`18.", ",", 
   RowBox[{"-", "0.00230833333333334798920244423925396404`18."}], ",", 
   RowBox[{"-", "14102.56410256409435532987117767333984375`18."}], ",", 
   RowBox[{"-", "18589.326923076921957544982433319091796875`18."}], ",", 
   RowBox[{"-", "5128.20512820512703910935670137405395507813`18."}], ",", 
   RowBox[{"-", "0.00006666666666666675117661200467011895`18."}], ",", 
   RowBox[{"-", "74679.48717948715784586966037750244140625`18."}], ",", 
   "5449.13461538462070166133344173431396484375`18.", ",", 
   RowBox[{"-", "5127.83012820512703910935670137405395507812`18."}], ",", 
   RowBox[{"-", "0.0002666666666666666252356876487539239`18."}], ",", 
   "14422.66025641025044023990631103515625`18.", ",", 
   "25961.53846153845734079368412494659423828125`18.", ",", 
   "25641.0673076923121698200702667236328125`18.", ",", 
   RowBox[{"-", "0.0009000000000000060468990925599541697`18."}], ",", 
   "24038.08653846152810729108750820159912109375`18.", ",", 
   "17628.16346153846461675129830837249755859375`18.", ",", 
   "20512.8205128205081564374268054962158203125`18.", ",", 
   RowBox[{"-", "0.00077500000000000539377570385468629865`18."}]}], 
  "}"}]], "Output",
 CellChangeTimes->{
  3.740429593978275*^9, 3.7404297027086763`*^9, 3.7404297629373703`*^9, {
   3.7404298121175528`*^9, 3.7404298325385866`*^9}, 3.7643706076169157`*^9, 
   3.7643708714311123`*^9, 3.7643712419865913`*^9, 3.76437152654244*^9, 
   3.7656536946595917`*^9, 3.7656541675282016`*^9, 3.7996093785705433`*^9, 
   3.7996116407620497`*^9, 3.849378863145879*^9, 3.850325936705236*^9, 
   3.906745921606317*^9, 3.906815994572987*^9, 3.906819249069519*^9, 
   3.906821185046365*^9, 3.9068222381709833`*^9, 3.9068224969161167`*^9, 
   3.9068227630137653`*^9, 3.906823213236649*^9, 3.906823561677984*^9, 
   3.907257879043475*^9},
 CellLabel->
  "Out[106]=",ExpressionUUID->"d382834c-f167-4640-82b1-1694cf14bfae"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Compute internal energy:", "Subsection",
 CellChangeTimes->{{3.7171711972127666`*^9, 3.71717120142911*^9}, {
  3.7209943882500362`*^9, 
  3.7209944015165186`*^9}},ExpressionUUID->"c18a08aa-1052-4e2e-a5b7-\
fa2612be9948"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"energySum", "=", "0.0"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"energyInc", "=", 
   RowBox[{"Table", "[", 
    RowBox[{"0.0", ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"Length", "[", "connect", "]"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Klocal", "=", 
   RowBox[{"Table", "[", 
    RowBox[{"0.0", ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"Length", "[", "connect", "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "1", ",", 
       RowBox[{"nnodes", "*", "ndofs"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"k", ",", "1", ",", 
       RowBox[{"nnodes", "*", "ndofs"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"For", "[", 
  RowBox[{
   RowBox[{"i", "=", "1"}], ",", " ", 
   RowBox[{"i", "\[LessEqual]", " ", 
    RowBox[{"Length", "[", "connect", "]"}]}], ",", 
   RowBox[{"i", "++"}], ",", 
   RowBox[{"Block", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"i1", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"connect", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}], "+", "1"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"i2", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"connect", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "[", 
          RowBox[{"[", "2", "]"}], "]"}], "+", "1"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"i3", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"connect", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "[", 
          RowBox[{"[", "3", "]"}], "]"}], "+", "1"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"i4", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"connect", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "[", 
          RowBox[{"[", "4", "]"}], "]"}], "+", "1"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"ids", "=", 
        RowBox[{"{", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"ndofs", " ", 
            RowBox[{"(", 
             RowBox[{"i1", "-", "1"}], ")"}]}], "+", "1"}], ",", " ", 
          RowBox[{
           RowBox[{"ndofs", 
            RowBox[{"(", " ", 
             RowBox[{"i1", "-", "1"}], ")"}]}], "+", "2"}], ",", " ", 
          RowBox[{
           RowBox[{"ndofs", 
            RowBox[{"(", " ", 
             RowBox[{"i1", "-", "1"}], ")"}]}], "+", "3"}], ",", " ", 
          RowBox[{
           RowBox[{"ndofs", 
            RowBox[{"(", 
             RowBox[{"i1", "-", "1"}], ")"}]}], "+", "4"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"ndofs", 
            RowBox[{"(", " ", 
             RowBox[{"i2", "-", "1"}], ")"}]}], "+", "1"}], ",", 
          RowBox[{
           RowBox[{"ndofs", 
            RowBox[{"(", 
             RowBox[{"i2", "-", "1"}], ")"}]}], "+", "2"}], ",", " ", 
          RowBox[{
           RowBox[{"ndofs", 
            RowBox[{"(", " ", 
             RowBox[{"i2", "-", "1"}], ")"}]}], "+", "3"}], ",", 
          RowBox[{
           RowBox[{"ndofs", 
            RowBox[{"(", 
             RowBox[{"i2", "-", "1"}], ")"}]}], "+", "4"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"ndofs", 
            RowBox[{"(", 
             RowBox[{"i3", "-", "1"}], ")"}]}], "+", "1"}], ",", 
          RowBox[{
           RowBox[{"ndofs", " ", 
            RowBox[{"(", 
             RowBox[{"i3", "-", "1"}], ")"}]}], "+", "2"}], ",", " ", 
          RowBox[{
           RowBox[{"ndofs", 
            RowBox[{"(", " ", 
             RowBox[{"i3", "-", "1"}], ")"}]}], "+", "3"}], ",", 
          RowBox[{
           RowBox[{"ndofs", 
            RowBox[{"(", 
             RowBox[{"i3", "-", "1"}], ")"}]}], "+", "4"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"ndofs", 
            RowBox[{"(", 
             RowBox[{"i4", "-", "1"}], ")"}]}], "+", "1"}], ",", 
          RowBox[{
           RowBox[{"ndofs", 
            RowBox[{"(", 
             RowBox[{"i4", "-", "1"}], ")"}]}], "+", "2"}], ",", " ", 
          RowBox[{
           RowBox[{"ndofs", 
            RowBox[{"(", " ", 
             RowBox[{"i4", "-", "1"}], ")"}]}], "+", "3"}], ",", 
          RowBox[{
           RowBox[{"ndofs", 
            RowBox[{"(", 
             RowBox[{"i4", "-", "1"}], ")"}]}], "+", "4"}]}], 
         "\[IndentingNewLine]", "}"}]}]}], "\[IndentingNewLine]", "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Kelmm", "=", 
       RowBox[{"Table", "[", 
        RowBox[{"0.0", ",", 
         RowBox[{"{", 
          RowBox[{"ii", ",", "1", ",", "12"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"jj", ",", "1", ",", "12"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Keltt", "=", 
       RowBox[{"Table", "[", 
        RowBox[{"0.0", ",", 
         RowBox[{"{", 
          RowBox[{"ii", ",", "1", ",", "4"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"jj", ",", "1", ",", "4"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Kelmt", "=", 
       RowBox[{"Table", "[", 
        RowBox[{"0.0", ",", 
         RowBox[{"{", 
          RowBox[{"ii", ",", "1", ",", "12"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"jj", ",", "1", ",", "4"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"j", "=", "1"}], ",", 
        RowBox[{"j", "<=", 
         RowBox[{"Length", "[", "gp", "]"}]}], ",", 
        RowBox[{"j", "++"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Kelmm", "+=", 
          RowBox[{
           RowBox[{"gw", "[", 
            RowBox[{"[", "j", "]"}], "]"}], "*", 
           RowBox[{"Kmm", "[", 
            RowBox[{
             RowBox[{"xv", "[", 
              RowBox[{"[", "i1", "]"}], "]"}], ",", 
             RowBox[{"yv", "[", 
              RowBox[{"[", "i1", "]"}], "]"}], ",", 
             RowBox[{"zv", "[", 
              RowBox[{"[", "i1", "]"}], "]"}], ",", 
             RowBox[{"xv", "[", 
              RowBox[{"[", "i2", "]"}], "]"}], ",", 
             RowBox[{"yv", "[", 
              RowBox[{"[", "i2", "]"}], "]"}], ",", 
             RowBox[{"zv", "[", 
              RowBox[{"[", "i2", "]"}], "]"}], ",", 
             RowBox[{"xv", "[", 
              RowBox[{"[", "i3", "]"}], "]"}], ",", 
             RowBox[{"yv", "[", 
              RowBox[{"[", "i3", "]"}], "]"}], ",", 
             RowBox[{"zv", "[", 
              RowBox[{"[", "i3", "]"}], "]"}], ",", 
             RowBox[{"xv", "[", 
              RowBox[{"[", "i4", "]"}], "]"}], ",", 
             RowBox[{"yv", "[", 
              RowBox[{"[", "i4", "]"}], "]"}], ",", 
             RowBox[{"zv", "[", 
              RowBox[{"[", "i4", "]"}], "]"}], ",", 
             RowBox[{"1", "*", 
              SuperscriptBox["10", "11"]}], ",", "0.3"}], "]"}]}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"Keltt", "+=", 
          RowBox[{
           RowBox[{
            RowBox[{"gw", "[", 
             RowBox[{"[", "j", "]"}], "]"}], "*", 
            RowBox[{"ktt", "[", 
             RowBox[{
              RowBox[{"xv", "[", 
               RowBox[{"[", "i1", "]"}], "]"}], ",", 
              RowBox[{"yv", "[", 
               RowBox[{"[", "i1", "]"}], "]"}], ",", 
              RowBox[{"zv", "[", 
               RowBox[{"[", "i1", "]"}], "]"}], ",", 
              RowBox[{"xv", "[", 
               RowBox[{"[", "i2", "]"}], "]"}], ",", 
              RowBox[{"yv", "[", 
               RowBox[{"[", "i2", "]"}], "]"}], ",", 
              RowBox[{"zv", "[", 
               RowBox[{"[", "i2", "]"}], "]"}], ",", 
              RowBox[{"xv", "[", 
               RowBox[{"[", "i3", "]"}], "]"}], ",", 
              RowBox[{"yv", "[", 
               RowBox[{"[", "i3", "]"}], "]"}], ",", 
              RowBox[{"zv", "[", 
               RowBox[{"[", "i3", "]"}], "]"}], ",", 
              RowBox[{"xv", "[", 
               RowBox[{"[", "i4", "]"}], "]"}], ",", 
              RowBox[{"yv", "[", 
               RowBox[{"[", "i4", "]"}], "]"}], ",", 
              RowBox[{"zv", "[", 
               RowBox[{"[", "i4", "]"}], "]"}], ",", "ConductionCoeff"}], 
             "]"}]}], "/.", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"\[Xi]", "\[Rule]", 
              RowBox[{
               RowBox[{"gp", "[", 
                RowBox[{"[", "j", "]"}], "]"}], "[", 
               RowBox[{"[", "1", "]"}], "]"}]}], ",", 
             RowBox[{"\[Psi]", "\[Rule]", 
              RowBox[{
               RowBox[{"gp", "[", 
                RowBox[{"[", "j", "]"}], "]"}], "[", 
               RowBox[{"[", "2", "]"}], "]"}]}], ",", 
             RowBox[{"\[Zeta]", "\[Rule]", 
              RowBox[{
               RowBox[{"gp", "[", 
                RowBox[{"[", "j", "]"}], "]"}], "[", 
               RowBox[{"[", "3", "]"}], "]"}]}]}], "}"}]}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"Kelmt", "+=", 
          RowBox[{
           RowBox[{
            RowBox[{"gw", "[", 
             RowBox[{"[", "j", "]"}], "]"}], "*", 
            RowBox[{"kmt", "[", 
             RowBox[{
              RowBox[{"xv", "[", 
               RowBox[{"[", "i1", "]"}], "]"}], ",", 
              RowBox[{"yv", "[", 
               RowBox[{"[", "i1", "]"}], "]"}], ",", 
              RowBox[{"zv", "[", 
               RowBox[{"[", "i1", "]"}], "]"}], ",", 
              RowBox[{"xv", "[", 
               RowBox[{"[", "i2", "]"}], "]"}], ",", 
              RowBox[{"yv", "[", 
               RowBox[{"[", "i2", "]"}], "]"}], ",", 
              RowBox[{"zv", "[", 
               RowBox[{"[", "i2", "]"}], "]"}], ",", 
              RowBox[{"xv", "[", 
               RowBox[{"[", "i3", "]"}], "]"}], ",", 
              RowBox[{"yv", "[", 
               RowBox[{"[", "i3", "]"}], "]"}], ",", 
              RowBox[{"zv", "[", 
               RowBox[{"[", "i3", "]"}], "]"}], ",", 
              RowBox[{"xv", "[", 
               RowBox[{"[", "i4", "]"}], "]"}], ",", 
              RowBox[{"yv", "[", 
               RowBox[{"[", "i4", "]"}], "]"}], ",", 
              RowBox[{"zv", "[", 
               RowBox[{"[", "i4", "]"}], "]"}], ",", 
              RowBox[{"1.0", "*", 
               SuperscriptBox["10", 
                RowBox[{"-", "5"}]]}], ",", 
              RowBox[{"1", "*", 
               SuperscriptBox["10", "11"]}], ",", "0.3"}], "]"}]}], "/.", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"\[Xi]", "\[Rule]", 
              RowBox[{
               RowBox[{"gp", "[", 
                RowBox[{"[", "j", "]"}], "]"}], "[", 
               RowBox[{"[", "1", "]"}], "]"}]}], ",", 
             RowBox[{"\[Psi]", "\[Rule]", 
              RowBox[{
               RowBox[{"gp", "[", 
                RowBox[{"[", "j", "]"}], "]"}], "[", 
               RowBox[{"[", "2", "]"}], "]"}]}], ",", 
             RowBox[{"\[Zeta]", "\[Rule]", 
              RowBox[{
               RowBox[{"gp", "[", 
                RowBox[{"[", "j", "]"}], "]"}], "[", 
               RowBox[{"[", "3", "]"}], "]"}]}]}], "}"}]}]}], ";"}]}], 
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"inode", "=", "0"}], ",", 
        RowBox[{"inode", "<", "nnodes"}], ",", 
        RowBox[{"inode", "++"}], ",", "\[IndentingNewLine]", 
        RowBox[{"For", "[", 
         RowBox[{
          RowBox[{"jnode", "=", "0"}], ",", 
          RowBox[{"jnode", "<", "nnodes"}], ",", 
          RowBox[{"jnode", "++"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"For", "[", 
            RowBox[{
             RowBox[{"idof", "=", "0"}], ",", 
             RowBox[{"idof", "<", "nmdofs"}], ",", 
             RowBox[{"idof", "++"}], ",", "\[IndentingNewLine]", 
             RowBox[{"For", "[", 
              RowBox[{
               RowBox[{"jdof", "=", "0"}], ",", 
               RowBox[{"jdof", "<", "nmdofs"}], ",", 
               RowBox[{"jdof", "++"}], ",", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{"Klocal", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "[", 
                   RowBox[{"[", 
                    RowBox[{
                    RowBox[{"inode", " ", "ndofs"}], "+", "idof", "+", "1"}], 
                    "]"}], "]"}], "[", 
                  RowBox[{"[", 
                   RowBox[{
                    RowBox[{"jnode", " ", "ndofs"}], "+", "jdof", "+", "1"}], 
                   "]"}], "]"}], " ", "=", 
                 RowBox[{
                  RowBox[{"Kelmm", "[", 
                   RowBox[{"[", 
                    RowBox[{
                    RowBox[{"inode", " ", "nmdofs"}], "+", "idof", "+", "1"}],
                     "]"}], "]"}], "[", 
                  RowBox[{"[", 
                   RowBox[{
                    RowBox[{"jnode", " ", "nmdofs"}], "+", "jdof", "+", "1"}],
                    "]"}], "]"}]}], ";"}]}], "\[IndentingNewLine]", "]"}]}], 
            "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"Klocal", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "[", 
              RowBox[{"[", 
               RowBox[{
                RowBox[{"inode", " ", "ndofs"}], "+", "nmdofs", "+", "1"}], 
               "]"}], "]"}], "[", 
             RowBox[{"[", 
              RowBox[{
               RowBox[{"jnode", " ", "ndofs"}], "+", "nmdofs", "+", "1"}], 
              "]"}], "]"}], " ", "=", 
            RowBox[{
             RowBox[{"Keltt", "[", 
              RowBox[{"[", 
               RowBox[{"inode", "+", "1"}], "]"}], "]"}], "[", 
             RowBox[{"[", 
              RowBox[{"jnode", "+", "1"}], "]"}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"For", "[", 
            RowBox[{
             RowBox[{"idof", "=", "0"}], ",", 
             RowBox[{"idof", "<", "nmdofs"}], ",", 
             RowBox[{"idof", "++"}], ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"Klocal", "[", 
                  RowBox[{"[", "i", "]"}], "]"}], "[", 
                 RowBox[{"[", 
                  RowBox[{
                   RowBox[{"inode", " ", "ndofs"}], "+", "idof", "+", "1"}], 
                  "]"}], "]"}], "[", 
                RowBox[{"[", 
                 RowBox[{
                  RowBox[{"jnode", " ", "ndofs"}], "+", "nmdofs", "+", "1"}], 
                 "]"}], "]"}], " ", "=", 
               RowBox[{"-", 
                RowBox[{
                 RowBox[{"Kelmt", "[", 
                  RowBox[{"[", 
                   RowBox[{
                    RowBox[{"inode", " ", "nmdofs"}], "+", "idof", "+", "1"}],
                    "]"}], "]"}], "[", 
                 RowBox[{"[", 
                  RowBox[{"jnode", "+", "1"}], "]"}], "]"}]}]}], ";"}]}], 
            "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", 
         "]"}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"disp", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"uv", "[", 
          RowBox[{"[", 
           RowBox[{"ids", "[", 
            RowBox[{"[", "ii", "]"}], "]"}], "]"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"ii", ",", "1", ",", "16"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"energyInc", "[", 
        RowBox[{"[", "i", "]"}], "]"}], "=", 
       RowBox[{"disp", ".", 
        RowBox[{"Klocal", "[", 
         RowBox[{"[", "i", "]"}], "]"}], ".", "disp"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"energySum", "+=", 
       RowBox[{"energyInc", "[", 
        RowBox[{"[", "i", "]"}], "]"}]}], ";"}]}], "\[IndentingNewLine]", 
    "]"}]}], "\[IndentingNewLine]", "]"}]}], "Input",
 CellChangeTimes->{{3.7167647605597653`*^9, 3.7167647892518883`*^9}, {
   3.7167648244240847`*^9, 3.716764841539942*^9}, {3.71676488019324*^9, 
   3.7167648969754357`*^9}, {3.716765065628334*^9, 3.716765185350045*^9}, {
   3.7167652229401484`*^9, 3.7167652383100395`*^9}, {3.7167653441168547`*^9, 
   3.7167655199547443`*^9}, {3.7167655675522327`*^9, 
   3.7167655810711265`*^9}, {3.716765622284607*^9, 3.7167656290567384`*^9}, {
   3.716765757154343*^9, 3.716765792076064*^9}, {3.7167658276745405`*^9, 
   3.7167660826802125`*^9}, {3.716766195664576*^9, 3.716766242915578*^9}, {
   3.7167663310833845`*^9, 3.7167663393539863`*^9}, {3.7167664503932595`*^9, 
   3.716766450932579*^9}, {3.7167664868258085`*^9, 3.7167665635541043`*^9}, {
   3.716766627651472*^9, 3.716766643645746*^9}, {3.716766826115865*^9, 
   3.7167668360695195`*^9}, {3.716766868385886*^9, 3.7167669130203*^9}, {
   3.717155721663645*^9, 3.7171557331420517`*^9}, {3.717155769178903*^9, 
   3.7171557818205233`*^9}, {3.7171567883516493`*^9, 3.717156887869956*^9}, {
   3.717156918335051*^9, 3.717156937057849*^9}, {3.717157017416103*^9, 
   3.717157052623994*^9}, {3.717157895689323*^9, 3.717157931742132*^9}, {
   3.717166282194605*^9, 3.71716628473459*^9}, {3.71716849797501*^9, 
   3.71716852298344*^9}, {3.717168562021318*^9, 3.717168562125424*^9}, {
   3.717168843821663*^9, 3.717168857297769*^9}, {3.7171692165304537`*^9, 
   3.7171692208302*^9}, {3.717170006857576*^9, 3.717170018830927*^9}, {
   3.717171209233417*^9, 3.717171213025419*^9}, {3.7173548750864697`*^9, 
   3.717354881757492*^9}, {3.717354996753583*^9, 3.717355017245678*^9}, {
   3.717355319697336*^9, 3.7173553216726255`*^9}, {3.7173557531181636`*^9, 
   3.7173557820403166`*^9}, {3.7173558138063755`*^9, 
   3.7173558166812677`*^9}, {3.7173587645155315`*^9, 
   3.7173587704721184`*^9}, {3.7173588122062426`*^9, 
   3.7173588501286516`*^9}, {3.717359014190798*^9, 3.7173590339564075`*^9}, {
   3.7173591194571896`*^9, 3.7173591202540846`*^9}, {3.717360749384885*^9, 
   3.717360755072524*^9}, {3.7173608405541487`*^9, 3.7173608453215923`*^9}, {
   3.7174176653039513`*^9, 3.7174177502357674`*^9}, {3.717418005127076*^9, 
   3.717418022383568*^9}, {3.7174180927900662`*^9, 3.717418180868244*^9}, {
   3.717419219270834*^9, 3.7174192266613092`*^9}, {3.71741926925568*^9, 
   3.717419272755123*^9}, {3.7174241468474283`*^9, 3.7174241510843997`*^9}, {
   3.71742429898483*^9, 3.717424381678406*^9}, {3.717427960779907*^9, 
   3.7174279724352093`*^9}, {3.7174281618258095`*^9, 
   3.7174281652786007`*^9}, {3.7208066594239817`*^9, 
   3.7208066657144737`*^9}, {3.723057650960129*^9, 3.7230576545889745`*^9}, {
   3.763398626297826*^9, 3.7633986377693434`*^9}, {3.763398969492062*^9, 
   3.763399017148432*^9}, {3.7633990692779627`*^9, 3.7633990694291053`*^9}, {
   3.7633991201481476`*^9, 3.763399174570841*^9}, {3.763399415268031*^9, 
   3.76339941606513*^9}, {3.7633996474373903`*^9, 3.7633996648412056`*^9}, {
   3.7633997501291094`*^9, 3.7633999258824277`*^9}, {3.7633999725549555`*^9, 
   3.763399976702032*^9}, {3.7634000083920765`*^9, 3.76340016737781*^9}, {
   3.7634002158964863`*^9, 3.76340029196223*^9}, {3.763400323496956*^9, 
   3.7634004027149053`*^9}, {3.76340045059245*^9, 3.763400463281616*^9}, {
   3.7634005294006834`*^9, 3.763400570424802*^9}, {3.764082973996101*^9, 
   3.764082975901887*^9}, {3.764085676134435*^9, 3.7640856834202404`*^9}, {
   3.7640858472503123`*^9, 3.7640858920767965`*^9}, {3.7640894255234814`*^9, 
   3.7640894257482643`*^9}, {3.7640894615887256`*^9, 
   3.7640894620724916`*^9}, {3.7640895179586363`*^9, 
   3.7640895273283195`*^9}, {3.7640896836413865`*^9, 
   3.7640896854169707`*^9}, {3.764098322843951*^9, 3.764098324217982*^9}, {
   3.7640983820840216`*^9, 3.764098382599674*^9}, {3.764099103461434*^9, 
   3.764099173185652*^9}, {3.764101764387092*^9, 3.7641017868352966`*^9}, {
   3.764162451449333*^9, 3.764162465312125*^9}, {3.764162509630781*^9, 
   3.764162550331856*^9}, {3.764162583165681*^9, 3.7641626039242*^9}, {
   3.764162639453498*^9, 3.764162731016221*^9}, 3.764162771654982*^9, {
   3.7641628042585936`*^9, 3.764162826582513*^9}, {3.764162885531745*^9, 
   3.76416292037608*^9}, 3.7641629564478016`*^9, {3.764163188990672*^9, 
   3.7641631922903223`*^9}, {3.7641633418697977`*^9, 
   3.7641633445908575`*^9}, {3.7641634102089243`*^9, 
   3.7641635244767513`*^9}, {3.7641636631227293`*^9, 
   3.7641636636004744`*^9}, {3.7641638975971966`*^9, 3.7641639005392556`*^9}, 
   3.9068148624522257`*^9, {3.906817650182959*^9, 3.906817802772189*^9}},
 CellLabel->
  "In[107]:=",ExpressionUUID->"0a238f2d-bf64-41f2-920d-affe3a1b917c"],

Cell[CellGroupData[{

Cell[BoxData["energyInc"], "Input",
 CellChangeTimes->{{3.7641635291837215`*^9, 3.7641635303600173`*^9}},
 CellLabel->
  "In[111]:=",ExpressionUUID->"fe05d70c-8185-4d11-b127-8cd00ee2c055"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "0.0667943480082051`", ",", "0.06679449800820511`", ",", 
   "0.0667945355082051`", ",", "0.0667944230082051`", ",", 
   "0.06679427300820513`", ",", "0.06679423550820512`", ",", 
   "0.06679427300820516`", ",", "0.06679442300820511`", ",", 
   "0.06679446050820512`", ",", "0.06679434800820512`", ",", 
   "0.06679419800820513`", ",", "0.06679416050820516`", ",", 
   "0.06679412300820516`", ",", "0.06679427300820512`", ",", 
   "0.0667943105082051`", ",", "0.06679419800820512`", ",", 
   "0.06679404800820524`", ",", "0.06679401050820523`", ",", 
   "0.06679404800820514`", ",", "0.06679419800820512`", ",", 
   "0.06679423550820512`", ",", "0.0667941230082051`", ",", 
   "0.06679397300820517`", ",", "0.0667939355082052`", ",", 
   "0.06679367300820516`", ",", "0.0667938230082052`", ",", 
   "0.06679386050820517`", ",", "0.06679374800820514`", ",", 
   "0.06679359800820531`", ",", "0.06679356050820524`", ",", 
   "0.06679359800820513`", ",", "0.06679374800820514`", ",", 
   "0.06679378550820514`", ",", "0.06679367300820516`", ",", 
   "0.06679352300820528`", ",", "0.06679348550820527`", ",", 
   "0.06679344800820523`", ",", "0.06679359800820524`", ",", 
   "0.06679363550820523`", ",", "0.06679352300820517`", ",", 
   "0.0667933730082053`", ",", "0.06679333550820514`", ",", 
   "0.06679337300820523`", ",", "0.06679352300820526`", ",", 
   "0.06679356050820512`", ",", "0.06679344800820512`", ",", 
   "0.06679329800820516`", ",", "0.06679326050820523`"}], "}"}]], "Output",
 CellChangeTimes->{3.7641639106273675`*^9, 3.764244525354228*^9, 
  3.850325937242318*^9, 3.906745923010496*^9, 3.9068159958955603`*^9, 
  3.906817833403081*^9, 3.906819251666999*^9, 3.9068211880094347`*^9, 
  3.9068222409784803`*^9, 3.90682249959232*^9, 3.906822766318342*^9, 
  3.9068232159508257`*^9, 3.906823564289966*^9, 3.907257880785861*^9},
 CellLabel->
  "Out[111]=",ExpressionUUID->"a5259f55-b8e7-4e1a-b88c-d255c76f5f84"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"SetPrecision", "[", 
  RowBox[{
   RowBox[{"Sum", "[", 
    RowBox[{
     RowBox[{"energyInc", "[", 
      RowBox[{"[", "i", "]"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"Length", "[", "energyInc", "]"}]}], "}"}]}], "]"}], ",", 
   "18"}], "]"}]], "Input",
 CellChangeTimes->{{3.7641639175031357`*^9, 3.7641639430078697`*^9}, {
  3.7641716632883053`*^9, 3.7641716686992283`*^9}},
 CellLabel->
  "In[112]:=",ExpressionUUID->"737fd114-524f-47a0-9aff-a5b08bef7aee"],

Cell[BoxData["3.20610710439385071524043269164394587278`18."], "Output",
 CellChangeTimes->{{3.7641639234457664`*^9, 3.7641639442960567`*^9}, 
   3.7641716695246778`*^9, 3.7642445875499754`*^9, 3.850325937253633*^9, 
   3.90674592324442*^9, 3.906815996095599*^9, 3.9068178413864317`*^9, 
   3.90681788299923*^9, 3.906819251690454*^9, 3.906821188060988*^9, 
   3.9068222410056763`*^9, 3.906822499614286*^9, 3.9068227663754787`*^9, 
   3.90682321597089*^9, 3.906823564311322*^9, 3.90725788080441*^9},
 CellLabel->
  "Out[112]=",ExpressionUUID->"a91e2d68-8315-4b04-b59d-610f12db27d6"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"SetPrecision", "[", 
  RowBox[{
   RowBox[{"uv", ".", 
    RowBox[{"(", 
     RowBox[{"Kglobal", ".", "uv"}], ")"}]}], ",", "18"}], "]"}]], "Input",
 CellChangeTimes->{{3.7641030835250883`*^9, 3.764103152952297*^9}, {
  3.76418642397815*^9, 3.7641864313163605`*^9}},
 CellLabel->
  "In[113]:=",ExpressionUUID->"f7bb990d-323e-45bd-927f-2f52684acbf7"],

Cell[BoxData["9.56800000000001410211530883387354`18.*^-6"], "Output",
 CellChangeTimes->{{3.7641031161414948`*^9, 3.7641031537124987`*^9}, 
   3.764186431839634*^9, 3.7642445902025733`*^9, 3.850325937263619*^9, 
   3.906745923370936*^9, 3.9068159961730633`*^9, {3.9068178703375*^9, 
   3.90681788522513*^9}, 3.9068192517720623`*^9, 3.906821188124743*^9, 
   3.906822241037764*^9, 3.906822499644405*^9, 3.906822766410267*^9, 
   3.906823215989633*^9, 3.906823564332169*^9, 3.907257880908725*^9},
 CellLabel->
  "Out[113]=",ExpressionUUID->"152afa11-0931-4bf3-96c4-b6abb35f8074"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Compute internal energy gradient wrt control:", "Subsection",
 CellChangeTimes->{{3.7171711972127666`*^9, 3.71717120142911*^9}, {
  3.7209943882500362`*^9, 3.7209944015165186`*^9}, {3.721049011972142*^9, 
  3.721049018596589*^9}},ExpressionUUID->"8db94860-4381-472d-bf4a-\
ca4b694f0cc9"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"gradZ", "=", 
   RowBox[{"Table", "[", 
    RowBox[{"0.0", ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"Length", "[", "xv", "]"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"energyInc", "=", 
   RowBox[{"Table", "[", 
    RowBox[{"0.0", ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"Length", "[", "connect", "]"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Klocal", "=", 
   RowBox[{"Table", "[", 
    RowBox[{"0.0", ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"Length", "[", "connect", "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "1", ",", 
       RowBox[{"nnodes", "*", "ndofs"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"k", ",", "1", ",", 
       RowBox[{"nnodes", "*", "ndofs"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"For", "[", 
  RowBox[{
   RowBox[{"i", "=", "1"}], ",", " ", 
   RowBox[{"i", "\[LessEqual]", " ", 
    RowBox[{"Length", "[", "connect", "]"}]}], ",", 
   RowBox[{"i", "++"}], ",", 
   RowBox[{"Block", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"i1", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"connect", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}], "+", "1"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"i2", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"connect", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "[", 
          RowBox[{"[", "2", "]"}], "]"}], "+", "1"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"i3", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"connect", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "[", 
          RowBox[{"[", "3", "]"}], "]"}], "+", "1"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"i4", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"connect", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "[", 
          RowBox[{"[", "4", "]"}], "]"}], "+", "1"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"ids", "=", 
        RowBox[{"{", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"ndofs", " ", 
            RowBox[{"(", 
             RowBox[{"i1", "-", "1"}], ")"}]}], "+", "1"}], ",", " ", 
          RowBox[{
           RowBox[{"ndofs", 
            RowBox[{"(", " ", 
             RowBox[{"i1", "-", "1"}], ")"}]}], "+", "2"}], ",", " ", 
          RowBox[{
           RowBox[{"ndofs", 
            RowBox[{"(", " ", 
             RowBox[{"i1", "-", "1"}], ")"}]}], "+", "3"}], ",", " ", 
          RowBox[{
           RowBox[{"ndofs", 
            RowBox[{"(", 
             RowBox[{"i1", "-", "1"}], ")"}]}], "+", "4"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"ndofs", 
            RowBox[{"(", " ", 
             RowBox[{"i2", "-", "1"}], ")"}]}], "+", "1"}], ",", 
          RowBox[{
           RowBox[{"ndofs", 
            RowBox[{"(", 
             RowBox[{"i2", "-", "1"}], ")"}]}], "+", "2"}], ",", " ", 
          RowBox[{
           RowBox[{"ndofs", 
            RowBox[{"(", " ", 
             RowBox[{"i2", "-", "1"}], ")"}]}], "+", "3"}], ",", 
          RowBox[{
           RowBox[{"ndofs", 
            RowBox[{"(", 
             RowBox[{"i2", "-", "1"}], ")"}]}], "+", "4"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"ndofs", 
            RowBox[{"(", 
             RowBox[{"i3", "-", "1"}], ")"}]}], "+", "1"}], ",", 
          RowBox[{
           RowBox[{"ndofs", " ", 
            RowBox[{"(", 
             RowBox[{"i3", "-", "1"}], ")"}]}], "+", "2"}], ",", " ", 
          RowBox[{
           RowBox[{"ndofs", 
            RowBox[{"(", " ", 
             RowBox[{"i3", "-", "1"}], ")"}]}], "+", "3"}], ",", 
          RowBox[{
           RowBox[{"ndofs", 
            RowBox[{"(", 
             RowBox[{"i3", "-", "1"}], ")"}]}], "+", "4"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"ndofs", 
            RowBox[{"(", 
             RowBox[{"i4", "-", "1"}], ")"}]}], "+", "1"}], ",", 
          RowBox[{
           RowBox[{"ndofs", 
            RowBox[{"(", 
             RowBox[{"i4", "-", "1"}], ")"}]}], "+", "2"}], ",", " ", 
          RowBox[{
           RowBox[{"ndofs", 
            RowBox[{"(", " ", 
             RowBox[{"i4", "-", "1"}], ")"}]}], "+", "3"}], ",", 
          RowBox[{
           RowBox[{"ndofs", 
            RowBox[{"(", 
             RowBox[{"i4", "-", "1"}], ")"}]}], "+", "4"}]}], 
         "\[IndentingNewLine]", "}"}]}]}], "\[IndentingNewLine]", "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Kelmm", "=", 
       RowBox[{"Table", "[", 
        RowBox[{"0.0", ",", 
         RowBox[{"{", 
          RowBox[{"ii", ",", "1", ",", "12"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"jj", ",", "1", ",", "12"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Keltt", "=", 
       RowBox[{"Table", "[", 
        RowBox[{"0.0", ",", 
         RowBox[{"{", 
          RowBox[{"ii", ",", "1", ",", "4"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"jj", ",", "1", ",", "4"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Kelmt", "=", 
       RowBox[{"Table", "[", 
        RowBox[{"0.0", ",", 
         RowBox[{"{", 
          RowBox[{"ii", ",", "1", ",", "12"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"jj", ",", "1", ",", "4"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"j", "=", "1"}], ",", 
        RowBox[{"j", "<=", 
         RowBox[{"Length", "[", "gp", "]"}]}], ",", 
        RowBox[{"j", "++"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Kelmm", "+=", 
          RowBox[{
           RowBox[{
            RowBox[{"gw", "[", 
             RowBox[{"[", "j", "]"}], "]"}], 
            RowBox[{"(", 
             RowBox[{"\[Phi]s", ".", 
              RowBox[{"{", 
               RowBox[{
               "\[Rho]1", ",", "\[Rho]2", ",", "\[Rho]3", ",", "\[Rho]4"}], 
               "}"}]}], ")"}], "*", 
            RowBox[{"Kmm", "[", 
             RowBox[{
              RowBox[{"xv", "[", 
               RowBox[{"[", "i1", "]"}], "]"}], ",", 
              RowBox[{"yv", "[", 
               RowBox[{"[", "i1", "]"}], "]"}], ",", 
              RowBox[{"zv", "[", 
               RowBox[{"[", "i1", "]"}], "]"}], ",", 
              RowBox[{"xv", "[", 
               RowBox[{"[", "i2", "]"}], "]"}], ",", 
              RowBox[{"yv", "[", 
               RowBox[{"[", "i2", "]"}], "]"}], ",", 
              RowBox[{"zv", "[", 
               RowBox[{"[", "i2", "]"}], "]"}], ",", 
              RowBox[{"xv", "[", 
               RowBox[{"[", "i3", "]"}], "]"}], ",", 
              RowBox[{"yv", "[", 
               RowBox[{"[", "i3", "]"}], "]"}], ",", 
              RowBox[{"zv", "[", 
               RowBox[{"[", "i3", "]"}], "]"}], ",", 
              RowBox[{"xv", "[", 
               RowBox[{"[", "i4", "]"}], "]"}], ",", 
              RowBox[{"yv", "[", 
               RowBox[{"[", "i4", "]"}], "]"}], ",", 
              RowBox[{"zv", "[", 
               RowBox[{"[", "i4", "]"}], "]"}], ",", 
              RowBox[{"1", "*", 
               SuperscriptBox["10", "11"]}], ",", "0.3"}], "]"}]}], "/.", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"\[Xi]", "\[Rule]", 
              RowBox[{
               RowBox[{"gp", "[", 
                RowBox[{"[", "j", "]"}], "]"}], "[", 
               RowBox[{"[", "1", "]"}], "]"}]}], ",", 
             RowBox[{"\[Psi]", "\[Rule]", 
              RowBox[{
               RowBox[{"gp", "[", 
                RowBox[{"[", "j", "]"}], "]"}], "[", 
               RowBox[{"[", "2", "]"}], "]"}]}], ",", 
             RowBox[{"\[Zeta]", "\[Rule]", 
              RowBox[{
               RowBox[{"gp", "[", 
                RowBox[{"[", "j", "]"}], "]"}], "[", 
               RowBox[{"[", "3", "]"}], "]"}]}]}], "}"}]}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"Keltt", "+=", 
          RowBox[{
           RowBox[{
            RowBox[{"gw", "[", 
             RowBox[{"[", "j", "]"}], "]"}], 
            RowBox[{"(", 
             RowBox[{"\[Phi]s", ".", 
              RowBox[{"{", 
               RowBox[{
               "\[Rho]1", ",", "\[Rho]2", ",", "\[Rho]3", ",", "\[Rho]4"}], 
               "}"}]}], ")"}], "*", 
            RowBox[{"ktt", "[", 
             RowBox[{
              RowBox[{"xv", "[", 
               RowBox[{"[", "i1", "]"}], "]"}], ",", 
              RowBox[{"yv", "[", 
               RowBox[{"[", "i1", "]"}], "]"}], ",", 
              RowBox[{"zv", "[", 
               RowBox[{"[", "i1", "]"}], "]"}], ",", 
              RowBox[{"xv", "[", 
               RowBox[{"[", "i2", "]"}], "]"}], ",", 
              RowBox[{"yv", "[", 
               RowBox[{"[", "i2", "]"}], "]"}], ",", 
              RowBox[{"zv", "[", 
               RowBox[{"[", "i2", "]"}], "]"}], ",", 
              RowBox[{"xv", "[", 
               RowBox[{"[", "i3", "]"}], "]"}], ",", 
              RowBox[{"yv", "[", 
               RowBox[{"[", "i3", "]"}], "]"}], ",", 
              RowBox[{"zv", "[", 
               RowBox[{"[", "i3", "]"}], "]"}], ",", 
              RowBox[{"xv", "[", 
               RowBox[{"[", "i4", "]"}], "]"}], ",", 
              RowBox[{"yv", "[", 
               RowBox[{"[", "i4", "]"}], "]"}], ",", 
              RowBox[{"zv", "[", 
               RowBox[{"[", "i4", "]"}], "]"}], ",", "910.0"}], "]"}]}], "/.", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"\[Xi]", "\[Rule]", 
              RowBox[{
               RowBox[{"gp", "[", 
                RowBox[{"[", "j", "]"}], "]"}], "[", 
               RowBox[{"[", "1", "]"}], "]"}]}], ",", 
             RowBox[{"\[Psi]", "\[Rule]", 
              RowBox[{
               RowBox[{"gp", "[", 
                RowBox[{"[", "j", "]"}], "]"}], "[", 
               RowBox[{"[", "2", "]"}], "]"}]}], ",", 
             RowBox[{"\[Zeta]", "\[Rule]", 
              RowBox[{
               RowBox[{"gp", "[", 
                RowBox[{"[", "j", "]"}], "]"}], "[", 
               RowBox[{"[", "3", "]"}], "]"}]}]}], "}"}]}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"Kelmt", "+=", 
          RowBox[{
           RowBox[{
            RowBox[{"gw", "[", 
             RowBox[{"[", "j", "]"}], "]"}], 
            RowBox[{"(", 
             RowBox[{"\[Phi]s", ".", 
              RowBox[{"{", 
               RowBox[{
               "\[Rho]1", ",", "\[Rho]2", ",", "\[Rho]3", ",", "\[Rho]4"}], 
               "}"}]}], ")"}], "*", 
            RowBox[{"kmt", "[", 
             RowBox[{
              RowBox[{"xv", "[", 
               RowBox[{"[", "i1", "]"}], "]"}], ",", 
              RowBox[{"yv", "[", 
               RowBox[{"[", "i1", "]"}], "]"}], ",", 
              RowBox[{"zv", "[", 
               RowBox[{"[", "i1", "]"}], "]"}], ",", 
              RowBox[{"xv", "[", 
               RowBox[{"[", "i2", "]"}], "]"}], ",", 
              RowBox[{"yv", "[", 
               RowBox[{"[", "i2", "]"}], "]"}], ",", 
              RowBox[{"zv", "[", 
               RowBox[{"[", "i2", "]"}], "]"}], ",", 
              RowBox[{"xv", "[", 
               RowBox[{"[", "i3", "]"}], "]"}], ",", 
              RowBox[{"yv", "[", 
               RowBox[{"[", "i3", "]"}], "]"}], ",", 
              RowBox[{"zv", "[", 
               RowBox[{"[", "i3", "]"}], "]"}], ",", 
              RowBox[{"xv", "[", 
               RowBox[{"[", "i4", "]"}], "]"}], ",", 
              RowBox[{"yv", "[", 
               RowBox[{"[", "i4", "]"}], "]"}], ",", 
              RowBox[{"zv", "[", 
               RowBox[{"[", "i4", "]"}], "]"}], ",", 
              RowBox[{"1.0", "*", 
               SuperscriptBox["10", 
                RowBox[{"-", "5"}]]}], ",", 
              RowBox[{"1", "*", 
               SuperscriptBox["10", "11"]}], ",", "0.3"}], "]"}]}], "/.", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"\[Xi]", "\[Rule]", 
              RowBox[{
               RowBox[{"gp", "[", 
                RowBox[{"[", "j", "]"}], "]"}], "[", 
               RowBox[{"[", "1", "]"}], "]"}]}], ",", 
             RowBox[{"\[Psi]", "\[Rule]", 
              RowBox[{
               RowBox[{"gp", "[", 
                RowBox[{"[", "j", "]"}], "]"}], "[", 
               RowBox[{"[", "2", "]"}], "]"}]}], ",", 
             RowBox[{"\[Zeta]", "\[Rule]", 
              RowBox[{
               RowBox[{"gp", "[", 
                RowBox[{"[", "j", "]"}], "]"}], "[", 
               RowBox[{"[", "3", "]"}], "]"}]}]}], "}"}]}]}], ";"}]}], 
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"inode", "=", "0"}], ",", 
        RowBox[{"inode", "<", "nnodes"}], ",", 
        RowBox[{"inode", "++"}], ",", "\[IndentingNewLine]", 
        RowBox[{"For", "[", 
         RowBox[{
          RowBox[{"jnode", "=", "0"}], ",", 
          RowBox[{"jnode", "<", "nnodes"}], ",", 
          RowBox[{"jnode", "++"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"For", "[", 
            RowBox[{
             RowBox[{"idof", "=", "0"}], ",", 
             RowBox[{"idof", "<", "nmdofs"}], ",", 
             RowBox[{"idof", "++"}], ",", "\[IndentingNewLine]", 
             RowBox[{"For", "[", 
              RowBox[{
               RowBox[{"jdof", "=", "0"}], ",", 
               RowBox[{"jdof", "<", "nmdofs"}], ",", 
               RowBox[{"jdof", "++"}], ",", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{"Klocal", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "[", 
                   RowBox[{"[", 
                    RowBox[{
                    RowBox[{"inode", " ", "ndofs"}], "+", "idof", "+", "1"}], 
                    "]"}], "]"}], "[", 
                  RowBox[{"[", 
                   RowBox[{
                    RowBox[{"jnode", " ", "ndofs"}], "+", "jdof", "+", "1"}], 
                   "]"}], "]"}], " ", "=", 
                 RowBox[{
                  RowBox[{"Kelmm", "[", 
                   RowBox[{"[", 
                    RowBox[{
                    RowBox[{"inode", " ", "nmdofs"}], "+", "idof", "+", "1"}],
                     "]"}], "]"}], "[", 
                  RowBox[{"[", 
                   RowBox[{
                    RowBox[{"jnode", " ", "nmdofs"}], "+", "jdof", "+", "1"}],
                    "]"}], "]"}]}], ";"}]}], "\[IndentingNewLine]", "]"}]}], 
            "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"Klocal", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "[", 
              RowBox[{"[", 
               RowBox[{
                RowBox[{"inode", " ", "ndofs"}], "+", "nmdofs", "+", "1"}], 
               "]"}], "]"}], "[", 
             RowBox[{"[", 
              RowBox[{
               RowBox[{"jnode", " ", "ndofs"}], "+", "nmdofs", "+", "1"}], 
              "]"}], "]"}], " ", "=", 
            RowBox[{
             RowBox[{"Keltt", "[", 
              RowBox[{"[", 
               RowBox[{"inode", "+", "1"}], "]"}], "]"}], "[", 
             RowBox[{"[", 
              RowBox[{"jnode", "+", "1"}], "]"}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"For", "[", 
            RowBox[{
             RowBox[{"idof", "=", "0"}], ",", 
             RowBox[{"idof", "<", "nmdofs"}], ",", 
             RowBox[{"idof", "++"}], ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"Klocal", "[", 
                  RowBox[{"[", "i", "]"}], "]"}], "[", 
                 RowBox[{"[", 
                  RowBox[{
                   RowBox[{"inode", " ", "ndofs"}], "+", "idof", "+", "1"}], 
                  "]"}], "]"}], "[", 
                RowBox[{"[", 
                 RowBox[{
                  RowBox[{"jnode", " ", "ndofs"}], "+", "nmdofs", "+", "1"}], 
                 "]"}], "]"}], " ", "=", 
               RowBox[{"-", 
                RowBox[{
                 RowBox[{"Kelmt", "[", 
                  RowBox[{"[", 
                   RowBox[{
                    RowBox[{"inode", " ", "nmdofs"}], "+", "idof", "+", "1"}],
                    "]"}], "]"}], "[", 
                 RowBox[{"[", 
                  RowBox[{"jnode", "+", "1"}], "]"}], "]"}]}]}], ";"}]}], 
            "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", 
         "]"}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"disp", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"uv", "[", 
          RowBox[{"[", 
           RowBox[{"ids", "[", 
            RowBox[{"[", "ii", "]"}], "]"}], "]"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"ii", ",", "1", ",", "16"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"energyInc", "=", " ", 
       RowBox[{"disp", ".", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Klocal", "[", 
           RowBox[{"[", "i", "]"}], "]"}], ".", "disp"}], ")"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"d\[Rho]", "=", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"D", "[", 
            RowBox[{"energyInc", ",", "\[Rho]1"}], "]"}], ",", 
           RowBox[{"D", "[", 
            RowBox[{"energyInc", ",", "\[Rho]2"}], "]"}], ",", 
           RowBox[{"D", "[", 
            RowBox[{"energyInc", ",", "\[Rho]3"}], "]"}], ",", 
           RowBox[{"D", "[", 
            RowBox[{"energyInc", ",", "\[Rho]4"}], "]"}]}], "}"}], "/.", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"\[Rho]1", "\[Rule]", "1.0"}], ",", 
           RowBox[{"\[Rho]2", "\[Rule]", "1.0"}], ",", 
           RowBox[{"\[Rho]3", "\[Rule]", "1.0"}], ",", 
           RowBox[{"\[Rho]4", "\[Rule]", "1.0"}]}], "}"}]}], ")"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"gradZ", "[", 
        RowBox[{"[", "i1", "]"}], "]"}], "+=", 
       RowBox[{"d\[Rho]", "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"gradZ", "[", 
        RowBox[{"[", "i2", "]"}], "]"}], "+=", 
       RowBox[{"d\[Rho]", "[", 
        RowBox[{"[", "2", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"gradZ", "[", 
        RowBox[{"[", "i3", "]"}], "]"}], "+=", 
       RowBox[{"d\[Rho]", "[", 
        RowBox[{"[", "3", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"gradZ", "[", 
        RowBox[{"[", "i4", "]"}], "]"}], "+=", 
       RowBox[{"d\[Rho]", "[", 
        RowBox[{"[", "4", "]"}], "]"}]}], ";"}]}], "\[IndentingNewLine]", 
    "]"}]}], "\[IndentingNewLine]", "]"}]}], "Input",
 CellChangeTimes->{{3.7642442961606417`*^9, 3.7642443289943247`*^9}, {
   3.764244647880147*^9, 3.7642446516489763`*^9}, 3.906814867168082*^9, {
   3.906819389339713*^9, 3.9068193931562*^9}, {3.906819476986189*^9, 
   3.906819491643066*^9}, {3.906822801452141*^9, 3.9068228055075083`*^9}},
 CellLabel->
  "In[114]:=",ExpressionUUID->"ab068d40-5e07-441e-8a70-30d25efbd6c2"],

Cell[CellGroupData[{

Cell[BoxData["gradZ"], "Input",
 CellChangeTimes->{{3.7642444005117345`*^9, 3.7642444013444624`*^9}},
 CellLabel->
  "In[118]:=",ExpressionUUID->"97d7c002-a3e5-4c5a-9ecd-414e654238df"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "0.10019172434850704`", ",", "0.13358888329800964`", ",", 
   "0.03339723394950264`", ",", "0.1335886207980097`", ",", 
   "0.2003828936970149`", ",", "0.06679434789900526`", ",", 
   "0.033397121449502645`", ",", "0.06679423539900527`", ",", 
   "0.033397113949502635`", ",", "0.1335878332980095`", ",", 
   "0.20038176869701502`", ",", "0.06679401039900533`", ",", 
   "0.20038139369701502`", ",", "0.400763387394031`", ",", 
   "0.20038199369701598`", ",", "0.06679378539900536`", ",", 
   "0.20038161869701596`", ",", "0.13358775829801064`", ",", 
   "0.033396783949502726`", ",", "0.06679356039900552`", ",", 
   "0.03339677644950274`", ",", "0.06679344789900543`", ",", 
   "0.20038049369701627`", ",", "0.1335869707980109`", ",", 
   "0.03339666394950275`", ",", "0.13358670829801092`", ",", 
   "0.10018996934850827`"}], "}"}]], "Output",
 CellChangeTimes->{3.7642444065938015`*^9, 3.850325937634037*^9, 
  3.906745924263658*^9, 3.906815997001875*^9, 3.906819252653112*^9, 
  3.906819675279707*^9, 3.906821191423932*^9, 3.9068222441111298`*^9, 
  3.906822502655027*^9, 3.906822769854396*^9, 3.90682287512029*^9, 
  3.906823218644691*^9, 3.9068235669174843`*^9, 3.907257882745029*^9},
 CellLabel->
  "Out[118]=",ExpressionUUID->"e18283f6-2623-431c-81a2-d10faba35b5f"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"SetPrecision", "[", 
  RowBox[{"gradZ", ",", "16"}], "]"}]], "Input",
 CellChangeTimes->{{3.7209949856957116`*^9, 3.7209949866369324`*^9}, {
  3.720995044627005*^9, 3.720995050464894*^9}},
 CellLabel->
  "In[119]:=",ExpressionUUID->"4169b468-74d1-4d99-8c3e-8047fdd48880"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "0.10019172434850703856668019398057367653`16.", ",", 
   "0.13358888329800963634674815239122835919`16.", ",", 
   "0.03339723394950264157010622056986903772`16.", ",", 
   "0.13358862079800970512621915986528620124`16.", ",", 
   "0.20038289369701489661679261189419776201`16.", ",", 
   "0.06679434789900526303618732981703942642`16.", ",", 
   "0.03339712144950264527398786640333128162`16.", ",", 
   "0.06679423539900526674006897565050167032`16.", ",", 
   "0.03339711394950263534386891706162714399`16.", ",", 
   "0.13358783329800949513099794785375706851`16.", ",", 
   "0.20038176869701501692233591711556073278`16.", ",", 
   "0.0667940103990053296589834985752531793`16.", ",", 
   "0.20038139369701502001674953135079704225`16.", ",", 
   "0.40076338739403100097646870381140615791`16.", ",", 
   "0.20038199369701598095971917246060911566`16.", ",", 
   "0.06679378539900536482232240587109117769`16.", ",", 
   "0.20038161869701595629855717106693191454`16.", ",", 
   "0.13358775829801064483071115773782366887`16.", ",", 
   "0.03339678394950272577457184297600178979`16.", ",", 
   "0.06679356039900552488575158349703997374`16.", ",", 
   "0.03339677644950273666113460535598278511`16.", ",", 
   "0.06679344789900543144511857462930493057`16.", ",", 
   "0.20038049369701627089312978569068945944`16.", ",", 
   "0.13358697079801090668027541141782421619`16.", ",", 
   "0.03339666394950274730391015509667340666`16.", ",", 
   "0.13358670829801091994859518763405503705`16.", ",", 
   "0.10018996934850826763252484852273482829`16."}], "}"}]], "Output",
 CellChangeTimes->{3.720994987716754*^9, 3.7209950515695486`*^9, 
  3.721047011769689*^9, 3.7210616304729853`*^9, 3.723054948630515*^9, 
  3.764244340219616*^9, 3.7642446042574973`*^9, 3.764244658312017*^9, 
  3.850325937642523*^9, 3.9067459247746143`*^9, 3.906815997519878*^9, 
  3.9068192533680143`*^9, 3.906819681149604*^9, 3.906821191462873*^9, 
  3.90682224413568*^9, 3.906822502677946*^9, 3.906822769881277*^9, 
  3.906822885890674*^9, 3.906823218665278*^9, 3.9068235669398317`*^9, 
  3.907257882764189*^9},
 CellLabel->
  "Out[119]=",ExpressionUUID->"c646a107-7bd1-4931-94dc-2f61d20832ee"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Compute internal energy gradient wrt state:", "Subsection",
 CellChangeTimes->{{3.7171711972127666`*^9, 3.71717120142911*^9}, {
  3.7209943882500362`*^9, 3.7209944015165186`*^9}, {3.721049011972142*^9, 
  3.721049018596589*^9}, {3.7210490655350704`*^9, 
  3.7210490675964766`*^9}},ExpressionUUID->"a07c66af-25da-465b-89bb-\
9c0d7e740fe6"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"gradU", "=", 
   RowBox[{"Table", "[", 
    RowBox[{"0.0", ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"4", 
        RowBox[{"Length", "[", "xv", "]"}]}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Klocal", "=", 
   RowBox[{"Table", "[", 
    RowBox[{"0.0", ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"Length", "[", "connect", "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "1", ",", 
       RowBox[{"nnodes", "*", "ndofs"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"k", ",", "1", ",", 
       RowBox[{"nnodes", "*", "ndofs"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"For", "[", 
  RowBox[{
   RowBox[{"i", "=", "1"}], ",", " ", 
   RowBox[{"i", "\[LessEqual]", " ", 
    RowBox[{"Length", "[", "connect", "]"}]}], ",", 
   RowBox[{"i", "++"}], ",", 
   RowBox[{"Block", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"i1", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"connect", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}], "+", "1"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"i2", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"connect", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "[", 
          RowBox[{"[", "2", "]"}], "]"}], "+", "1"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"i3", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"connect", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "[", 
          RowBox[{"[", "3", "]"}], "]"}], "+", "1"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"i4", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"connect", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "[", 
          RowBox[{"[", "4", "]"}], "]"}], "+", "1"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"ids", "=", 
        RowBox[{"{", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"ndofs", " ", 
            RowBox[{"(", 
             RowBox[{"i1", "-", "1"}], ")"}]}], "+", "1"}], ",", " ", 
          RowBox[{
           RowBox[{"ndofs", 
            RowBox[{"(", " ", 
             RowBox[{"i1", "-", "1"}], ")"}]}], "+", "2"}], ",", " ", 
          RowBox[{
           RowBox[{"ndofs", 
            RowBox[{"(", " ", 
             RowBox[{"i1", "-", "1"}], ")"}]}], "+", "3"}], ",", " ", 
          RowBox[{
           RowBox[{"ndofs", 
            RowBox[{"(", 
             RowBox[{"i1", "-", "1"}], ")"}]}], "+", "4"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"ndofs", 
            RowBox[{"(", " ", 
             RowBox[{"i2", "-", "1"}], ")"}]}], "+", "1"}], ",", 
          RowBox[{
           RowBox[{"ndofs", 
            RowBox[{"(", 
             RowBox[{"i2", "-", "1"}], ")"}]}], "+", "2"}], ",", " ", 
          RowBox[{
           RowBox[{"ndofs", 
            RowBox[{"(", " ", 
             RowBox[{"i2", "-", "1"}], ")"}]}], "+", "3"}], ",", 
          RowBox[{
           RowBox[{"ndofs", 
            RowBox[{"(", 
             RowBox[{"i2", "-", "1"}], ")"}]}], "+", "4"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"ndofs", 
            RowBox[{"(", 
             RowBox[{"i3", "-", "1"}], ")"}]}], "+", "1"}], ",", 
          RowBox[{
           RowBox[{"ndofs", " ", 
            RowBox[{"(", 
             RowBox[{"i3", "-", "1"}], ")"}]}], "+", "2"}], ",", " ", 
          RowBox[{
           RowBox[{"ndofs", 
            RowBox[{"(", " ", 
             RowBox[{"i3", "-", "1"}], ")"}]}], "+", "3"}], ",", 
          RowBox[{
           RowBox[{"ndofs", 
            RowBox[{"(", 
             RowBox[{"i3", "-", "1"}], ")"}]}], "+", "4"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"ndofs", 
            RowBox[{"(", 
             RowBox[{"i4", "-", "1"}], ")"}]}], "+", "1"}], ",", 
          RowBox[{
           RowBox[{"ndofs", 
            RowBox[{"(", 
             RowBox[{"i4", "-", "1"}], ")"}]}], "+", "2"}], ",", " ", 
          RowBox[{
           RowBox[{"ndofs", 
            RowBox[{"(", " ", 
             RowBox[{"i4", "-", "1"}], ")"}]}], "+", "3"}], ",", 
          RowBox[{
           RowBox[{"ndofs", 
            RowBox[{"(", 
             RowBox[{"i4", "-", "1"}], ")"}]}], "+", "4"}]}], 
         "\[IndentingNewLine]", "}"}]}]}], "\[IndentingNewLine]", "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Kelmm", "=", 
       RowBox[{"Table", "[", 
        RowBox[{"0.0", ",", 
         RowBox[{"{", 
          RowBox[{"ii", ",", "1", ",", "12"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"jj", ",", "1", ",", "12"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Keltt", "=", 
       RowBox[{"Table", "[", 
        RowBox[{"0.0", ",", 
         RowBox[{"{", 
          RowBox[{"ii", ",", "1", ",", "4"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"jj", ",", "1", ",", "4"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Kelmt", "=", 
       RowBox[{"Table", "[", 
        RowBox[{"0.0", ",", 
         RowBox[{"{", 
          RowBox[{"ii", ",", "1", ",", "12"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"jj", ",", "1", ",", "4"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"j", "=", "1"}], ",", 
        RowBox[{"j", "<=", 
         RowBox[{"Length", "[", "gp", "]"}]}], ",", 
        RowBox[{"j", "++"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Kelmm", "+=", 
          RowBox[{
           RowBox[{"gw", "[", 
            RowBox[{"[", "j", "]"}], "]"}], "*", 
           RowBox[{"Kmm", "[", 
            RowBox[{
             RowBox[{"xv", "[", 
              RowBox[{"[", "i1", "]"}], "]"}], ",", 
             RowBox[{"yv", "[", 
              RowBox[{"[", "i1", "]"}], "]"}], ",", 
             RowBox[{"zv", "[", 
              RowBox[{"[", "i1", "]"}], "]"}], ",", 
             RowBox[{"xv", "[", 
              RowBox[{"[", "i2", "]"}], "]"}], ",", 
             RowBox[{"yv", "[", 
              RowBox[{"[", "i2", "]"}], "]"}], ",", 
             RowBox[{"zv", "[", 
              RowBox[{"[", "i2", "]"}], "]"}], ",", 
             RowBox[{"xv", "[", 
              RowBox[{"[", "i3", "]"}], "]"}], ",", 
             RowBox[{"yv", "[", 
              RowBox[{"[", "i3", "]"}], "]"}], ",", 
             RowBox[{"zv", "[", 
              RowBox[{"[", "i3", "]"}], "]"}], ",", 
             RowBox[{"xv", "[", 
              RowBox[{"[", "i4", "]"}], "]"}], ",", 
             RowBox[{"yv", "[", 
              RowBox[{"[", "i4", "]"}], "]"}], ",", 
             RowBox[{"zv", "[", 
              RowBox[{"[", "i4", "]"}], "]"}], ",", 
             RowBox[{"1", "*", 
              SuperscriptBox["10", "11"]}], ",", "0.3"}], "]"}]}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"Keltt", "+=", 
          RowBox[{
           RowBox[{
            RowBox[{"gw", "[", 
             RowBox[{"[", "j", "]"}], "]"}], "*", 
            RowBox[{"ktt", "[", 
             RowBox[{
              RowBox[{"xv", "[", 
               RowBox[{"[", "i1", "]"}], "]"}], ",", 
              RowBox[{"yv", "[", 
               RowBox[{"[", "i1", "]"}], "]"}], ",", 
              RowBox[{"zv", "[", 
               RowBox[{"[", "i1", "]"}], "]"}], ",", 
              RowBox[{"xv", "[", 
               RowBox[{"[", "i2", "]"}], "]"}], ",", 
              RowBox[{"yv", "[", 
               RowBox[{"[", "i2", "]"}], "]"}], ",", 
              RowBox[{"zv", "[", 
               RowBox[{"[", "i2", "]"}], "]"}], ",", 
              RowBox[{"xv", "[", 
               RowBox[{"[", "i3", "]"}], "]"}], ",", 
              RowBox[{"yv", "[", 
               RowBox[{"[", "i3", "]"}], "]"}], ",", 
              RowBox[{"zv", "[", 
               RowBox[{"[", "i3", "]"}], "]"}], ",", 
              RowBox[{"xv", "[", 
               RowBox[{"[", "i4", "]"}], "]"}], ",", 
              RowBox[{"yv", "[", 
               RowBox[{"[", "i4", "]"}], "]"}], ",", 
              RowBox[{"zv", "[", 
               RowBox[{"[", "i4", "]"}], "]"}], ",", "ConductionCoeff"}], 
             "]"}]}], "/.", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"\[Xi]", "\[Rule]", 
              RowBox[{
               RowBox[{"gp", "[", 
                RowBox[{"[", "j", "]"}], "]"}], "[", 
               RowBox[{"[", "1", "]"}], "]"}]}], ",", 
             RowBox[{"\[Psi]", "\[Rule]", 
              RowBox[{
               RowBox[{"gp", "[", 
                RowBox[{"[", "j", "]"}], "]"}], "[", 
               RowBox[{"[", "2", "]"}], "]"}]}], ",", 
             RowBox[{"\[Zeta]", "\[Rule]", 
              RowBox[{
               RowBox[{"gp", "[", 
                RowBox[{"[", "j", "]"}], "]"}], "[", 
               RowBox[{"[", "3", "]"}], "]"}]}]}], "}"}]}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"Kelmt", "+=", 
          RowBox[{
           RowBox[{
            RowBox[{"gw", "[", 
             RowBox[{"[", "j", "]"}], "]"}], "*", 
            RowBox[{"kmt", "[", 
             RowBox[{
              RowBox[{"xv", "[", 
               RowBox[{"[", "i1", "]"}], "]"}], ",", 
              RowBox[{"yv", "[", 
               RowBox[{"[", "i1", "]"}], "]"}], ",", 
              RowBox[{"zv", "[", 
               RowBox[{"[", "i1", "]"}], "]"}], ",", 
              RowBox[{"xv", "[", 
               RowBox[{"[", "i2", "]"}], "]"}], ",", 
              RowBox[{"yv", "[", 
               RowBox[{"[", "i2", "]"}], "]"}], ",", 
              RowBox[{"zv", "[", 
               RowBox[{"[", "i2", "]"}], "]"}], ",", 
              RowBox[{"xv", "[", 
               RowBox[{"[", "i3", "]"}], "]"}], ",", 
              RowBox[{"yv", "[", 
               RowBox[{"[", "i3", "]"}], "]"}], ",", 
              RowBox[{"zv", "[", 
               RowBox[{"[", "i3", "]"}], "]"}], ",", 
              RowBox[{"xv", "[", 
               RowBox[{"[", "i4", "]"}], "]"}], ",", 
              RowBox[{"yv", "[", 
               RowBox[{"[", "i4", "]"}], "]"}], ",", 
              RowBox[{"zv", "[", 
               RowBox[{"[", "i4", "]"}], "]"}], ",", 
              RowBox[{"1.0", "*", 
               SuperscriptBox["10", 
                RowBox[{"-", "5"}]]}], ",", 
              RowBox[{"1", "*", 
               SuperscriptBox["10", "11"]}], ",", "0.3"}], "]"}]}], "/.", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"\[Xi]", "\[Rule]", 
              RowBox[{
               RowBox[{"gp", "[", 
                RowBox[{"[", "j", "]"}], "]"}], "[", 
               RowBox[{"[", "1", "]"}], "]"}]}], ",", 
             RowBox[{"\[Psi]", "\[Rule]", 
              RowBox[{
               RowBox[{"gp", "[", 
                RowBox[{"[", "j", "]"}], "]"}], "[", 
               RowBox[{"[", "2", "]"}], "]"}]}], ",", 
             RowBox[{"\[Zeta]", "\[Rule]", 
              RowBox[{
               RowBox[{"gp", "[", 
                RowBox[{"[", "j", "]"}], "]"}], "[", 
               RowBox[{"[", "3", "]"}], "]"}]}]}], "}"}]}]}], ";"}]}], 
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"inode", "=", "0"}], ",", 
        RowBox[{"inode", "<", "nnodes"}], ",", 
        RowBox[{"inode", "++"}], ",", "\[IndentingNewLine]", 
        RowBox[{"For", "[", 
         RowBox[{
          RowBox[{"jnode", "=", "0"}], ",", 
          RowBox[{"jnode", "<", "nnodes"}], ",", 
          RowBox[{"jnode", "++"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"For", "[", 
            RowBox[{
             RowBox[{"idof", "=", "0"}], ",", 
             RowBox[{"idof", "<", "nmdofs"}], ",", 
             RowBox[{"idof", "++"}], ",", "\[IndentingNewLine]", 
             RowBox[{"For", "[", 
              RowBox[{
               RowBox[{"jdof", "=", "0"}], ",", 
               RowBox[{"jdof", "<", "nmdofs"}], ",", 
               RowBox[{"jdof", "++"}], ",", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{"Klocal", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "[", 
                   RowBox[{"[", 
                    RowBox[{
                    RowBox[{"inode", " ", "ndofs"}], "+", "idof", "+", "1"}], 
                    "]"}], "]"}], "[", 
                  RowBox[{"[", 
                   RowBox[{
                    RowBox[{"jnode", " ", "ndofs"}], "+", "jdof", "+", "1"}], 
                   "]"}], "]"}], " ", "=", 
                 RowBox[{
                  RowBox[{"Kelmm", "[", 
                   RowBox[{"[", 
                    RowBox[{
                    RowBox[{"inode", " ", "nmdofs"}], "+", "idof", "+", "1"}],
                     "]"}], "]"}], "[", 
                  RowBox[{"[", 
                   RowBox[{
                    RowBox[{"jnode", " ", "nmdofs"}], "+", "jdof", "+", "1"}],
                    "]"}], "]"}]}], ";"}]}], "\[IndentingNewLine]", "]"}]}], 
            "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"Klocal", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "[", 
              RowBox[{"[", 
               RowBox[{
                RowBox[{"inode", " ", "ndofs"}], "+", "nmdofs", "+", "1"}], 
               "]"}], "]"}], "[", 
             RowBox[{"[", 
              RowBox[{
               RowBox[{"jnode", " ", "ndofs"}], "+", "nmdofs", "+", "1"}], 
              "]"}], "]"}], " ", "=", 
            RowBox[{
             RowBox[{"Keltt", "[", 
              RowBox[{"[", 
               RowBox[{"inode", "+", "1"}], "]"}], "]"}], "[", 
             RowBox[{"[", 
              RowBox[{"jnode", "+", "1"}], "]"}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"For", "[", 
            RowBox[{
             RowBox[{"idof", "=", "0"}], ",", 
             RowBox[{"idof", "<", "nmdofs"}], ",", 
             RowBox[{"idof", "++"}], ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"Klocal", "[", 
                  RowBox[{"[", "i", "]"}], "]"}], "[", 
                 RowBox[{"[", 
                  RowBox[{
                   RowBox[{"inode", " ", "ndofs"}], "+", "idof", "+", "1"}], 
                  "]"}], "]"}], "[", 
                RowBox[{"[", 
                 RowBox[{
                  RowBox[{"jnode", " ", "ndofs"}], "+", "nmdofs", "+", "1"}], 
                 "]"}], "]"}], " ", "=", 
               RowBox[{"-", 
                RowBox[{
                 RowBox[{"Kelmt", "[", 
                  RowBox[{"[", 
                   RowBox[{
                    RowBox[{"inode", " ", "nmdofs"}], "+", "idof", "+", "1"}],
                    "]"}], "]"}], "[", 
                 RowBox[{"[", 
                  RowBox[{"jnode", "+", "1"}], "]"}], "]"}]}]}], ";"}]}], 
            "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", 
         "]"}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"disp", "=", 
       RowBox[{"{", 
        RowBox[{
        "u1", ",", "u2", ",", "u3", ",", "u4", ",", "u5", ",", "u6", ",", 
         "u7", ",", "u8", ",", "u9", ",", "u10", ",", "u11", ",", "u12", ",", 
         "u13", ",", "u14", ",", "u15", ",", "u16"}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"energyInc", "=", 
       RowBox[{"disp", ".", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Klocal", "[", 
           RowBox[{"[", "i", "]"}], "]"}], ".", "disp"}], ")"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"du", "=", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"D", "[", 
            RowBox[{"energyInc", ",", "u1"}], "]"}], ",", 
           RowBox[{"D", "[", 
            RowBox[{"energyInc", ",", "u2"}], "]"}], ",", 
           RowBox[{"D", "[", 
            RowBox[{"energyInc", ",", "u3"}], "]"}], ",", 
           RowBox[{"D", "[", 
            RowBox[{"energyInc", ",", "u4"}], "]"}], ",", 
           RowBox[{"D", "[", 
            RowBox[{"energyInc", ",", "u5"}], "]"}], ",", 
           RowBox[{"D", "[", 
            RowBox[{"energyInc", ",", "u6"}], "]"}], ",", 
           RowBox[{"D", "[", 
            RowBox[{"energyInc", ",", "u7"}], "]"}], ",", 
           RowBox[{"D", "[", 
            RowBox[{"energyInc", ",", "u8"}], "]"}], ",", 
           RowBox[{"D", "[", 
            RowBox[{"energyInc", ",", "u9"}], "]"}], ",", 
           RowBox[{"D", "[", 
            RowBox[{"energyInc", ",", "u10"}], "]"}], ",", 
           RowBox[{"D", "[", 
            RowBox[{"energyInc", ",", "u11"}], "]"}], ",", 
           RowBox[{"D", "[", 
            RowBox[{"energyInc", ",", "u12"}], "]"}], ",", 
           RowBox[{"D", "[", 
            RowBox[{"energyInc", ",", "u13"}], "]"}], ",", 
           RowBox[{"D", "[", 
            RowBox[{"energyInc", ",", "u14"}], "]"}], ",", 
           RowBox[{"D", "[", 
            RowBox[{"energyInc", ",", "u15"}], "]"}], ",", 
           RowBox[{"D", "[", 
            RowBox[{"energyInc", ",", "u16"}], "]"}]}], "}"}], "/.", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"u1", "\[Rule]", 
            RowBox[{"uv", "[", 
             RowBox[{"[", 
              RowBox[{"ids", "[", 
               RowBox[{"[", "1", "]"}], "]"}], "]"}], "]"}]}], ",", 
           RowBox[{"u2", "\[Rule]", 
            RowBox[{"uv", "[", 
             RowBox[{"[", 
              RowBox[{"ids", "[", 
               RowBox[{"[", "2", "]"}], "]"}], "]"}], "]"}]}], ",", 
           RowBox[{"u3", "\[Rule]", 
            RowBox[{"uv", "[", 
             RowBox[{"[", 
              RowBox[{"ids", "[", 
               RowBox[{"[", "3", "]"}], "]"}], "]"}], "]"}]}], ",", 
           RowBox[{"u4", "\[Rule]", 
            RowBox[{"uv", "[", 
             RowBox[{"[", 
              RowBox[{"ids", "[", 
               RowBox[{"[", "4", "]"}], "]"}], "]"}], "]"}]}], ",", 
           RowBox[{"u5", "\[Rule]", 
            RowBox[{"uv", "[", 
             RowBox[{"[", 
              RowBox[{"ids", "[", 
               RowBox[{"[", "5", "]"}], "]"}], "]"}], "]"}]}], ",", 
           RowBox[{"u6", "\[Rule]", 
            RowBox[{"uv", "[", 
             RowBox[{"[", 
              RowBox[{"ids", "[", 
               RowBox[{"[", "6", "]"}], "]"}], "]"}], "]"}]}], ",", 
           RowBox[{"u7", "\[Rule]", 
            RowBox[{"uv", "[", 
             RowBox[{"[", 
              RowBox[{"ids", "[", 
               RowBox[{"[", "7", "]"}], "]"}], "]"}], "]"}]}], ",", 
           RowBox[{"u8", "\[Rule]", 
            RowBox[{"uv", "[", 
             RowBox[{"[", 
              RowBox[{"ids", "[", 
               RowBox[{"[", "8", "]"}], "]"}], "]"}], "]"}]}], ",", 
           RowBox[{"u9", "\[Rule]", 
            RowBox[{"uv", "[", 
             RowBox[{"[", 
              RowBox[{"ids", "[", 
               RowBox[{"[", "9", "]"}], "]"}], "]"}], "]"}]}], ",", 
           RowBox[{"u10", "\[Rule]", 
            RowBox[{"uv", "[", 
             RowBox[{"[", 
              RowBox[{"ids", "[", 
               RowBox[{"[", "10", "]"}], "]"}], "]"}], "]"}]}], ",", 
           RowBox[{"u11", "\[Rule]", 
            RowBox[{"uv", "[", 
             RowBox[{"[", 
              RowBox[{"ids", "[", 
               RowBox[{"[", "11", "]"}], "]"}], "]"}], "]"}]}], ",", 
           RowBox[{"u12", "\[Rule]", 
            RowBox[{"uv", "[", 
             RowBox[{"[", 
              RowBox[{"ids", "[", 
               RowBox[{"[", "12", "]"}], "]"}], "]"}], "]"}]}], ",", 
           RowBox[{"u13", "\[Rule]", 
            RowBox[{"uv", "[", 
             RowBox[{"[", 
              RowBox[{"ids", "[", 
               RowBox[{"[", "13", "]"}], "]"}], "]"}], "]"}]}], ",", 
           RowBox[{"u14", "\[Rule]", 
            RowBox[{"uv", "[", 
             RowBox[{"[", 
              RowBox[{"ids", "[", 
               RowBox[{"[", "14", "]"}], "]"}], "]"}], "]"}]}], ",", 
           RowBox[{"u15", "\[Rule]", 
            RowBox[{"uv", "[", 
             RowBox[{"[", 
              RowBox[{"ids", "[", 
               RowBox[{"[", "15", "]"}], "]"}], "]"}], "]"}]}], ",", 
           RowBox[{"u16", "\[Rule]", 
            RowBox[{"uv", "[", 
             RowBox[{"[", 
              RowBox[{"ids", "[", 
               RowBox[{"[", "16", "]"}], "]"}], "]"}], "]"}]}]}], "}"}]}], 
        ")"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"j", "=", "1"}], ",", 
        RowBox[{"j", "\[LessEqual]", "16"}], ",", 
        RowBox[{"j", "++"}], ",", 
        RowBox[{
         RowBox[{"gradU", "[", 
          RowBox[{"[", 
           RowBox[{"ids", "[", 
            RowBox[{"[", "j", "]"}], "]"}], "]"}], "]"}], "+=", 
         RowBox[{"du", "[", 
          RowBox[{"[", "j", "]"}], "]"}]}]}], "]"}], ";"}]}], 
    "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]}], "Input",
 CellChangeTimes->{{3.7642452569805026`*^9, 3.764245263358354*^9}, {
   3.764245305776163*^9, 3.764245328650949*^9}, {3.7642453588766627`*^9, 
   3.7642454488433666`*^9}, {3.764246854431797*^9, 3.7642468553631997`*^9}, 
   3.906814870911618*^9, {3.9068198165349817`*^9, 3.906819825781301*^9}, 
   3.906819858820736*^9},
 CellLabel->
  "In[120]:=",ExpressionUUID->"e3aeff08-53d9-4e77-8c83-112bbac04ddf"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"SetPrecision", "[", 
  RowBox[{"gradU", ",", "16"}], "]"}]], "Input",
 CellChangeTimes->{{3.7209949856957116`*^9, 3.7209949866369324`*^9}, {
  3.720995044627005*^9, 3.720995050464894*^9}, {3.7210497813919053`*^9, 
  3.7210497819111586`*^9}},
 CellLabel->
  "In[123]:=",ExpressionUUID->"39d7f66b-6fe6-45be-b1a2-2f2f6b882af9"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"-", "120512.1330128205008804798126220703125`16."}], ",", 
   RowBox[{"-", "91025.141025640987209044396877288818359375`16."}], ",", 
   RowBox[{"-", "92307.25480769228306598961353302001953125`16."}], ",", 
   RowBox[{"-", "0.28298333333333164363310174849175382406`16."}], ",", 
   RowBox[{"-", "126922.05608974353526718914508819580078125`16."}], ",", 
   RowBox[{"-", "115383.844551281988970004022121429443359375`16."}], ",", 
   RowBox[{"-", "74999.916666666671517305076122283935546875`16."}], ",", 
   RowBox[{"-", "0.37739999999999840341047274705488234758`16."}], ",", 
   RowBox[{"-", "6409.9647435897422838024795055389404296875`16."}], ",", 
   RowBox[{"-", "24358.74519230767691624350845813751220703125`16."}], ",", 
   "17307.17147435896913520991802215576171875`16.", ",", 
   RowBox[{"-", "0.0944166666666668430440978454498690553`16."}], ",", 
   RowBox[{"-", "140383.38621794871869497001171112060546875`16."}], ",", 
   RowBox[{"-", "61538.211538461517193354666233062744140625`16."}], ",", 
   RowBox[{"-", "117306.7964743589400313794612884521484375`16."}], ",", 
   RowBox[{"-", "0.37699999999999844746412236418109387159`16."}], ",", 
   RowBox[{"-", "173074.7980769229470752179622650146484375`16."}], ",", 
   RowBox[{"-", "80768.855769230736768804490566253662109375`16."}], ",", 
   RowBox[{"-", "107692.18269230765872634947299957275390625`16."}], ",", 
   RowBox[{"-", "0.56609999999999882636103620825451798737`16."}], ",", 
   RowBox[{"-", "32691.41185897435570950619876384735107421875`16."}], ",", 
   RowBox[{"-", "19230.64423076922321342863142490386962890625`16."}], ",", 
   "9614.363782051295856945216655731201171875`16.", ",", 
   RowBox[{"-", "0.18910000000000035114133822844451060519`16."}], ",", 
   RowBox[{"-", "19871.37820512820690055377781391143798828125`16."}], ",", 
   "29486.42948717947001568973064422607421875`16.", ",", 
   RowBox[{"-", "24999.6666666666787932626903057098388671875`16."}], ",", 
   RowBox[{"-", "0.09401666666666681770880842350379680283`16."}], ",", 
   RowBox[{"-", "46152.741987179455463774502277374267578125`16."}], ",", 
   "34614.2387820512885809876024723052978515625`16.", ",", 
   RowBox[{"-", "32692.26602564100539893843233585357666015625`16."}], ",", 
   RowBox[{"-", "0.18870000000000031192826099868398159742`16."}], ",", 
   RowBox[{"-", "26281.322115384609787724912166595458984375`16."}], ",", 
   "5127.85096153846552624600008130073547363281`16.", ",", 
   RowBox[{"-", "7692.68269230767509725410491228103637695313`16."}], ",", 
   RowBox[{"-", "0.09468333333333350809724038299464154989`16."}], ",", 
   RowBox[{"-", "94230.019230769205023534595966339111328125`16."}], ",", 
   RowBox[{"-", "96152.2419871794409118592739105224609375`16."}], ",", 
   RowBox[{"-", "84613.86378205125220119953155517578125`16."}], ",", 
   RowBox[{"-", "0.37579999999999846860276875304407440126`16."}], ",", 
   RowBox[{"-", "80768.1057692308095283806324005126953125`16."}], ",", 
   RowBox[{"-", "149997.12499999997089616954326629638671875`16."}], ",", 
   RowBox[{"-", "42307.5673076921957544982433319091796875`16."}], ",", 
   RowBox[{"-", "0.5636999999999988686383289859804790467`16."}], ",", 
   "13461.91346153849372058175504207611083984375`16.", ",", 
   RowBox[{"-", "53844.883012820428120903670787811279296875`16."}], ",", 
   "42306.046474358925479464232921600341796875`16.", ",", 
   RowBox[{"-", "0.18790000000000028901325777042075060308`16."}], ",", 
   RowBox[{"-", "107691.18269230765872634947299957275390625`16."}], ",", 
   RowBox[{"-", "42307.31730769228306598961353302001953125`16."}], ",", 
   RowBox[{"-", "126919.951923076834646053612232208251953125`16."}], ",", 
   RowBox[{"-", "0.56289999999999873470102329520159401`16."}], ",", 
   "2.25`16.", ",", "0.7500000000654836185276508331298828125`16.", ",", 
   "0.2500000001091393642127513885498046875`16.", ",", 
   RowBox[{"-", "1.12499999999999955591079014993738383055`16."}], ",", 
   "107693.43269230774603784084320068359375`16.", ",", 
   "42308.0673076923121698200702667236328125`16.", ",", 
   "126919.701923076878301799297332763671875`16.", ",", 
   RowBox[{"-", "0.56210000000000104325437177976709790528`16."}], ",", 
   RowBox[{"-", "13461.16346153840640909038484096527099609375`16."}], ",", 
   "53844.174679487230605445802211761474609375`16.", ",", 
   RowBox[{"-", "42306.088141025524237193167209625244140625`16."}], ",", 
   RowBox[{"-", "0.18710000000000032160940577341534662992`16."}], ",", 
   "80770.355769230736768804490566253662109375`16.", ",", 
   "149996.37499999997089616954326629638671875`16.", ",", 
   "42307.817307692326721735298633575439453125`16.", ",", 
   RowBox[{"-", "0.56130000000000102033936855150386691093`16."}], ",", 
   "94231.519230769234127365052700042724609375`16.", ",", 
   "96152.20032051275484263896942138671875`16.", ",", 
   "84613.655448717923718504607677459716796875`16.", ",", 
   RowBox[{"-", "0.37420000000000064321881154683069325984`16."}], ",", 
   "26280.6137820512740290723741054534912109375`16.", ",", 
   RowBox[{"-", "5127.4759615384464268572628498077392578125`16."}], ",", 
   "7693.01602564107088255695998668670654296875`16.", ",", 
   RowBox[{"-", "0.0928166666666668527252426201812340878`16."}], ",", 
   "46151.70032051284215413033962249755859375`16.", ",", 
   RowBox[{"-", "34613.2804487178873387165367603302001953125`16."}], ",", 
   "32692.34935897442119312472641468048095703125`16.", ",", 
   RowBox[{"-", "0.18630000000000046522785623892559669912`16."}], ",", 
   "19871.12820512818507268093526363372802734375`16.", ",", 
   RowBox[{"-", "29485.7628205127912224270403385162353515625`16."}], ",", 
   "24999.25000000004001776687800884246826171875`16.", ",", 
   RowBox[{"-", "0.09348333333333352923588677185762207955`16."}], ",", 
   "32689.95352564103450276888906955718994140625`16.", ",", 
   "19230.894230769205023534595966339111328125`16.", ",", 
   RowBox[{"-", "9613.1554487178291310556232929229736328125`16."}], ",", 
   RowBox[{"-", "0.1859000000000002872369009310205001384`16."}], ",", 
   "173072.548076923121698200702667236328125`16.", ",", 
   "80769.60576923095504753291606903076171875`16.", ",", 
   "107692.432692307644174434244632720947265625`16.", ",", 
   RowBox[{"-", "0.55890000000000106261666132922982797027`16."}], ",", 
   "140382.59455128191621042788028717041015625`16.", ",", 
   "61538.7115384615681250579655170440673828125`16.", ",", 
   "117305.3381410256843082606792449951171875`16.", ",", 
   RowBox[{"-", "0.37300000000000077537976039820932783186`16."}], ",", 
   "6409.46474358975865470711141824722290039063`16.", ",", 
   "24358.1201923077096580527722835540771484375`16.", ",", 
   RowBox[{"-", "17306.04647435896913520991802215576171875`16."}], ",", 
   RowBox[{"-", "0.09308333333333343451165831083926605061`16."}], ",", 
   "126920.847756410264992155134677886962890625`16.", ",", 
   "115382.136217948645935393869876861572265625`16.", ",", 
   "75000.083333333386690355837345123291015625`16.", ",", 
   RowBox[{"-", "0.37260000000000070841110755281988531351`16."}], ",", 
   "120511.3413461538148112595081329345703125`16.", ",", 
   "91023.97435897434479556977748870849609375`16.", ",", 
   "92305.963141025626100599765777587890625`16.", ",", 
   RowBox[{"-", "0.27951666666666713512157116383605170995`16."}]}], 
  "}"}]], "Output",
 CellChangeTimes->{3.720994987716754*^9, 3.7209950515695486`*^9, 
  3.721047011769689*^9, 3.721049783085235*^9, 3.7210616458831215`*^9, 
  3.7230549598023367`*^9, 3.764245463887192*^9, 3.764246859671549*^9, 
  3.850325938329838*^9, 3.906745930823977*^9, 3.906816003171933*^9, 
  3.906819258925969*^9, 3.9068198899456244`*^9, 3.9068211938627033`*^9, 
  3.9068222464340553`*^9, 3.9068225049340677`*^9, 3.906822772421632*^9, 
  3.906823220992012*^9, 3.906823569156041*^9, 3.907257884379583*^9},
 CellLabel->
  "Out[123]=",ExpressionUUID->"7b057146-b3a0-4ae2-b257-3cbce872e26b"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Compute internal energy gradient wrt config:", "Subsection",
 CellChangeTimes->{{3.7171711972127666`*^9, 3.71717120142911*^9}, {
  3.7209943882500362`*^9, 3.7209944015165186`*^9}, {3.721049011972142*^9, 
  3.721049018596589*^9}, {3.7210490655350704`*^9, 3.7210490675964766`*^9}, {
  3.7230551164809313`*^9, 
  3.7230551185900598`*^9}},ExpressionUUID->"07433628-474a-44e7-a865-\
44770d6d2336"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ndims", "=", "3"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"gradX", "=", 
   RowBox[{"Table", "[", 
    RowBox[{"0.0", ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"3", 
        RowBox[{"Length", "[", "xv", "]"}]}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Klocal", "=", 
   RowBox[{"Table", "[", 
    RowBox[{"0.0", ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"Length", "[", "connect", "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "1", ",", 
       RowBox[{"nnodes", "*", "ndofs"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"k", ",", "1", ",", 
       RowBox[{"nnodes", "*", "ndofs"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"For", "[", 
  RowBox[{
   RowBox[{"i", "=", "1"}], ",", " ", 
   RowBox[{"i", "\[LessEqual]", " ", 
    RowBox[{"Length", "[", "connect", "]"}]}], ",", 
   RowBox[{"i", "++"}], ",", 
   RowBox[{"Block", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"i1", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"connect", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}], "+", "1"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"i2", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"connect", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "[", 
          RowBox[{"[", "2", "]"}], "]"}], "+", "1"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"i3", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"connect", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "[", 
          RowBox[{"[", "3", "]"}], "]"}], "+", "1"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"i4", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"connect", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "[", 
          RowBox[{"[", "4", "]"}], "]"}], "+", "1"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"ids", "=", 
        RowBox[{"{", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"ndofs", " ", 
            RowBox[{"(", 
             RowBox[{"i1", "-", "1"}], ")"}]}], "+", "1"}], ",", " ", 
          RowBox[{
           RowBox[{"ndofs", 
            RowBox[{"(", " ", 
             RowBox[{"i1", "-", "1"}], ")"}]}], "+", "2"}], ",", " ", 
          RowBox[{
           RowBox[{"ndofs", 
            RowBox[{"(", " ", 
             RowBox[{"i1", "-", "1"}], ")"}]}], "+", "3"}], ",", " ", 
          RowBox[{
           RowBox[{"ndofs", 
            RowBox[{"(", 
             RowBox[{"i1", "-", "1"}], ")"}]}], "+", "4"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"ndofs", 
            RowBox[{"(", " ", 
             RowBox[{"i2", "-", "1"}], ")"}]}], "+", "1"}], ",", 
          RowBox[{
           RowBox[{"ndofs", 
            RowBox[{"(", 
             RowBox[{"i2", "-", "1"}], ")"}]}], "+", "2"}], ",", " ", 
          RowBox[{
           RowBox[{"ndofs", 
            RowBox[{"(", " ", 
             RowBox[{"i2", "-", "1"}], ")"}]}], "+", "3"}], ",", 
          RowBox[{
           RowBox[{"ndofs", 
            RowBox[{"(", 
             RowBox[{"i2", "-", "1"}], ")"}]}], "+", "4"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"ndofs", 
            RowBox[{"(", 
             RowBox[{"i3", "-", "1"}], ")"}]}], "+", "1"}], ",", 
          RowBox[{
           RowBox[{"ndofs", " ", 
            RowBox[{"(", 
             RowBox[{"i3", "-", "1"}], ")"}]}], "+", "2"}], ",", " ", 
          RowBox[{
           RowBox[{"ndofs", 
            RowBox[{"(", " ", 
             RowBox[{"i3", "-", "1"}], ")"}]}], "+", "3"}], ",", 
          RowBox[{
           RowBox[{"ndofs", 
            RowBox[{"(", 
             RowBox[{"i3", "-", "1"}], ")"}]}], "+", "4"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"ndofs", 
            RowBox[{"(", 
             RowBox[{"i4", "-", "1"}], ")"}]}], "+", "1"}], ",", 
          RowBox[{
           RowBox[{"ndofs", 
            RowBox[{"(", 
             RowBox[{"i4", "-", "1"}], ")"}]}], "+", "2"}], ",", " ", 
          RowBox[{
           RowBox[{"ndofs", 
            RowBox[{"(", " ", 
             RowBox[{"i4", "-", "1"}], ")"}]}], "+", "3"}], ",", 
          RowBox[{
           RowBox[{"ndofs", 
            RowBox[{"(", 
             RowBox[{"i4", "-", "1"}], ")"}]}], "+", "4"}]}], 
         "\[IndentingNewLine]", "}"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"xids", "=", 
        RowBox[{"{", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"ndims", " ", 
            RowBox[{"(", 
             RowBox[{"i1", "-", "1"}], ")"}]}], "+", "1"}], ",", " ", 
          RowBox[{
           RowBox[{"ndims", 
            RowBox[{"(", " ", 
             RowBox[{"i1", "-", "1"}], ")"}]}], "+", "2"}], ",", " ", 
          RowBox[{
           RowBox[{"ndims", 
            RowBox[{"(", " ", 
             RowBox[{"i1", "-", "1"}], ")"}]}], "+", "3"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"ndims", 
            RowBox[{"(", " ", 
             RowBox[{"i2", "-", "1"}], ")"}]}], "+", "1"}], ",", 
          RowBox[{
           RowBox[{"ndims", 
            RowBox[{"(", 
             RowBox[{"i2", "-", "1"}], ")"}]}], "+", "2"}], ",", " ", 
          RowBox[{
           RowBox[{"ndims", 
            RowBox[{"(", " ", 
             RowBox[{"i2", "-", "1"}], ")"}]}], "+", "3"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"ndims", 
            RowBox[{"(", 
             RowBox[{"i3", "-", "1"}], ")"}]}], "+", "1"}], ",", 
          RowBox[{
           RowBox[{"ndims", " ", 
            RowBox[{"(", 
             RowBox[{"i3", "-", "1"}], ")"}]}], "+", "2"}], ",", " ", 
          RowBox[{
           RowBox[{"ndims", 
            RowBox[{"(", " ", 
             RowBox[{"i3", "-", "1"}], ")"}]}], "+", "3"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"ndims", 
            RowBox[{"(", 
             RowBox[{"i4", "-", "1"}], ")"}]}], "+", "1"}], ",", 
          RowBox[{
           RowBox[{"ndims", 
            RowBox[{"(", 
             RowBox[{"i4", "-", "1"}], ")"}]}], "+", "2"}], ",", " ", 
          RowBox[{
           RowBox[{"ndims", 
            RowBox[{"(", " ", 
             RowBox[{"i4", "-", "1"}], ")"}]}], "+", "3"}]}], 
         "\[IndentingNewLine]", "}"}]}]}], "\[IndentingNewLine]", "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Kelmm", "=", 
       RowBox[{"Table", "[", 
        RowBox[{"0.0", ",", 
         RowBox[{"{", 
          RowBox[{"ii", ",", "1", ",", "12"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"jj", ",", "1", ",", "12"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Keltt", "=", 
       RowBox[{"Table", "[", 
        RowBox[{"0.0", ",", 
         RowBox[{"{", 
          RowBox[{"ii", ",", "1", ",", "4"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"jj", ",", "1", ",", "4"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Kelmt", "=", 
       RowBox[{"Table", "[", 
        RowBox[{"0.0", ",", 
         RowBox[{"{", 
          RowBox[{"ii", ",", "1", ",", "12"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"jj", ",", "1", ",", "4"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"j", "=", "1"}], ",", 
        RowBox[{"j", "<=", 
         RowBox[{"Length", "[", "gp", "]"}]}], ",", 
        RowBox[{"j", "++"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Kelmm", "+=", 
          RowBox[{
           RowBox[{"gw", "[", 
            RowBox[{"[", "j", "]"}], "]"}], "*", 
           RowBox[{"KmmNoAbs", "[", 
            RowBox[{
            "x1", ",", "x2", ",", "x3", ",", "x4", ",", "x5", ",", "x6", ",", 
             "x7", ",", "x8", ",", "x9", ",", "x10", ",", "x11", ",", "x12", 
             ",", 
             RowBox[{"1", "*", 
              SuperscriptBox["10", "11"]}], ",", "0.3"}], "]"}]}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"Keltt", "+=", 
          RowBox[{
           RowBox[{
            RowBox[{"gw", "[", 
             RowBox[{"[", "j", "]"}], "]"}], "*", 
            RowBox[{"kttNoAbs", "[", 
             RowBox[{
             "x1", ",", "x2", ",", "x3", ",", "x4", ",", "x5", ",", "x6", ",",
               "x7", ",", "x8", ",", "x9", ",", "x10", ",", "x11", ",", "x12",
               ",", "ConductionCoeff"}], "]"}]}], "/.", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"\[Xi]", "\[Rule]", 
              RowBox[{
               RowBox[{"gp", "[", 
                RowBox[{"[", "j", "]"}], "]"}], "[", 
               RowBox[{"[", "1", "]"}], "]"}]}], ",", 
             RowBox[{"\[Psi]", "\[Rule]", 
              RowBox[{
               RowBox[{"gp", "[", 
                RowBox[{"[", "j", "]"}], "]"}], "[", 
               RowBox[{"[", "2", "]"}], "]"}]}], ",", 
             RowBox[{"\[Zeta]", "\[Rule]", 
              RowBox[{
               RowBox[{"gp", "[", 
                RowBox[{"[", "j", "]"}], "]"}], "[", 
               RowBox[{"[", "3", "]"}], "]"}]}]}], "}"}]}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"Kelmt", "+=", 
          RowBox[{
           RowBox[{
            RowBox[{"gw", "[", 
             RowBox[{"[", "j", "]"}], "]"}], "*", 
            RowBox[{"kmtNoAbs", "[", 
             RowBox[{
             "x1", ",", "x2", ",", "x3", ",", "x4", ",", "x5", ",", "x6", ",",
               "x7", ",", "x8", ",", "x9", ",", "x10", ",", "x11", ",", "x12",
               ",", 
              RowBox[{"1.0", "*", 
               SuperscriptBox["10", 
                RowBox[{"-", "5"}]]}], ",", 
              RowBox[{"1", "*", 
               SuperscriptBox["10", "11"]}], ",", "0.3"}], "]"}]}], "/.", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"\[Xi]", "\[Rule]", 
              RowBox[{
               RowBox[{"gp", "[", 
                RowBox[{"[", "j", "]"}], "]"}], "[", 
               RowBox[{"[", "1", "]"}], "]"}]}], ",", 
             RowBox[{"\[Psi]", "\[Rule]", 
              RowBox[{
               RowBox[{"gp", "[", 
                RowBox[{"[", "j", "]"}], "]"}], "[", 
               RowBox[{"[", "2", "]"}], "]"}]}], ",", 
             RowBox[{"\[Zeta]", "\[Rule]", 
              RowBox[{
               RowBox[{"gp", "[", 
                RowBox[{"[", "j", "]"}], "]"}], "[", 
               RowBox[{"[", "3", "]"}], "]"}]}]}], "}"}]}]}], ";"}]}], 
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"inode", "=", "0"}], ",", 
        RowBox[{"inode", "<", "nnodes"}], ",", 
        RowBox[{"inode", "++"}], ",", "\[IndentingNewLine]", 
        RowBox[{"For", "[", 
         RowBox[{
          RowBox[{"jnode", "=", "0"}], ",", 
          RowBox[{"jnode", "<", "nnodes"}], ",", 
          RowBox[{"jnode", "++"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"For", "[", 
            RowBox[{
             RowBox[{"idof", "=", "0"}], ",", 
             RowBox[{"idof", "<", "nmdofs"}], ",", 
             RowBox[{"idof", "++"}], ",", "\[IndentingNewLine]", 
             RowBox[{"For", "[", 
              RowBox[{
               RowBox[{"jdof", "=", "0"}], ",", 
               RowBox[{"jdof", "<", "nmdofs"}], ",", 
               RowBox[{"jdof", "++"}], ",", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{"Klocal", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "[", 
                   RowBox[{"[", 
                    RowBox[{
                    RowBox[{"inode", " ", "ndofs"}], "+", "idof", "+", "1"}], 
                    "]"}], "]"}], "[", 
                  RowBox[{"[", 
                   RowBox[{
                    RowBox[{"jnode", " ", "ndofs"}], "+", "jdof", "+", "1"}], 
                   "]"}], "]"}], " ", "=", 
                 RowBox[{
                  RowBox[{"Kelmm", "[", 
                   RowBox[{"[", 
                    RowBox[{
                    RowBox[{"inode", " ", "nmdofs"}], "+", "idof", "+", "1"}],
                     "]"}], "]"}], "[", 
                  RowBox[{"[", 
                   RowBox[{
                    RowBox[{"jnode", " ", "nmdofs"}], "+", "jdof", "+", "1"}],
                    "]"}], "]"}]}], ";"}]}], "\[IndentingNewLine]", "]"}]}], 
            "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"Klocal", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "[", 
              RowBox[{"[", 
               RowBox[{
                RowBox[{"inode", " ", "ndofs"}], "+", "nmdofs", "+", "1"}], 
               "]"}], "]"}], "[", 
             RowBox[{"[", 
              RowBox[{
               RowBox[{"jnode", " ", "ndofs"}], "+", "nmdofs", "+", "1"}], 
              "]"}], "]"}], " ", "=", 
            RowBox[{
             RowBox[{"Keltt", "[", 
              RowBox[{"[", 
               RowBox[{"inode", "+", "1"}], "]"}], "]"}], "[", 
             RowBox[{"[", 
              RowBox[{"jnode", "+", "1"}], "]"}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"For", "[", 
            RowBox[{
             RowBox[{"idof", "=", "0"}], ",", 
             RowBox[{"idof", "<", "nmdofs"}], ",", 
             RowBox[{"idof", "++"}], ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"Klocal", "[", 
                  RowBox[{"[", "i", "]"}], "]"}], "[", 
                 RowBox[{"[", 
                  RowBox[{
                   RowBox[{"inode", " ", "ndofs"}], "+", "idof", "+", "1"}], 
                  "]"}], "]"}], "[", 
                RowBox[{"[", 
                 RowBox[{
                  RowBox[{"jnode", " ", "ndofs"}], "+", "nmdofs", "+", "1"}], 
                 "]"}], "]"}], " ", "=", 
               RowBox[{"-", 
                RowBox[{
                 RowBox[{"Kelmt", "[", 
                  RowBox[{"[", 
                   RowBox[{
                    RowBox[{"inode", " ", "nmdofs"}], "+", "idof", "+", "1"}],
                    "]"}], "]"}], "[", 
                 RowBox[{"[", 
                  RowBox[{"jnode", "+", "1"}], "]"}], "]"}]}]}], ";"}]}], 
            "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", 
         "]"}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"disp", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"uv", "[", 
          RowBox[{"[", 
           RowBox[{"ids", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "]"}], "]"}], ",", 
         RowBox[{"uv", "[", 
          RowBox[{"[", 
           RowBox[{"ids", "[", 
            RowBox[{"[", "2", "]"}], "]"}], "]"}], "]"}], ",", 
         RowBox[{"uv", "[", 
          RowBox[{"[", 
           RowBox[{"ids", "[", 
            RowBox[{"[", "3", "]"}], "]"}], "]"}], "]"}], ",", 
         RowBox[{"uv", "[", 
          RowBox[{"[", 
           RowBox[{"ids", "[", 
            RowBox[{"[", "4", "]"}], "]"}], "]"}], "]"}], ",", 
         RowBox[{"uv", "[", 
          RowBox[{"[", 
           RowBox[{"ids", "[", 
            RowBox[{"[", "5", "]"}], "]"}], "]"}], "]"}], ",", 
         RowBox[{"uv", "[", 
          RowBox[{"[", 
           RowBox[{"ids", "[", 
            RowBox[{"[", "6", "]"}], "]"}], "]"}], "]"}], ",", 
         RowBox[{"uv", "[", 
          RowBox[{"[", 
           RowBox[{"ids", "[", 
            RowBox[{"[", "7", "]"}], "]"}], "]"}], "]"}], ",", 
         RowBox[{"uv", "[", 
          RowBox[{"[", 
           RowBox[{"ids", "[", 
            RowBox[{"[", "8", "]"}], "]"}], "]"}], "]"}], ",", 
         RowBox[{"uv", "[", 
          RowBox[{"[", 
           RowBox[{"ids", "[", 
            RowBox[{"[", "9", "]"}], "]"}], "]"}], "]"}], ",", 
         RowBox[{"uv", "[", 
          RowBox[{"[", 
           RowBox[{"ids", "[", 
            RowBox[{"[", "10", "]"}], "]"}], "]"}], "]"}], ",", 
         RowBox[{"uv", "[", 
          RowBox[{"[", 
           RowBox[{"ids", "[", 
            RowBox[{"[", "11", "]"}], "]"}], "]"}], "]"}], ",", 
         RowBox[{"uv", "[", 
          RowBox[{"[", 
           RowBox[{"ids", "[", 
            RowBox[{"[", "12", "]"}], "]"}], "]"}], "]"}], ",", 
         RowBox[{"uv", "[", 
          RowBox[{"[", 
           RowBox[{"ids", "[", 
            RowBox[{"[", "13", "]"}], "]"}], "]"}], "]"}], ",", 
         RowBox[{"uv", "[", 
          RowBox[{"[", 
           RowBox[{"ids", "[", 
            RowBox[{"[", "14", "]"}], "]"}], "]"}], "]"}], ",", 
         RowBox[{"uv", "[", 
          RowBox[{"[", 
           RowBox[{"ids", "[", 
            RowBox[{"[", "15", "]"}], "]"}], "]"}], "]"}], ",", 
         RowBox[{"uv", "[", 
          RowBox[{"[", 
           RowBox[{"ids", "[", 
            RowBox[{"[", "16", "]"}], "]"}], "]"}], "]"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"energyInc", "=", 
       RowBox[{"disp", ".", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Klocal", "[", 
           RowBox[{"[", "i", "]"}], "]"}], ".", "disp"}], ")"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"du", "=", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"D", "[", 
            RowBox[{"energyInc", ",", "x1"}], "]"}], ",", 
           RowBox[{"D", "[", 
            RowBox[{"energyInc", ",", "x2"}], "]"}], ",", 
           RowBox[{"D", "[", 
            RowBox[{"energyInc", ",", "x3"}], "]"}], ",", 
           RowBox[{"D", "[", 
            RowBox[{"energyInc", ",", "x4"}], "]"}], ",", 
           RowBox[{"D", "[", 
            RowBox[{"energyInc", ",", "x5"}], "]"}], ",", 
           RowBox[{"D", "[", 
            RowBox[{"energyInc", ",", "x6"}], "]"}], ",", 
           RowBox[{"D", "[", 
            RowBox[{"energyInc", ",", "x7"}], "]"}], ",", 
           RowBox[{"D", "[", 
            RowBox[{"energyInc", ",", "x8"}], "]"}], ",", 
           RowBox[{"D", "[", 
            RowBox[{"energyInc", ",", "x9"}], "]"}], ",", 
           RowBox[{"D", "[", 
            RowBox[{"energyInc", ",", "x10"}], "]"}], ",", 
           RowBox[{"D", "[", 
            RowBox[{"energyInc", ",", "x11"}], "]"}], ",", 
           RowBox[{"D", "[", 
            RowBox[{"energyInc", ",", "x12"}], "]"}]}], "}"}], "/.", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"x1", "\[Rule]", 
            RowBox[{"xv", "[", 
             RowBox[{"[", "i1", "]"}], "]"}]}], ",", 
           RowBox[{"x2", "\[Rule]", 
            RowBox[{"yv", "[", 
             RowBox[{"[", "i1", "]"}], "]"}]}], ",", 
           RowBox[{"x3", "\[Rule]", 
            RowBox[{"zv", "[", 
             RowBox[{"[", "i1", "]"}], "]"}]}], ",", 
           RowBox[{"x4", "\[Rule]", 
            RowBox[{"xv", "[", 
             RowBox[{"[", "i2", "]"}], "]"}]}], ",", 
           RowBox[{"x5", "\[Rule]", 
            RowBox[{"yv", "[", 
             RowBox[{"[", "i2", "]"}], "]"}]}], ",", 
           RowBox[{"x6", "\[Rule]", 
            RowBox[{"zv", "[", 
             RowBox[{"[", "i2", "]"}], "]"}]}], ",", 
           RowBox[{"x7", "\[Rule]", 
            RowBox[{"xv", "[", 
             RowBox[{"[", "i3", "]"}], "]"}]}], ",", 
           RowBox[{"x8", "\[Rule]", 
            RowBox[{"yv", "[", 
             RowBox[{"[", "i3", "]"}], "]"}]}], ",", 
           RowBox[{"x9", "\[Rule]", 
            RowBox[{"zv", "[", 
             RowBox[{"[", "i3", "]"}], "]"}]}], ",", 
           RowBox[{"x10", "\[Rule]", 
            RowBox[{"xv", "[", 
             RowBox[{"[", "i4", "]"}], "]"}]}], ",", 
           RowBox[{"x11", "\[Rule]", 
            RowBox[{"yv", "[", 
             RowBox[{"[", "i4", "]"}], "]"}]}], ",", 
           RowBox[{"x12", "\[Rule]", 
            RowBox[{"zv", "[", 
             RowBox[{"[", "i4", "]"}], "]"}]}]}], "}"}]}], ")"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Detj", "[", 
          RowBox[{
           RowBox[{"xv", "[", 
            RowBox[{"[", "i1", "]"}], "]"}], ",", 
           RowBox[{"yv", "[", 
            RowBox[{"[", "i1", "]"}], "]"}], ",", 
           RowBox[{"zv", "[", 
            RowBox[{"[", "i1", "]"}], "]"}], ",", 
           RowBox[{"xv", "[", 
            RowBox[{"[", "i2", "]"}], "]"}], ",", 
           RowBox[{"yv", "[", 
            RowBox[{"[", "i2", "]"}], "]"}], ",", 
           RowBox[{"zv", "[", 
            RowBox[{"[", "i2", "]"}], "]"}], ",", 
           RowBox[{"xv", "[", 
            RowBox[{"[", "i3", "]"}], "]"}], ",", 
           RowBox[{"yv", "[", 
            RowBox[{"[", "i3", "]"}], "]"}], ",", 
           RowBox[{"zv", "[", 
            RowBox[{"[", "i3", "]"}], "]"}], ",", 
           RowBox[{"xv", "[", 
            RowBox[{"[", "i4", "]"}], "]"}], ",", 
           RowBox[{"yv", "[", 
            RowBox[{"[", "i4", "]"}], "]"}], ",", 
           RowBox[{"zv", "[", 
            RowBox[{"[", "i4", "]"}], "]"}]}], "]"}], "\[GreaterEqual]", 
         "0.0"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"For", "[", 
          RowBox[{
           RowBox[{"j", "=", "1"}], ",", 
           RowBox[{"j", "\[LessEqual]", "12"}], ",", 
           RowBox[{"j", "++"}], ",", 
           RowBox[{
            RowBox[{"gradX", "[", 
             RowBox[{"[", 
              RowBox[{"xids", "[", 
               RowBox[{"[", "j", "]"}], "]"}], "]"}], "]"}], "+=", 
            RowBox[{"du", "[", 
             RowBox[{"[", "j", "]"}], "]"}]}]}], "]"}], ";"}], ",", 
        RowBox[{
         RowBox[{"For", "[", 
          RowBox[{
           RowBox[{"j", "=", "1"}], ",", 
           RowBox[{"j", "\[LessEqual]", "12"}], ",", 
           RowBox[{"j", "++"}], ",", 
           RowBox[{
            RowBox[{"gradX", "[", 
             RowBox[{"[", 
              RowBox[{"xids", "[", 
               RowBox[{"[", "j", "]"}], "]"}], "]"}], "]"}], "-=", 
            RowBox[{"du", "[", 
             RowBox[{"[", "j", "]"}], "]"}]}]}], "]"}], ";"}]}], "]"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]}], "Input",
 CellChangeTimes->{{3.76424600551651*^9, 3.7642461711801653`*^9}, {
   3.7642462028071766`*^9, 3.764246220213563*^9}, {3.764246283329853*^9, 
   3.764246293892589*^9}, {3.7642463610108213`*^9, 3.7642464906323004`*^9}, {
   3.7642465289172134`*^9, 3.764246546403119*^9}, {3.7642466386150875`*^9, 
   3.7642466547357836`*^9}, {3.7642466873858633`*^9, 3.764246732945367*^9}, {
   3.7642468131619663`*^9, 3.7642468162460403`*^9}, {3.7642468752406893`*^9, 
   3.7642468758494267`*^9}, {3.7642471307562113`*^9, 
   3.7642472796655865`*^9}, {3.764247331374629*^9, 3.7642473324519873`*^9}, {
   3.764254726830079*^9, 3.764254727571266*^9}, 3.906814874345439*^9, {
   3.906820091196525*^9, 3.9068200934194937`*^9}, {3.906820124736086*^9, 
   3.906820147494068*^9}},
 CellLabel->
  "In[124]:=",ExpressionUUID->"78f0f57c-1ecb-4d51-a360-31e5132a4ab9"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"SetPrecision", "[", 
  RowBox[{"gradX", ",", "20"}], "]"}]], "Input",
 CellChangeTimes->{{3.7209949856957116`*^9, 3.7209949866369324`*^9}, {
  3.720995044627005*^9, 3.720995050464894*^9}, {3.7210497813919053`*^9, 
  3.7210497819111586`*^9}, {3.7230570968479857`*^9, 3.7230571009733553`*^9}, {
  3.7230574419255185`*^9, 3.7230574467536917`*^9}, {3.764247363281391*^9, 
  3.764247364672212*^9}, {3.764248028186861*^9, 3.764248029554489*^9}},
 CellLabel->
  "In[128]:=",ExpressionUUID->"8b6c38ef-92c0-484b-a3cd-e794f61a36d1"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "0.77589451852410240562107901496347039938`20.", ",", 
   "0.08051281981948724131292749461863422766`20.", ",", 
   RowBox[{"-", "0.15128107974871790597504173092602286488`20."}], ",", 
   "0.64807554557692292895865193713689222932`20.", ",", 
   RowBox[{"-", "0.05115276017384609574811804577620932832`20."}], ",", 
   "0.11653820095846151305707394385535735637`20.", ",", 
   RowBox[{"-", "0.12781799794717940699229075107723474503`20."}], ",", 
   RowBox[{"-", "0.1316653549933332889576576008039410226`20."}], ",", 
   "0.26781880570717936373981160613766405731`20.", ",", 
   "0.70691955904307679503517647390253841877`20.", ",", 
   "0.36922902403076901522993580329057294875`20.", ",", 
   RowBox[{"-", "0.27768997170564080345656066128867678344`20."}], ",", 
   "0.38230950366769222981133680150378495455`20.", ",", 
   "0.39461479325538484363988800396327860653`20.", ",", 
   "0.13153826441846147576875125650985864922`20.", ",", 
   RowBox[{"-", "0.32460870537538444313696572862681932747`20."}], ",", 
   "0.02538621922461534868853405555455537979`20.", ",", 
   "0.40922748612410247970316845567140262574`20.", ",", 
   RowBox[{"-", "0.06897270948102565690795984210126334801`20."}], ",", 
   "0.28871530421128194232593955348420422524`20.", ",", 
   RowBox[{"-", "0.12640904195692306832832230156782316044`20."}], ",", 
   RowBox[{"-", "0.26576334190923095457392832940968219191`20."}], ",", 
   "0.44576575342923063782762937989900819957`20.", ",", 
   "0.01500036346000011011625474566244520247`20.", ",", 
   RowBox[{"-", "0.19679025742820505096020156088343355805`20."}], ",", 
   "0.15705067421794866033835091911896597594`20.", ",", 
   "0.14140913041692304563667903494206257164`20.", ",", 
   "0.97267967595230775401660139323212206364`20.", ",", 
   RowBox[{"-", "0.07653780439846172289897197060781763867`20."}], ",", 
   RowBox[{"-", "0.29268854349897427402638072635454591364`20."}], ",", 
   "0.91383716248615354249551501197856850922`20.", ",", 
   RowBox[{"-", "0.49691708860307670647671329788863658905`20."}], ",", 
   "0.10153746249846164195762554527391330339`20.", ",", 
   RowBox[{"-", "0.05884116346615367310057820304791675881`20."}], ",", 
   RowBox[{"-", "0.4203788342046152481934484512748895213`20."}], ",", 
   "0.39422525599743579727274322976882103831`20.", ",", 
   "1.03152226441846139870506249280879274011`20.", ",", 
   "0.34384075480615405862039324347279034555`20.", ",", 
   RowBox[{"-", "0.68691409116307644566745693737175315619`20."}], ",", 
   "2.498001805406602215953171253204345703125`20.*^-16", ",", 
   "4.163336342344337026588618755340576171875`20.*^-17", ",", 
   "9.714451465470119728706777095794677734375`20.*^-17", ",", 
   RowBox[{"-", "1.03151956441846159862052445532754063606`20."}], ",", 
   RowBox[{"-", "0.34383985480615436580720256642962340266`20."}], ",", 
   "0.68691259116307668008971631934400647879`20.", ",", 
   "0.05884528846615341701742352142900926992`20.", ",", 
   "0.42037675920461448075826638159924186766`20.", ",", 
   RowBox[{"-", "0.39422524766410249608128424370079301298`20."}], ",", 
   RowBox[{"-", "0.91383176248615338721492662443779408932`20."}], ",", 
   "0.49691348860307682500092596455942839384`20.", ",", 
   RowBox[{"-", "0.10153686249846141653740971833030926064`20."}], ",", 
   RowBox[{"-", "0.9726757009523072650125641303020529449`20."}], ",", 
   "0.07653717939846170492668164797578356229`20.", ",", 
   "0.2926876351656407249102187506650807336`20.", ",", 
   "0.19678583242820515963877880949439713731`20.", ",", 
   RowBox[{"-", "0.15704994921794862561270633705134969205`20."}], ",", 
   RowBox[{"-", "0.14140813875025645685035158294340362772`20."}], ",", 
   "0.26575756690923069136545109358849003911`20.", ",", 
   RowBox[{"-", "0.4457629784292307384419018490007147193`20."}], ",", 
   RowBox[{"-", "0.01500028846000017734851894601888488978`20."}], ",", 
   "0.06897210948102552863225866985885659233`20.", ",", 
   RowBox[{"-", "0.28871280421128214799253441924520302564`20."}], ",", 
   "0.12640757529025645200526639655436156318`20.", ",", 
   "0.32459865537538423740926418759045191109`20.", ",", 
   RowBox[{"-", "0.02538691922461566718993708491325378418`20."}], ",", 
   RowBox[{"-", "0.40922366945743554600412039690127130598`20."}], ",", 
   RowBox[{"-", "0.38231760366769207415416076401015743613`20."}], ",", 
   RowBox[{"-", "0.39461209325538493253304750396637246013`20."}], ",", 
   RowBox[{"-", "0.13153736441846203275574112012691330165`20."}], ",", 
   RowBox[{"-", "0.70691490904307696663266824543825350702`20."}], ",", 
   RowBox[{"-", "0.36922472403076916913633453987131360918`20."}], ",", 
   "0.27768555503897407454871881782310083508`20.", ",", 
   "0.12781327294717981235550041674287058413`20.", ",", 
   "0.13166212999333329336515419072384247556`20.", ",", 
   RowBox[{"-", "0.26781508070717946479177840046759229153`20."}], ",", 
   RowBox[{"-", "0.64807247057692274339046889508608728647`20."}], ",", 
   "0.05114908517384615660450464247333002277`20.", ",", 
   RowBox[{"-", "0.11653677595846112513555681289290077984`20."}], ",", 
   RowBox[{"-", "0.77588476852410204198662313501699827611`20."}], ",", 
   RowBox[{"-", "0.08051281981948746335753241964994231239`20."}], ",", 
   "0.1512778297487178402747076688683591783`20."}], "}"}]], "Output",
 CellChangeTimes->{3.720994987716754*^9, 3.7209950515695486`*^9, 
  3.721047011769689*^9, 3.721049783085235*^9, 3.7210616458831215`*^9, 
  3.7230549598023367`*^9, 3.723057053332902*^9, 3.723057102083436*^9, 
  3.7230574482999644`*^9, 3.7230575621588583`*^9, 3.723058428273193*^9, 
  3.764247524736701*^9, 3.764248030454146*^9, 3.850325989533304*^9, 
  3.906746267622693*^9, 3.906816366552599*^9, 3.906819618031509*^9, 
  3.9068203934325047`*^9, 3.906821289706399*^9, 3.906822338327339*^9, 
  3.90682259810216*^9, 3.906822868034203*^9, 3.906823314960956*^9, 
  3.9068236608534937`*^9, 3.907257942746798*^9},
 CellLabel->
  "Out[128]=",ExpressionUUID->"98e6e97e-6afd-4817-8b57-2094cccacebc"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
},
WindowSize->{570, 762},
WindowMargins->{{Automatic, 252}, {Automatic, 0}},
PrintingCopies->1,
PrintingPageRange->{Automatic, Automatic},
PrivateNotebookOptions->{"VersionedStylesheet"->{"Default.nb"[8.] -> False}},
TaggingRules-><|"TryRealOnly" -> False|>,
Magnification:>0.75 Inherited,
FrontEndVersion->"13.3 for Linux x86 (64-bit) (June 3, 2023)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"649893d9-5402-40bc-8cd9-259bc1bfb5da"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 290, 4, 74, "Title",ExpressionUUID->"771e95de-c1e0-4cb0-b95b-188d71903383"],
Cell[873, 28, 534, 8, 22, "Input",ExpressionUUID->"e60664fb-ad25-4fbd-8f55-21a63ccade1e"],
Cell[CellGroupData[{
Cell[1432, 40, 272, 5, 41, "Subsection",ExpressionUUID->"4a7a747f-5137-48e0-801e-adfd224e3d96"],
Cell[1707, 47, 571, 11, 22, "Input",ExpressionUUID->"fc9a7eb8-3e91-40c3-b7be-38c80e7f0144"]
}, Open  ]],
Cell[CellGroupData[{
Cell[2315, 63, 1373, 40, 66, "Subsection",ExpressionUUID->"53eada42-ca3e-42bd-b0b0-c31c412a1992"],
Cell[3691, 105, 1551, 48, 164, "Input",ExpressionUUID->"3f927f14-3a11-4830-a6a6-d270587527ba"]
}, Open  ]],
Cell[CellGroupData[{
Cell[5279, 158, 412, 13, 42, "Subsection",ExpressionUUID->"e3834ce3-cb36-4e14-baa8-6f292a0d07e4"],
Cell[CellGroupData[{
Cell[5716, 175, 1311, 35, 22, "Input",ExpressionUUID->"9af17278-f128-4f02-919c-3be62331686b"],
Cell[7030, 212, 2504, 58, 60, "Output",ExpressionUUID->"cabbda43-3ff8-4da1-84a7-b56d08429ee2"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[9583, 276, 186, 3, 41, "Subsection",ExpressionUUID->"51fac0ff-1b91-4c89-9b7c-96ac8b6630cb"],
Cell[9772, 281, 243, 5, 22, "Input",ExpressionUUID->"086d4aa6-523d-463b-be06-f8ec08bff819"]
}, Open  ]],
Cell[CellGroupData[{
Cell[10052, 291, 184, 3, 41, "Subsection",ExpressionUUID->"54dd63dc-da38-481f-95b6-1bb85f47dadc"],
Cell[10239, 296, 403, 8, 24, "Input",ExpressionUUID->"5e63601b-e173-4e5e-9cd7-7e3741f40ed1"]
}, Open  ]],
Cell[CellGroupData[{
Cell[10679, 309, 910, 28, 63, "Subsection",ExpressionUUID->"91f33a9d-5463-42e5-937f-abaa5c2812d5"],
Cell[11592, 339, 722, 17, 22, "Input",ExpressionUUID->"18dc3d08-39a5-49ed-b484-e1462a1e5703"],
Cell[12317, 358, 789, 13, 22, "Input",ExpressionUUID->"db5ba82c-c666-484b-990e-75c1bea963ae"]
}, Open  ]],
Cell[CellGroupData[{
Cell[13143, 376, 173, 3, 41, "Subsection",ExpressionUUID->"a4634761-5f01-4334-8928-a93cfab6a12e"],
Cell[13319, 381, 7169, 187, 191, "Input",ExpressionUUID->"e6750456-352d-4b51-b4b9-61e222a811e1"]
}, Open  ]],
Cell[CellGroupData[{
Cell[20525, 573, 174, 3, 41, "Subsection",ExpressionUUID->"3b966684-148f-4354-b993-32ea79514c3a"],
Cell[CellGroupData[{
Cell[20724, 580, 5441, 157, 256, "Input",ExpressionUUID->"56bef7e8-9c24-4c0a-bc52-38851c79f249"],
Cell[26168, 739, 4714, 131, 161, "Output",ExpressionUUID->"db0fefa6-3f14-48b1-9d0d-09c9c984185e"],
Cell[30885, 872, 1945, 38, 60, "Output",ExpressionUUID->"cf8cc942-cef3-4f01-a497-a634d3644b78"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[32879, 916, 370, 8, 61, "Subsection",ExpressionUUID->"7f2325a2-777e-49ff-88ec-91efc948f3c4"],
Cell[33252, 926, 5483, 144, 242, "Input",ExpressionUUID->"fc7cdb0c-6834-415f-9be9-95db28b285b9"],
Cell[38738, 1072, 825, 16, 68, "Input",ExpressionUUID->"a9dd6fc3-97c0-491e-8c8b-d90dc15a4001"],
Cell[CellGroupData[{
Cell[39588, 1092, 174, 3, 34, "Subsubsection",ExpressionUUID->"28e601ce-bfae-4e94-b74f-ec7ecd125c77"],
Cell[39765, 1097, 650, 16, 38, "Input",ExpressionUUID->"36bc45a4-325a-4aa4-84ef-372a151833d7"]
}, Open  ]],
Cell[CellGroupData[{
Cell[40452, 1118, 172, 3, 34, "Subsubsection",ExpressionUUID->"4262d29f-7535-4693-9364-d166d121a7b6"],
Cell[40627, 1123, 1290, 32, 91, "Input",ExpressionUUID->"44b73894-aa8c-4485-943c-95e9a000b9a8"],
Cell[41920, 1157, 1450, 38, 87, "Input",ExpressionUUID->"6cc1fb1f-7213-47ba-9752-e7008690a404"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[43419, 1201, 283, 6, 41, "Subsection",ExpressionUUID->"989f3063-be7b-4b8a-9a78-3a82814ce7c7"],
Cell[43705, 1209, 4553, 106, 145, "Input",ExpressionUUID->"c01a37d6-773b-4d01-b998-8e2872d677f3"],
Cell[48261, 1317, 2062, 38, 106, "Input",ExpressionUUID->"4c025298-5d73-48ed-a7da-0e00b826e80d"],
Cell[CellGroupData[{
Cell[50348, 1359, 361, 8, 22, "Input",ExpressionUUID->"0453cf91-07b9-43fa-8817-5f2de806bf71"],
Cell[50712, 1369, 1555, 24, 25, "Output",ExpressionUUID->"c537ef6b-df38-453e-ac6e-c042f961699b"]
}, Open  ]],
Cell[52282, 1396, 1883, 54, 118, "Input",ExpressionUUID->"2b5fbef1-aed0-41b9-b95d-9d13cf671b8b"],
Cell[54168, 1452, 1803, 53, 118, "Input",ExpressionUUID->"4806e59d-077e-4506-b247-bed9963cf8be"]
}, Open  ]],
Cell[CellGroupData[{
Cell[56008, 1510, 602, 8, 40, "Subsection",ExpressionUUID->"09d16991-86e5-4930-8f3c-cee753764178"],
Cell[56613, 1520, 1098, 23, 53, "Input",ExpressionUUID->"851f8080-6153-4056-98ca-c9ef3726099c"],
Cell[57714, 1545, 7131, 149, 201, "Input",ExpressionUUID->"43ebea43-99df-4425-8b86-298a2464caaf"],
Cell[CellGroupData[{
Cell[64870, 1698, 948, 19, 22, "Input",ExpressionUUID->"3cad78f2-5e1c-4674-b57e-f381bb95c25f"],
Cell[65821, 1719, 7162, 165, 194, "Output",ExpressionUUID->"3fb135e8-e441-456c-a550-6930a3be3ee1"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[73032, 1890, 686, 10, 40, "Subsection",ExpressionUUID->"19c11695-01af-4181-9f67-a648f94d389b"],
Cell[73721, 1902, 1147, 22, 38, "Input",ExpressionUUID->"ec9bbd20-fef2-49e3-8f31-b872ccab3ad3"],
Cell[74871, 1926, 7136, 146, 136, "Input",ExpressionUUID->"e3eb67e3-02c0-4e32-951c-fa06df0766dc"],
Cell[CellGroupData[{
Cell[82032, 2076, 996, 20, 22, "Input",ExpressionUUID->"8eb943eb-a033-41de-b6a6-00a7d6b52d7d"],
Cell[83031, 2098, 7267, 168, 197, "Output",ExpressionUUID->"61c63558-ab02-4283-aad7-293f1fefe6fa"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[90347, 2272, 683, 10, 40, "Subsection",ExpressionUUID->"8015ca1e-971e-4630-adf2-45cea31b08ab"],
Cell[91033, 2284, 1148, 22, 38, "Input",ExpressionUUID->"bee8cdb9-929d-4f0a-aa63-c93d3d14da84"],
Cell[92184, 2308, 9053, 191, 234, "Input",ExpressionUUID->"30824ff5-afa1-47b3-bd16-a34ceac1ad24"],
Cell[CellGroupData[{
Cell[101262, 2503, 1047, 21, 22, "Input",ExpressionUUID->"cf3f18e4-2463-4120-a70e-cbdc1690e0af"],
Cell[102312, 2526, 7275, 167, 194, "Output",ExpressionUUID->"5bc27110-c776-477c-975e-fb1d9955cdd3"]
}, Open  ]],
Cell[109602, 2696, 1099, 22, 38, "Input",ExpressionUUID->"f9de8d39-051b-4f66-8aa7-1b4a42ff02b8"],
Cell[110704, 2720, 5796, 116, 133, "Input",ExpressionUUID->"ce75a897-c9bf-4e52-901c-ba13cbc04188"],
Cell[CellGroupData[{
Cell[116525, 2840, 1093, 20, 22, "Input",ExpressionUUID->"ff016f88-a171-401e-a033-7b7fad4b294b"],
Cell[117621, 2862, 3988, 101, 102, "Output",ExpressionUUID->"c0798d8a-c247-4371-808b-348cd2c3eb8e"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[121658, 2969, 569, 9, 40, "Subsection",ExpressionUUID->"5860f7f5-2d1c-48b4-8888-7ed0fda6f20a"],
Cell[122230, 2980, 1023, 20, 38, "Input",ExpressionUUID->"872f2a55-0e59-488c-8b5e-47561c639dde"],
Cell[123256, 3002, 6968, 148, 167, "Input",ExpressionUUID->"6d4057dd-1d33-4d6c-90c8-28d3276321c5"],
Cell[CellGroupData[{
Cell[130249, 3154, 810, 16, 22, "Input",ExpressionUUID->"9c27492e-386f-4ab0-b3cc-16819c9b77e8"],
Cell[131062, 3172, 1720, 30, 44, "Output",ExpressionUUID->"3dda9842-42d1-47b6-9407-364399b7506e"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[132831, 3208, 179, 3, 41, "Subsection",ExpressionUUID->"57b92da3-4a18-4aa2-8b87-12b63d36cd9a"],
Cell[133013, 3213, 1246, 26, 38, "Input",ExpressionUUID->"68f460db-017a-43ee-8bb2-c26c0b7a873a"],
Cell[134262, 3241, 22544, 522, 771, "Input",ExpressionUUID->"7588e917-d549-496a-a98d-a702386e3173"],
Cell[CellGroupData[{
Cell[156831, 3767, 2899, 79, 99, "Input",ExpressionUUID->"7926ee95-92f2-4436-8d86-30cb41cf9de0"],
Cell[159733, 3848, 3385, 55, 182, "Output",ExpressionUUID->"a1b220bd-66f8-47c0-98ef-c71a0e5684e8"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[163167, 3909, 298, 4, 41, "Subsection",ExpressionUUID->"1a00b5e1-9901-401d-87d8-a2fa8b5fc56d"],
Cell[163468, 3915, 1001, 17, 38, "Input",ExpressionUUID->"e573a390-9a7b-4e8e-ac74-d5c4a6746f04"],
Cell[164472, 3934, 17164, 391, 660, "Input",ExpressionUUID->"eeecd4b6-94c2-4ba2-adaf-b5dce8509318"],
Cell[CellGroupData[{
Cell[181661, 4329, 3215, 83, 191, "Input",ExpressionUUID->"378e4713-a8c0-4cc5-bb6a-c448a09a26a9"],
Cell[184879, 4414, 1193, 18, 71, "Output",ExpressionUUID->"de838bbb-ef95-4d7b-8056-36488475c2bc"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[186121, 4438, 318, 5, 41, "Subsection",ExpressionUUID->"1c35546a-ed60-4e5e-954b-f646316d618d"],
Cell[186442, 4445, 27392, 652, 1101, "Input",ExpressionUUID->"7d0d04f0-a55d-4e39-a92c-9b0e1a1bb5f8"],
Cell[CellGroupData[{
Cell[213859, 5101, 347, 6, 22, "Input",ExpressionUUID->"28d23028-aa6b-4960-9054-22d9805ea509"],
Cell[214209, 5109, 7522, 118, 516, "Output",ExpressionUUID->"dcde3ae9-1968-425c-9751-e9ee8dcc405c"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[221780, 5233, 387, 6, 41, "Subsection",ExpressionUUID->"67096089-1c8f-45bf-b9c7-112140cf8b33"],
Cell[222170, 5241, 29555, 701, 1193, "Input",ExpressionUUID->"79bdf52c-4e6a-4b5d-b66a-eb57b393b808"],
Cell[251728, 5944, 287, 6, 22, "Input",ExpressionUUID->"3956f888-77ef-45eb-90f5-1c691aa3fb44"],
Cell[CellGroupData[{
Cell[252040, 5954, 2255, 59, 99, "Input",ExpressionUUID->"b0592e7e-8d14-4787-b139-86a2775b4a67"],
Cell[254298, 6015, 2153, 34, 114, "Output",ExpressionUUID->"4cf14b84-16b3-4df0-8962-3a698fd53393"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[256500, 6055, 438, 6, 41, "Subsection",ExpressionUUID->"41c3a2d8-57a1-4802-ab6b-52ea4c1b5d2b"],
Cell[256941, 6063, 30953, 736, 1384, "Input",ExpressionUUID->"729b7cf2-3b50-4314-a343-ff8d4a04eb50"],
Cell[CellGroupData[{
Cell[287919, 6803, 3596, 88, 222, "Input",ExpressionUUID->"3d3d99c0-d4ba-4488-9545-7606b0076acc"],
Cell[291518, 6893, 4008, 63, 267, "Output",ExpressionUUID->"d382834c-f167-4640-82b1-1694cf14bfae"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[295575, 6962, 226, 4, 41, "Subsection",ExpressionUUID->"c18a08aa-1052-4e2e-a5b7-fa2612be9948"],
Cell[295804, 6968, 20879, 486, 859, "Input",ExpressionUUID->"0a238f2d-bf64-41f2-920d-affe3a1b917c"],
Cell[CellGroupData[{
Cell[316708, 7458, 188, 3, 22, "Input",ExpressionUUID->"fe05d70c-8185-4d11-b127-8cd00ee2c055"],
Cell[316899, 7463, 1964, 33, 129, "Output",ExpressionUUID->"a5259f55-b8e7-4e1a-b88c-d255c76f5f84"]
}, Open  ]],
Cell[CellGroupData[{
Cell[318900, 7501, 530, 14, 22, "Input",ExpressionUUID->"737fd114-524f-47a0-9aff-a5b08bef7aee"],
Cell[319433, 7517, 580, 8, 36, "Output",ExpressionUUID->"a91e2d68-8315-4b04-b59d-610f12db27d6"]
}, Open  ]],
Cell[CellGroupData[{
Cell[320050, 7530, 373, 9, 22, "Input",ExpressionUUID->"f7bb990d-323e-45bd-927f-2f52684acbf7"],
Cell[320426, 7541, 577, 8, 36, "Output",ExpressionUUID->"152afa11-0931-4bf3-96c4-b6abb35f8074"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[321052, 7555, 293, 4, 41, "Subsection",ExpressionUUID->"8db94860-4381-472d-bf4a-ca4b694f0cc9"],
Cell[321348, 7561, 19626, 504, 982, "Input",ExpressionUUID->"ab068d40-5e07-441e-8a70-30d25efbd6c2"],
Cell[CellGroupData[{
Cell[340999, 8069, 184, 3, 22, "Input",ExpressionUUID->"97d7c002-a3e5-4c5a-9ecd-414e654238df"],
Cell[341186, 8074, 1316, 23, 83, "Output",ExpressionUUID->"e18283f6-2623-431c-81a2-d10faba35b5f"]
}, Open  ]],
Cell[CellGroupData[{
Cell[342539, 8102, 295, 6, 22, "Input",ExpressionUUID->"4169b468-74d1-4d99-8c3e-8047fdd48880"],
Cell[342837, 8110, 2187, 39, 159, "Output",ExpressionUUID->"c646a107-7bd1-4931-94dc-2f61d20832ee"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[345073, 8155, 344, 5, 41, "Subsection",ExpressionUUID->"a07c66af-25da-465b-89bb-9c0d7e740fe6"],
Cell[345420, 8162, 21717, 552, 1014, "Input",ExpressionUUID->"e3aeff08-53d9-4e77-8c83-112bbac04ddf"],
Cell[CellGroupData[{
Cell[367162, 8718, 348, 7, 22, "Input",ExpressionUUID->"39d7f66b-6fe6-45be-b1a2-2f2f6b882af9"],
Cell[367513, 8727, 7879, 119, 543, "Output",ExpressionUUID->"7b057146-b3a0-4ae2-b257-3cbce872e26b"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[375441, 8852, 398, 6, 41, "Subsection",ExpressionUUID->"07433628-474a-44e7-a865-44770d6d2336"],
Cell[375842, 8860, 23420, 604, 1132, "Input",ExpressionUUID->"78f0f57c-1ecb-4d51-a360-31e5132a4ab9"],
Cell[CellGroupData[{
Cell[399287, 9468, 546, 9, 22, "Input",ExpressionUUID->"8b6c38ef-92c0-484b-a3cd-e794f61a36d1"],
Cell[399836, 9479, 5956, 94, 454, "Output",ExpressionUUID->"98e6e97e-6afd-4817-8b57-2094cccacebc"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}
]
*)

