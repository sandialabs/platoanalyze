(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    273182,       6561]
NotebookOptionsPosition[    266486,       6339]
NotebookOutlinePosition[    266949,       6357]
CellTagsIndexPosition[    266906,       6354]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell[TextData[{
 "Definitions for linear ",
 StyleBox["thermostatics",
  IgnoreSpellCheck->True],
 ":"
}], "Title",
 CellChangeTimes->{{3.7227097911277695`*^9, 3.7227098092418723`*^9}, {
  3.722710006292494*^9, 3.722710010158146*^9}}],

Cell[CellGroupData[{

Cell["Define Tri3 basis functions in parent coordinates \
(\[Xi],\[Psi],\[Zeta]):", "Subsection",
 CellChangeTimes->{{3.717170430098735*^9, 3.717170455794014*^9}, {
  3.717367163060734*^9, 3.717367164420561*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"\[Phi]s", "=", 
   RowBox[{"{", 
    RowBox[{"\[Xi]", ",", "\[Psi]", ",", "\[Zeta]", ",", 
     RowBox[{"1", "-", "\[Xi]", "-", "\[Psi]", "-", "\[Zeta]"}]}], "}"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.717159762670228*^9, 3.717159772862687*^9}, 
   3.7171704577284317`*^9, {3.7173671489361877`*^9, 3.717367156764295*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "Define local nodal coordinate arrays, X, Y, and Z, and compute the \
position, ",
 Cell[BoxData[
  FormBox[
   RowBox[{"x", " ", "=", 
    RowBox[{"\[Sum]", 
     RowBox[{
      RowBox[{
       SubscriptBox["\[Phi]", "I"], "[", 
       RowBox[{"\[Xi]", ",", "\[Psi]", ",", "\[Zeta]"}], "]"}], 
      SubscriptBox["X", "I"]}]}]}], TraditionalForm]]],
 ", ",
 Cell[BoxData[
  FormBox[
   RowBox[{"y", " ", "=", " ", 
    RowBox[{"\[Sum]", 
     RowBox[{
      RowBox[{
       SubscriptBox["\[Phi]", "I"], "[", 
       RowBox[{"\[Xi]", ",", "\[Psi]", ",", "\[Zeta]"}], "]"}], 
      SubscriptBox["Y", "I"]}]}]}], TraditionalForm]]],
 ", and  ",
 Cell[BoxData[
  FormBox[
   RowBox[{"z", " ", "=", " ", 
    RowBox[{"\[Sum]", 
     RowBox[{
      RowBox[{
       SubscriptBox["\[Phi]", "I"], "[", 
       RowBox[{"\[Xi]", ",", "\[Psi]", ",", "\[Zeta]"}], "]"}], 
      RowBox[{
       SubscriptBox["Z", "I"], ":"}]}]}]}], TraditionalForm]]]
}], "Subsection",
 CellChangeTimes->{{3.717170467034111*^9, 3.717170646080793*^9}, {
  3.7173672533732233`*^9, 3.717367296127637*^9}, {3.7173676524772353`*^9, 
  3.7173676768522606`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"X", "=", 
   RowBox[{"{", 
    RowBox[{"x1", ",", "x2", ",", "x3", ",", "x4"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Y", "=", 
   RowBox[{"{", 
    RowBox[{"y1", ",", "y2", ",", "y3", ",", "y4"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Z", "=", 
   RowBox[{"{", 
    RowBox[{"z1", ",", "z2", ",", "z3", ",", "z4"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"x", "=", 
   RowBox[{
    UnderoverscriptBox["\[Sum]", 
     RowBox[{"i", "=", "1"}], "4"], 
    RowBox[{
     RowBox[{"\[Phi]s", "[", 
      RowBox[{"[", "i", "]"}], "]"}], "*", 
     RowBox[{"X", "[", 
      RowBox[{"[", "i", "]"}], "]"}]}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"y", "=", 
   RowBox[{
    UnderoverscriptBox["\[Sum]", 
     RowBox[{"i", "=", "1"}], "4"], 
    RowBox[{
     RowBox[{"\[Phi]s", "[", 
      RowBox[{"[", "i", "]"}], "]"}], "*", 
     RowBox[{"Y", "[", 
      RowBox[{"[", "i", "]"}], "]"}]}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"z", "=", 
   RowBox[{
    UnderoverscriptBox["\[Sum]", 
     RowBox[{"i", "=", "1"}], "4"], 
    RowBox[{
     RowBox[{"\[Phi]s", "[", 
      RowBox[{"[", "i", "]"}], "]"}], "*", 
     RowBox[{"Z", "[", 
      RowBox[{"[", "i", "]"}], "]"}]}]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.716761356116639*^9, 3.71676136863325*^9}, 
   3.717159777614208*^9, {3.717367683976516*^9, 3.7173677669144773`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "Define the Jacobian matrix, ",
 Cell[BoxData[
  FormBox[
   RowBox[{"J", "=", 
    RowBox[{
     SubscriptBox["dx", "i"], "/", 
     SubscriptBox["d\[Xi]", "j"]}]}], TraditionalForm]]],
 ":"
}], "Subsection",
 CellChangeTimes->{{3.7171706589407587`*^9, 3.717170706016591*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   RowBox[{"J", "=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"D", "[", 
         RowBox[{"x", ",", "\[Xi]"}], "]"}], ",", 
        RowBox[{"D", "[", 
         RowBox[{"x", ",", "\[Psi]"}], "]"}], ",", 
        RowBox[{"D", "[", 
         RowBox[{"x", ",", "\[Zeta]"}], "]"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"D", "[", 
         RowBox[{"y", ",", "\[Xi]"}], "]"}], ",", 
        RowBox[{"D", "[", 
         RowBox[{"y", ",", "\[Psi]"}], "]"}], ",", 
        RowBox[{"D", "[", 
         RowBox[{"y", ",", "\[Zeta]"}], "]"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"D", "[", 
         RowBox[{"z", ",", "\[Xi]"}], "]"}], ",", 
        RowBox[{"D", "[", 
         RowBox[{"z", ",", "\[Psi]"}], "]"}], ",", 
        RowBox[{"D", "[", 
         RowBox[{"z", ",", "\[Zeta]"}], "]"}]}], "}"}]}], "}"}]}], ")"}], "//",
   "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.717159400798109*^9, 3.717159402472238*^9}, {
   3.7171594670820827`*^9, 3.717159481884482*^9}, {3.717159528167789*^9, 
   3.7171595453911543`*^9}, 3.717159782011516*^9, {3.7173677887268276`*^9, 
   3.7173678325554037`*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{"x1", "-", "x4"}], 
      RowBox[{"x2", "-", "x4"}], 
      RowBox[{"x3", "-", "x4"}]},
     {
      RowBox[{"y1", "-", "y4"}], 
      RowBox[{"y2", "-", "y4"}], 
      RowBox[{"y3", "-", "y4"}]},
     {
      RowBox[{"z1", "-", "z4"}], 
      RowBox[{"z2", "-", "z4"}], 
      RowBox[{"z3", "-", "z4"}]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.7167614354761105`*^9, 3.716765302982686*^9, 
  3.7171556785772953`*^9, 3.717157543718261*^9, 3.717159484292647*^9, 
  3.717159565326777*^9, 3.717159783432115*^9, 3.717354900932816*^9, 
  3.7173678516174393`*^9, 3.717417860423373*^9, 3.720268227067238*^9, 
  3.720806396391696*^9, 3.7209936838639107`*^9, 3.721061216314333*^9, 
  3.722710226636188*^9, 3.7239049426662817`*^9, 3.726518721086444*^9, 
  3.72842765812936*^9, 3.7404310495142593`*^9, 3.8491095664338493`*^9, 
  3.8491229060672827`*^9, 3.8503240087204103`*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Define the determinant of the Jacobian:", "Subsection",
 CellChangeTimes->{{3.717170742514415*^9, 3.71717075277886*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"detj", "=", 
   RowBox[{"Det", "[", "J", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{3.717157550322625*^9, 3.71741786843908*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Define the inverse of the Jacobian:", "Subsection",
 CellChangeTimes->{{3.7171707115541143`*^9, 3.71717072339587*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"InvJ", " ", "=", " ", 
   RowBox[{"Simplify", "[", " ", 
    RowBox[{"Inverse", "[", "J", "]"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{
  3.7167614674219794`*^9, 3.716762132096217*^9, 3.717157545859642*^9, 
   3.7173678815154886`*^9, {3.7173685526975317`*^9, 3.717368591121168*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "Define the derivative of the basis function wrt parent coordinates, ",
 Cell[BoxData[
  FormBox[
   RowBox[{"d\[Phi]", "/", 
    SubscriptBox["d\[Xi]", "i"]}], TraditionalForm]]],
 ", and wrt physical coordinates, ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"d\[Phi]", "/", 
     SubscriptBox["dx", "i"]}], "=", 
    RowBox[{"(", 
     RowBox[{"d\[Phi]", "/", 
      SubscriptBox["d\[Xi]", "k"]}]}]}], TraditionalForm]]],
 ")( ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["d\[Xi]", "k"], "/", 
    SubscriptBox["dx", "i"]}], TraditionalForm]]],
 "):"
}], "Subsection",
 CellChangeTimes->{{3.717170774772771*^9, 3.7171709274438047`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"D\[Phi]D\[Xi]", "=", 
   RowBox[{"Transpose", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"D", "[", 
       RowBox[{"\[Phi]s", ",", "\[Xi]"}], "]"}], ",", 
      RowBox[{"D", "[", 
       RowBox[{"\[Phi]s", ",", "\[Psi]"}], "]"}], ",", 
      RowBox[{"D", "[", 
       RowBox[{"\[Phi]s", ",", "\[Zeta]"}], "]"}]}], "}"}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.716762040827201*^9, 3.7167620550573683`*^9}, {
   3.7167622782753077`*^9, 3.7167622879320135`*^9}, {3.717159585262508*^9, 
   3.7171596049010277`*^9}, 3.717170767862856*^9, {3.7173679090158405`*^9, 
   3.7173679140631857`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"D\[Phi]Dx", "=", 
   RowBox[{"Simplify", "[", 
    RowBox[{"Transpose", "[", 
     RowBox[{"D\[Phi]D\[Xi]", ".", "InvJ"}], "]"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.7167620697517557`*^9, 3.7167621221822166`*^9}, {
  3.7167623794326005`*^9, 3.7167624191349125`*^9}, {3.717159618780408*^9, 
  3.717159620088848*^9}, {3.7171599769229116`*^9, 3.717159996771841*^9}, {
  3.717170940753901*^9, 3.7171709490170727`*^9}, {3.7171709936534357`*^9, 
  3.717171005961763*^9}, {3.7173600965536957`*^9, 3.717360100742365*^9}, {
  3.7173685313367987`*^9, 3.7173685371065826`*^9}, {3.7173686082063704`*^9, 
  3.717368609587582*^9}, {3.717417891626897*^9, 3.717417893049127*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Define the gradient matrix:", "Subsection",
 CellChangeTimes->{{3.7171710170541*^9, 3.717171027281568*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"B", "=", "D\[Phi]Dx"}], ";"}]], "Input",
 CellChangeTimes->{{3.7173602746482644`*^9, 3.717360595407016*^9}, {
  3.7173679545623984`*^9, 3.717368016994071*^9}, {3.7173686738090096`*^9, 
  3.7173688008877954`*^9}, {3.717369134558451*^9, 3.7173691870734324`*^9}, {
  3.717415750201002*^9, 3.7174157973412743`*^9}, {3.7174158656066456`*^9, 
  3.717415993127372*^9}, {3.7174178972678013`*^9, 3.717417921642746*^9}, {
  3.722710120055441*^9, 3.722710124298463*^9}, {3.7227102687949667`*^9, 
  3.7227102689430313`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Define a stiffness tensor:", "Subsection",
 CellChangeTimes->{{3.717171037170329*^9, 3.717171055154701*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   RowBox[{"S", "=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"\[Mu]", ",", "0", ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "\[Mu]", ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "\[Mu]"}], "}"}]}], "}"}]}], ")"}], "//", 
  "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.7167628480497184`*^9, 3.716762972237756*^9}, {
  3.716763132980883*^9, 3.7167631890087504`*^9}, {3.717157475771058*^9, 
  3.717157528260871*^9}, {3.7174160414866905`*^9, 3.717416148690319*^9}, {
  3.7227101432176976`*^9, 3.722710167062109*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"\[Mu]", "0", "0"},
     {"0", "\[Mu]", "0"},
     {"0", "0", "\[Mu]"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.7167631923698587`*^9, 3.7167653124350247`*^9, 
  3.7171556932721453`*^9, 3.7171575626207314`*^9, 3.717354914858255*^9, 
  3.7174161523932776`*^9, 3.7174179645333047`*^9, 3.7202682431217527`*^9, 
  3.7208064571168013`*^9, 3.7209937026548615`*^9, 3.721061236237527*^9, 
  3.722710176396038*^9, 3.7227102792095594`*^9, 3.723904965675609*^9, 
  3.72651878006872*^9, 3.7284276697233934`*^9, 3.7404310591809816`*^9, 
  3.849109576875492*^9, 3.849122954993163*^9, 3.850324009059869*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Define the local stiffness matrix (Note that the absolute value of the \
Jacobian determinant is used.  The mesh from omega_h can have inside out \
elements.):\
\>", "Subsection",
 CellChangeTimes->{{3.7171710837254143`*^9, 3.717171091066893*^9}, {
  3.7174287074048176`*^9, 3.7174287551552706`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Kmat", "[", 
    RowBox[{
    "x1_", ",", "y1_", ",", "z1_", ",", "x2_", ",", "y2_", ",", "z2_", ",", 
     "x3_", ",", "y3_", ",", "z3_", ",", "x4_", ",", "y4_", ",", "z4_", ",", 
     "\[Mu]_"}], "]"}], "=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"Transpose", "[", "B", "]"}], ".", "S", ".", "B"}], ")"}], 
    RowBox[{"Abs", "[", "detj", "]"}]}]}], " ", ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"KmatNoAbs", "[", 
    RowBox[{
    "x1_", ",", "y1_", ",", "z1_", ",", "x2_", ",", "y2_", ",", "z2_", ",", 
     "x3_", ",", "y3_", ",", "z3_", ",", "x4_", ",", "y4_", ",", "z4_", ",", 
     "\[Mu]_"}], "]"}], "=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"Transpose", "[", "B", "]"}], ".", "S", ".", "B"}], ")"}], 
    "detj"}]}], " ", ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Detj", "[", 
    RowBox[{
    "x1_", ",", "y1_", ",", "z1_", ",", "x2_", ",", "y2_", ",", "z2_", ",", 
     "x3_", ",", "y3_", ",", "z3_", ",", "x4_", ",", "y4_", ",", "z4_"}], 
    "]"}], "=", "detj"}], " ", ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Gmatrix", "[", 
    RowBox[{
    "x1_", ",", "y1_", ",", "z1_", ",", "x2_", ",", "y2_", ",", "z2_", ",", 
     "x3_", ",", "y3_", ",", "z3_", ",", "x4_", ",", "y4_", ",", "z4_"}], 
    "]"}], "=", "B"}], ";"}]}], "Input",
 CellChangeTimes->{{3.7167629997677364`*^9, 3.7167630532499137`*^9}, {
  3.7167632159689455`*^9, 3.7167632167198725`*^9}, {3.716763302561515*^9, 
  3.7167633417022843`*^9}, {3.717157099403368*^9, 3.7171571006823473`*^9}, {
  3.717157190107882*^9, 3.717157192598886*^9}, {3.7171572411342154`*^9, 
  3.717157241737953*^9}, {3.717157583129187*^9, 3.717157590129175*^9}, {
  3.71741618069042*^9, 3.71741618598754*^9}, {3.717418034258523*^9, 
  3.717418064836534*^9}, {3.717422282760172*^9, 3.7174222858073797`*^9}, {
  3.722710200264534*^9, 3.7227102106608515`*^9}, {3.723905212772517*^9, 
  3.723905258879529*^9}, {3.7239060680756407`*^9, 3.72390606909126*^9}, {
  3.7265186604696107`*^9, 3.726518691642288*^9}, {3.7265187465842485`*^9, 
  3.7265187516310453`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"gp", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"1", "/", "4"}], ",", 
     RowBox[{"1", "/", "4"}], ",", 
     RowBox[{"1", "/", "4"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"gw", "=", 
   RowBox[{"1", "/", "6"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.720277340993009*^9, 3.72027737961343*^9}, {
  3.7202774283513937`*^9, 3.7202774293658648`*^9}, {3.720278067092781*^9, 
  3.720278074392303*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Fbody", "[", 
    RowBox[{
    "x1_", ",", "y1_", ",", "z1_", ",", "x2_", ",", "y2_", ",", "z2_", ",", 
     "x3_", ",", "y3_", ",", "z3_", ",", "x4_", ",", "y4_", ",", "z4_"}], 
    "]"}], "=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"\[Phi]s", "/.", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"\[Xi]", "\[Rule]", 
         RowBox[{"gp", "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], ",", 
        RowBox[{"\[Psi]", "\[Rule]", 
         RowBox[{"gp", "[", 
          RowBox[{"[", "2", "]"}], "]"}]}], ",", 
        RowBox[{"\[Zeta]", "\[Rule]", 
         RowBox[{"gp", "[", 
          RowBox[{"[", "3", "]"}], "]"}]}]}], "}"}]}], ")"}], " ", "detj"}]}],
   ";"}]], "Input",
 CellChangeTimes->{{3.720276857562365*^9, 3.72027689050346*^9}, {
  3.720276933199112*^9, 3.7202769367774963`*^9}, {3.72027697666714*^9, 
  3.720277021013089*^9}, {3.720277389298491*^9, 3.720277419388343*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Define the mesh.  This mesh is produced by the build_box function in Omega_h.\
\>", "Subsection",
 CellChangeTimes->{{3.717171103353293*^9, 3.71717112863015*^9}, {
  3.7171711761508427`*^9, 3.717171184346429*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"connect", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "12", ",", "3", ",", "13"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "3", ",", "4", ",", "13"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "4", ",", "1", ",", "13"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "1", ",", "10", ",", "13"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "10", ",", "9", ",", "13"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "9", ",", "12", ",", "13"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "13", ",", "4", ",", "14"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "4", ",", "5", ",", "14"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "5", ",", "2", ",", "14"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "2", ",", "11", ",", "14"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "11", ",", "10", ",", "14"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "10", ",", "13", ",", "14"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"3", ",", "15", ",", "6", ",", "16"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"3", ",", "6", ",", "7", ",", "16"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"3", ",", "7", ",", "4", ",", "16"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"3", ",", "4", ",", "13", ",", "16"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"3", ",", "13", ",", "12", ",", "16"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"3", ",", "12", ",", "15", ",", "16"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"4", ",", "16", ",", "7", ",", "17"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"4", ",", "7", ",", "8", ",", "17"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"4", ",", "8", ",", "5", ",", "17"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"4", ",", "5", ",", "14", ",", "17"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"4", ",", "14", ",", "13", ",", "17"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"4", ",", "13", ",", "16", ",", "17"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"9", ",", "21", ",", "12", ",", "22"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"9", ",", "12", ",", "13", ",", "22"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"9", ",", "13", ",", "10", ",", "22"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"9", ",", "10", ",", "19", ",", "22"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"9", ",", "19", ",", "18", ",", "22"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"9", ",", "18", ",", "21", ",", "22"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"10", ",", "22", ",", "13", ",", "23"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"10", ",", "13", ",", "14", ",", "23"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"10", ",", "14", ",", "11", ",", "23"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"10", ",", "11", ",", "20", ",", "23"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"10", ",", "20", ",", "19", ",", "23"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"10", ",", "19", ",", "22", ",", "23"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"12", ",", "24", ",", "15", ",", "25"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"12", ",", "15", ",", "16", ",", "25"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"12", ",", "16", ",", "13", ",", "25"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"12", ",", "13", ",", "22", ",", "25"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"12", ",", "22", ",", "21", ",", "25"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"12", ",", "21", ",", "24", ",", "25"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"13", ",", "25", ",", "16", ",", "26"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"13", ",", "16", ",", "17", ",", "26"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"13", ",", "17", ",", "14", ",", "26"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"13", ",", "14", ",", "23", ",", "26"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"13", ",", "23", ",", "22", ",", "26"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"13", ",", "22", ",", "25", ",", "26"}], "}"}]}], "}"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.7174169577864523`*^9, 3.7174169658023443`*^9}, 
   3.717417651397601*^9, {3.76409786087125*^9, 3.7640978639703207`*^9}, {
   3.7640978943425765`*^9, 3.7640978954822354`*^9}, {3.849008712370339*^9, 
   3.8490087306012497`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"xv", "=", 
   RowBox[{"{", 
    RowBox[{
    "0.0", ",", "0.0", ",", "0.0", ",", "0.0", ",", "0.0", ",", "0.0", ",", 
     "0.0", ",", "0.0", ",", "0.0", ",", "0.5", ",", "0.5", ",", "0.5", ",", 
     "0.5", ",", "0.5", ",", "0.5", ",", "0.5", ",", "0.5", ",", "0.5", ",", 
     "1.0", ",", "1.0", ",", "1.0", ",", "1.0", ",", "1.0", ",", "1.0", ",", 
     "1.0", ",", "1.0", ",", "1.0"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"yv", "=", 
   RowBox[{"{", 
    RowBox[{
    "0.0", ",", "0.0", ",", "0.0", ",", "0.5", ",", "0.5", ",", "0.5", ",", 
     "1.0", ",", " ", "1.0", ",", " ", "1.0", ",", "0.0", ",", " ", "0.0", 
     ",", " ", "0.0", ",", "0.5", ",", " ", "0.5", ",", " ", "0.5", ",", 
     "1.0", ",", " ", "1.0", ",", " ", "1.0", ",", "0.0", ",", " ", "0.0", 
     ",", " ", "0.0", ",", "0.5", ",", " ", "0.5", ",", " ", "0.5", ",", 
     "1.0", ",", " ", "1.0", ",", " ", "1.0"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"zv", "=", 
   RowBox[{"{", 
    RowBox[{
    "0.0", ",", " ", "0.5", ",", " ", "1.0", ",", "0.0", ",", " ", "0.5", ",",
      " ", "1.0", ",", "0.0", ",", " ", "0.5", ",", " ", "1.0", ",", "0.0", 
     ",", "0.5", ",", "1.0", ",", "0.0", ",", " ", "0.5", ",", " ", "1.0", 
     ",", "0.0", ",", " ", "0.5", ",", " ", "1.0", ",", "0.0", ",", " ", 
     "0.5", ",", " ", "1.0", ",", "0.0", ",", " ", "0.5", ",", " ", "1.0", 
     ",", "0.0", ",", " ", "0.5", ",", " ", "1.0"}], "}"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.7174174700232644`*^9, 3.7174174845856824`*^9}, {
  3.717417517163823*^9, 3.717417642288141*^9}, {3.7210467593944297`*^9, 
  3.7210467621477776`*^9}, {3.849008737603016*^9, 3.8490087975493383`*^9}, {
  3.8490394034966097`*^9, 3.849039442363715*^9}, {3.84903949928415*^9, 
  3.849039511928667*^9}, {3.849039557090678*^9, 3.84903958355398*^9}, {
  3.849040182904023*^9, 3.849040499401132*^9}, {3.849040541554579*^9, 
  3.8490405432435417`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[Rho]v", "=", 
  RowBox[{"Table", "[", 
   RowBox[{"1.0", ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "1", ",", 
      RowBox[{"Length", "[", "xv", "]"}]}], "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.7209938116705494`*^9, 3.7209938528649826`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "1.`", ",", "1.`", ",", "1.`", ",", "1.`", ",", "1.`", ",", "1.`", ",", 
   "1.`", ",", "1.`", ",", "1.`", ",", "1.`", ",", "1.`", ",", "1.`", ",", 
   "1.`", ",", "1.`", ",", "1.`", ",", "1.`", ",", "1.`", ",", "1.`", ",", 
   "1.`", ",", "1.`", ",", "1.`", ",", "1.`", ",", "1.`", ",", "1.`", ",", 
   "1.`", ",", "1.`", ",", "1.`"}], "}"}]], "Output",
 CellChangeTimes->{3.7209938545509453`*^9, 3.7210612745209227`*^9, 
  3.722710295111224*^9, 3.723904980849421*^9, 3.726518795209201*^9, 
  3.7284276796926746`*^9, 3.740431068369254*^9, 3.849109587091461*^9, 
  3.8491229710531683`*^9, 3.850324009091216*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"uv", "=", 
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"i", "*", "0.1"}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "1", ",", 
      RowBox[{"Length", "[", "xv", "]"}]}], "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.7210466573505106`*^9, 3.721046659816079*^9}, {
  3.721046777601693*^9, 3.721046848873374*^9}, {3.7227103034444604`*^9, 
  3.7227103038191986`*^9}, {3.722782880431888*^9, 3.7227828812579*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "0.1`", ",", "0.2`", ",", "0.30000000000000004`", ",", "0.4`", ",", "0.5`", 
   ",", "0.6000000000000001`", ",", "0.7000000000000001`", ",", "0.8`", ",", 
   "0.9`", ",", "1.`", ",", "1.1`", ",", "1.2000000000000002`", ",", "1.3`", 
   ",", "1.4000000000000001`", ",", "1.5`", ",", "1.6`", ",", 
   "1.7000000000000002`", ",", "1.8`", ",", "1.9000000000000001`", ",", "2.`",
    ",", "2.1`", ",", "2.2`", ",", "2.3000000000000003`", ",", 
   "2.4000000000000004`", ",", "2.5`", ",", "2.6`", ",", "2.7`"}], 
  "}"}]], "Output",
 CellChangeTimes->{3.721046853711686*^9, 3.721061275906258*^9, 
  3.722710305039832*^9, 3.7227828821395884`*^9, 3.7239049824137096`*^9, 
  3.726518796771579*^9, 3.728427680942066*^9, 3.740431069757995*^9, 
  3.849109588390725*^9, 3.8491229719871817`*^9, 3.850324009105259*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   RowBox[{"B", "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"x1", "->", 
       RowBox[{"xv", "[", 
        RowBox[{"[", 
         RowBox[{
          RowBox[{
           RowBox[{"connect", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "[", 
           RowBox[{"[", "1", "]"}], "]"}], "+", "1"}], "]"}], "]"}]}], ",", 
      RowBox[{"y1", "->", 
       RowBox[{"yv", "[", 
        RowBox[{"[", 
         RowBox[{
          RowBox[{
           RowBox[{"connect", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "[", 
           RowBox[{"[", "1", "]"}], "]"}], "+", "1"}], "]"}], "]"}]}], ",", 
      RowBox[{"z1", "->", 
       RowBox[{"zv", "[", 
        RowBox[{"[", 
         RowBox[{
          RowBox[{
           RowBox[{"connect", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "[", 
           RowBox[{"[", "1", "]"}], "]"}], "+", "1"}], "]"}], "]"}]}], ",", 
      RowBox[{"x2", "->", 
       RowBox[{"xv", "[", 
        RowBox[{"[", 
         RowBox[{
          RowBox[{
           RowBox[{"connect", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "[", 
           RowBox[{"[", "2", "]"}], "]"}], "+", "1"}], "]"}], "]"}]}], ",", 
      RowBox[{"y2", "->", 
       RowBox[{"yv", "[", 
        RowBox[{"[", 
         RowBox[{
          RowBox[{
           RowBox[{"connect", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "[", 
           RowBox[{"[", "2", "]"}], "]"}], "+", "1"}], "]"}], "]"}]}], ",", 
      RowBox[{"z2", "->", 
       RowBox[{"zv", "[", 
        RowBox[{"[", 
         RowBox[{
          RowBox[{
           RowBox[{"connect", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "[", 
           RowBox[{"[", "2", "]"}], "]"}], "+", "1"}], "]"}], "]"}]}], ",", 
      RowBox[{"x3", "->", 
       RowBox[{"xv", "[", 
        RowBox[{"[", 
         RowBox[{
          RowBox[{
           RowBox[{"connect", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "[", 
           RowBox[{"[", "3", "]"}], "]"}], "+", "1"}], "]"}], "]"}]}], ",", 
      RowBox[{"y3", "->", 
       RowBox[{"yv", "[", 
        RowBox[{"[", 
         RowBox[{
          RowBox[{
           RowBox[{"connect", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "[", 
           RowBox[{"[", "3", "]"}], "]"}], "+", "1"}], "]"}], "]"}]}], ",", 
      RowBox[{"z3", "->", 
       RowBox[{"zv", "[", 
        RowBox[{"[", 
         RowBox[{
          RowBox[{
           RowBox[{"connect", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "[", 
           RowBox[{"[", "3", "]"}], "]"}], "+", "1"}], "]"}], "]"}]}], ",", 
      RowBox[{"x4", "->", 
       RowBox[{"xv", "[", 
        RowBox[{"[", 
         RowBox[{
          RowBox[{
           RowBox[{"connect", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "[", 
           RowBox[{"[", "4", "]"}], "]"}], "+", "1"}], "]"}], "]"}]}], ",", 
      RowBox[{"y4", "->", 
       RowBox[{"yv", "[", 
        RowBox[{"[", 
         RowBox[{
          RowBox[{
           RowBox[{"connect", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "[", 
           RowBox[{"[", "4", "]"}], "]"}], "+", "1"}], "]"}], "]"}]}], ",", 
      RowBox[{"z4", "->", 
       RowBox[{"zv", "[", 
        RowBox[{"[", 
         RowBox[{
          RowBox[{
           RowBox[{"connect", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "[", 
           RowBox[{"[", "4", "]"}], "]"}], "+", "1"}], "]"}], "]"}]}]}], 
     "}"}]}], ")"}], "//", "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.717419886988741*^9, 3.7174199557586236`*^9}, 
   3.7174200134621477`*^9, {3.7174200537679987`*^9, 3.717420096779709*^9}, {
   3.7174202425916443`*^9, 3.717420244294836*^9}, {3.7174232752978487`*^9, 
   3.7174232937823305`*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0.`", "2.`", 
      RowBox[{"-", "2.`"}], "0.`"},
     {
      RowBox[{"-", "2.`"}], "0.`", "2.`", "0.`"},
     {"0.`", 
      RowBox[{"-", "2.`"}], "0.`", "2.`"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.7174199569726567`*^9, 3.717420013965046*^9, 3.7174200982012625`*^9, 
   3.717420245388923*^9, {3.7174232787349763`*^9, 3.717423294625579*^9}, 
   3.720268259944398*^9, 3.720806469085964*^9, 3.7208117239082513`*^9, 
   3.7209937608585668`*^9, 3.7210612798003244`*^9, 3.7227103143652925`*^9, 
   3.7239049847799826`*^9, 3.7265187988968835`*^9, 3.728427682473898*^9, 
   3.7404310711562195`*^9, 3.84910958991292*^9, 3.849122973050664*^9, 
   3.850324009122345*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Assemble the global stiffness:", "Subsection",
 CellChangeTimes->{{3.7171711972127666`*^9, 3.71717120142911*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"gaussWeight", "=", 
   RowBox[{"1", "/", "6"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ndofs", "=", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ndims", "=", "3"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ndofsTotal", "=", 
   RowBox[{"ndofs", " ", 
    RowBox[{"Length", "[", "xv", "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Klocal", "=", 
   RowBox[{"Table", "[", 
    RowBox[{"0.0", ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"Length", "[", "connect", "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "1", ",", "4"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"k", ",", "1", ",", "4"}], "}"}]}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.717166271741476*^9, 3.71716629726234*^9}, {
  3.717423563398694*^9, 3.717423566476555*^9}, {3.717424308471903*^9, 
  3.717424318282713*^9}, {3.7174279410435295`*^9, 3.717427953121283*^9}, {
  3.720806567996297*^9, 3.7208066398399677`*^9}, {3.722710373383209*^9, 
  3.7227104022009687`*^9}, {3.7239058302630987`*^9, 3.72390583245625*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Kglobal", "=", 
   RowBox[{"Table", "[", 
    RowBox[{"0.0", ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", "ndofsTotal"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "1", ",", "ndofsTotal"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"For", "[", 
  RowBox[{
   RowBox[{"i", "=", "1"}], ",", " ", 
   RowBox[{"i", "\[LessEqual]", " ", 
    RowBox[{"Length", "[", "connect", "]"}]}], ",", 
   RowBox[{"i", "++"}], ",", 
   RowBox[{"Block", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"i1", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"connect", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}], "+", "1"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"i2", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"connect", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "[", 
          RowBox[{"[", "2", "]"}], "]"}], "+", "1"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"i3", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"connect", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "[", 
          RowBox[{"[", "3", "]"}], "]"}], "+", "1"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"i4", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"connect", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "[", 
          RowBox[{"[", "4", "]"}], "]"}], "+", "1"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"ids", "=", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"ndofs", " ", 
            RowBox[{"(", 
             RowBox[{"i1", "-", "1"}], ")"}]}], "+", "1"}], ",", 
          RowBox[{
           RowBox[{"ndofs", 
            RowBox[{"(", " ", 
             RowBox[{"i2", "-", "1"}], ")"}]}], "+", "1"}], ",", 
          RowBox[{
           RowBox[{"ndofs", 
            RowBox[{"(", 
             RowBox[{"i3", "-", "1"}], ")"}]}], "+", "1"}], ",", 
          RowBox[{
           RowBox[{"ndofs", 
            RowBox[{"(", 
             RowBox[{"i4", "-", "1"}], ")"}]}], "+", "1"}]}], "}"}]}]}], 
      "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Kel", "=", 
       RowBox[{"gaussWeight", "*", 
        RowBox[{"Kmat", "[", 
         RowBox[{
          RowBox[{"xv", "[", 
           RowBox[{"[", "i1", "]"}], "]"}], ",", 
          RowBox[{"yv", "[", 
           RowBox[{"[", "i1", "]"}], "]"}], ",", 
          RowBox[{"zv", "[", 
           RowBox[{"[", "i1", "]"}], "]"}], ",", 
          RowBox[{"xv", "[", 
           RowBox[{"[", "i2", "]"}], "]"}], ",", 
          RowBox[{"yv", "[", 
           RowBox[{"[", "i2", "]"}], "]"}], ",", 
          RowBox[{"zv", "[", 
           RowBox[{"[", "i2", "]"}], "]"}], ",", 
          RowBox[{"xv", "[", 
           RowBox[{"[", "i3", "]"}], "]"}], ",", 
          RowBox[{"yv", "[", 
           RowBox[{"[", "i3", "]"}], "]"}], ",", 
          RowBox[{"zv", "[", 
           RowBox[{"[", "i3", "]"}], "]"}], ",", 
          RowBox[{"xv", "[", 
           RowBox[{"[", "i4", "]"}], "]"}], ",", 
          RowBox[{"yv", "[", 
           RowBox[{"[", "i4", "]"}], "]"}], ",", 
          RowBox[{"zv", "[", 
           RowBox[{"[", "i4", "]"}], "]"}], ",", 
          RowBox[{"1", "*", 
           SuperscriptBox["10", "2"]}]}], "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Klocal", "[", 
        RowBox[{"[", "i", "]"}], "]"}], "=", "Kel"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"j", "=", "1"}], ",", 
        RowBox[{"j", "\[LessEqual]", "4"}], ",", 
        RowBox[{"j", "++"}], ",", "\[IndentingNewLine]", 
        RowBox[{"For", "[", 
         RowBox[{
          RowBox[{"k", "=", "1"}], ",", 
          RowBox[{"k", "\[LessEqual]", "4"}], ",", 
          RowBox[{"k", "++"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"Kglobal", "[", 
              RowBox[{"[", 
               RowBox[{"ids", "[", 
                RowBox[{"[", "j", "]"}], "]"}], "]"}], "]"}], "[", 
             RowBox[{"[", 
              RowBox[{"ids", "[", 
               RowBox[{"[", "k", "]"}], "]"}], "]"}], "]"}], "+=", 
            RowBox[{
             RowBox[{"Kel", "[", 
              RowBox[{"[", "j", "]"}], "]"}], "[", 
             RowBox[{"[", "k", "]"}], "]"}]}], ";"}]}], "]"}]}], "]"}]}]}], 
    "]"}]}], "]"}]}], "Input",
 CellChangeTimes->CompressedData["
1:eJwdz1tI02EABfA1YxmUKWGJQ9sqkzUyQycpy1yOJTpxKFJZNhtEtrZs4mVJ
0LbKLnOSl61NhbRGLJWl1tRpWjPzEgo+iKmTiBBjjryETSvIvvN/OPyezoHD
lhVkXqbTaDQeCbR4gvSH270C9S5bJQyt3lkDY08fM0LGUUYd/Bi3rwFKmLHt
sDqG+x52BH8ZhNPe0SEo6vObhELDPw+cb1ldhi2iZ6tQwxz1wfGJpnV4acW6
jUsML6DvgFPG4kCYPpgdDXnC4kQoF+cK4Z4WWQZ0Z12TQKNRfBG2fc6lZChn
ZTC+V6WAc9NFRXDtZVEJ5DqSDVAbr6uEUecqqqH4BcsMa/k8lQd7emshrHFG
lMIeQY8adibpfdA+9Ze+SOzr/sSACzPs7bBLcmQ3HFiv2QuXA3waWPGu9B6M
TRBZlogftE8oU2JO2peJZ9TSdvjcntQJb/oJKQPTymZg1n2OG5b9DvRfIdKq
6iiTVW45XDPlKGCkOnLLKpE/0Uh5YVD2KrXDK8g7cbwN5oSZ+6F5LtIFayW+
BXionPcdbg4fCEsjilJdLDg57jwIf44FR0D+7cdGMfrMDBN8ZCmvh4thwka4
lTn0Bs7XJXZBcdOSC5aw/QfgH0mrIZ0YnimrhKbeIAu8ldpMueHknL1KzNcP
yyA9yKqD0aKxuzA+xWKAtpF6M2xtzg+VEws52Uz4IMrGghucEDbcH35epyBe
ef2NsueO1Ag1DsdTSPsVIr2OXz8MedBfmaCG4kUb5akqJetrN9mbi2PDkYfT
Du1bryDgxmw/tMmdm1aiKWeG8j8kZsSm
  "]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Kglobal", "//", "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.7227105262204704`*^9, 3.722710532154334*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"49.999999999999986`", 
      RowBox[{"-", "16.666666666666664`"}], "0.`", 
      RowBox[{"-", "16.666666666666664`"}], "0.`", "0.`", "0.`", "0.`", "0.`", 
      RowBox[{"-", "16.666666666666664`"}], "0.`", "0.`", "0.`", "0.`", "0.`",
       "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", 
      "0.`", "0.`"},
     {
      RowBox[{"-", "16.666666666666664`"}], "83.3333333333333`", 
      RowBox[{"-", "16.666666666666664`"}], "0.`", 
      RowBox[{"-", "24.999999999999996`"}], "0.`", "0.`", "0.`", "0.`", "0.`", 
      RowBox[{"-", "24.999999999999996`"}], "0.`", "0.`", "0.`", "0.`", "0.`",
       "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", 
      "0.`"},
     {"0.`", 
      RowBox[{"-", "16.666666666666664`"}], "33.33333333333333`", "0.`", 
      "0.`", 
      RowBox[{"-", "8.333333333333332`"}], "0.`", "0.`", "0.`", "0.`", "0.`", 
      RowBox[{"-", "8.333333333333332`"}], "0.`", "0.`", "0.`", "0.`", "0.`", 
      "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`"},
     {
      RowBox[{"-", "16.666666666666664`"}], "0.`", "0.`", "83.3333333333333`", 
      RowBox[{"-", "24.999999999999996`"}], "0.`", 
      RowBox[{"-", "16.666666666666664`"}], "0.`", "0.`", "0.`", "0.`", "0.`", 
      RowBox[{"-", "24.999999999999996`"}], "0.`", "0.`", "0.`", "0.`", "0.`",
       "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`"},
     {"0.`", 
      RowBox[{"-", "24.999999999999996`"}], "0.`", 
      RowBox[{"-", "24.999999999999996`"}], "149.99999999999997`", 
      RowBox[{"-", "24.999999999999996`"}], "0.`", 
      RowBox[{"-", "24.999999999999996`"}], "0.`", "0.`", "0.`", "0.`", "0.`", 
      RowBox[{"-", "49.999999999999986`"}], "0.`", "0.`", "0.`", "0.`", "0.`",
       "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`"},
     {"0.`", "0.`", 
      RowBox[{"-", "8.333333333333332`"}], "0.`", 
      RowBox[{"-", "24.999999999999996`"}], "66.66666666666666`", "0.`", 
      "0.`", 
      RowBox[{"-", "8.333333333333332`"}], "0.`", "0.`", "0.`", "0.`", "0.`", 
      RowBox[{"-", "24.999999999999996`"}], "0.`", "0.`", "0.`", "0.`", "0.`",
       "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`"},
     {"0.`", "0.`", "0.`", 
      RowBox[{"-", "16.666666666666664`"}], "0.`", "0.`", 
      "33.33333333333333`", 
      RowBox[{"-", "8.333333333333332`"}], "0.`", "0.`", "0.`", "0.`", "0.`", 
      "0.`", "0.`", 
      RowBox[{"-", "8.333333333333332`"}], "0.`", "0.`", "0.`", "0.`", "0.`", 
      "0.`", "0.`", "0.`", "0.`", "0.`", "0.`"},
     {"0.`", "0.`", "0.`", "0.`", 
      RowBox[{"-", "24.999999999999996`"}], "0.`", 
      RowBox[{"-", "8.333333333333332`"}], "66.66666666666666`", 
      RowBox[{"-", "8.333333333333332`"}], "0.`", "0.`", "0.`", "0.`", "0.`", 
      "0.`", "0.`", 
      RowBox[{"-", "24.999999999999996`"}], "0.`", "0.`", "0.`", "0.`", "0.`",
       "0.`", "0.`", "0.`", "0.`", "0.`"},
     {"0.`", "0.`", "0.`", "0.`", "0.`", 
      RowBox[{"-", "8.333333333333332`"}], "0.`", 
      RowBox[{"-", "8.333333333333332`"}], "33.33333333333333`", "0.`", "0.`",
       "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", 
      RowBox[{"-", "16.666666666666664`"}], "0.`", "0.`", "0.`", "0.`", "0.`",
       "0.`", "0.`", "0.`", "0.`"},
     {
      RowBox[{"-", "16.666666666666664`"}], "0.`", "0.`", "0.`", "0.`", "0.`",
       "0.`", "0.`", "0.`", "83.3333333333333`", 
      RowBox[{"-", "24.999999999999996`"}], "0.`", 
      RowBox[{"-", "24.999999999999996`"}], "0.`", "0.`", "0.`", "0.`", "0.`", 
      RowBox[{"-", "16.666666666666664`"}], "0.`", "0.`", "0.`", "0.`", "0.`",
       "0.`", "0.`", "0.`"},
     {"0.`", 
      RowBox[{"-", "24.999999999999996`"}], "0.`", "0.`", "0.`", "0.`", "0.`",
       "0.`", "0.`", 
      RowBox[{"-", "24.999999999999996`"}], "149.99999999999997`", 
      RowBox[{"-", "24.999999999999996`"}], "0.`", 
      RowBox[{"-", "49.999999999999986`"}], "0.`", "0.`", "0.`", "0.`", "0.`", 
      RowBox[{"-", "24.999999999999996`"}], "0.`", "0.`", "0.`", "0.`", "0.`",
       "0.`", "0.`"},
     {"0.`", "0.`", 
      RowBox[{"-", "8.333333333333332`"}], "0.`", "0.`", "0.`", "0.`", "0.`", 
      "0.`", "0.`", 
      RowBox[{"-", "24.999999999999996`"}], "66.66666666666666`", "0.`", 
      "0.`", 
      RowBox[{"-", "24.999999999999996`"}], "0.`", "0.`", "0.`", "0.`", "0.`", 
      RowBox[{"-", "8.333333333333332`"}], "0.`", "0.`", "0.`", "0.`", "0.`", 
      "0.`"},
     {"0.`", "0.`", "0.`", 
      RowBox[{"-", "24.999999999999996`"}], "0.`", "0.`", "0.`", "0.`", "0.`", 
      RowBox[{"-", "24.999999999999996`"}], "0.`", "0.`", 
      "149.99999999999997`", 
      RowBox[{"-", "49.999999999999986`"}], "0.`", 
      RowBox[{"-", "24.999999999999996`"}], "0.`", "0.`", "0.`", "0.`", "0.`", 
      RowBox[{"-", "24.999999999999996`"}], "0.`", "0.`", "0.`", "0.`", "0.`"},
     {"0.`", "0.`", "0.`", "0.`", 
      RowBox[{"-", "49.999999999999986`"}], "0.`", "0.`", "0.`", "0.`", "0.`", 
      RowBox[{"-", "49.999999999999986`"}], "0.`", 
      RowBox[{"-", "49.999999999999986`"}], "299.9999999999998`", 
      RowBox[{"-", "49.999999999999986`"}], "0.`", 
      RowBox[{"-", "49.999999999999986`"}], "0.`", "0.`", "0.`", "0.`", "0.`", 
      RowBox[{"-", "49.999999999999986`"}], "0.`", "0.`", "0.`", "0.`"},
     {"0.`", "0.`", "0.`", "0.`", "0.`", 
      RowBox[{"-", "24.999999999999996`"}], "0.`", "0.`", "0.`", "0.`", "0.`", 
      RowBox[{"-", "24.999999999999996`"}], "0.`", 
      RowBox[{"-", "49.999999999999986`"}], "149.99999999999994`", "0.`", 
      "0.`", 
      RowBox[{"-", "24.999999999999996`"}], "0.`", "0.`", "0.`", "0.`", "0.`", 
      RowBox[{"-", "24.999999999999996`"}], "0.`", "0.`", "0.`"},
     {"0.`", "0.`", "0.`", "0.`", "0.`", "0.`", 
      RowBox[{"-", "8.333333333333332`"}], "0.`", "0.`", "0.`", "0.`", "0.`", 
      RowBox[{"-", "24.999999999999996`"}], "0.`", "0.`", 
      "66.66666666666666`", 
      RowBox[{"-", "24.999999999999996`"}], "0.`", "0.`", "0.`", "0.`", "0.`",
       "0.`", "0.`", 
      RowBox[{"-", "8.333333333333332`"}], "0.`", "0.`"},
     {"0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", 
      RowBox[{"-", "24.999999999999996`"}], "0.`", "0.`", "0.`", "0.`", "0.`", 
      RowBox[{"-", "49.999999999999986`"}], "0.`", 
      RowBox[{"-", "24.999999999999996`"}], "149.99999999999994`", 
      RowBox[{"-", "24.999999999999996`"}], "0.`", "0.`", "0.`", "0.`", "0.`",
       "0.`", "0.`", 
      RowBox[{"-", "24.999999999999996`"}], "0.`"},
     {"0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", 
      RowBox[{"-", "16.666666666666664`"}], "0.`", "0.`", "0.`", "0.`", "0.`", 
      RowBox[{"-", "24.999999999999996`"}], "0.`", 
      RowBox[{"-", "24.999999999999996`"}], "83.33333333333331`", "0.`", 
      "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", 
      RowBox[{"-", "16.666666666666664`"}]},
     {"0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", 
      RowBox[{"-", "16.666666666666664`"}], "0.`", "0.`", "0.`", "0.`", "0.`",
       "0.`", "0.`", "0.`", "33.33333333333333`", 
      RowBox[{"-", "8.333333333333332`"}], "0.`", 
      RowBox[{"-", "8.333333333333332`"}], "0.`", "0.`", "0.`", "0.`", "0.`"},
     {"0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", 
      RowBox[{"-", "24.999999999999996`"}], "0.`", "0.`", "0.`", "0.`", "0.`",
       "0.`", "0.`", 
      RowBox[{"-", "8.333333333333332`"}], "66.66666666666666`", 
      RowBox[{"-", "8.333333333333332`"}], "0.`", 
      RowBox[{"-", "24.999999999999996`"}], "0.`", "0.`", "0.`", "0.`"},
     {"0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", 
      "0.`", 
      RowBox[{"-", "8.333333333333332`"}], "0.`", "0.`", "0.`", "0.`", "0.`", 
      "0.`", "0.`", 
      RowBox[{"-", "8.333333333333332`"}], "33.33333333333333`", "0.`", "0.`", 
      RowBox[{"-", "16.666666666666664`"}], "0.`", "0.`", "0.`"},
     {"0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", 
      "0.`", "0.`", 
      RowBox[{"-", "24.999999999999996`"}], "0.`", "0.`", "0.`", "0.`", "0.`", 
      RowBox[{"-", "8.333333333333332`"}], "0.`", "0.`", "66.66666666666666`", 
      RowBox[{"-", "24.999999999999996`"}], "0.`", 
      RowBox[{"-", "8.333333333333332`"}], "0.`", "0.`"},
     {"0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", 
      "0.`", "0.`", "0.`", 
      RowBox[{"-", "49.999999999999986`"}], "0.`", "0.`", "0.`", "0.`", "0.`", 
      RowBox[{"-", "24.999999999999996`"}], "0.`", 
      RowBox[{"-", "24.999999999999996`"}], "149.99999999999994`", 
      RowBox[{"-", "24.999999999999996`"}], "0.`", 
      RowBox[{"-", "24.999999999999996`"}], "0.`"},
     {"0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", 
      "0.`", "0.`", "0.`", "0.`", 
      RowBox[{"-", "24.999999999999996`"}], "0.`", "0.`", "0.`", "0.`", "0.`", 
      RowBox[{"-", "16.666666666666664`"}], "0.`", 
      RowBox[{"-", "24.999999999999996`"}], "83.33333333333331`", "0.`", 
      "0.`", 
      RowBox[{"-", "16.666666666666664`"}]},
     {"0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", 
      "0.`", "0.`", "0.`", "0.`", "0.`", 
      RowBox[{"-", "8.333333333333332`"}], "0.`", "0.`", "0.`", "0.`", "0.`", 
      RowBox[{"-", "8.333333333333332`"}], "0.`", "0.`", "33.33333333333333`", 
      RowBox[{"-", "16.666666666666664`"}], "0.`"},
     {"0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", 
      "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", 
      RowBox[{"-", "24.999999999999996`"}], "0.`", "0.`", "0.`", "0.`", "0.`", 
      RowBox[{"-", "24.999999999999996`"}], "0.`", 
      RowBox[{"-", "16.666666666666664`"}], "83.33333333333331`", 
      RowBox[{"-", "16.666666666666664`"}]},
     {"0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", 
      "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", 
      RowBox[{"-", "16.666666666666664`"}], "0.`", "0.`", "0.`", "0.`", "0.`", 
      RowBox[{"-", "16.666666666666664`"}], "0.`", 
      RowBox[{"-", "16.666666666666664`"}], "49.999999999999986`"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.722710533348419*^9, 3.722782725237771*^9, {3.7227828985139065`*^9, 
   3.722782902215784*^9}, 3.723905010066472*^9, 3.7265188120370965`*^9, 
   3.7265190700895996`*^9, 3.728427689373209*^9, 3.740431077514471*^9, 
   3.849109610012429*^9, 3.8491229814820642`*^9, 3.850324009178246*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"colMap", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "0", ",", "1", ",", "3", ",", "4", ",", "9", ",", "10", ",", "12", ",", 
       "13"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "0", ",", "1", ",", "2", ",", "4", ",", "5", ",", "10", ",", "11", ",", 
       "13", ",", "14"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "2", ",", "5", ",", "11", ",", "14"}], "}"}]}], 
    "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"SetPrecision", "[", 
  RowBox[{
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Kglobal", "[", 
         RowBox[{"[", "i", "]"}], "]"}], "[", 
        RowBox[{"[", 
         RowBox[{
          RowBox[{
           RowBox[{"colMap", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "[", 
           RowBox[{"[", "j", "]"}], "]"}], "+", "1"}], "]"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "1", ",", 
         RowBox[{"Length", "[", 
          RowBox[{"colMap", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "]"}]}], "}"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"Length", "[", "colMap", "]"}]}], "}"}]}], "]"}], ",", "18"}], 
  "]"}], "\n"}], "Input",
 CellChangeTimes->{{3.849123499838376*^9, 3.849123669973609*^9}, {
  3.849123745978812*^9, 3.8491237570398703`*^9}, {3.849123818021318*^9, 
  3.849123929152157*^9}, {3.849124034910472*^9, 3.849124064621046*^9}, {
  3.849124324564086*^9, 3.849124356678981*^9}, {3.850319918016466*^9, 
  3.850320039892253*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"49.99999999999998578914528479799628257751`18.", ",", 
     RowBox[{"-", "16.66666666666666429819088079966604709625`18."}], ",", 
     RowBox[{"-", "16.66666666666666429819088079966604709625`18."}], ",", "0",
      ",", 
     RowBox[{"-", "16.66666666666666429819088079966604709625`18."}], ",", "0",
      ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "16.66666666666666429819088079966604709625`18."}], ",", 
     "83.33333333333330017467233119532465934753`18.", ",", 
     RowBox[{"-", "16.66666666666666429819088079966604709625`18."}], ",", 
     RowBox[{"-", "24.99999999999999644728632119949907064438`18."}], ",", "0",
      ",", 
     RowBox[{"-", "24.99999999999999644728632119949907064438`18."}], ",", "0",
      ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "16.66666666666666429819088079966604709625`18."}], ",", 
     "33.3333333333333285963817615993320941925`18.", ",", 
     RowBox[{"-", "8.33333333333333214909544039983302354813`18."}], ",", 
     RowBox[{"-", "8.33333333333333214909544039983302354813`18."}], ",", 
     "0"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.849123936670495*^9, {3.849124036111981*^9, 3.849124065070026*^9}, {
   3.849124335580565*^9, 3.849124358427006*^9}, 3.850320041069936*^9, 
   3.850324009195094*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[StyleBox["Compute the flux:", "Subsubsection"]], "Subsection",
 CellChangeTimes->{{3.7171711972127666`*^9, 3.71717120142911*^9}, {
  3.7235049764198055`*^9, 3.723505001764184*^9}, {3.7235116638104506`*^9, 
  3.7235116651539674`*^9}, {3.7235117226463957`*^9, 3.723511723427744*^9}, {
  3.7265184340783014`*^9, 3.726518438796838*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"gaussWeight", "=", 
   RowBox[{"1", "/", "6"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ndofs", "=", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ndofsTotal", "=", 
   RowBox[{"ndofs", " ", 
    RowBox[{"Length", "[", "xv", "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Flux", "=", 
   RowBox[{"Table", "[", 
    RowBox[{"0.0", ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"Length", "[", "connect", "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "1", ",", "3"}], "}"}]}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.717166271741476*^9, 3.71716629726234*^9}, {
  3.717423563398694*^9, 3.717423566476555*^9}, {3.717424308471903*^9, 
  3.717424318282713*^9}, {3.7174279410435295`*^9, 3.717427953121283*^9}, {
  3.720806567996297*^9, 3.7208066398399677`*^9}, {3.7235053432057877`*^9, 
  3.7235054046120386`*^9}, {3.7235117305213585`*^9, 3.7235117319907336`*^9}, {
  3.726518443374713*^9, 3.726518462578518*^9}, {3.84912300955525*^9, 
  3.849123010926467*^9}}],

Cell[BoxData[
 RowBox[{"For", "[", 
  RowBox[{
   RowBox[{"i", "=", "1"}], ",", " ", 
   RowBox[{"i", "\[LessEqual]", " ", 
    RowBox[{"Length", "[", "connect", "]"}]}], ",", 
   RowBox[{"i", "++"}], ",", 
   RowBox[{"Block", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"i1", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"connect", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}], "+", "1"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"i2", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"connect", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "[", 
          RowBox[{"[", "2", "]"}], "]"}], "+", "1"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"i3", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"connect", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "[", 
          RowBox[{"[", "3", "]"}], "]"}], "+", "1"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"i4", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"connect", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "[", 
          RowBox[{"[", "4", "]"}], "]"}], "+", "1"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"ids", "=", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"ndofs", " ", 
            RowBox[{"(", 
             RowBox[{"i1", "-", "1"}], ")"}]}], "+", "1"}], ",", 
          RowBox[{
           RowBox[{"ndofs", 
            RowBox[{"(", " ", 
             RowBox[{"i2", "-", "1"}], ")"}]}], "+", "1"}], ",", 
          RowBox[{
           RowBox[{"ndofs", 
            RowBox[{"(", 
             RowBox[{"i3", "-", "1"}], ")"}]}], "+", "1"}], ",", 
          RowBox[{
           RowBox[{"ndofs", 
            RowBox[{"(", 
             RowBox[{"i4", "-", "1"}], ")"}]}], "+", "1"}]}], "}"}]}]}], 
      "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"Flux", "[", 
        RowBox[{"[", "i", "]"}], "]"}], "=", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"S", "/.", 
          RowBox[{"{", 
           RowBox[{"\[Mu]", "\[Rule]", "100.0"}], "}"}]}], ")"}], ".", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Gmatrix", "[", 
           RowBox[{
            RowBox[{"xv", "[", 
             RowBox[{"[", "i1", "]"}], "]"}], ",", 
            RowBox[{"yv", "[", 
             RowBox[{"[", "i1", "]"}], "]"}], ",", 
            RowBox[{"zv", "[", 
             RowBox[{"[", "i1", "]"}], "]"}], ",", 
            RowBox[{"xv", "[", 
             RowBox[{"[", "i2", "]"}], "]"}], ",", 
            RowBox[{"yv", "[", 
             RowBox[{"[", "i2", "]"}], "]"}], ",", 
            RowBox[{"zv", "[", 
             RowBox[{"[", "i2", "]"}], "]"}], ",", 
            RowBox[{"xv", "[", 
             RowBox[{"[", "i3", "]"}], "]"}], ",", 
            RowBox[{"yv", "[", 
             RowBox[{"[", "i3", "]"}], "]"}], ",", 
            RowBox[{"zv", "[", 
             RowBox[{"[", "i3", "]"}], "]"}], ",", 
            RowBox[{"xv", "[", 
             RowBox[{"[", "i4", "]"}], "]"}], ",", 
            RowBox[{"yv", "[", 
             RowBox[{"[", "i4", "]"}], "]"}], ",", 
            RowBox[{"zv", "[", 
             RowBox[{"[", "i4", "]"}], "]"}]}], "]"}], ".", 
          RowBox[{"(", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"uv", "[", 
              RowBox[{"[", 
               RowBox[{"ids", "[", 
                RowBox[{"[", "i", "]"}], "]"}], "]"}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "1", ",", "4"}], "}"}]}], "]"}], ")"}]}], 
         ")"}]}]}], ";"}]}], "\[IndentingNewLine]", "]"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.7167647605597653`*^9, 3.7167647892518883`*^9}, {
   3.7167648244240847`*^9, 3.716764841539942*^9}, {3.71676488019324*^9, 
   3.7167648969754357`*^9}, {3.716765065628334*^9, 3.716765185350045*^9}, {
   3.7167652229401484`*^9, 3.7167652383100395`*^9}, {3.7167653441168547`*^9, 
   3.7167655199547443`*^9}, {3.7167655675522327`*^9, 
   3.7167655810711265`*^9}, {3.716765622284607*^9, 3.7167656290567384`*^9}, {
   3.716765757154343*^9, 3.716765792076064*^9}, {3.7167658276745405`*^9, 
   3.7167660826802125`*^9}, {3.716766195664576*^9, 3.716766242915578*^9}, {
   3.7167663310833845`*^9, 3.7167663393539863`*^9}, {3.7167664503932595`*^9, 
   3.716766450932579*^9}, {3.7167664868258085`*^9, 3.7167665635541043`*^9}, {
   3.716766627651472*^9, 3.716766643645746*^9}, {3.716766826115865*^9, 
   3.7167668360695195`*^9}, {3.716766868385886*^9, 3.7167669130203*^9}, {
   3.717155721663645*^9, 3.7171557331420517`*^9}, {3.717155769178903*^9, 
   3.7171557818205233`*^9}, {3.7171567883516493`*^9, 3.717156887869956*^9}, {
   3.717156918335051*^9, 3.717156937057849*^9}, {3.717157017416103*^9, 
   3.717157052623994*^9}, {3.717157895689323*^9, 3.717157931742132*^9}, {
   3.717166282194605*^9, 3.71716628473459*^9}, {3.71716849797501*^9, 
   3.71716852298344*^9}, {3.717168562021318*^9, 3.717168562125424*^9}, {
   3.717168843821663*^9, 3.717168857297769*^9}, {3.7171692165304537`*^9, 
   3.7171692208302*^9}, {3.717170006857576*^9, 3.717170018830927*^9}, {
   3.717171209233417*^9, 3.717171213025419*^9}, {3.7173548750864697`*^9, 
   3.717354881757492*^9}, {3.717354996753583*^9, 3.717355017245678*^9}, {
   3.717355319697336*^9, 3.7173553216726255`*^9}, {3.7173557531181636`*^9, 
   3.7173557820403166`*^9}, {3.7173558138063755`*^9, 
   3.7173558166812677`*^9}, {3.7173587645155315`*^9, 
   3.7173587704721184`*^9}, {3.7173588122062426`*^9, 
   3.7173588501286516`*^9}, {3.717359014190798*^9, 3.7173590339564075`*^9}, {
   3.7173591194571896`*^9, 3.7173591202540846`*^9}, {3.717360749384885*^9, 
   3.717360755072524*^9}, {3.7173608405541487`*^9, 3.7173608453215923`*^9}, {
   3.7174176653039513`*^9, 3.7174177502357674`*^9}, {3.717418005127076*^9, 
   3.717418022383568*^9}, {3.7174180927900662`*^9, 3.717418180868244*^9}, {
   3.717419219270834*^9, 3.7174192266613092`*^9}, {3.71741926925568*^9, 
   3.717419272755123*^9}, {3.7174241468474283`*^9, 3.7174241510843997`*^9}, {
   3.71742429898483*^9, 3.717424381678406*^9}, {3.717427960779907*^9, 
   3.7174279724352093`*^9}, {3.7174281618258095`*^9, 
   3.7174281652786007`*^9}, {3.7208066594239817`*^9, 
   3.7208066657144737`*^9}, {3.723057650960129*^9, 3.7230576545889745`*^9}, {
   3.7235054152685385`*^9, 3.723505446143653*^9}, {3.723505542221841*^9, 
   3.7235055715031414`*^9}, {3.723505611190547*^9, 3.7235056388310738`*^9}, 
   3.7235057207531905`*^9, {3.723511832834532*^9, 3.7235118497876167`*^9}, {
   3.723511887365533*^9, 3.72351189056898*^9}, 3.726518499578006*^9, {
   3.726518560374749*^9, 3.7265185767658353`*^9}, {3.726519168245932*^9, 
   3.726519201792951*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Table", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"SetPrecision", "[", 
     RowBox[{
      RowBox[{"Flux", "[", 
       RowBox[{"[", "i", "]"}], "]"}], ",", "16"}], "]"}], "//", 
    "MatrixForm"}], ",", 
   RowBox[{"{", 
    RowBox[{"i", ",", "1", ",", 
     RowBox[{"Length", "[", "connect", "]"}]}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.723505659409583*^9, 3.7235056624558945`*^9}, {
  3.7235057476593637`*^9, 3.7235057479091177`*^9}, {3.723506092534135*^9, 
  3.723506114956089*^9}, {3.723511860928227*^9, 3.7235118618810616`*^9}, {
  3.723511987702938*^9, 3.7235119968124857`*^9}, {3.7265192145272465`*^9, 
  3.726519217747201*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   TagBox[
    RowBox[{"(", "\[NoBreak]", 
     TagBox[GridBox[{
        {"180.`16."},
        {"60.00000000000000710542735760100185871124`16."},
        {"20.00000000000001776356839400250464677811`16."}
       },
       GridBoxAlignment->{
        "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
         "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.5599999999999999]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
           Offset[0.2], {
            Offset[0.4]}, 
           Offset[0.2]}, "RowsIndexed" -> {}}],
      Column], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]], ",", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", 
     TagBox[GridBox[{
        {"180.00000000000002842170943040400743484497`16."},
        {"60.00000000000000710542735760100185871124`16."},
        {"19.99999999999999644728632119949907064438`16."}
       },
       GridBoxAlignment->{
        "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
         "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.5599999999999999]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
           Offset[0.2], {
            Offset[0.4]}, 
           Offset[0.2]}, "RowsIndexed" -> {}}],
      Column], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]], ",", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", 
     TagBox[GridBox[{
        {"180.00000000000002842170943040400743484497`16."},
        {"60.`16."},
        {"20.`16."}
       },
       GridBoxAlignment->{
        "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
         "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.5599999999999999]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
           Offset[0.2], {
            Offset[0.4]}, 
           Offset[0.2]}, "RowsIndexed" -> {}}],
      Column], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]], ",", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", 
     TagBox[GridBox[{
        {"180.00000000000002842170943040400743484497`16."},
        {"60.00000000000000710542735760100185871124`16."},
        {"20.`16."}
       },
       GridBoxAlignment->{
        "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
         "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.5599999999999999]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
           Offset[0.2], {
            Offset[0.4]}, 
           Offset[0.2]}, "RowsIndexed" -> {}}],
      Column], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]], ",", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", 
     TagBox[GridBox[{
        {"180.`16."},
        {"60.00000000000000710542735760100185871124`16."},
        {"20.00000000000001776356839400250464677811`16."}
       },
       GridBoxAlignment->{
        "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
         "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.5599999999999999]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
           Offset[0.2], {
            Offset[0.4]}, 
           Offset[0.2]}, "RowsIndexed" -> {}}],
      Column], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]], ",", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", 
     TagBox[GridBox[{
        {"180.`16."},
        {"60.00000000000000710542735760100185871124`16."},
        {"20.00000000000001776356839400250464677811`16."}
       },
       GridBoxAlignment->{
        "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
         "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.5599999999999999]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
           Offset[0.2], {
            Offset[0.4]}, 
           Offset[0.2]}, "RowsIndexed" -> {}}],
      Column], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]], ",", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", 
     TagBox[GridBox[{
        {"180.00000000000002842170943040400743484497`16."},
        {"60.`16."},
        {"19.99999999999997157829056959599256515503`16."}
       },
       GridBoxAlignment->{
        "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
         "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.5599999999999999]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
           Offset[0.2], {
            Offset[0.4]}, 
           Offset[0.2]}, "RowsIndexed" -> {}}],
      Column], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]], ",", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", 
     TagBox[GridBox[{
        {"179.99999999999997157829056959599256515503`16."},
        {"60.`16."},
        {"20.00000000000001776356839400250464677811`16."}
       },
       GridBoxAlignment->{
        "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
         "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.5599999999999999]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
           Offset[0.2], {
            Offset[0.4]}, 
           Offset[0.2]}, "RowsIndexed" -> {}}],
      Column], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]], ",", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", 
     TagBox[GridBox[{
        {"179.99999999999997157829056959599256515503`16."},
        {"60.00000000000000710542735760100185871124`16."},
        {"20.00000000000000710542735760100185871124`16."}
       },
       GridBoxAlignment->{
        "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
         "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.5599999999999999]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
           Offset[0.2], {
            Offset[0.4]}, 
           Offset[0.2]}, "RowsIndexed" -> {}}],
      Column], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]], ",", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", 
     TagBox[GridBox[{
        {"180.00000000000002842170943040400743484497`16."},
        {"59.99999999999996447286321199499070644379`16."},
        {"20.00000000000000710542735760100185871124`16."}
       },
       GridBoxAlignment->{
        "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
         "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.5599999999999999]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
           Offset[0.2], {
            Offset[0.4]}, 
           Offset[0.2]}, "RowsIndexed" -> {}}],
      Column], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]], ",", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", 
     TagBox[GridBox[{
        {"180.00000000000002842170943040400743484497`16."},
        {"59.99999999999996447286321199499070644379`16."},
        {"20.00000000000001776356839400250464677811`16."}
       },
       GridBoxAlignment->{
        "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
         "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.5599999999999999]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
           Offset[0.2], {
            Offset[0.4]}, 
           Offset[0.2]}, "RowsIndexed" -> {}}],
      Column], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]], ",", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", 
     TagBox[GridBox[{
        {"180.00000000000002842170943040400743484497`16."},
        {"60.00000000000000710542735760100185871124`16."},
        {"19.99999999999997157829056959599256515503`16."}
       },
       GridBoxAlignment->{
        "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
         "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.5599999999999999]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
           Offset[0.2], {
            Offset[0.4]}, 
           Offset[0.2]}, "RowsIndexed" -> {}}],
      Column], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]], ",", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", 
     TagBox[GridBox[{
        {"180.`16."},
        {"60.00000000000000710542735760100185871124`16."},
        {"20.00000000000001776356839400250464677811`16."}
       },
       GridBoxAlignment->{
        "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
         "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.5599999999999999]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
           Offset[0.2], {
            Offset[0.4]}, 
           Offset[0.2]}, "RowsIndexed" -> {}}],
      Column], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]], ",", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", 
     TagBox[GridBox[{
        {"180.00000000000002842170943040400743484497`16."},
        {"60.00000000000000710542735760100185871124`16."},
        {"19.99999999999999644728632119949907064438`16."}
       },
       GridBoxAlignment->{
        "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
         "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.5599999999999999]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
           Offset[0.2], {
            Offset[0.4]}, 
           Offset[0.2]}, "RowsIndexed" -> {}}],
      Column], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]], ",", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", 
     TagBox[GridBox[{
        {"180.00000000000002842170943040400743484497`16."},
        {"60.00000000000000710542735760100185871124`16."},
        {"19.99999999999999644728632119949907064438`16."}
       },
       GridBoxAlignment->{
        "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
         "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.5599999999999999]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
           Offset[0.2], {
            Offset[0.4]}, 
           Offset[0.2]}, "RowsIndexed" -> {}}],
      Column], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]], ",", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", 
     TagBox[GridBox[{
        {"180.00000000000002842170943040400743484497`16."},
        {"60.00000000000000710542735760100185871124`16."},
        {"19.99999999999999644728632119949907064438`16."}
       },
       GridBoxAlignment->{
        "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
         "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.5599999999999999]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
           Offset[0.2], {
            Offset[0.4]}, 
           Offset[0.2]}, "RowsIndexed" -> {}}],
      Column], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]], ",", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", 
     TagBox[GridBox[{
        {"180.`16."},
        {"60.00000000000000710542735760100185871124`16."},
        {"20.00000000000001776356839400250464677811`16."}
       },
       GridBoxAlignment->{
        "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
         "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.5599999999999999]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
           Offset[0.2], {
            Offset[0.4]}, 
           Offset[0.2]}, "RowsIndexed" -> {}}],
      Column], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]], ",", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", 
     TagBox[GridBox[{
        {"180.`16."},
        {"60.00000000000000710542735760100185871124`16."},
        {"20.00000000000001776356839400250464677811`16."}
       },
       GridBoxAlignment->{
        "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
         "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.5599999999999999]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
           Offset[0.2], {
            Offset[0.4]}, 
           Offset[0.2]}, "RowsIndexed" -> {}}],
      Column], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]], ",", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", 
     TagBox[GridBox[{
        {"180.00000000000002842170943040400743484497`16."},
        {"60.00000000000000710542735760100185871124`16."},
        {"19.99999999999997157829056959599256515503`16."}
       },
       GridBoxAlignment->{
        "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
         "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.5599999999999999]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
           Offset[0.2], {
            Offset[0.4]}, 
           Offset[0.2]}, "RowsIndexed" -> {}}],
      Column], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]], ",", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", 
     TagBox[GridBox[{
        {"180.`16."},
        {"60.00000000000000710542735760100185871124`16."},
        {"19.99999999999999644728632119949907064438`16."}
       },
       GridBoxAlignment->{
        "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
         "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.5599999999999999]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
           Offset[0.2], {
            Offset[0.4]}, 
           Offset[0.2]}, "RowsIndexed" -> {}}],
      Column], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]], ",", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", 
     TagBox[GridBox[{
        {"180.`16."},
        {"59.99999999999998578914528479799628257751`16."},
        {"20.00000000000001776356839400250464677811`16."}
       },
       GridBoxAlignment->{
        "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
         "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.5599999999999999]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
           Offset[0.2], {
            Offset[0.4]}, 
           Offset[0.2]}, "RowsIndexed" -> {}}],
      Column], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]], ",", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", 
     TagBox[GridBox[{
        {"179.99999999999997157829056959599256515503`16."},
        {"60.00000000000000710542735760100185871124`16."},
        {"20.00000000000001776356839400250464677811`16."}
       },
       GridBoxAlignment->{
        "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
         "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.5599999999999999]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
           Offset[0.2], {
            Offset[0.4]}, 
           Offset[0.2]}, "RowsIndexed" -> {}}],
      Column], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]], ",", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", 
     TagBox[GridBox[{
        {"180.00000000000002842170943040400743484497`16."},
        {"60.00000000000000710542735760100185871124`16."},
        {"19.99999999999997157829056959599256515503`16."}
       },
       GridBoxAlignment->{
        "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
         "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.5599999999999999]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
           Offset[0.2], {
            Offset[0.4]}, 
           Offset[0.2]}, "RowsIndexed" -> {}}],
      Column], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]], ",", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", 
     TagBox[GridBox[{
        {"180.00000000000002842170943040400743484497`16."},
        {"60.00000000000000710542735760100185871124`16."},
        {"19.99999999999997157829056959599256515503`16."}
       },
       GridBoxAlignment->{
        "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
         "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.5599999999999999]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
           Offset[0.2], {
            Offset[0.4]}, 
           Offset[0.2]}, "RowsIndexed" -> {}}],
      Column], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]], ",", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", 
     TagBox[GridBox[{
        {"180.00000000000002842170943040400743484497`16."},
        {"60.00000000000000710542735760100185871124`16."},
        {"20.00000000000001776356839400250464677811`16."}
       },
       GridBoxAlignment->{
        "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
         "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.5599999999999999]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
           Offset[0.2], {
            Offset[0.4]}, 
           Offset[0.2]}, "RowsIndexed" -> {}}],
      Column], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]], ",", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", 
     TagBox[GridBox[{
        {"180.00000000000002842170943040400743484497`16."},
        {"60.00000000000000710542735760100185871124`16."},
        {"20.00000000000001776356839400250464677811`16."}
       },
       GridBoxAlignment->{
        "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
         "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.5599999999999999]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
           Offset[0.2], {
            Offset[0.4]}, 
           Offset[0.2]}, "RowsIndexed" -> {}}],
      Column], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]], ",", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", 
     TagBox[GridBox[{
        {"180.00000000000002842170943040400743484497`16."},
        {"60.00000000000000710542735760100185871124`16."},
        {"20.00000000000001776356839400250464677811`16."}
       },
       GridBoxAlignment->{
        "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
         "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.5599999999999999]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
           Offset[0.2], {
            Offset[0.4]}, 
           Offset[0.2]}, "RowsIndexed" -> {}}],
      Column], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]], ",", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", 
     TagBox[GridBox[{
        {"179.99999999999997157829056959599256515503`16."},
        {"60.00000000000005684341886080801486968994`16."},
        {"20.00000000000001776356839400250464677811`16."}
       },
       GridBoxAlignment->{
        "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
         "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.5599999999999999]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
           Offset[0.2], {
            Offset[0.4]}, 
           Offset[0.2]}, "RowsIndexed" -> {}}],
      Column], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]], ",", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", 
     TagBox[GridBox[{
        {"180.00000000000002842170943040400743484497`16."},
        {"60.00000000000005684341886080801486968994`16."},
        {"19.99999999999997157829056959599256515503`16."}
       },
       GridBoxAlignment->{
        "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
         "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.5599999999999999]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
           Offset[0.2], {
            Offset[0.4]}, 
           Offset[0.2]}, "RowsIndexed" -> {}}],
      Column], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]], ",", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", 
     TagBox[GridBox[{
        {"180.00000000000002842170943040400743484497`16."},
        {"60.00000000000000710542735760100185871124`16."},
        {"20.00000000000001776356839400250464677811`16."}
       },
       GridBoxAlignment->{
        "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
         "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.5599999999999999]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
           Offset[0.2], {
            Offset[0.4]}, 
           Offset[0.2]}, "RowsIndexed" -> {}}],
      Column], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]], ",", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", 
     TagBox[GridBox[{
        {"180.00000000000002842170943040400743484497`16."},
        {"60.00000000000000710542735760100185871124`16."},
        {"20.00000000000001776356839400250464677811`16."}
       },
       GridBoxAlignment->{
        "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
         "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.5599999999999999]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
           Offset[0.2], {
            Offset[0.4]}, 
           Offset[0.2]}, "RowsIndexed" -> {}}],
      Column], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]], ",", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", 
     TagBox[GridBox[{
        {"180.00000000000005684341886080801486968994`16."},
        {"60.00000000000000710542735760100185871124`16."},
        {"19.99999999999997157829056959599256515503`16."}
       },
       GridBoxAlignment->{
        "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
         "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.5599999999999999]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
           Offset[0.2], {
            Offset[0.4]}, 
           Offset[0.2]}, "RowsIndexed" -> {}}],
      Column], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]], ",", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", 
     TagBox[GridBox[{
        {"180.00000000000005684341886080801486968994`16."},
        {"59.99999999999996447286321199499070644379`16."},
        {"20.00000000000001776356839400250464677811`16."}
       },
       GridBoxAlignment->{
        "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
         "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.5599999999999999]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
           Offset[0.2], {
            Offset[0.4]}, 
           Offset[0.2]}, "RowsIndexed" -> {}}],
      Column], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]], ",", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", 
     TagBox[GridBox[{
        {"179.99999999999997157829056959599256515503`16."},
        {"60.00000000000005684341886080801486968994`16."},
        {"20.00000000000001776356839400250464677811`16."}
       },
       GridBoxAlignment->{
        "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
         "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.5599999999999999]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
           Offset[0.2], {
            Offset[0.4]}, 
           Offset[0.2]}, "RowsIndexed" -> {}}],
      Column], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]], ",", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", 
     TagBox[GridBox[{
        {"179.99999999999997157829056959599256515503`16."},
        {"60.00000000000005684341886080801486968994`16."},
        {"20.00000000000001776356839400250464677811`16."}
       },
       GridBoxAlignment->{
        "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
         "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.5599999999999999]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
           Offset[0.2], {
            Offset[0.4]}, 
           Offset[0.2]}, "RowsIndexed" -> {}}],
      Column], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]], ",", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", 
     TagBox[GridBox[{
        {"179.99999999999997157829056959599256515503`16."},
        {"60.00000000000005684341886080801486968994`16."},
        {"20.00000000000001776356839400250464677811`16."}
       },
       GridBoxAlignment->{
        "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
         "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.5599999999999999]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
           Offset[0.2], {
            Offset[0.4]}, 
           Offset[0.2]}, "RowsIndexed" -> {}}],
      Column], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]], ",", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", 
     TagBox[GridBox[{
        {"179.99999999999997157829056959599256515503`16."},
        {"60.00000000000000710542735760100185871124`16."},
        {"20.00000000000001776356839400250464677811`16."}
       },
       GridBoxAlignment->{
        "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
         "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.5599999999999999]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
           Offset[0.2], {
            Offset[0.4]}, 
           Offset[0.2]}, "RowsIndexed" -> {}}],
      Column], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]], ",", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", 
     TagBox[GridBox[{
        {"179.99999999999997157829056959599256515503`16."},
        {"60.00000000000000710542735760100185871124`16."},
        {"20.00000000000001776356839400250464677811`16."}
       },
       GridBoxAlignment->{
        "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
         "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.5599999999999999]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
           Offset[0.2], {
            Offset[0.4]}, 
           Offset[0.2]}, "RowsIndexed" -> {}}],
      Column], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]], ",", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", 
     TagBox[GridBox[{
        {"179.99999999999997157829056959599256515503`16."},
        {"60.00000000000000710542735760100185871124`16."},
        {"20.00000000000001776356839400250464677811`16."}
       },
       GridBoxAlignment->{
        "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
         "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.5599999999999999]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
           Offset[0.2], {
            Offset[0.4]}, 
           Offset[0.2]}, "RowsIndexed" -> {}}],
      Column], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]], ",", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", 
     TagBox[GridBox[{
        {"180.00000000000002842170943040400743484497`16."},
        {"59.99999999999996447286321199499070644379`16."},
        {"20.00000000000001776356839400250464677811`16."}
       },
       GridBoxAlignment->{
        "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
         "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.5599999999999999]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
           Offset[0.2], {
            Offset[0.4]}, 
           Offset[0.2]}, "RowsIndexed" -> {}}],
      Column], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]], ",", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", 
     TagBox[GridBox[{
        {"180.00000000000002842170943040400743484497`16."},
        {"59.99999999999996447286321199499070644379`16."},
        {"20.00000000000001776356839400250464677811`16."}
       },
       GridBoxAlignment->{
        "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
         "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.5599999999999999]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
           Offset[0.2], {
            Offset[0.4]}, 
           Offset[0.2]}, "RowsIndexed" -> {}}],
      Column], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]], ",", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", 
     TagBox[GridBox[{
        {"180.00000000000002842170943040400743484497`16."},
        {"59.99999999999996447286321199499070644379`16."},
        {"20.00000000000001776356839400250464677811`16."}
       },
       GridBoxAlignment->{
        "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
         "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.5599999999999999]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
           Offset[0.2], {
            Offset[0.4]}, 
           Offset[0.2]}, "RowsIndexed" -> {}}],
      Column], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]], ",", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", 
     TagBox[GridBox[{
        {"179.99999999999997157829056959599256515503`16."},
        {"60.00000000000000710542735760100185871124`16."},
        {"20.00000000000001776356839400250464677811`16."}
       },
       GridBoxAlignment->{
        "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
         "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.5599999999999999]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
           Offset[0.2], {
            Offset[0.4]}, 
           Offset[0.2]}, "RowsIndexed" -> {}}],
      Column], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]], ",", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", 
     TagBox[GridBox[{
        {"180.00000000000002842170943040400743484497`16."},
        {"60.00000000000000710542735760100185871124`16."},
        {"19.99999999999997157829056959599256515503`16."}
       },
       GridBoxAlignment->{
        "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
         "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.5599999999999999]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
           Offset[0.2], {
            Offset[0.4]}, 
           Offset[0.2]}, "RowsIndexed" -> {}}],
      Column], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]], ",", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", 
     TagBox[GridBox[{
        {"180.00000000000002842170943040400743484497`16."},
        {"60.00000000000000710542735760100185871124`16."},
        {"19.99999999999997157829056959599256515503`16."}
       },
       GridBoxAlignment->{
        "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
         "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.5599999999999999]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
           Offset[0.2], {
            Offset[0.4]}, 
           Offset[0.2]}, "RowsIndexed" -> {}}],
      Column], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]], ",", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", 
     TagBox[GridBox[{
        {"180.00000000000005684341886080801486968994`16."},
        {"59.99999999999996447286321199499070644379`16."},
        {"19.99999999999997157829056959599256515503`16."}
       },
       GridBoxAlignment->{
        "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
         "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.5599999999999999]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
           Offset[0.2], {
            Offset[0.4]}, 
           Offset[0.2]}, "RowsIndexed" -> {}}],
      Column], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]], ",", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", 
     TagBox[GridBox[{
        {"180.00000000000002842170943040400743484497`16."},
        {"59.99999999999996447286321199499070644379`16."},
        {"20.00000000000001776356839400250464677811`16."}
       },
       GridBoxAlignment->{
        "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
         "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.5599999999999999]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
           Offset[0.2], {
            Offset[0.4]}, 
           Offset[0.2]}, "RowsIndexed" -> {}}],
      Column], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]], ",", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", 
     TagBox[GridBox[{
        {"180.00000000000002842170943040400743484497`16."},
        {"59.99999999999996447286321199499070644379`16."},
        {"20.00000000000001776356839400250464677811`16."}
       },
       GridBoxAlignment->{
        "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
         "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
       GridBoxSpacings->{"Columns" -> {
           Offset[0.27999999999999997`], {
            Offset[0.5599999999999999]}, 
           Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
           Offset[0.2], {
            Offset[0.4]}, 
           Offset[0.2]}, "RowsIndexed" -> {}}],
      Column], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]]}], "}"}]], "Output",
 CellChangeTimes->{
  3.7235056633778315`*^9, {3.7235057267213154`*^9, 3.72350574884632*^9}, 
   3.7235058719249067`*^9, 3.7235061165654483`*^9, 3.7235119033810225`*^9, 
   3.72351199906176*^9, 3.723981170104637*^9, 3.7265158705191135`*^9, 
   3.7265192194647903`*^9, 3.7284277488612876`*^9, 3.7404311039543076`*^9, 
   3.8491230172869864`*^9, 3.850324009229494*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Compute flux 6-norm:", "Subsection",
 CellChangeTimes->{{3.7239812397455273`*^9, 3.723981246962036*^9}, {
  3.7265193731517396`*^9, 3.7265193758391666`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"fluxNorm", " ", "=", "0"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"For", "[", 
  RowBox[{
   RowBox[{"i", "=", "1"}], ",", " ", 
   RowBox[{"i", "\[LessEqual]", " ", 
    RowBox[{"Length", "[", "connect", "]"}]}], ",", 
   RowBox[{"i", "++"}], ",", 
   RowBox[{"Block", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"i1", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"connect", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}], "+", "1"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"i2", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"connect", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "[", 
          RowBox[{"[", "2", "]"}], "]"}], "+", "1"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"i3", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"connect", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "[", 
          RowBox[{"[", "3", "]"}], "]"}], "+", "1"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"i4", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"connect", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "[", 
          RowBox[{"[", "4", "]"}], "]"}], "+", "1"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"ids", "=", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"ndofs", " ", 
            RowBox[{"(", 
             RowBox[{"i1", "-", "1"}], ")"}]}], "+", "1"}], ",", 
          RowBox[{
           RowBox[{"ndofs", 
            RowBox[{"(", " ", 
             RowBox[{"i2", "-", "1"}], ")"}]}], "+", "1"}], ",", 
          RowBox[{
           RowBox[{"ndofs", 
            RowBox[{"(", 
             RowBox[{"i3", "-", "1"}], ")"}]}], "+", "1"}], ",", 
          RowBox[{
           RowBox[{"ndofs", 
            RowBox[{"(", 
             RowBox[{"i4", "-", "1"}], ")"}]}], "+", "1"}]}], "}"}]}]}], 
      "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"cellFlux", "=", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"S", "/.", 
          RowBox[{"{", 
           RowBox[{"\[Mu]", "\[Rule]", "100.0"}], "}"}]}], ")"}], ".", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Gmatrix", "[", 
           RowBox[{
            RowBox[{"xv", "[", 
             RowBox[{"[", "i1", "]"}], "]"}], ",", 
            RowBox[{"yv", "[", 
             RowBox[{"[", "i1", "]"}], "]"}], ",", 
            RowBox[{"zv", "[", 
             RowBox[{"[", "i1", "]"}], "]"}], ",", 
            RowBox[{"xv", "[", 
             RowBox[{"[", "i2", "]"}], "]"}], ",", 
            RowBox[{"yv", "[", 
             RowBox[{"[", "i2", "]"}], "]"}], ",", 
            RowBox[{"zv", "[", 
             RowBox[{"[", "i2", "]"}], "]"}], ",", 
            RowBox[{"xv", "[", 
             RowBox[{"[", "i3", "]"}], "]"}], ",", 
            RowBox[{"yv", "[", 
             RowBox[{"[", "i3", "]"}], "]"}], ",", 
            RowBox[{"zv", "[", 
             RowBox[{"[", "i3", "]"}], "]"}], ",", 
            RowBox[{"xv", "[", 
             RowBox[{"[", "i4", "]"}], "]"}], ",", 
            RowBox[{"yv", "[", 
             RowBox[{"[", "i4", "]"}], "]"}], ",", 
            RowBox[{"zv", "[", 
             RowBox[{"[", "i4", "]"}], "]"}]}], "]"}], ".", 
          RowBox[{"(", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"uv", "[", 
              RowBox[{"[", 
               RowBox[{"ids", "[", 
                RowBox[{"[", "i", "]"}], "]"}], "]"}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "1", ",", "4"}], "}"}]}], "]"}], ")"}]}], 
         ")"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"cellVolume", "=", 
       RowBox[{"gaussWeight", " ", 
        RowBox[{"Abs", "[", 
         RowBox[{"Detj", "[", 
          RowBox[{
           RowBox[{"xv", "[", 
            RowBox[{"[", "i1", "]"}], "]"}], ",", 
           RowBox[{"yv", "[", 
            RowBox[{"[", "i1", "]"}], "]"}], ",", 
           RowBox[{"zv", "[", 
            RowBox[{"[", "i1", "]"}], "]"}], ",", 
           RowBox[{"xv", "[", 
            RowBox[{"[", "i2", "]"}], "]"}], ",", 
           RowBox[{"yv", "[", 
            RowBox[{"[", "i2", "]"}], "]"}], ",", 
           RowBox[{"zv", "[", 
            RowBox[{"[", "i2", "]"}], "]"}], ",", 
           RowBox[{"xv", "[", 
            RowBox[{"[", "i3", "]"}], "]"}], ",", 
           RowBox[{"yv", "[", 
            RowBox[{"[", "i3", "]"}], "]"}], ",", 
           RowBox[{"zv", "[", 
            RowBox[{"[", "i3", "]"}], "]"}], ",", 
           RowBox[{"xv", "[", 
            RowBox[{"[", "i4", "]"}], "]"}], ",", 
           RowBox[{"yv", "[", 
            RowBox[{"[", "i4", "]"}], "]"}], ",", 
           RowBox[{"zv", "[", 
            RowBox[{"[", "i4", "]"}], "]"}]}], "]"}], "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"fluxNorm", "+=", 
       RowBox[{"cellVolume", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"cellFlux", ".", "cellFlux"}], ")"}], "6"]}]}], ";"}]}], 
    "\[IndentingNewLine]", "]"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"SetPrecision", "[", 
  RowBox[{
   SuperscriptBox["fluxNorm", 
    RowBox[{"1", "/", "12"}]], ",", "16"}], "]"}]}], "Input",
 CellChangeTimes->{{3.7167647605597653`*^9, 3.7167647892518883`*^9}, {
   3.7167648244240847`*^9, 3.716764841539942*^9}, {3.71676488019324*^9, 
   3.7167648969754357`*^9}, {3.716765065628334*^9, 3.716765185350045*^9}, {
   3.7167652229401484`*^9, 3.7167652383100395`*^9}, {3.7167653441168547`*^9, 
   3.7167655199547443`*^9}, {3.7167655675522327`*^9, 
   3.7167655810711265`*^9}, {3.716765622284607*^9, 3.7167656290567384`*^9}, {
   3.716765757154343*^9, 3.716765792076064*^9}, {3.7167658276745405`*^9, 
   3.7167660826802125`*^9}, {3.716766195664576*^9, 3.716766242915578*^9}, {
   3.7167663310833845`*^9, 3.7167663393539863`*^9}, {3.7167664503932595`*^9, 
   3.716766450932579*^9}, {3.7167664868258085`*^9, 3.7167665635541043`*^9}, {
   3.716766627651472*^9, 3.716766643645746*^9}, {3.716766826115865*^9, 
   3.7167668360695195`*^9}, {3.716766868385886*^9, 3.7167669130203*^9}, {
   3.717155721663645*^9, 3.7171557331420517`*^9}, {3.717155769178903*^9, 
   3.7171557818205233`*^9}, {3.7171567883516493`*^9, 3.717156887869956*^9}, {
   3.717156918335051*^9, 3.717156937057849*^9}, {3.717157017416103*^9, 
   3.717157052623994*^9}, {3.717157895689323*^9, 3.717157931742132*^9}, {
   3.717166282194605*^9, 3.71716628473459*^9}, {3.71716849797501*^9, 
   3.71716852298344*^9}, {3.717168562021318*^9, 3.717168562125424*^9}, {
   3.717168843821663*^9, 3.717168857297769*^9}, {3.7171692165304537`*^9, 
   3.7171692208302*^9}, {3.717170006857576*^9, 3.717170018830927*^9}, {
   3.717171209233417*^9, 3.717171213025419*^9}, {3.7173548750864697`*^9, 
   3.717354881757492*^9}, {3.717354996753583*^9, 3.717355017245678*^9}, {
   3.717355319697336*^9, 3.7173553216726255`*^9}, {3.7173557531181636`*^9, 
   3.7173557820403166`*^9}, {3.7173558138063755`*^9, 
   3.7173558166812677`*^9}, {3.7173587645155315`*^9, 
   3.7173587704721184`*^9}, {3.7173588122062426`*^9, 
   3.7173588501286516`*^9}, {3.717359014190798*^9, 3.7173590339564075`*^9}, {
   3.7173591194571896`*^9, 3.7173591202540846`*^9}, {3.717360749384885*^9, 
   3.717360755072524*^9}, {3.7173608405541487`*^9, 3.7173608453215923`*^9}, {
   3.7174176653039513`*^9, 3.7174177502357674`*^9}, {3.717418005127076*^9, 
   3.717418022383568*^9}, {3.7174180927900662`*^9, 3.717418180868244*^9}, {
   3.717419219270834*^9, 3.7174192266613092`*^9}, {3.71741926925568*^9, 
   3.717419272755123*^9}, {3.7174241468474283`*^9, 3.7174241510843997`*^9}, {
   3.71742429898483*^9, 3.717424381678406*^9}, {3.717427960779907*^9, 
   3.7174279724352093`*^9}, {3.7174281618258095`*^9, 
   3.7174281652786007`*^9}, {3.7208066594239817`*^9, 
   3.7208066657144737`*^9}, {3.723057650960129*^9, 3.7230576545889745`*^9}, {
   3.7235054152685385`*^9, 3.723505446143653*^9}, {3.723505542221841*^9, 
   3.7235055715031414`*^9}, {3.723505611190547*^9, 3.7235056388310738`*^9}, 
   3.7235057207531905`*^9, {3.723511832834532*^9, 3.7235118497876167`*^9}, {
   3.723511887365533*^9, 3.72351189056898*^9}, {3.723995684619661*^9, 
   3.723995740838527*^9}, {3.7239961359975967`*^9, 3.723996236418959*^9}, {
   3.7239964864932685`*^9, 3.723996595881749*^9}, {3.723996660736905*^9, 
   3.723996697678873*^9}, {3.723996789225758*^9, 3.723996803881894*^9}, {
   3.7239968796275477`*^9, 3.723996888634445*^9}, {3.726519442206482*^9, 
   3.72651949125377*^9}, {3.726519557628924*^9, 3.72651958653504*^9}}],

Cell[BoxData["190.78784028338907319266581907868385314941`16."], "Output",
 CellChangeTimes->{{3.723996227294252*^9, 3.723996239137789*^9}, {
   3.723996559281272*^9, 3.7239965966440353`*^9}, {3.7239966733977313`*^9, 
   3.723996698491889*^9}, {3.723996795351232*^9, 3.7239968046163964`*^9}, 
   3.7239968894758997`*^9, 3.726515881378374*^9, 3.7265197468299546`*^9, 
   3.7284277522204046`*^9, 3.7404311072675185`*^9, 3.849123025988398*^9, 
   3.850324009255052*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Compute gradient of flux 6-norm wrt state:", "Subsection",
 CellChangeTimes->{{3.723997713981868*^9, 3.7239977512939644`*^9}, {
  3.7265224516078215`*^9, 3.726522454670375*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"totalFluxNorm", "=", "0"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"fluxNormGradU", "=", 
   RowBox[{"Table", "[", 
    RowBox[{"0.0", ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"ndofs", " ", 
        RowBox[{"Length", "[", "xv", "]"}]}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"For", "[", 
  RowBox[{
   RowBox[{"i", "=", "1"}], ",", " ", 
   RowBox[{"i", "\[LessEqual]", " ", 
    RowBox[{"Length", "[", "connect", "]"}]}], ",", 
   RowBox[{"i", "++"}], ",", 
   RowBox[{"Block", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"i1", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"connect", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}], "+", "1"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"i2", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"connect", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "[", 
          RowBox[{"[", "2", "]"}], "]"}], "+", "1"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"i3", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"connect", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "[", 
          RowBox[{"[", "3", "]"}], "]"}], "+", "1"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"i4", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"connect", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "[", 
          RowBox[{"[", "4", "]"}], "]"}], "+", "1"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"ids", "=", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"ndofs", " ", 
            RowBox[{"(", 
             RowBox[{"i1", "-", "1"}], ")"}]}], "+", "1"}], ",", 
          RowBox[{
           RowBox[{"ndofs", 
            RowBox[{"(", " ", 
             RowBox[{"i2", "-", "1"}], ")"}]}], "+", "1"}], ",", 
          RowBox[{
           RowBox[{"ndofs", 
            RowBox[{"(", 
             RowBox[{"i3", "-", "1"}], ")"}]}], "+", "1"}], ",", 
          RowBox[{
           RowBox[{"ndofs", 
            RowBox[{"(", 
             RowBox[{"i4", "-", "1"}], ")"}]}], "+", "1"}]}], "}"}]}]}], 
      "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"cellFlux", "=", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"S", "/.", 
          RowBox[{"{", 
           RowBox[{"\[Mu]", "\[Rule]", "100.0"}], "}"}]}], ")"}], ".", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Gmatrix", "[", 
           RowBox[{
            RowBox[{"xv", "[", 
             RowBox[{"[", "i1", "]"}], "]"}], ",", 
            RowBox[{"yv", "[", 
             RowBox[{"[", "i1", "]"}], "]"}], ",", 
            RowBox[{"zv", "[", 
             RowBox[{"[", "i1", "]"}], "]"}], ",", 
            RowBox[{"xv", "[", 
             RowBox[{"[", "i2", "]"}], "]"}], ",", 
            RowBox[{"yv", "[", 
             RowBox[{"[", "i2", "]"}], "]"}], ",", 
            RowBox[{"zv", "[", 
             RowBox[{"[", "i2", "]"}], "]"}], ",", 
            RowBox[{"xv", "[", 
             RowBox[{"[", "i3", "]"}], "]"}], ",", 
            RowBox[{"yv", "[", 
             RowBox[{"[", "i3", "]"}], "]"}], ",", 
            RowBox[{"zv", "[", 
             RowBox[{"[", "i3", "]"}], "]"}], ",", 
            RowBox[{"xv", "[", 
             RowBox[{"[", "i4", "]"}], "]"}], ",", 
            RowBox[{"yv", "[", 
             RowBox[{"[", "i4", "]"}], "]"}], ",", 
            RowBox[{"zv", "[", 
             RowBox[{"[", "i4", "]"}], "]"}]}], "]"}], ".", 
          RowBox[{"{", 
           RowBox[{"u1", ",", "u2", ",", "u3", ",", "u4"}], "}"}]}], 
         ")"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"cellVolume", "=", 
       RowBox[{"gaussWeight", " ", 
        RowBox[{"Abs", "[", 
         RowBox[{"Detj", "[", 
          RowBox[{
           RowBox[{"xv", "[", 
            RowBox[{"[", "i1", "]"}], "]"}], ",", 
           RowBox[{"yv", "[", 
            RowBox[{"[", "i1", "]"}], "]"}], ",", 
           RowBox[{"zv", "[", 
            RowBox[{"[", "i1", "]"}], "]"}], ",", 
           RowBox[{"xv", "[", 
            RowBox[{"[", "i2", "]"}], "]"}], ",", 
           RowBox[{"yv", "[", 
            RowBox[{"[", "i2", "]"}], "]"}], ",", 
           RowBox[{"zv", "[", 
            RowBox[{"[", "i2", "]"}], "]"}], ",", 
           RowBox[{"xv", "[", 
            RowBox[{"[", "i3", "]"}], "]"}], ",", 
           RowBox[{"yv", "[", 
            RowBox[{"[", "i3", "]"}], "]"}], ",", 
           RowBox[{"zv", "[", 
            RowBox[{"[", "i3", "]"}], "]"}], ",", 
           RowBox[{"xv", "[", 
            RowBox[{"[", "i4", "]"}], "]"}], ",", 
           RowBox[{"yv", "[", 
            RowBox[{"[", "i4", "]"}], "]"}], ",", 
           RowBox[{"zv", "[", 
            RowBox[{"[", "i4", "]"}], "]"}]}], "]"}], "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"fluxNorm", "=", 
       RowBox[{"cellVolume", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"cellFlux", ".", "cellFlux"}], ")"}], "6"]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"totalFluxNorm", "+=", 
       RowBox[{"(", 
        RowBox[{"fluxNorm", "/.", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"u1", "\[Rule]", 
            RowBox[{"uv", "[", 
             RowBox[{"[", 
              RowBox[{"ids", "[", 
               RowBox[{"[", "1", "]"}], "]"}], "]"}], "]"}]}], ",", 
           RowBox[{"u2", "\[Rule]", 
            RowBox[{"uv", "[", 
             RowBox[{"[", 
              RowBox[{"ids", "[", 
               RowBox[{"[", "2", "]"}], "]"}], "]"}], "]"}]}], ",", 
           RowBox[{"u3", "\[Rule]", 
            RowBox[{"uv", "[", 
             RowBox[{"[", 
              RowBox[{"ids", "[", 
               RowBox[{"[", "3", "]"}], "]"}], "]"}], "]"}]}], ",", 
           RowBox[{"u4", "\[Rule]", 
            RowBox[{"uv", "[", 
             RowBox[{"[", 
              RowBox[{"ids", "[", 
               RowBox[{"[", "4", "]"}], "]"}], "]"}], "]"}]}]}], "}"}]}], 
        ")"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"du", "=", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"D", "[", 
            RowBox[{"fluxNorm", ",", "u1"}], "]"}], ",", 
           RowBox[{"D", "[", 
            RowBox[{"fluxNorm", ",", "u2"}], "]"}], ",", 
           RowBox[{"D", "[", 
            RowBox[{"fluxNorm", ",", "u3"}], "]"}], ",", 
           RowBox[{"D", "[", 
            RowBox[{"fluxNorm", ",", "u4"}], "]"}]}], "}"}], "/.", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"u1", "\[Rule]", 
            RowBox[{"uv", "[", 
             RowBox[{"[", 
              RowBox[{"ids", "[", 
               RowBox[{"[", "1", "]"}], "]"}], "]"}], "]"}]}], ",", 
           RowBox[{"u2", "\[Rule]", 
            RowBox[{"uv", "[", 
             RowBox[{"[", 
              RowBox[{"ids", "[", 
               RowBox[{"[", "2", "]"}], "]"}], "]"}], "]"}]}], ",", 
           RowBox[{"u3", "\[Rule]", 
            RowBox[{"uv", "[", 
             RowBox[{"[", 
              RowBox[{"ids", "[", 
               RowBox[{"[", "3", "]"}], "]"}], "]"}], "]"}]}], ",", 
           RowBox[{"u4", "\[Rule]", 
            RowBox[{"uv", "[", 
             RowBox[{"[", 
              RowBox[{"ids", "[", 
               RowBox[{"[", "4", "]"}], "]"}], "]"}], "]"}]}]}], "}"}]}], 
        ")"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"j", "=", "1"}], ",", 
        RowBox[{"j", "\[LessEqual]", "4"}], ",", 
        RowBox[{"j", "++"}], ",", 
        RowBox[{
         RowBox[{"fluxNormGradU", "[", 
          RowBox[{"[", 
           RowBox[{"ids", "[", 
            RowBox[{"[", "j", "]"}], "]"}], "]"}], "]"}], "+=", 
         RowBox[{"du", "[", 
          RowBox[{"[", "j", "]"}], "]"}]}]}], "]"}], ";"}]}], 
    "\[IndentingNewLine]", "]"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"fluxNormGradU", "*=", 
   RowBox[{
    FractionBox["1", "12"], 
    SuperscriptBox["totalFluxNorm", 
     FractionBox[
      RowBox[{"(", 
       RowBox[{"1.0", "-", "12.0"}], ")"}], "12.0"]]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.7167647605597653`*^9, 3.7167647892518883`*^9}, {
   3.7167648244240847`*^9, 3.716764841539942*^9}, {3.71676488019324*^9, 
   3.7167648969754357`*^9}, {3.716765065628334*^9, 3.716765185350045*^9}, {
   3.7167652229401484`*^9, 3.7167652383100395`*^9}, {3.7167653441168547`*^9, 
   3.7167655199547443`*^9}, {3.7167655675522327`*^9, 
   3.7167655810711265`*^9}, {3.716765622284607*^9, 3.7167656290567384`*^9}, {
   3.716765757154343*^9, 3.716765792076064*^9}, {3.7167658276745405`*^9, 
   3.7167660826802125`*^9}, {3.716766195664576*^9, 3.716766242915578*^9}, {
   3.7167663310833845`*^9, 3.7167663393539863`*^9}, {3.7167664503932595`*^9, 
   3.716766450932579*^9}, {3.7167664868258085`*^9, 3.7167665635541043`*^9}, {
   3.716766627651472*^9, 3.716766643645746*^9}, {3.716766826115865*^9, 
   3.7167668360695195`*^9}, {3.716766868385886*^9, 3.7167669130203*^9}, {
   3.717155721663645*^9, 3.7171557331420517`*^9}, {3.717155769178903*^9, 
   3.7171557818205233`*^9}, {3.7171567883516493`*^9, 3.717156887869956*^9}, {
   3.717156918335051*^9, 3.717156937057849*^9}, {3.717157017416103*^9, 
   3.717157052623994*^9}, {3.717157895689323*^9, 3.717157931742132*^9}, {
   3.717166282194605*^9, 3.71716628473459*^9}, {3.71716849797501*^9, 
   3.71716852298344*^9}, {3.717168562021318*^9, 3.717168562125424*^9}, {
   3.717168843821663*^9, 3.717168857297769*^9}, {3.7171692165304537`*^9, 
   3.7171692208302*^9}, {3.717170006857576*^9, 3.717170018830927*^9}, {
   3.717171209233417*^9, 3.717171213025419*^9}, {3.7173548750864697`*^9, 
   3.717354881757492*^9}, {3.717354996753583*^9, 3.717355017245678*^9}, {
   3.717355319697336*^9, 3.7173553216726255`*^9}, {3.7173557531181636`*^9, 
   3.7173557820403166`*^9}, {3.7173558138063755`*^9, 
   3.7173558166812677`*^9}, {3.7173587645155315`*^9, 
   3.7173587704721184`*^9}, {3.7173588122062426`*^9, 
   3.7173588501286516`*^9}, {3.717359014190798*^9, 3.7173590339564075`*^9}, {
   3.7173591194571896`*^9, 3.7173591202540846`*^9}, {3.717360749384885*^9, 
   3.717360755072524*^9}, {3.7173608405541487`*^9, 3.7173608453215923`*^9}, {
   3.7174176653039513`*^9, 3.7174177502357674`*^9}, {3.717418005127076*^9, 
   3.717418022383568*^9}, {3.7174180927900662`*^9, 3.717418180868244*^9}, {
   3.717419219270834*^9, 3.7174192266613092`*^9}, {3.71741926925568*^9, 
   3.717419272755123*^9}, {3.7174241468474283`*^9, 3.7174241510843997`*^9}, {
   3.71742429898483*^9, 3.717424381678406*^9}, {3.717427960779907*^9, 
   3.7174279724352093`*^9}, {3.7174281618258095`*^9, 
   3.7174281652786007`*^9}, {3.7208066594239817`*^9, 
   3.7208066657144737`*^9}, {3.723057650960129*^9, 3.7230576545889745`*^9}, {
   3.7235054152685385`*^9, 3.723505446143653*^9}, {3.723505542221841*^9, 
   3.7235055715031414`*^9}, {3.723505611190547*^9, 3.7235056388310738`*^9}, 
   3.7235057207531905`*^9, {3.723511832834532*^9, 3.7235118497876167`*^9}, {
   3.723511887365533*^9, 3.72351189056898*^9}, {3.723995684619661*^9, 
   3.723995740838527*^9}, {3.7239961359975967`*^9, 3.723996236418959*^9}, {
   3.7239964864932685`*^9, 3.723996595881749*^9}, {3.723996660736905*^9, 
   3.723996697678873*^9}, {3.723996789225758*^9, 3.723996803881894*^9}, {
   3.7239968796275477`*^9, 3.723996888634445*^9}, {3.7239978268565784`*^9, 
   3.723997848919774*^9}, {3.7239979939234915`*^9, 3.723998123923856*^9}, {
   3.723998343319007*^9, 3.723998359257045*^9}, 3.7239984107928753`*^9, {
   3.7239984412881813`*^9, 3.723998472309635*^9}, {3.723998562980158*^9, 
   3.723998576527381*^9}, {3.723998627452985*^9, 3.7239987042927628`*^9}, {
   3.723998748964592*^9, 3.723998752515873*^9}, {3.7239988402469745`*^9, 
   3.7239989766055064`*^9}, {3.724002515687359*^9, 3.724002531227868*^9}, 
   3.724002932106194*^9, {3.7265224589513254`*^9, 3.726522608560412*^9}, {
   3.7265226554819508`*^9, 3.7265227527793913`*^9}, {3.7265230290776963`*^9, 
   3.726523107031155*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"SetPrecision", "[", 
  RowBox[{"fluxNormGradU", ",", "16"}], "]"}]], "Input",
 CellChangeTimes->{{3.7239981347202115`*^9, 3.7239981379312325`*^9}, {
  3.724000016469468*^9, 3.7240000229688377`*^9}, {3.7265227661699657`*^9, 
  3.7265227691381087`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"-", "11.35641906448747917579567001666873693466`16."}], ",", 
   RowBox[{"-", "15.72427255082882346925998717779293656349`16."}], ",", 
   RowBox[{"-", "4.36785348634133629985853985999710857868`16."}], ",", 
   RowBox[{"-", "13.10356045902401156411087868036702275276`16."}], ",", 
   RowBox[{"-", "23.58640882624324675020943686831742525101`16."}], ",", 
   RowBox[{"-", "10.48284836721918900082073378143832087517`16."}], ",", 
   RowBox[{"-", "1.74714139453653394262744313891744241118`16."}], ",", 
   RowBox[{"-", "7.86213627541441795187893148977309465408`16."}], ",", 
   RowBox[{"-", "6.11499488087786957635216822382062673569`16."}], ",", 
   RowBox[{"-", "5.24142418360961936940611849422566592693`16."}], ",", 
   RowBox[{"-", "7.86213627541439574741843898664228618145`16."}], ",", 
   RowBox[{"-", "2.62071209180479680611597359529696404934`16."}], ",", 
   RowBox[{"-", "2.62071209180479991474044254573527723551`16."}], ",", 
   "1.69099953647965219111484382342796050082106389`16.*^-14", ",", 
   "2.62071209180474884448130978853441774845`16.", ",", 
   "2.62071209180480524381096074648667126894`16.", ",", 
   "7.86213627541444637358836189378052949905`16.", ",", 
   "5.24142418360959094769668809021823108196`16.", ",", 
   "6.11499488087788112267162432544864714146`16.", ",", 
   "7.86213627541439397106159958639182150364`16.", ",", 
   "1.74714139453653127809218403854174539447`16.", ",", 
   "10.48284836721921564617332478519529104233`16.", ",", 
   "23.58640882624324319749575806781649589539`16.", ",", 
   "13.10356045902404353853398788487538695335`16.", ",", 
   "4.36785348634132919443118225899524986744`16.", ",", 
   "15.72427255082878794212319917278364300728`16.", ",", 
   "11.35641906448748450486618821742013096809`16."}], "}"}]], "Output",
 CellChangeTimes->{3.723998139299197*^9, 3.7239984776684504`*^9, 
  3.723998772037675*^9, 3.723998982308257*^9, 3.7240000245319033`*^9, 
  3.7265158940653973`*^9, 3.726522770966097*^9, 3.726523116250061*^9, 
  3.728427764048768*^9, 3.7404311170823307`*^9, 3.84912303317443*^9, 
  3.850324009287486*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Compute gradient of flux 6-norm wrt control:", "Subsection",
 CellChangeTimes->{{3.723997713981868*^9, 3.7239977512939644`*^9}, {
  3.72400246288676*^9, 3.7240024648995476`*^9}, {3.7265238020314674`*^9, 
  3.7265238049068527`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"totalFluxNorm", "=", "0"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"fluxNormGradZ", "=", 
   RowBox[{"Table", "[", 
    RowBox[{"0.0", ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"Length", "[", "xv", "]"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"For", "[", 
  RowBox[{
   RowBox[{"i", "=", "1"}], ",", " ", 
   RowBox[{"i", "\[LessEqual]", " ", 
    RowBox[{"Length", "[", "connect", "]"}]}], ",", 
   RowBox[{"i", "++"}], ",", 
   RowBox[{"Block", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"i1", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"connect", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}], "+", "1"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"i2", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"connect", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "[", 
          RowBox[{"[", "2", "]"}], "]"}], "+", "1"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"i3", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"connect", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "[", 
          RowBox[{"[", "3", "]"}], "]"}], "+", "1"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"i4", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"connect", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "[", 
          RowBox[{"[", "4", "]"}], "]"}], "+", "1"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"ids", "=", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"ndofs", " ", 
            RowBox[{"(", 
             RowBox[{"i1", "-", "1"}], ")"}]}], "+", "1"}], ",", 
          RowBox[{
           RowBox[{"ndofs", 
            RowBox[{"(", " ", 
             RowBox[{"i2", "-", "1"}], ")"}]}], "+", "1"}], ",", 
          RowBox[{
           RowBox[{"ndofs", 
            RowBox[{"(", 
             RowBox[{"i3", "-", "1"}], ")"}]}], "+", "1"}], ",", 
          RowBox[{
           RowBox[{"ndofs", 
            RowBox[{"(", 
             RowBox[{"i4", "-", "1"}], ")"}]}], "+", "1"}]}], "}"}]}]}], 
      "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"cellFlux", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"S", "/.", 
           RowBox[{"{", 
            RowBox[{"\[Mu]", "\[Rule]", "100.0"}], "}"}]}], ")"}], ".", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Gmatrix", "[", 
            RowBox[{
             RowBox[{"xv", "[", 
              RowBox[{"[", "i1", "]"}], "]"}], ",", 
             RowBox[{"yv", "[", 
              RowBox[{"[", "i1", "]"}], "]"}], ",", 
             RowBox[{"zv", "[", 
              RowBox[{"[", "i1", "]"}], "]"}], ",", 
             RowBox[{"xv", "[", 
              RowBox[{"[", "i2", "]"}], "]"}], ",", 
             RowBox[{"yv", "[", 
              RowBox[{"[", "i2", "]"}], "]"}], ",", 
             RowBox[{"zv", "[", 
              RowBox[{"[", "i2", "]"}], "]"}], ",", 
             RowBox[{"xv", "[", 
              RowBox[{"[", "i3", "]"}], "]"}], ",", 
             RowBox[{"yv", "[", 
              RowBox[{"[", "i3", "]"}], "]"}], ",", 
             RowBox[{"zv", "[", 
              RowBox[{"[", "i3", "]"}], "]"}], ",", 
             RowBox[{"xv", "[", 
              RowBox[{"[", "i4", "]"}], "]"}], ",", 
             RowBox[{"yv", "[", 
              RowBox[{"[", "i4", "]"}], "]"}], ",", 
             RowBox[{"zv", "[", 
              RowBox[{"[", "i4", "]"}], "]"}]}], "]"}], ".", 
           RowBox[{"(", 
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"uv", "[", 
               RowBox[{"[", 
                RowBox[{"ids", "[", 
                 RowBox[{"[", "i", "]"}], "]"}], "]"}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"i", ",", "1", ",", "4"}], "}"}]}], "]"}], ")"}]}], 
          ")"}]}], 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"\[Rho]1", "+", "\[Rho]2", "+", "\[Rho]3", "+", "\[Rho]4"}],
           ")"}], "/", "4"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"cellVolume", "=", 
       RowBox[{"gaussWeight", " ", 
        RowBox[{"Abs", "[", 
         RowBox[{"Detj", "[", 
          RowBox[{
           RowBox[{"xv", "[", 
            RowBox[{"[", "i1", "]"}], "]"}], ",", 
           RowBox[{"yv", "[", 
            RowBox[{"[", "i1", "]"}], "]"}], ",", 
           RowBox[{"zv", "[", 
            RowBox[{"[", "i1", "]"}], "]"}], ",", 
           RowBox[{"xv", "[", 
            RowBox[{"[", "i2", "]"}], "]"}], ",", 
           RowBox[{"yv", "[", 
            RowBox[{"[", "i2", "]"}], "]"}], ",", 
           RowBox[{"zv", "[", 
            RowBox[{"[", "i2", "]"}], "]"}], ",", 
           RowBox[{"xv", "[", 
            RowBox[{"[", "i3", "]"}], "]"}], ",", 
           RowBox[{"yv", "[", 
            RowBox[{"[", "i3", "]"}], "]"}], ",", 
           RowBox[{"zv", "[", 
            RowBox[{"[", "i3", "]"}], "]"}], ",", 
           RowBox[{"xv", "[", 
            RowBox[{"[", "i4", "]"}], "]"}], ",", 
           RowBox[{"yv", "[", 
            RowBox[{"[", "i4", "]"}], "]"}], ",", 
           RowBox[{"zv", "[", 
            RowBox[{"[", "i4", "]"}], "]"}]}], "]"}], "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"fluxNorm", "=", 
       RowBox[{"cellVolume", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"cellFlux", ".", "cellFlux"}], ")"}], "6"]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"d\[Rho]", "=", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"D", "[", 
            RowBox[{"fluxNorm", ",", "\[Rho]1"}], "]"}], ",", 
           RowBox[{"D", "[", 
            RowBox[{"fluxNorm", ",", "\[Rho]2"}], "]"}], ",", 
           RowBox[{"D", "[", 
            RowBox[{"fluxNorm", ",", "\[Rho]3"}], "]"}], ",", 
           RowBox[{"D", "[", 
            RowBox[{"fluxNorm", ",", "\[Rho]4"}], "]"}]}], "}"}], "/.", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"\[Rho]1", "\[Rule]", "1.0"}], ",", 
           RowBox[{"\[Rho]2", "\[Rule]", "1.0"}], ",", 
           RowBox[{"\[Rho]3", "\[Rule]", "1.0"}], ",", 
           RowBox[{"\[Rho]4", "\[Rule]", "1.0"}]}], "}"}]}], ")"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"totalFluxNorm", "+=", 
       RowBox[{"(", 
        RowBox[{"fluxNorm", "/.", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"\[Rho]1", "\[Rule]", "1.0"}], ",", 
           RowBox[{"\[Rho]2", "\[Rule]", "1.0"}], ",", 
           RowBox[{"\[Rho]3", "\[Rule]", "1.0"}], ",", 
           RowBox[{"\[Rho]4", "\[Rule]", "1.0"}]}], "}"}]}], ")"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"fluxNormGradZ", "[", 
        RowBox[{"[", "i1", "]"}], "]"}], "+=", 
       RowBox[{"d\[Rho]", "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"fluxNormGradZ", "[", 
        RowBox[{"[", "i2", "]"}], "]"}], "+=", 
       RowBox[{"d\[Rho]", "[", 
        RowBox[{"[", "2", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"fluxNormGradZ", "[", 
        RowBox[{"[", "i3", "]"}], "]"}], "+=", 
       RowBox[{"d\[Rho]", "[", 
        RowBox[{"[", "3", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"fluxNormGradZ", "[", 
        RowBox[{"[", "i4", "]"}], "]"}], "+=", 
       RowBox[{"d\[Rho]", "[", 
        RowBox[{"[", "4", "]"}], "]"}]}], ";"}]}], "\[IndentingNewLine]", 
    "]"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"fluxNormGradZ", "*=", 
   RowBox[{
    FractionBox["1", "12"], 
    SuperscriptBox["totalFluxNorm", 
     FractionBox[
      RowBox[{"(", 
       RowBox[{"1.0", "-", "12.0"}], ")"}], "12.0"]]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.7167647605597653`*^9, 3.7167647892518883`*^9}, {
   3.7167648244240847`*^9, 3.716764841539942*^9}, {3.71676488019324*^9, 
   3.7167648969754357`*^9}, {3.716765065628334*^9, 3.716765185350045*^9}, {
   3.7167652229401484`*^9, 3.7167652383100395`*^9}, {3.7167653441168547`*^9, 
   3.7167655199547443`*^9}, {3.7167655675522327`*^9, 
   3.7167655810711265`*^9}, {3.716765622284607*^9, 3.7167656290567384`*^9}, {
   3.716765757154343*^9, 3.716765792076064*^9}, {3.7167658276745405`*^9, 
   3.7167660826802125`*^9}, {3.716766195664576*^9, 3.716766242915578*^9}, {
   3.7167663310833845`*^9, 3.7167663393539863`*^9}, {3.7167664503932595`*^9, 
   3.716766450932579*^9}, {3.7167664868258085`*^9, 3.7167665635541043`*^9}, {
   3.716766627651472*^9, 3.716766643645746*^9}, {3.716766826115865*^9, 
   3.7167668360695195`*^9}, {3.716766868385886*^9, 3.7167669130203*^9}, {
   3.717155721663645*^9, 3.7171557331420517`*^9}, {3.717155769178903*^9, 
   3.7171557818205233`*^9}, {3.7171567883516493`*^9, 3.717156887869956*^9}, {
   3.717156918335051*^9, 3.717156937057849*^9}, {3.717157017416103*^9, 
   3.717157052623994*^9}, {3.717157895689323*^9, 3.717157931742132*^9}, {
   3.717166282194605*^9, 3.71716628473459*^9}, {3.71716849797501*^9, 
   3.71716852298344*^9}, {3.717168562021318*^9, 3.717168562125424*^9}, {
   3.717168843821663*^9, 3.717168857297769*^9}, {3.7171692165304537`*^9, 
   3.7171692208302*^9}, {3.717170006857576*^9, 3.717170018830927*^9}, {
   3.717171209233417*^9, 3.717171213025419*^9}, {3.7173548750864697`*^9, 
   3.717354881757492*^9}, {3.717354996753583*^9, 3.717355017245678*^9}, {
   3.717355319697336*^9, 3.7173553216726255`*^9}, {3.7173557531181636`*^9, 
   3.7173557820403166`*^9}, {3.7173558138063755`*^9, 
   3.7173558166812677`*^9}, {3.7173587645155315`*^9, 
   3.7173587704721184`*^9}, {3.7173588122062426`*^9, 
   3.7173588501286516`*^9}, {3.717359014190798*^9, 3.7173590339564075`*^9}, {
   3.7173591194571896`*^9, 3.7173591202540846`*^9}, {3.717360749384885*^9, 
   3.717360755072524*^9}, {3.7173608405541487`*^9, 3.7173608453215923`*^9}, {
   3.7174176653039513`*^9, 3.7174177502357674`*^9}, {3.717418005127076*^9, 
   3.717418022383568*^9}, {3.7174180927900662`*^9, 3.717418180868244*^9}, {
   3.717419219270834*^9, 3.7174192266613092`*^9}, {3.71741926925568*^9, 
   3.717419272755123*^9}, {3.7174241468474283`*^9, 3.7174241510843997`*^9}, {
   3.71742429898483*^9, 3.717424381678406*^9}, {3.717427960779907*^9, 
   3.7174279724352093`*^9}, {3.7174281618258095`*^9, 
   3.7174281652786007`*^9}, {3.7208066594239817`*^9, 
   3.7208066657144737`*^9}, {3.723057650960129*^9, 3.7230576545889745`*^9}, {
   3.7235054152685385`*^9, 3.723505446143653*^9}, {3.723505542221841*^9, 
   3.7235055715031414`*^9}, {3.723505611190547*^9, 3.7235056388310738`*^9}, 
   3.7235057207531905`*^9, {3.723511832834532*^9, 3.7235118497876167`*^9}, {
   3.723511887365533*^9, 3.72351189056898*^9}, {3.723995684619661*^9, 
   3.723995740838527*^9}, {3.7239961359975967`*^9, 3.723996236418959*^9}, {
   3.7239964864932685`*^9, 3.723996595881749*^9}, {3.723996660736905*^9, 
   3.723996697678873*^9}, {3.723996789225758*^9, 3.723996803881894*^9}, {
   3.7239968796275477`*^9, 3.723996888634445*^9}, {3.7239978268565784`*^9, 
   3.723997848919774*^9}, {3.7239979939234915`*^9, 3.723998123923856*^9}, {
   3.723998343319007*^9, 3.723998359257045*^9}, 3.7239984107928753`*^9, {
   3.7239984412881813`*^9, 3.723998472309635*^9}, {3.723998562980158*^9, 
   3.723998576527381*^9}, {3.723998627452985*^9, 3.7239987042927628`*^9}, {
   3.723998748964592*^9, 3.723998752515873*^9}, {3.7239988402469745`*^9, 
   3.7239989766055064`*^9}, 3.724002489854061*^9, {3.724002621406389*^9, 
   3.724002622352501*^9}, {3.7240026940388455`*^9, 3.7240028077577734`*^9}, {
   3.7240028409397926`*^9, 3.7240028631476974`*^9}, {3.7240029458562803`*^9, 
   3.7240029813546762`*^9}, {3.724003292667596*^9, 3.7240033264806194`*^9}, {
   3.7265238103755226`*^9, 3.7265239700298443`*^9}, {3.7265240327159185`*^9, 
   3.7265240550286765`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"SetPrecision", "[", 
  RowBox[{"fluxNormGradZ", ",", "16"}], "]"}]], "Input",
 CellChangeTimes->{{3.7239981347202115`*^9, 3.7239981379312325`*^9}, {
  3.724000016469468*^9, 3.7240000229688377`*^9}, {3.7240029954792805`*^9, 
  3.724002996291543*^9}, {3.7265239744822598`*^9, 3.726523976279775*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "5.96212000885592541266078114858828485012`16.", ",", 
   "7.94949334514123329142876173136755824089`16.", ",", 
   "1.98737333628530654650035103259142488241`16.", ",", 
   "7.9494933451412350677856011316180229187`16.", ",", 
   "11.92424001771185437803524109767749905586`16.", ",", 
   "3.97474667257060998437623311474453657866`16.", ",", 
   "1.98737333628530876694640028290450572968`16.", ",", 
   "3.97474667257061975433884981612209230661`16.", ",", 
   "1.98737333628530676854495595762273296714`16.", ",", 
   "7.94949334514123773232086023199371993542`16.", ",", 
   "11.92424001771185437803524109767749905586`16.", ",", 
   "3.97474667257061842207122026593424379826`16.", ",", 
   "11.92424001771184549625104409642517566681`16.", ",", 
   "23.84848003542370875607048219535499811172`16.", ",", 
   "11.92424001771185437803524109767749905586`16.", ",", 
   "3.97474667257061087255465281486976891756`16.", ",", 
   "11.92424001771185082532156229717656970024`16.", ",", 
   "7.94949334514123773232086023199371993542`16.", ",", 
   "1.98737333628531098739244953321758657694`16.", ",", 
   "3.97474667257061575753596116555854678154`16.", ",", 
   "1.98737333628530676854495595762273296714`16.", ",", 
   "3.97474667257061931024963996605947613716`16.", ",", 
   "11.92424001771185793074891989817842841148`16.", ",", 
   "7.94949334514123862049927993211895227432`16.", ",", 
   "1.98737333628530654650035103259142488241`16.", ",", 
   "7.94949334514122529782298443024046719074`16.", ",", 
   "5.96212000885592630083920084871351718903`16."}], "}"}]], "Output",
 CellChangeTimes->{3.723998139299197*^9, 3.7239984776684504`*^9, 
  3.723998772037675*^9, 3.723998982308257*^9, 3.7240000245319033`*^9, 
  3.724002997572895*^9, 3.724003341403702*^9, 3.726524063091545*^9, 
  3.7284277707048635`*^9, 3.7404311214943423`*^9, 3.84912303901476*^9, 
  3.85032400931689*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Compute gradient of flux 6-norm wrt config:", "Subsection",
 CellChangeTimes->{{3.723997713981868*^9, 3.7239977512939644`*^9}, {
  3.72400246288676*^9, 3.7240024648995476`*^9}, {3.7240060300396523`*^9, 
  3.724006031165293*^9}, {3.726535253173585*^9, 3.726535256541898*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"totalFluxNorm", "=", "0"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"fluxNormGradX", "=", 
   RowBox[{"Table", "[", 
    RowBox[{"0.0", ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"ndims", " ", 
        RowBox[{"Length", "[", "xv", "]"}]}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"For", "[", 
  RowBox[{
   RowBox[{"i", "=", "1"}], ",", " ", 
   RowBox[{"i", "\[LessEqual]", " ", 
    RowBox[{"Length", "[", "connect", "]"}]}], ",", 
   RowBox[{"i", "++"}], ",", 
   RowBox[{"Block", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"i1", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"connect", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}], "+", "1"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"i2", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"connect", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "[", 
          RowBox[{"[", "2", "]"}], "]"}], "+", "1"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"i3", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"connect", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "[", 
          RowBox[{"[", "3", "]"}], "]"}], "+", "1"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"i4", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"connect", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "[", 
          RowBox[{"[", "4", "]"}], "]"}], "+", "1"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"dofIds", "=", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"ndofs", " ", 
            RowBox[{"(", 
             RowBox[{"i1", "-", "1"}], ")"}]}], "+", "1"}], ",", 
          RowBox[{
           RowBox[{"ndofs", 
            RowBox[{"(", " ", 
             RowBox[{"i2", "-", "1"}], ")"}]}], "+", "1"}], ",", 
          RowBox[{
           RowBox[{"ndofs", 
            RowBox[{"(", 
             RowBox[{"i3", "-", "1"}], ")"}]}], "+", "1"}], ",", 
          RowBox[{
           RowBox[{"ndofs", 
            RowBox[{"(", 
             RowBox[{"i4", "-", "1"}], ")"}]}], "+", "1"}]}], "}"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"ids", "=", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"ndims", 
            RowBox[{"(", 
             RowBox[{"i1", "-", "1"}], ")"}]}], "+", "1"}], ",", " ", 
          RowBox[{
           RowBox[{"ndims", 
            RowBox[{"(", " ", 
             RowBox[{"i1", "-", "1"}], ")"}]}], "+", "2"}], ",", " ", 
          RowBox[{
           RowBox[{"ndims", 
            RowBox[{"(", " ", 
             RowBox[{"i1", "-", "1"}], ")"}]}], "+", "3"}], ",", 
          RowBox[{
           RowBox[{"ndims", 
            RowBox[{"(", " ", 
             RowBox[{"i2", "-", "1"}], ")"}]}], "+", "1"}], ",", 
          RowBox[{
           RowBox[{"ndims", 
            RowBox[{"(", 
             RowBox[{"i2", "-", "1"}], ")"}]}], "+", "2"}], ",", " ", 
          RowBox[{
           RowBox[{"ndims", 
            RowBox[{"(", " ", 
             RowBox[{"i2", "-", "1"}], ")"}]}], "+", "3"}], ",", 
          RowBox[{
           RowBox[{"ndims", 
            RowBox[{"(", 
             RowBox[{"i3", "-", "1"}], ")"}]}], "+", "1"}], ",", 
          RowBox[{
           RowBox[{"ndims", " ", 
            RowBox[{"(", 
             RowBox[{"i3", "-", "1"}], ")"}]}], "+", "2"}], ",", " ", 
          RowBox[{
           RowBox[{"ndims", 
            RowBox[{"(", " ", 
             RowBox[{"i3", "-", "1"}], ")"}]}], "+", "3"}], ",", 
          RowBox[{
           RowBox[{"ndims", 
            RowBox[{"(", 
             RowBox[{"i4", "-", "1"}], ")"}]}], "+", "1"}], ",", 
          RowBox[{
           RowBox[{"ndims", 
            RowBox[{"(", 
             RowBox[{"i4", "-", "1"}], ")"}]}], "+", "2"}], ",", " ", 
          RowBox[{
           RowBox[{"ndims", 
            RowBox[{"(", " ", 
             RowBox[{"i4", "-", "1"}], ")"}]}], "+", "3"}]}], "}"}]}]}], 
      "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"cellFlux", "=", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"S", "/.", 
          RowBox[{"{", 
           RowBox[{"\[Mu]", "\[Rule]", "100.0"}], "}"}]}], ")"}], ".", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Gmatrix", "[", 
           RowBox[{
           "x1", ",", "x2", ",", "x3", ",", "x4", ",", "x5", ",", "x6", ",", 
            "x7", ",", "x8", ",", "x9", ",", "x10", ",", "x11", ",", "x12"}], 
           "]"}], ".", 
          RowBox[{"(", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"uv", "[", 
              RowBox[{"[", 
               RowBox[{"dofIds", "[", 
                RowBox[{"[", "i", "]"}], "]"}], "]"}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "1", ",", "4"}], "}"}]}], "]"}], ")"}]}], 
         ")"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"cellVolume", "=", 
       RowBox[{"gaussWeight", " ", 
        RowBox[{"Detj", "[", 
         RowBox[{
         "x1", ",", "x2", ",", "x3", ",", "x4", ",", "x5", ",", "x6", ",", 
          "x7", ",", "x8", ",", "x9", ",", "x10", ",", "x11", ",", "x12"}], 
         "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"fluxNorm", "=", 
       RowBox[{"cellVolume", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"cellFlux", ".", "cellFlux"}], ")"}], "6"]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Detj", "[", 
          RowBox[{
           RowBox[{"xv", "[", 
            RowBox[{"[", "i1", "]"}], "]"}], ",", 
           RowBox[{"yv", "[", 
            RowBox[{"[", "i1", "]"}], "]"}], ",", 
           RowBox[{"zv", "[", 
            RowBox[{"[", "i1", "]"}], "]"}], ",", 
           RowBox[{"xv", "[", 
            RowBox[{"[", "i2", "]"}], "]"}], ",", 
           RowBox[{"yv", "[", 
            RowBox[{"[", "i2", "]"}], "]"}], ",", 
           RowBox[{"zv", "[", 
            RowBox[{"[", "i2", "]"}], "]"}], ",", 
           RowBox[{"xv", "[", 
            RowBox[{"[", "i3", "]"}], "]"}], ",", 
           RowBox[{"yv", "[", 
            RowBox[{"[", "i3", "]"}], "]"}], ",", 
           RowBox[{"zv", "[", 
            RowBox[{"[", "i3", "]"}], "]"}], ",", 
           RowBox[{"xv", "[", 
            RowBox[{"[", "i4", "]"}], "]"}], ",", 
           RowBox[{"yv", "[", 
            RowBox[{"[", "i4", "]"}], "]"}], ",", 
           RowBox[{"zv", "[", 
            RowBox[{"[", "i4", "]"}], "]"}]}], "]"}], "<", "0.0"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"fluxNorm", "*=", 
         RowBox[{"-", "1.0"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"totalFluxNorm", "+=", 
       RowBox[{"(", 
        RowBox[{"fluxNorm", "/.", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"x1", "\[Rule]", 
            RowBox[{"xv", "[", 
             RowBox[{"[", "i1", "]"}], "]"}]}], ",", 
           RowBox[{"x2", "\[Rule]", 
            RowBox[{"yv", "[", 
             RowBox[{"[", "i1", "]"}], "]"}]}], ",", 
           RowBox[{"x3", "\[Rule]", 
            RowBox[{"zv", "[", 
             RowBox[{"[", "i1", "]"}], "]"}]}], ",", 
           RowBox[{"x4", "\[Rule]", 
            RowBox[{"xv", "[", 
             RowBox[{"[", "i2", "]"}], "]"}]}], ",", 
           RowBox[{"x5", "\[Rule]", 
            RowBox[{"yv", "[", 
             RowBox[{"[", "i2", "]"}], "]"}]}], ",", 
           RowBox[{"x6", "\[Rule]", 
            RowBox[{"zv", "[", 
             RowBox[{"[", "i2", "]"}], "]"}]}], ",", 
           RowBox[{"x7", "\[Rule]", 
            RowBox[{"xv", "[", 
             RowBox[{"[", "i3", "]"}], "]"}]}], ",", 
           RowBox[{"x8", "\[Rule]", 
            RowBox[{"yv", "[", 
             RowBox[{"[", "i3", "]"}], "]"}]}], ",", 
           RowBox[{"x9", "\[Rule]", 
            RowBox[{"zv", "[", 
             RowBox[{"[", "i3", "]"}], "]"}]}], ",", 
           RowBox[{"x10", "\[Rule]", 
            RowBox[{"xv", "[", 
             RowBox[{"[", "i4", "]"}], "]"}]}], ",", 
           RowBox[{"x11", "\[Rule]", 
            RowBox[{"yv", "[", 
             RowBox[{"[", "i4", "]"}], "]"}]}], ",", 
           RowBox[{"x12", "\[Rule]", 
            RowBox[{"zv", "[", 
             RowBox[{"[", "i4", "]"}], "]"}]}]}], "}"}]}], ")"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"du", "=", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"D", "[", 
            RowBox[{"fluxNorm", ",", "x1"}], "]"}], ",", 
           RowBox[{"D", "[", 
            RowBox[{"fluxNorm", ",", "x2"}], "]"}], ",", 
           RowBox[{"D", "[", 
            RowBox[{"fluxNorm", ",", "x3"}], "]"}], ",", 
           RowBox[{"D", "[", 
            RowBox[{"fluxNorm", ",", "x4"}], "]"}], ",", 
           RowBox[{"D", "[", 
            RowBox[{"fluxNorm", ",", "x5"}], "]"}], ",", 
           RowBox[{"D", "[", 
            RowBox[{"fluxNorm", ",", "x6"}], "]"}], ",", 
           RowBox[{"D", "[", 
            RowBox[{"fluxNorm", ",", "x7"}], "]"}], ",", 
           RowBox[{"D", "[", 
            RowBox[{"fluxNorm", ",", "x8"}], "]"}], ",", 
           RowBox[{"D", "[", 
            RowBox[{"fluxNorm", ",", "x9"}], "]"}], ",", 
           RowBox[{"D", "[", 
            RowBox[{"fluxNorm", ",", "x10"}], "]"}], ",", 
           RowBox[{"D", "[", 
            RowBox[{"fluxNorm", ",", "x11"}], "]"}], ",", 
           RowBox[{"D", "[", 
            RowBox[{"fluxNorm", ",", "x12"}], "]"}]}], "}"}], "/.", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"x1", "\[Rule]", 
            RowBox[{"xv", "[", 
             RowBox[{"[", "i1", "]"}], "]"}]}], ",", 
           RowBox[{"x2", "\[Rule]", 
            RowBox[{"yv", "[", 
             RowBox[{"[", "i1", "]"}], "]"}]}], ",", 
           RowBox[{"x3", "\[Rule]", 
            RowBox[{"zv", "[", 
             RowBox[{"[", "i1", "]"}], "]"}]}], ",", 
           RowBox[{"x4", "\[Rule]", 
            RowBox[{"xv", "[", 
             RowBox[{"[", "i2", "]"}], "]"}]}], ",", 
           RowBox[{"x5", "\[Rule]", 
            RowBox[{"yv", "[", 
             RowBox[{"[", "i2", "]"}], "]"}]}], ",", 
           RowBox[{"x6", "\[Rule]", 
            RowBox[{"zv", "[", 
             RowBox[{"[", "i2", "]"}], "]"}]}], ",", 
           RowBox[{"x7", "\[Rule]", 
            RowBox[{"xv", "[", 
             RowBox[{"[", "i3", "]"}], "]"}]}], ",", 
           RowBox[{"x8", "\[Rule]", 
            RowBox[{"yv", "[", 
             RowBox[{"[", "i3", "]"}], "]"}]}], ",", 
           RowBox[{"x9", "\[Rule]", 
            RowBox[{"zv", "[", 
             RowBox[{"[", "i3", "]"}], "]"}]}], ",", 
           RowBox[{"x10", "\[Rule]", 
            RowBox[{"xv", "[", 
             RowBox[{"[", "i4", "]"}], "]"}]}], ",", 
           RowBox[{"x11", "\[Rule]", 
            RowBox[{"yv", "[", 
             RowBox[{"[", "i4", "]"}], "]"}]}], ",", 
           RowBox[{"x12", "\[Rule]", 
            RowBox[{"zv", "[", 
             RowBox[{"[", "i4", "]"}], "]"}]}]}], "}"}]}], ")"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"j", "=", "1"}], ",", 
        RowBox[{"j", "\[LessEqual]", "12"}], ",", 
        RowBox[{"j", "++"}], ",", 
        RowBox[{
         RowBox[{"fluxNormGradX", "[", 
          RowBox[{"[", 
           RowBox[{"ids", "[", 
            RowBox[{"[", "j", "]"}], "]"}], "]"}], "]"}], "+=", 
         RowBox[{"du", "[", 
          RowBox[{"[", "j", "]"}], "]"}]}]}], "]"}], ";"}]}], 
    "\[IndentingNewLine]", "]"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"fluxNormGradX", "*=", 
   RowBox[{
    FractionBox["1", "12"], 
    SuperscriptBox["totalFluxNorm", 
     FractionBox[
      RowBox[{"(", 
       RowBox[{"1.0", "-", "12.0"}], ")"}], "12.0"]]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.7167647605597653`*^9, 3.7167647892518883`*^9}, {
   3.7167648244240847`*^9, 3.716764841539942*^9}, {3.71676488019324*^9, 
   3.7167648969754357`*^9}, {3.716765065628334*^9, 3.716765185350045*^9}, {
   3.7167652229401484`*^9, 3.7167652383100395`*^9}, {3.7167653441168547`*^9, 
   3.7167655199547443`*^9}, {3.7167655675522327`*^9, 
   3.7167655810711265`*^9}, {3.716765622284607*^9, 3.7167656290567384`*^9}, {
   3.716765757154343*^9, 3.716765792076064*^9}, {3.7167658276745405`*^9, 
   3.7167660826802125`*^9}, {3.716766195664576*^9, 3.716766242915578*^9}, {
   3.7167663310833845`*^9, 3.7167663393539863`*^9}, {3.7167664503932595`*^9, 
   3.716766450932579*^9}, {3.7167664868258085`*^9, 3.7167665635541043`*^9}, {
   3.716766627651472*^9, 3.716766643645746*^9}, {3.716766826115865*^9, 
   3.7167668360695195`*^9}, {3.716766868385886*^9, 3.7167669130203*^9}, {
   3.717155721663645*^9, 3.7171557331420517`*^9}, {3.717155769178903*^9, 
   3.7171557818205233`*^9}, {3.7171567883516493`*^9, 3.717156887869956*^9}, {
   3.717156918335051*^9, 3.717156937057849*^9}, {3.717157017416103*^9, 
   3.717157052623994*^9}, {3.717157895689323*^9, 3.717157931742132*^9}, {
   3.717166282194605*^9, 3.71716628473459*^9}, {3.71716849797501*^9, 
   3.71716852298344*^9}, {3.717168562021318*^9, 3.717168562125424*^9}, {
   3.717168843821663*^9, 3.717168857297769*^9}, {3.7171692165304537`*^9, 
   3.7171692208302*^9}, {3.717170006857576*^9, 3.717170018830927*^9}, {
   3.717171209233417*^9, 3.717171213025419*^9}, {3.7173548750864697`*^9, 
   3.717354881757492*^9}, {3.717354996753583*^9, 3.717355017245678*^9}, {
   3.717355319697336*^9, 3.7173553216726255`*^9}, {3.7173557531181636`*^9, 
   3.7173557820403166`*^9}, {3.7173558138063755`*^9, 
   3.7173558166812677`*^9}, {3.7173587645155315`*^9, 
   3.7173587704721184`*^9}, {3.7173588122062426`*^9, 
   3.7173588501286516`*^9}, {3.717359014190798*^9, 3.7173590339564075`*^9}, {
   3.7173591194571896`*^9, 3.7173591202540846`*^9}, {3.717360749384885*^9, 
   3.717360755072524*^9}, {3.7173608405541487`*^9, 3.7173608453215923`*^9}, {
   3.7174176653039513`*^9, 3.7174177502357674`*^9}, {3.717418005127076*^9, 
   3.717418022383568*^9}, {3.7174180927900662`*^9, 3.717418180868244*^9}, {
   3.717419219270834*^9, 3.7174192266613092`*^9}, {3.71741926925568*^9, 
   3.717419272755123*^9}, {3.7174241468474283`*^9, 3.7174241510843997`*^9}, {
   3.71742429898483*^9, 3.717424381678406*^9}, {3.717427960779907*^9, 
   3.7174279724352093`*^9}, {3.7174281618258095`*^9, 
   3.7174281652786007`*^9}, {3.7208066594239817`*^9, 
   3.7208066657144737`*^9}, {3.723057650960129*^9, 3.7230576545889745`*^9}, {
   3.7235054152685385`*^9, 3.723505446143653*^9}, {3.723505542221841*^9, 
   3.7235055715031414`*^9}, {3.723505611190547*^9, 3.7235056388310738`*^9}, 
   3.7235057207531905`*^9, {3.723511832834532*^9, 3.7235118497876167`*^9}, {
   3.723511887365533*^9, 3.72351189056898*^9}, {3.723995684619661*^9, 
   3.723995740838527*^9}, {3.7239961359975967`*^9, 3.723996236418959*^9}, {
   3.7239964864932685`*^9, 3.723996595881749*^9}, {3.723996660736905*^9, 
   3.723996697678873*^9}, {3.723996789225758*^9, 3.723996803881894*^9}, {
   3.7239968796275477`*^9, 3.723996888634445*^9}, {3.7239978268565784`*^9, 
   3.723997848919774*^9}, {3.7239979939234915`*^9, 3.723998123923856*^9}, {
   3.723998343319007*^9, 3.723998359257045*^9}, 3.7239984107928753`*^9, {
   3.7239984412881813`*^9, 3.723998472309635*^9}, {3.723998562980158*^9, 
   3.723998576527381*^9}, {3.723998627452985*^9, 3.7239987042927628`*^9}, {
   3.723998748964592*^9, 3.723998752515873*^9}, {3.7239988402469745`*^9, 
   3.7239989766055064`*^9}, 3.724002489854061*^9, {3.724002621406389*^9, 
   3.724002622352501*^9}, {3.7240026940388455`*^9, 3.7240028077577734`*^9}, {
   3.7240028409397926`*^9, 3.7240028631476974`*^9}, {3.7240029458562803`*^9, 
   3.7240029813546762`*^9}, {3.724003292667596*^9, 3.7240033264806194`*^9}, {
   3.724006081180295*^9, 3.7240061458811316`*^9}, {3.7240061961343727`*^9, 
   3.7240063341943207`*^9}, {3.7240064226059303`*^9, 3.7240064972791*^9}, {
   3.7240065807585363`*^9, 3.7240066134278955`*^9}, {3.724006701846982*^9, 
   3.724006748643714*^9}, {3.7240067804718857`*^9, 3.7240067955969505`*^9}, {
   3.7265352609668283`*^9, 3.726535383998263*^9}, {3.726535415498535*^9, 
   3.726535593858086*^9}, 3.7265357152985363`*^9, {3.7265359293003607`*^9, 
   3.726535955695425*^9}, {3.7265359917714524`*^9, 3.726535993914441*^9}, {
   3.726536100878948*^9, 3.72653610239563*^9}, {3.726536163754781*^9, 
   3.726536233785889*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"SetPrecision", "[", 
  RowBox[{"fluxNormGradX", ",", "16"}], "]"}]], "Input",
 CellChangeTimes->{{3.7239981347202115`*^9, 3.7239981379312325`*^9}, {
  3.724000016469468*^9, 3.7240000229688377`*^9}, {3.7240029954792805`*^9, 
  3.724002996291543*^9}, {3.7240063460064936`*^9, 3.724006346631173*^9}, {
  3.726536005883772*^9, 3.726536008508711*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "19.11663875855392547009614645503461360931`16.", ",", 
   "5.48893588116894903805587091483175754547`16.", ",", 
   "0.94636825537395685703501158059225417674`16.", ",", 
   "26.31631725520657028027926571667194366455`16.", ",", 
   "7.44719019421198513697390808374620974064`16.", ",", 
   "3.14485451016576611493746895575895905495`16.", ",", 
   "7.19967849665263681657734196051023900509`16.", ",", 
   "1.95825431304303188007054359331959858537`16.", ",", 
   "2.1984862547918053721218711871188133955`16.", ",", 
   "21.5990354899579166669809637824073433876`16.", ",", 
   "7.86213627541440729373789508827030658722`16.", ",", 
   "0.63333875551949381232930136320646852255`16.", ",", 
   "38.48078921466723301136880763806402683258`16.", ",", 
   "14.15184529574594840539703000104054808617`16.", ",", 
   "4.71728176524864917240620343363843858242`16.", ",", 
   "16.88175372470923463197323144413530826569`16.", ",", 
   "6.28970902033151091359286510851234197617`16.", ",", 
   "4.08394300972914425784665581886656582355`16.", ",", 
   "2.48239673140399030870639762724749743938`16.", ",", 
   "2.37320039424546092021728327381424605846`16.", ",", 
   RowBox[{"-", "0.31302949985446315572801267990143969655`16."}], ",", 
   "12.16447195946063963845062971813604235649`16.", ",", 
   "6.70465510153396149206628251704387366772`16.", ",", 
   "1.57242725508288239133491970278555527329`16.", ",", 
   "9.68207522805662712528373958775773644447`16.", ",", 
   "4.33145470728849080188638254185207188129`16.", ",", 
   "1.88545675493734377070609298243653029203`16.", ",", 
   "9.43456353049731610838080086978152394295`16.", ",", 
   "1.15748117388046467546303119888762012124`16.", ",", 
   RowBox[{"-", "0.93908849956338524833654446410946547985`16."}], ",", 
   "14.15184529574591643097392079653218388557`16.", ",", 
   "0.74253509267802386695223049173364415765`16.", ",", 
   "1.57242725508288083702268522756639868021`16.", ",", 
   "4.71728176524863407337306853150948882103`16.", ",", 
   RowBox[{"-", "0.41494608120242981730285691810422576964`16."}], ",", 
   "2.51151575464627008216211834223940968513`16.", ",", 
   "4.7172817652486456196925246331375092268`16.", ",", 
   "1.57242725508288150315650000266032293439`16.", ",", 
   RowBox[{"-", "3.45060425420965266596340370597317814827`16."}], ",", 
   RowBox[{"-", "4.13355442250581646716961823504612566867371173`16.*^-14"}], 
   ",", 
   RowBox[{"-", "9.3944418693314010617491323523775583378947994`16.*^-15"}], 
   ",", 
   RowBox[{"-", "4.4623598879324155043308378673793402105000297`16.*^-15"}], 
   ",", 
   RowBox[{"-", "4.71728176524854259099583941861055791378`16."}], ",", 
   RowBox[{"-", "1.57242725508284730828734154783887788653`16."}], ",", 
   "3.45060425420967131771021740860305726528`16.", ",", 
   RowBox[{"-", "4.71728176524864828422778373351320624352`16."}], ",", 
   "0.41494608120242226778628946703975088894`16.", ",", 
   RowBox[{"-", "2.51151575464626741762685924186371266842`16."}], ",", 
   RowBox[{"-", "14.15184529574600169610221200855448842049`16."}], ",", 
   RowBox[{"-", "0.74253509267805217763935843322542496026`16."}], ",", 
   RowBox[{"-", "1.57242725508288994085148715385003015399`16."}], ",", 
   RowBox[{"-", "9.43456353049726814674613706301897764206`16."}], ",", 
   RowBox[{"-", "1.1574811738804458016716125712264329195`16."}], ",", 
   "0.93908849956339057740706266486085951328`16.", ",", 
   RowBox[{"-", "9.68207522805664488885213359026238322258`16."}], ",", 
   RowBox[{"-", "4.33145470728850057184899924322962760925`16."}], ",", 
   RowBox[{"-", "1.88545675493734554706293238268699496984`16."}], ",", 
   RowBox[{"-", "12.16447195946059878224332351237535476685`16."}], ",", 
   RowBox[{"-", "6.70465510153394816938998701516538858414`16."}], ",", 
   RowBox[{"-", "1.5724272550828790606658458273159340024`16."}], ",", 
   RowBox[{"-", "2.48239673140398631190350897668395191431`16."}], ",", 
   RowBox[{"-", "2.37320039424545736750360447331331670284`16."}], ",", 
   "0.31302949985446226754959297977620735765`16.", ",", 
   RowBox[{"-", "16.88175372470928081725105585064738988876`16."}], ",", 
   RowBox[{"-", "6.28970902033152601262600001064129173756`16."}], ",", 
   RowBox[{"-", "4.08394300972915491598769222036935389042`16."}], ",", 
   RowBox[{"-", "38.48078921466722590594145003706216812134`16."}], ",", 
   RowBox[{"-", "14.15184529574594662904019060079008340836`16."}], ",", 
   RowBox[{"-", "4.71728176524865006058462313376367092133`16."}], ",", 
   RowBox[{"-", "21.59903548995797706311350339092314243317`16."}], ",", 
   RowBox[{"-", "7.86213627541443038637680729152634739876`16."}], ",", 
   RowBox[{"-", "0.6333387555194996965113318765361327678`16."}], ",", 
   RowBox[{"-", "7.19967849665262438207946615875698626041`16."}], ",", 
   RowBox[{"-", "1.95825431304302766122305001772474497557`16."}], ",", 
   RowBox[{"-", "2.19848625479180403985424163693096488714`16."}], ",", 
   RowBox[{"-", "26.31631725520651698957408370915800333023`16."}], ",", 
   RowBox[{"-", "7.44719019421196470887025498086586594582`16."}], ",", 
   RowBox[{"-", "3.14485451016576034177774090494494885206`16."}], ",", 
   RowBox[{"-", "19.1166387585539396809508616570383310318`16."}], ",", 
   RowBox[{"-", "5.48893588116895170259113001520745456219`16."}], ",", 
   RowBox[{"-", "0.94636825537395763419112881820183247328`16."}]}], 
  "}"}]], "Output",
 CellChangeTimes->{3.723998139299197*^9, 3.7239984776684504`*^9, 
  3.723998772037675*^9, 3.723998982308257*^9, 3.7240000245319033`*^9, 
  3.724002997572895*^9, 3.724003341403702*^9, 3.7240065229734564`*^9, 
  3.724006829300213*^9, 3.726536010320677*^9, 3.726536244161354*^9, 
  3.7284277783608723`*^9, 3.7404311332850976`*^9, 3.849123045020618*^9, 
  3.850324011830842*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Compute residual:", "Subsection",
 CellChangeTimes->{{3.7171711972127666`*^9, 3.71717120142911*^9}, {
  3.7209943882500362`*^9, 3.7209944015165186`*^9}, {3.721049011972142*^9, 
  3.721049018596589*^9}, {3.7210554397242594`*^9, 3.7210554438131027`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"residual", "=", 
   RowBox[{"Table", "[", 
    RowBox[{"0.0", ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"Length", "[", "xv", "]"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"For", "[", 
  RowBox[{
   RowBox[{"i", "=", "1"}], ",", " ", 
   RowBox[{"i", "\[LessEqual]", " ", 
    RowBox[{"Length", "[", "connect", "]"}]}], ",", 
   RowBox[{"i", "++"}], ",", 
   RowBox[{"Block", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"i1", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"connect", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}], "+", "1"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"i2", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"connect", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "[", 
          RowBox[{"[", "2", "]"}], "]"}], "+", "1"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"i3", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"connect", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "[", 
          RowBox[{"[", "3", "]"}], "]"}], "+", "1"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"i4", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"connect", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "[", 
          RowBox[{"[", "4", "]"}], "]"}], "+", "1"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"ids", "=", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"ndofs", 
            RowBox[{"(", 
             RowBox[{"i1", "-", "1"}], ")"}]}], "+", "1"}], ",", 
          RowBox[{
           RowBox[{"ndofs", 
            RowBox[{"(", " ", 
             RowBox[{"i2", "-", "1"}], ")"}]}], "+", "1"}], ",", 
          RowBox[{
           RowBox[{"ndofs", 
            RowBox[{"(", 
             RowBox[{"i3", "-", "1"}], ")"}]}], "+", "1"}], ",", 
          RowBox[{
           RowBox[{"ndofs", 
            RowBox[{"(", 
             RowBox[{"i4", "-", "1"}], ")"}]}], "+", "1"}]}], "}"}]}]}], 
      "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Kel", "=", 
       RowBox[{"gaussWeight", "*", 
        RowBox[{"Kmat", "[", 
         RowBox[{
          RowBox[{"xv", "[", 
           RowBox[{"[", "i1", "]"}], "]"}], ",", 
          RowBox[{"yv", "[", 
           RowBox[{"[", "i1", "]"}], "]"}], ",", 
          RowBox[{"zv", "[", 
           RowBox[{"[", "i1", "]"}], "]"}], ",", 
          RowBox[{"xv", "[", 
           RowBox[{"[", "i2", "]"}], "]"}], ",", 
          RowBox[{"yv", "[", 
           RowBox[{"[", "i2", "]"}], "]"}], ",", 
          RowBox[{"zv", "[", 
           RowBox[{"[", "i2", "]"}], "]"}], ",", 
          RowBox[{"xv", "[", 
           RowBox[{"[", "i3", "]"}], "]"}], ",", 
          RowBox[{"yv", "[", 
           RowBox[{"[", "i3", "]"}], "]"}], ",", 
          RowBox[{"zv", "[", 
           RowBox[{"[", "i3", "]"}], "]"}], ",", 
          RowBox[{"xv", "[", 
           RowBox[{"[", "i4", "]"}], "]"}], ",", 
          RowBox[{"yv", "[", 
           RowBox[{"[", "i4", "]"}], "]"}], ",", 
          RowBox[{"zv", "[", 
           RowBox[{"[", "i4", "]"}], "]"}], ",", 
          RowBox[{"1", "*", 
           SuperscriptBox["10", "2"]}]}], "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"disp", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"uv", "[", 
          RowBox[{"[", 
           RowBox[{"ids", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "]"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", "4"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"resid", "=", " ", 
       RowBox[{"(", 
        RowBox[{"Kel", ".", "disp"}], ")"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"j", "=", "1"}], ",", 
        RowBox[{"j", "\[LessEqual]", "4"}], ",", 
        RowBox[{"j", "++"}], ",", 
        RowBox[{
         RowBox[{"residual", "[", 
          RowBox[{"[", 
           RowBox[{"ids", "[", 
            RowBox[{"[", "j", "]"}], "]"}], "]"}], "]"}], "+=", 
         RowBox[{"resid", "[", 
          RowBox[{"[", "j", "]"}], "]"}]}]}], "]"}], ";"}]}], 
    "\[IndentingNewLine]", "]"}]}], "]"}]}], "Input",
 CellChangeTimes->CompressedData["
1:eJwdz30s1HEABvBzGmolt1LmRi5kssS8zOmS43aJMzdmRXnpliWRMS+X2uIq
Kc7ycnJUqCsXN3nJyxFFIkZJJi9Xa2YaJ0cTqvXyfX5/PPv89TzbwxIlBsfQ
aTQahwTK5xm5+xu0XPF2ZT40L9xWBF2POsugwUGDMvjafc9dKGS6NsBCF4eX
sNH0cy+c0A70QX6n/hjkSf/Ow9naFR2s5T9YgZnMgTU4PFK1Dk8vKwwdiJaJ
9K1wXJZqAgN7Q52gGy/VC8YJInhwV60oCE6HnBdCmUwQCes/RlAaJEyJILsj
KR5qJlJS4OqTlDTo0OwrhVlsST50DMsrhILHVqWwmOOWNI+9XEUyLFLbpsN2
brsYtnjnrsG68d/0BWJn26ABnJtkbYatwgM7YM960W6oM17LhHkv0q9DV0++
fIn4KusOpZ/LkTod8bg4qgE+rPNugRf1eZQmARmTMOSG/TTM+GlitEykFZRR
+iZNx8HVkvB4aCe201shckYqKU/1ip76N2q50Yc96mG4RWkXLNXYdcNi4doc
3Jft9hX+67e2CCDy/but4Niw2gZ+HzK1hZwrt2UC9JlBJfCWPLscLljwKuEm
Zt8zOFvm1QoFVUvdMI1l1AN/CVXSQKJlsCgflnQw5PCyfw3lhtr+xDlibG6/
CNIZCgl04g9dg2w/uRQq35SXQlVNrHkcMdk+lAlzHJVWcMPejAX3Wp6UxBPP
Ns1Qtl+NksHM5uYKSPthFnUBv75Jo6FRgqcYChaUlD4FCVZf2siexp0FhaMh
FYfUWq7pFqEKqppsGuGZDEEnLOiMnIKCLv1PcMzhzxKUhBzbySFGGTMvhRJn
cnwoNex3ZWFE68WK+9CZY1gN3yZ4qOCi7n1P1nMtVxE0Ogjvfbip94gYw6im
/A8kifyw
  "]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"SetPrecision", "[", 
  RowBox[{"residual", ",", "16"}], "]"}]], "Input",
 CellChangeTimes->{{3.7209949856957116`*^9, 3.7209949866369324`*^9}, {
  3.720995044627005*^9, 3.720995050464894*^9}, {3.7210555900106316`*^9, 
  3.7210555918891406`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"-", "21.66666666666666429819088079966604709625`16."}], ",", 
   RowBox[{"-", "30.`16."}], ",", 
   RowBox[{"-", "8.33333333333333214909544039983302354813`16."}], ",", 
   RowBox[{"-", "24.99999999999999644728632119949907064438`16."}], ",", 
   RowBox[{"-", "45.00000000000000710542735760100185871124`16."}], ",", 
   RowBox[{"-", "19.99999999999999289457264239899814128876`16."}], ",", 
   RowBox[{"-", "3.33333333333333214909544039983302354813`16."}], ",", 
   RowBox[{"-", "15.`16."}], ",", 
   RowBox[{"-", "11.66666666666666607454772019991651177406`16."}], ",", 
   RowBox[{"-", "10.00000000000000532907051820075139403343`16."}], ",", 
   RowBox[{"-", "15.`16."}], ",", 
   RowBox[{"-", "4.99999999999999289457264239899814128876`16."}], ",", 
   RowBox[{"-", "5.00000000000000355271367880050092935562`16."}], ",", 
   RowBox[{"-", "1.0658141036401502788066864013671875`16.*^-14"}], ",", 
   "4.99999999999998046007476659724488854408`16.", ",", 
   "5.00000000000000177635683940025046467781`16.", ",", 
   "15.00000000000000532907051820075139403343`16.", ",", 
   "9.99999999999999467092948179924860596657`16.", ",", 
   "11.66666666666666785090455960016697645187`16.", ",", 
   "14.99999999999998578914528479799628257751`16.", ",", 
   "3.33333333333333570180911920033395290375`16.", ",", 
   "19.99999999999999644728632119949907064438`16.", ",", 
   "45.0000000000000497379915032070130109787`16.", ",", "25.`16.", ",", 
   "8.33333333333332149095440399833023548126`16.", ",", 
   "29.99999999999998578914528479799628257751`16.", ",", 
   "21.66666666666667495633191720116883516312`16."}], "}"}]], "Output",
 CellChangeTimes->{3.720994987716754*^9, 3.7209950515695486`*^9, 
  3.721047011769689*^9, 3.7210555991426263`*^9, 3.7227106222004614`*^9, 
  3.722782735863827*^9, 3.72278290976573*^9, 3.7239050403684235`*^9, 
  3.7284278077050643`*^9, 3.740431149818462*^9, 3.849123049225357*^9, 
  3.850324011879039*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Compute residual gradient wrt control:", "Subsection",
 CellChangeTimes->{{3.7171711972127666`*^9, 3.71717120142911*^9}, {
  3.7209943882500362`*^9, 3.7209944015165186`*^9}, {3.721049011972142*^9, 
  3.721049018596589*^9}, {3.7210554397242594`*^9, 3.7210554438131027`*^9}, {
  3.721059980929894*^9, 3.72105998715461*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"residualGradient", "=", 
   RowBox[{"Table", "[", 
    RowBox[{"0.0", ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"Length", "[", "xv", "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "1", ",", 
       RowBox[{"Length", "[", "xv", "]"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"For", "[", 
  RowBox[{
   RowBox[{"i", "=", "1"}], ",", " ", 
   RowBox[{"i", "\[LessEqual]", " ", 
    RowBox[{"Length", "[", "connect", "]"}]}], ",", 
   RowBox[{"i", "++"}], ",", 
   RowBox[{"Block", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"i1", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"connect", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}], "+", "1"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"i2", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"connect", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "[", 
          RowBox[{"[", "2", "]"}], "]"}], "+", "1"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"i3", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"connect", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "[", 
          RowBox[{"[", "3", "]"}], "]"}], "+", "1"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"i4", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"connect", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "[", 
          RowBox[{"[", "4", "]"}], "]"}], "+", "1"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"nids", "=", 
        RowBox[{"{", 
         RowBox[{"i1", ",", "i2", ",", "i3", ",", "i4"}], "}"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"ids", "=", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"ndofs", " ", 
            RowBox[{"(", 
             RowBox[{"i1", "-", "1"}], ")"}]}], "+", "1"}], ",", 
          RowBox[{
           RowBox[{"ndofs", 
            RowBox[{"(", " ", 
             RowBox[{"i2", "-", "1"}], ")"}]}], "+", "1"}], ",", 
          RowBox[{
           RowBox[{"ndofs", 
            RowBox[{"(", 
             RowBox[{"i3", "-", "1"}], ")"}]}], "+", "1"}], ",", 
          RowBox[{
           RowBox[{"ndofs", 
            RowBox[{"(", 
             RowBox[{"i4", "-", "1"}], ")"}]}], "+", "1"}]}], "}"}]}]}], 
      "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Kel", "=", 
       RowBox[{"gaussWeight", "*", 
        RowBox[{"Kmat", "[", 
         RowBox[{
          RowBox[{"xv", "[", 
           RowBox[{"[", "i1", "]"}], "]"}], ",", 
          RowBox[{"yv", "[", 
           RowBox[{"[", "i1", "]"}], "]"}], ",", 
          RowBox[{"zv", "[", 
           RowBox[{"[", "i1", "]"}], "]"}], ",", 
          RowBox[{"xv", "[", 
           RowBox[{"[", "i2", "]"}], "]"}], ",", 
          RowBox[{"yv", "[", 
           RowBox[{"[", "i2", "]"}], "]"}], ",", 
          RowBox[{"zv", "[", 
           RowBox[{"[", "i2", "]"}], "]"}], ",", 
          RowBox[{"xv", "[", 
           RowBox[{"[", "i3", "]"}], "]"}], ",", 
          RowBox[{"yv", "[", 
           RowBox[{"[", "i3", "]"}], "]"}], ",", 
          RowBox[{"zv", "[", 
           RowBox[{"[", "i3", "]"}], "]"}], ",", 
          RowBox[{"xv", "[", 
           RowBox[{"[", "i4", "]"}], "]"}], ",", 
          RowBox[{"yv", "[", 
           RowBox[{"[", "i4", "]"}], "]"}], ",", 
          RowBox[{"zv", "[", 
           RowBox[{"[", "i4", "]"}], "]"}], ",", 
          RowBox[{"1", "*", 
           SuperscriptBox["10", "2"]}]}], "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"disp", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"uv", "[", 
          RowBox[{"[", 
           RowBox[{"ids", "[", 
            RowBox[{"[", "k", "]"}], "]"}], "]"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"k", ",", "1", ",", "4"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"energyInc", "=", " ", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"\[Rho]1", "+", "\[Rho]2", "+", "\[Rho]3", "+", "\[Rho]4"}], 
         ")"}], 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"Kel", ".", "disp"}], ")"}], "/", "4.0"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"d\[Rho]", "=", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"D", "[", 
            RowBox[{"energyInc", ",", "\[Rho]1"}], "]"}], ",", 
           RowBox[{"D", "[", 
            RowBox[{"energyInc", ",", "\[Rho]2"}], "]"}], ",", 
           RowBox[{"D", "[", 
            RowBox[{"energyInc", ",", "\[Rho]3"}], "]"}], ",", 
           RowBox[{"D", "[", 
            RowBox[{"energyInc", ",", "\[Rho]4"}], "]"}]}], "}"}], "/.", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"\[Rho]1", "\[Rule]", "1.0"}], ",", 
           RowBox[{"\[Rho]2", "\[Rule]", "1.0"}], ",", 
           RowBox[{"\[Rho]3", "\[Rule]", "1.0"}], ",", 
           RowBox[{"\[Rho]4", "\[Rule]", "1.0"}]}], "}"}]}], ")"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"Iv", "=", "1"}], ",", 
        RowBox[{"Iv", "\[LessEqual]", "4"}], ",", 
        RowBox[{"Iv", "++"}], ",", "\[IndentingNewLine]", 
        RowBox[{"For", "[", 
         RowBox[{
          RowBox[{"Jv", "=", "1"}], ",", 
          RowBox[{"Jv", "\[LessEqual]", "4"}], ",", 
          RowBox[{"Jv", "++"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"residualGradient", "[", 
              RowBox[{"[", 
               RowBox[{"ids", "[", 
                RowBox[{"[", "Iv", "]"}], "]"}], "]"}], "]"}], "[", 
             RowBox[{"[", 
              RowBox[{"nids", "[", 
               RowBox[{"[", "Jv", "]"}], "]"}], "]"}], "]"}], "+=", 
            RowBox[{
             RowBox[{"d\[Rho]", "[", 
              RowBox[{"[", "Jv", "]"}], "]"}], "[", 
             RowBox[{"[", "Iv", "]"}], "]"}]}], ";"}]}], 
         "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}], 
      ";"}]}], "\[IndentingNewLine]", "]"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.7167647605597653`*^9, 3.7167647892518883`*^9}, {
   3.7167648244240847`*^9, 3.716764841539942*^9}, {3.71676488019324*^9, 
   3.7167648969754357`*^9}, {3.716765065628334*^9, 3.716765185350045*^9}, {
   3.7167652229401484`*^9, 3.7167652383100395`*^9}, {3.7167653441168547`*^9, 
   3.7167655199547443`*^9}, {3.7167655675522327`*^9, 
   3.7167655810711265`*^9}, {3.716765622284607*^9, 3.7167656290567384`*^9}, {
   3.716765757154343*^9, 3.716765792076064*^9}, {3.7167658276745405`*^9, 
   3.7167660826802125`*^9}, {3.716766195664576*^9, 3.716766242915578*^9}, {
   3.7167663310833845`*^9, 3.7167663393539863`*^9}, {3.7167664503932595`*^9, 
   3.716766450932579*^9}, {3.7167664868258085`*^9, 3.7167665635541043`*^9}, {
   3.716766627651472*^9, 3.716766643645746*^9}, {3.716766826115865*^9, 
   3.7167668360695195`*^9}, {3.716766868385886*^9, 3.7167669130203*^9}, {
   3.717155721663645*^9, 3.7171557331420517`*^9}, {3.717155769178903*^9, 
   3.7171557818205233`*^9}, {3.7171567883516493`*^9, 3.717156887869956*^9}, {
   3.717156918335051*^9, 3.717156937057849*^9}, {3.717157017416103*^9, 
   3.717157052623994*^9}, {3.717157895689323*^9, 3.717157931742132*^9}, {
   3.717166282194605*^9, 3.71716628473459*^9}, {3.71716849797501*^9, 
   3.71716852298344*^9}, {3.717168562021318*^9, 3.717168562125424*^9}, {
   3.717168843821663*^9, 3.717168857297769*^9}, {3.7171692165304537`*^9, 
   3.7171692208302*^9}, {3.717170006857576*^9, 3.717170018830927*^9}, {
   3.717171209233417*^9, 3.717171213025419*^9}, {3.7173548750864697`*^9, 
   3.717354881757492*^9}, {3.717354996753583*^9, 3.717355017245678*^9}, {
   3.717355319697336*^9, 3.7173553216726255`*^9}, {3.7173557531181636`*^9, 
   3.7173557820403166`*^9}, {3.7173558138063755`*^9, 
   3.7173558166812677`*^9}, {3.7173587645155315`*^9, 
   3.7173587704721184`*^9}, {3.7173588122062426`*^9, 
   3.7173588501286516`*^9}, {3.717359014190798*^9, 3.7173590339564075`*^9}, {
   3.7173591194571896`*^9, 3.7173591202540846`*^9}, {3.717360749384885*^9, 
   3.717360755072524*^9}, {3.7173608405541487`*^9, 3.7173608453215923`*^9}, {
   3.7174176653039513`*^9, 3.7174177502357674`*^9}, {3.717418005127076*^9, 
   3.717418022383568*^9}, {3.7174180927900662`*^9, 3.717418180868244*^9}, {
   3.717419219270834*^9, 3.7174192266613092`*^9}, {3.71741926925568*^9, 
   3.717419272755123*^9}, {3.7174241468474283`*^9, 3.7174241510843997`*^9}, {
   3.71742429898483*^9, 3.717424381678406*^9}, {3.717427960779907*^9, 
   3.7174279724352093`*^9}, {3.7174281618258095`*^9, 
   3.7174281652786007`*^9}, {3.7208066594239817`*^9, 
   3.7208066657144737`*^9}, {3.720994042619423*^9, 3.7209941465012307`*^9}, {
   3.7209941931469326`*^9, 3.7209942823899403`*^9}, {3.7209945149606404`*^9, 
   3.7209945361169796`*^9}, {3.7209946799116*^9, 3.720994978291444*^9}, {
   3.7210470008455043`*^9, 3.7210470020792093`*^9}, {3.721055446475813*^9, 
   3.7210554769975753`*^9}, {3.7210555442260976`*^9, 3.721055585763404*^9}, {
   3.7210600453267174`*^9, 3.7210600563938503`*^9}, {3.7210601122386665`*^9, 
   3.721060117990325*^9}, {3.721060190495677*^9, 3.721060212721558*^9}, 
   3.7210602600845275`*^9, {3.7210603177920356`*^9, 3.721060476929365*^9}, 
   3.7210606992938013`*^9, 3.7210607353447104`*^9, 3.7210607779378586`*^9, {
   3.7210608198444405`*^9, 3.7210608238191824`*^9}, {3.7210608538969774`*^9, 
   3.721060865228549*^9}, {3.7210610574870963`*^9, 3.7210611755949063`*^9}, {
   3.72106134205572*^9, 3.7210613786269007`*^9}, {3.722790602383395*^9, 
   3.722790613581335*^9}, {3.7227906875470157`*^9, 3.7227907375883846`*^9}, {
   3.722790779358223*^9, 3.7227907797158976`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"GradZTranspose", "=", 
   RowBox[{"Transpose", "[", "residualGradient", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.7209949856957116`*^9, 3.7209949866369324`*^9}, {
  3.720995044627005*^9, 3.720995050464894*^9}, {3.7210555900106316`*^9, 
  3.7210555918891406`*^9}, {3.72106118460649*^9, 3.721061185651959*^9}, {
  3.721061402431693*^9, 3.7210614048560953`*^9}, {3.728427930298377*^9, 
  3.728427942782789*^9}, {3.849125012378852*^9, 3.849125031465947*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"colMap", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "0", ",", "1", ",", "3", ",", "4", ",", "9", ",", "10", ",", "12", ",", 
       "13"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "0", ",", "1", ",", "2", ",", "4", ",", "5", ",", "10", ",", "11", ",", 
       "13", ",", "14"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "2", ",", "5", ",", "11", ",", "14"}], "}"}]}], 
    "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"SetPrecision", "[", 
  RowBox[{
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"GradZTranspose", "[", 
         RowBox[{"[", "i", "]"}], "]"}], "[", 
        RowBox[{"[", 
         RowBox[{
          RowBox[{
           RowBox[{"colMap", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "[", 
           RowBox[{"[", "j", "]"}], "]"}], "+", "1"}], "]"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "1", ",", 
         RowBox[{"Length", "[", 
          RowBox[{"colMap", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "]"}]}], "}"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"Length", "[", "colMap", "]"}]}], "}"}]}], "]"}], ",", "18"}], 
  "]"}], "\n"}], "Input",
 CellChangeTimes->{{3.849123499838376*^9, 3.849123669973609*^9}, {
   3.849123745978812*^9, 3.8491237570398703`*^9}, {3.849123818021318*^9, 
   3.849123929152157*^9}, {3.849124034910472*^9, 3.849124064621046*^9}, {
   3.849124324564086*^9, 3.849124356678981*^9}, {3.849125038220111*^9, 
   3.8491250429613037`*^9}, 3.850320094096889*^9, {3.850323870862212*^9, 
   3.8503238751224413`*^9}, {3.8503239319622507`*^9, 3.8503239357028*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "5.41666666666666607454772019991651177406`18."}], ",", 
     RowBox[{"-", "2.08333333333333303727386009995825588703`18."}], ",", 
     RowBox[{"-", "0.83333333333333325931846502498956397176`18."}], ",", 
     RowBox[{"-", "2.91666666666666696272613990004174411297`18."}], ",", 
     "2.91666666666666563045851034985389560461`18.", ",", 
     "0.83333333333333303727386009995825588703`18.", ",", 
     "2.08333333333333303727386009995825588703`18.", ",", 
     "5.41666666666666785090455960016697645187`18."}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "0.41666666666666662965923251249478198588`18."}], ",", 
     RowBox[{"-", "7.5`18."}], ",", 
     RowBox[{"-", "2.08333333333333303727386009995825588703`18."}], ",", 
     RowBox[{"-", "2.08333333333333348136306995002087205648`18."}], ",", 
     RowBox[{"-", "2.91666666666666563045851034985389560461`18."}], ",", 
     "4.16666666666666607454772019991651177406`18.", ",", 
     "0.83333333333333436954148965014610439539`18.", ",", 
     "4.58333333333333303727386009995825588703`18.", ",", 
     "5.41666666666666518636930049979127943516`18."}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "0.41666666666666674068153497501043602824`18."}], ",", 
     RowBox[{"-", "2.08333333333333303727386009995825588703`18."}], ",", 
     RowBox[{"-", "1.24999999999999955591079014993738383055`18."}], ",", 
     "1.25000000000000044408920985006261616945`18.", ",", 
     "2.49999999999999911182158029987476766109`18."}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{
  3.849123936670495*^9, {3.849124036111981*^9, 3.849124065070026*^9}, {
   3.849124335580565*^9, 3.849124358427006*^9}, 3.84912504440175*^9, 
   3.850324011938703*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\[LineSeparator]Compute residual gradient wrt config:", "Subsection",
 CellChangeTimes->{{3.7171711972127666`*^9, 3.71717120142911*^9}, {
   3.7209943882500362`*^9, 3.7209944015165186`*^9}, {3.721049011972142*^9, 
   3.721049018596589*^9}, {3.7210554397242594`*^9, 3.7210554438131027`*^9}, {
   3.721059980929894*^9, 3.72105998715461*^9}, {3.723913091723068*^9, 
   3.723913093160647*^9}, 3.740431181072399*^9}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"residualGradientX", "=", 
   RowBox[{"Table", "[", 
    RowBox[{"0.0", ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"ndofs", " ", 
        RowBox[{"Length", "[", "xv", "]"}]}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "1", ",", 
       RowBox[{"ndims", " ", 
        RowBox[{"Length", "[", "xv", "]"}]}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"For", "[", 
  RowBox[{
   RowBox[{"i", "=", "1"}], ",", " ", 
   RowBox[{"i", "\[LessEqual]", 
    RowBox[{"Length", "[", "connect", "]"}]}], ",", 
   RowBox[{"i", "++"}], ",", 
   RowBox[{"Block", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"i1", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"connect", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}], "+", "1"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"i2", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"connect", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "[", 
          RowBox[{"[", "2", "]"}], "]"}], "+", "1"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"i3", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"connect", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "[", 
          RowBox[{"[", "3", "]"}], "]"}], "+", "1"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"i4", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"connect", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "[", 
          RowBox[{"[", "4", "]"}], "]"}], "+", "1"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"dofIds", "=", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"ndofs", " ", 
            RowBox[{"(", 
             RowBox[{"i1", "-", "1"}], ")"}]}], "+", "1"}], ",", 
          RowBox[{
           RowBox[{"ndofs", 
            RowBox[{"(", " ", 
             RowBox[{"i2", "-", "1"}], ")"}]}], "+", "1"}], ",", 
          RowBox[{
           RowBox[{"ndofs", 
            RowBox[{"(", 
             RowBox[{"i3", "-", "1"}], ")"}]}], "+", "1"}], ",", 
          RowBox[{
           RowBox[{"ndofs", 
            RowBox[{"(", 
             RowBox[{"i4", "-", "1"}], ")"}]}], "+", "1"}]}], "}"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"gradIds", "=", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"ndims", " ", 
            RowBox[{"(", 
             RowBox[{"i1", "-", "1"}], ")"}]}], "+", "1"}], ",", " ", 
          RowBox[{
           RowBox[{"ndims", 
            RowBox[{"(", " ", 
             RowBox[{"i1", "-", "1"}], ")"}]}], "+", "2"}], ",", " ", 
          RowBox[{
           RowBox[{"ndims", 
            RowBox[{"(", " ", 
             RowBox[{"i1", "-", "1"}], ")"}]}], "+", "3"}], ",", 
          RowBox[{
           RowBox[{"ndims", 
            RowBox[{"(", " ", 
             RowBox[{"i2", "-", "1"}], ")"}]}], "+", "1"}], ",", 
          RowBox[{
           RowBox[{"ndims", 
            RowBox[{"(", 
             RowBox[{"i2", "-", "1"}], ")"}]}], "+", "2"}], ",", " ", 
          RowBox[{
           RowBox[{"ndims", 
            RowBox[{"(", " ", 
             RowBox[{"i2", "-", "1"}], ")"}]}], "+", "3"}], ",", 
          RowBox[{
           RowBox[{"ndims", 
            RowBox[{"(", 
             RowBox[{"i3", "-", "1"}], ")"}]}], "+", "1"}], ",", 
          RowBox[{
           RowBox[{"ndims", " ", 
            RowBox[{"(", 
             RowBox[{"i3", "-", "1"}], ")"}]}], "+", "2"}], ",", " ", 
          RowBox[{
           RowBox[{"ndims", 
            RowBox[{"(", " ", 
             RowBox[{"i3", "-", "1"}], ")"}]}], "+", "3"}], ",", 
          RowBox[{
           RowBox[{"ndims", 
            RowBox[{"(", 
             RowBox[{"i4", "-", "1"}], ")"}]}], "+", "1"}], ",", 
          RowBox[{
           RowBox[{"ndims", 
            RowBox[{"(", 
             RowBox[{"i4", "-", "1"}], ")"}]}], "+", "2"}], ",", " ", 
          RowBox[{
           RowBox[{"ndims", 
            RowBox[{"(", " ", 
             RowBox[{"i4", "-", "1"}], ")"}]}], "+", "3"}]}], "}"}]}]}], 
      "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Kel", "=", 
       RowBox[{"gaussWeight", "*", 
        RowBox[{"KmatNoAbs", "[", 
         RowBox[{
         "x1", ",", "x2", ",", "x3", ",", "x4", ",", "x5", ",", "x6", ",", 
          "x7", ",", "x8", ",", "x9", ",", "x10", ",", "x11", ",", "x12", ",", 
          RowBox[{"1", "*", 
           SuperscriptBox["10", "2"]}]}], "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"disp", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"uv", "[", 
          RowBox[{"[", 
           RowBox[{"dofIds", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "]"}], "]"}], ",", 
         RowBox[{"uv", "[", 
          RowBox[{"[", 
           RowBox[{"dofIds", "[", 
            RowBox[{"[", "2", "]"}], "]"}], "]"}], "]"}], ",", 
         RowBox[{"uv", "[", 
          RowBox[{"[", 
           RowBox[{"dofIds", "[", 
            RowBox[{"[", "3", "]"}], "]"}], "]"}], "]"}], ",", 
         RowBox[{"uv", "[", 
          RowBox[{"[", 
           RowBox[{"dofIds", "[", 
            RowBox[{"[", "4", "]"}], "]"}], "]"}], "]"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"energyInc", "=", 
       RowBox[{"(", 
        RowBox[{"Kel", ".", "disp"}], ")"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"du", "=", 
       RowBox[{"Transpose", "[", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"D", "[", 
             RowBox[{"energyInc", ",", "x1"}], "]"}], ",", 
            RowBox[{"D", "[", 
             RowBox[{"energyInc", ",", "x2"}], "]"}], ",", 
            RowBox[{"D", "[", 
             RowBox[{"energyInc", ",", "x3"}], "]"}], ",", 
            RowBox[{"D", "[", 
             RowBox[{"energyInc", ",", "x4"}], "]"}], ",", 
            RowBox[{"D", "[", 
             RowBox[{"energyInc", ",", "x5"}], "]"}], ",", 
            RowBox[{"D", "[", 
             RowBox[{"energyInc", ",", "x6"}], "]"}], ",", 
            RowBox[{"D", "[", 
             RowBox[{"energyInc", ",", "x7"}], "]"}], ",", 
            RowBox[{"D", "[", 
             RowBox[{"energyInc", ",", "x8"}], "]"}], ",", 
            RowBox[{"D", "[", 
             RowBox[{"energyInc", ",", "x9"}], "]"}], ",", 
            RowBox[{"D", "[", 
             RowBox[{"energyInc", ",", "x10"}], "]"}], ",", 
            RowBox[{"D", "[", 
             RowBox[{"energyInc", ",", "x11"}], "]"}], ",", 
            RowBox[{"D", "[", 
             RowBox[{"energyInc", ",", "x12"}], "]"}]}], "}"}], "/.", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"x1", "\[Rule]", 
             RowBox[{"xv", "[", 
              RowBox[{"[", "i1", "]"}], "]"}]}], ",", 
            RowBox[{"x2", "\[Rule]", 
             RowBox[{"yv", "[", 
              RowBox[{"[", "i1", "]"}], "]"}]}], ",", 
            RowBox[{"x3", "\[Rule]", 
             RowBox[{"zv", "[", 
              RowBox[{"[", "i1", "]"}], "]"}]}], ",", 
            RowBox[{"x4", "\[Rule]", 
             RowBox[{"xv", "[", 
              RowBox[{"[", "i2", "]"}], "]"}]}], ",", 
            RowBox[{"x5", "\[Rule]", 
             RowBox[{"yv", "[", 
              RowBox[{"[", "i2", "]"}], "]"}]}], ",", 
            RowBox[{"x6", "\[Rule]", 
             RowBox[{"zv", "[", 
              RowBox[{"[", "i2", "]"}], "]"}]}], ",", 
            RowBox[{"x7", "\[Rule]", 
             RowBox[{"xv", "[", 
              RowBox[{"[", "i3", "]"}], "]"}]}], ",", 
            RowBox[{"x8", "\[Rule]", 
             RowBox[{"yv", "[", 
              RowBox[{"[", "i3", "]"}], "]"}]}], ",", 
            RowBox[{"x9", "\[Rule]", 
             RowBox[{"zv", "[", 
              RowBox[{"[", "i3", "]"}], "]"}]}], ",", 
            RowBox[{"x10", "\[Rule]", 
             RowBox[{"xv", "[", 
              RowBox[{"[", "i4", "]"}], "]"}]}], ",", 
            RowBox[{"x11", "\[Rule]", 
             RowBox[{"yv", "[", 
              RowBox[{"[", "i4", "]"}], "]"}]}], ",", 
            RowBox[{"x12", "\[Rule]", 
             RowBox[{"zv", "[", 
              RowBox[{"[", "i4", "]"}], "]"}]}]}], "}"}]}], ")"}], "]"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Detj", "[", 
          RowBox[{
           RowBox[{"xv", "[", 
            RowBox[{"[", "i1", "]"}], "]"}], ",", 
           RowBox[{"yv", "[", 
            RowBox[{"[", "i1", "]"}], "]"}], ",", 
           RowBox[{"zv", "[", 
            RowBox[{"[", "i1", "]"}], "]"}], ",", 
           RowBox[{"xv", "[", 
            RowBox[{"[", "i2", "]"}], "]"}], ",", 
           RowBox[{"yv", "[", 
            RowBox[{"[", "i2", "]"}], "]"}], ",", 
           RowBox[{"zv", "[", 
            RowBox[{"[", "i2", "]"}], "]"}], ",", 
           RowBox[{"xv", "[", 
            RowBox[{"[", "i3", "]"}], "]"}], ",", 
           RowBox[{"yv", "[", 
            RowBox[{"[", "i3", "]"}], "]"}], ",", 
           RowBox[{"zv", "[", 
            RowBox[{"[", "i3", "]"}], "]"}], ",", 
           RowBox[{"xv", "[", 
            RowBox[{"[", "i4", "]"}], "]"}], ",", 
           RowBox[{"yv", "[", 
            RowBox[{"[", "i4", "]"}], "]"}], ",", 
           RowBox[{"zv", "[", 
            RowBox[{"[", "i4", "]"}], "]"}]}], "]"}], "\[GreaterEqual]", 
         "0.0"}], ",", "\[IndentingNewLine]", 
        RowBox[{"For", "[", 
         RowBox[{
          RowBox[{"j", "=", "1"}], ",", 
          RowBox[{"j", "\[LessEqual]", "4"}], ",", 
          RowBox[{"j", "++"}], ",", "\[IndentingNewLine]", 
          RowBox[{"For", "[", 
           RowBox[{
            RowBox[{"k", "=", "1"}], ",", 
            RowBox[{"k", "\[LessEqual]", "12"}], ",", 
            RowBox[{"k", "++"}], ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"residualGradientX", "[", 
                RowBox[{"[", 
                 RowBox[{"dofIds", "[", 
                  RowBox[{"[", "j", "]"}], "]"}], "]"}], "]"}], "[", 
               RowBox[{"[", 
                RowBox[{"gradIds", "[", 
                 RowBox[{"[", "k", "]"}], "]"}], "]"}], "]"}], "+=", 
              RowBox[{
               RowBox[{"du", "[", 
                RowBox[{"[", "j", "]"}], "]"}], "[", 
               RowBox[{"[", "k", "]"}], "]"}]}], ";"}]}], 
           "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"For", "[", 
         RowBox[{
          RowBox[{"j", "=", "1"}], ",", 
          RowBox[{"j", "\[LessEqual]", "4"}], ",", 
          RowBox[{"j", "++"}], ",", "\[IndentingNewLine]", 
          RowBox[{"For", "[", 
           RowBox[{
            RowBox[{"k", "=", "1"}], ",", 
            RowBox[{"k", "\[LessEqual]", "12"}], ",", 
            RowBox[{"k", "++"}], ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"residualGradientX", "[", 
                RowBox[{"[", 
                 RowBox[{"dofIds", "[", 
                  RowBox[{"[", "j", "]"}], "]"}], "]"}], "]"}], "[", 
               RowBox[{"[", 
                RowBox[{"gradIds", "[", 
                 RowBox[{"[", "k", "]"}], "]"}], "]"}], "]"}], "-=", 
              RowBox[{
               RowBox[{"du", "[", 
                RowBox[{"[", "j", "]"}], "]"}], "[", 
               RowBox[{"[", "k", "]"}], "]"}]}], ";"}]}], 
           "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]}], 
       "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
  "]"}]}], "Input",
 CellChangeTimes->{{3.7167647605597653`*^9, 3.7167647892518883`*^9}, {
   3.7167648244240847`*^9, 3.716764841539942*^9}, {3.71676488019324*^9, 
   3.7167648969754357`*^9}, {3.716765065628334*^9, 3.716765185350045*^9}, {
   3.7167652229401484`*^9, 3.7167652383100395`*^9}, {3.7167653441168547`*^9, 
   3.7167655199547443`*^9}, {3.7167655675522327`*^9, 
   3.7167655810711265`*^9}, {3.716765622284607*^9, 3.7167656290567384`*^9}, {
   3.716765757154343*^9, 3.716765792076064*^9}, {3.7167658276745405`*^9, 
   3.7167660826802125`*^9}, {3.716766195664576*^9, 3.716766242915578*^9}, {
   3.7167663310833845`*^9, 3.7167663393539863`*^9}, {3.7167664503932595`*^9, 
   3.716766450932579*^9}, {3.7167664868258085`*^9, 3.7167665635541043`*^9}, {
   3.716766627651472*^9, 3.716766643645746*^9}, {3.716766826115865*^9, 
   3.7167668360695195`*^9}, {3.716766868385886*^9, 3.7167669130203*^9}, {
   3.717155721663645*^9, 3.7171557331420517`*^9}, {3.717155769178903*^9, 
   3.7171557818205233`*^9}, {3.7171567883516493`*^9, 3.717156887869956*^9}, {
   3.717156918335051*^9, 3.717156937057849*^9}, {3.717157017416103*^9, 
   3.717157052623994*^9}, {3.717157895689323*^9, 3.717157931742132*^9}, {
   3.717166282194605*^9, 3.71716628473459*^9}, {3.71716849797501*^9, 
   3.71716852298344*^9}, {3.717168562021318*^9, 3.717168562125424*^9}, {
   3.717168843821663*^9, 3.717168857297769*^9}, {3.7171692165304537`*^9, 
   3.7171692208302*^9}, {3.717170006857576*^9, 3.717170018830927*^9}, {
   3.717171209233417*^9, 3.717171213025419*^9}, {3.7173548750864697`*^9, 
   3.717354881757492*^9}, {3.717354996753583*^9, 3.717355017245678*^9}, {
   3.717355319697336*^9, 3.7173553216726255`*^9}, {3.7173557531181636`*^9, 
   3.7173557820403166`*^9}, {3.7173558138063755`*^9, 
   3.7173558166812677`*^9}, {3.7173587645155315`*^9, 
   3.7173587704721184`*^9}, {3.7173588122062426`*^9, 
   3.7173588501286516`*^9}, {3.717359014190798*^9, 3.7173590339564075`*^9}, {
   3.7173591194571896`*^9, 3.7173591202540846`*^9}, {3.717360749384885*^9, 
   3.717360755072524*^9}, {3.7173608405541487`*^9, 3.7173608453215923`*^9}, {
   3.7174176653039513`*^9, 3.7174177502357674`*^9}, {3.717418005127076*^9, 
   3.717418022383568*^9}, {3.7174180927900662`*^9, 3.717418180868244*^9}, {
   3.717419219270834*^9, 3.7174192266613092`*^9}, {3.71741926925568*^9, 
   3.717419272755123*^9}, {3.7174241468474283`*^9, 3.7174241510843997`*^9}, {
   3.71742429898483*^9, 3.717424381678406*^9}, {3.717427960779907*^9, 
   3.7174279724352093`*^9}, {3.7174281618258095`*^9, 
   3.7174281652786007`*^9}, {3.7208066594239817`*^9, 
   3.7208066657144737`*^9}, {3.720994042619423*^9, 3.7209941465012307`*^9}, {
   3.7209941931469326`*^9, 3.7209942823899403`*^9}, {3.7209945149606404`*^9, 
   3.7209945361169796`*^9}, {3.7209946799116*^9, 3.720994978291444*^9}, {
   3.7210470008455043`*^9, 3.7210470020792093`*^9}, {3.7210490923010983`*^9, 
   3.7210491222796535`*^9}, {3.7210491757545376`*^9, 
   3.7210493138722425`*^9}, {3.721049409321796*^9, 3.721049640653741*^9}, 
   3.721049765856733*^9, {3.723055124450037*^9, 3.723055129574788*^9}, {
   3.723055292912021*^9, 3.7230553309253855`*^9}, {3.7230553941804533`*^9, 
   3.7230554578048472`*^9}, {3.723055525200883*^9, 3.723055731450719*^9}, {
   3.723055828378682*^9, 3.7230558285355997`*^9}, {3.7230559085505037`*^9, 
   3.7230559544567056`*^9}, {3.723056073457146*^9, 3.723056217017265*^9}, {
   3.723056712834525*^9, 3.7230568061937404`*^9}, {3.7230570373170767`*^9, 
   3.723057041598381*^9}, {3.7230574604717684`*^9, 3.7230574691597023`*^9}, {
   3.7230576687082634`*^9, 3.723057672733388*^9}, {3.723057739783541*^9, 
   3.7230577772921667`*^9}, {3.723057872614895*^9, 3.7230578808186064`*^9}, {
   3.7230582312110176`*^9, 3.723058233179638*^9}, {3.7230582693977594`*^9, 
   3.7230583084759116`*^9}, {3.723058342960322*^9, 3.7230583468666005`*^9}, {
   3.7230585527283564`*^9, 3.723058554150366*^9}, {3.7237578674536314`*^9, 
   3.7237579530367565`*^9}, {3.723758026886219*^9, 3.7237580298343897`*^9}, {
   3.723758446116063*^9, 3.723758490487317*^9}, {3.723758534943349*^9, 
   3.7237586467179585`*^9}, {3.723758714374293*^9, 3.723758764328038*^9}, {
   3.7238390044561663`*^9, 3.7238390130181665`*^9}, {3.723913105441674*^9, 
   3.7239132371450615`*^9}, {3.7239132845796275`*^9, 
   3.7239132887039943`*^9}, {3.7239133876572685`*^9, 
   3.7239134045165205`*^9}, {3.7239136002106304`*^9, 3.7239136151480265`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Join", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"SetPrecision", "[", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"residualGradientX", "[", 
        RowBox[{"[", 
         RowBox[{
          RowBox[{"0", "+", "1"}], ",", 
          RowBox[{"i", "+", "1"}]}], "]"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "0", ",", "2"}], "}"}]}], "]"}], ",", "18"}], "]"}],
    ",", "\[IndentingNewLine]", 
   RowBox[{"SetPrecision", "[", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"residualGradientX", "[", 
        RowBox[{"[", 
         RowBox[{
          RowBox[{"1", "+", "1"}], ",", 
          RowBox[{"i", "+", "1"}]}], "]"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "0", ",", "2"}], "}"}]}], "]"}], ",", "18"}], "]"}],
    ",", "\[IndentingNewLine]", 
   RowBox[{"SetPrecision", "[", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"residualGradientX", "[", 
        RowBox[{"[", 
         RowBox[{
          RowBox[{"3", "+", "1"}], ",", 
          RowBox[{"i", "+", "1"}]}], "]"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "0", ",", "2"}], "}"}]}], "]"}], ",", "18"}], "]"}],
    ",", "\[IndentingNewLine]", 
   RowBox[{"SetPrecision", "[", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"residualGradientX", "[", 
        RowBox[{"[", 
         RowBox[{
          RowBox[{"4", "+", "1"}], ",", 
          RowBox[{"i", "+", "1"}]}], "]"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "0", ",", "2"}], "}"}]}], "]"}], ",", "18"}], 
    "]"}]}], "\[IndentingNewLine]", "]"}]], "Input",
 CellChangeTimes->{{3.740431401073248*^9, 3.7404314575337563`*^9}, {
  3.7404315025683193`*^9, 3.7404315287753773`*^9}, {3.740431587677674*^9, 
  3.7404315942350407`*^9}, {3.849125395599906*^9, 3.849125401202023*^9}, {
  3.8503239629781437`*^9, 3.850323967349153*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"-", "90.`18."}], ",", 
   RowBox[{"-", "29.99999999999999289457264239899814128876`18."}], ",", 
   RowBox[{"-", "10.`18."}], ",", 
   "28.33333333333333570180911920033395290375`18.", ",", 
   "8.3333333333333285963817615993320941925`18.", ",", 
   "23.33333333333333214909544039983302354813`18.", ",", "25.`18.", ",", 
   "26.66666666666666785090455960016697645187`18.", ",", 
   RowBox[{"-", "1.66666666666667051543981870054267346859`18."}], ",", 
   RowBox[{"-", "6.66666666666666696272613990004174411297`18."}], ",", 
   "15.00000000000000177635683940025046467781`18.", ",", 
   "15.00000000000000177635683940025046467781`18."}], "}"}]], "Output",
 CellChangeTimes->{
  3.7404314631996255`*^9, {3.740431512446096*^9, 3.7404315293778973`*^9}, 
   3.740431595141285*^9, 3.8491254054546022`*^9, 3.849125677128265*^9, 
   3.850324018347309*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Compute internal energy:", "Subsection",
 CellChangeTimes->{{3.7171711972127666`*^9, 3.71717120142911*^9}, {
  3.7209943882500362`*^9, 3.7209944015165186`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"energySum", "=", "0.0"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"For", "[", 
  RowBox[{
   RowBox[{"i", "=", "1"}], ",", " ", 
   RowBox[{"i", "\[LessEqual]", " ", 
    RowBox[{"Length", "[", "connect", "]"}]}], ",", 
   RowBox[{"i", "++"}], ",", 
   RowBox[{"Block", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"i1", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"connect", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}], "+", "1"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"i2", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"connect", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "[", 
          RowBox[{"[", "2", "]"}], "]"}], "+", "1"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"i3", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"connect", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "[", 
          RowBox[{"[", "3", "]"}], "]"}], "+", "1"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"i4", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"connect", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "[", 
          RowBox[{"[", "4", "]"}], "]"}], "+", "1"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"ids", "=", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"ndofs", " ", 
            RowBox[{"(", 
             RowBox[{"i1", "-", "1"}], ")"}]}], "+", "1"}], ",", 
          RowBox[{
           RowBox[{"ndofs", 
            RowBox[{"(", " ", 
             RowBox[{"i2", "-", "1"}], ")"}]}], "+", "1"}], ",", 
          RowBox[{
           RowBox[{"ndofs", 
            RowBox[{"(", 
             RowBox[{"i3", "-", "1"}], ")"}]}], "+", "1"}], ",", 
          RowBox[{
           RowBox[{"ndofs", 
            RowBox[{"(", 
             RowBox[{"i4", "-", "1"}], ")"}]}], "+", "1"}]}], "}"}]}]}], 
      "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Kel", "=", 
       RowBox[{"gaussWeight", "*", 
        RowBox[{"Kmat", "[", 
         RowBox[{
          RowBox[{"xv", "[", 
           RowBox[{"[", "i1", "]"}], "]"}], ",", 
          RowBox[{"yv", "[", 
           RowBox[{"[", "i1", "]"}], "]"}], ",", 
          RowBox[{"zv", "[", 
           RowBox[{"[", "i1", "]"}], "]"}], ",", 
          RowBox[{"xv", "[", 
           RowBox[{"[", "i2", "]"}], "]"}], ",", 
          RowBox[{"yv", "[", 
           RowBox[{"[", "i2", "]"}], "]"}], ",", 
          RowBox[{"zv", "[", 
           RowBox[{"[", "i2", "]"}], "]"}], ",", 
          RowBox[{"xv", "[", 
           RowBox[{"[", "i3", "]"}], "]"}], ",", 
          RowBox[{"yv", "[", 
           RowBox[{"[", "i3", "]"}], "]"}], ",", 
          RowBox[{"zv", "[", 
           RowBox[{"[", "i3", "]"}], "]"}], ",", 
          RowBox[{"xv", "[", 
           RowBox[{"[", "i4", "]"}], "]"}], ",", 
          RowBox[{"yv", "[", 
           RowBox[{"[", "i4", "]"}], "]"}], ",", 
          RowBox[{"zv", "[", 
           RowBox[{"[", "i4", "]"}], "]"}], ",", 
          RowBox[{"1", "*", 
           SuperscriptBox["10", "2"]}]}], "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"disp", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"uv", "[", 
          RowBox[{"[", 
           RowBox[{"ids", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "]"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", "4"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"energySum", " ", "+=", " ", 
       RowBox[{"disp", ".", 
        RowBox[{"(", 
         RowBox[{"Kel", ".", "disp"}], ")"}]}]}], ";"}]}], 
    "\[IndentingNewLine]", "]"}]}], "]"}]}], "Input",
 CellChangeTimes->CompressedData["
1:eJwdz3lI03EABfA1Y1l0KGGJY7aVJksyxQM1M5djif7EoUhpXo0kW1symbos
SJdZtE3ymG0aqCmx5jCPPOZRaaYZGhJimhIRYsyRR9i0gur7fn88Pn+9B48n
yU3MZjIYjFASaLS5ao612wWqfaZy6FG5pwoGnQ3QQ9YJVi18E3LoERSzg9ph
ZaDvK9jh9nkEztrHR6Fo0GkaCnV/bXCxZX0Vtoger8Ni9rgDTk41bsKLa807
fImeuczdcEaf7wLjR5L9YbAwPxJKqXQhPNAiSYDzSVfFUK+nMmDbx3RalvyT
BIb1K2RwYVaphBtPlQXQtytaB0vC1OXQL0VbCaknXAOsjghW2LCnac6DVVbv
Qtgn6FPB7iiNA7bO/GEuEwd737Hg0hxvJ+wRH98PhzerDsLVvY5iqH1ZeAcG
hYuMK8TXJQ9pYwJPt64Sz6ky22FTa1Q3vO4kpHWJK5qDSXf587Dol4vzGpFR
UUsbrZiXwo2aVBn0UflsWydGTDXQpo1InsV22AVZp0LbYCrH8AIaFnyGYLXY
sQSPlgV/g//GjnDiiKLYIS6cnrR6wR8Tbt4w4tYDPYU+O6EG3jeW1cFljrAB
bmePPoeLtZE9kGpcGYIFPOdh+Fts0cUTPRMl5bCm39UIb8aaabes/PNXiDma
MQlkujarob9oohSGxRh10PS2zgAt5hwPKTGPn8yG9/xMXLjFd+fBw54X1DLi
5c6vtH23M/WwuKurHjJ+umdew6/vuizoLA9XQWrZRHumQs790kv2FkJ4UPwh
qf6k1S5w2yW2QEunVwe8VEQNQmnGDXkyMTvArIBaZXdjClGtHWiCpZFpDW0D
doHtPccM/wNL/tqF
  "]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"SetPrecision", "[", 
  RowBox[{"energySum", ",", "18"}], "]"}]], "Input",
 CellChangeTimes->{{3.7209942858326397`*^9, 3.7209943261689053`*^9}}],

Cell[BoxData["363.99999999999982946974341757595539093018`18."], "Output",
 CellChangeTimes->{{3.720994290435001*^9, 3.720994327365387*^9}, 
   3.721046930295552*^9, 3.7210616247192526`*^9, 3.722806639625266*^9, 
   3.7239050878158693`*^9, 3.849128372675419*^9, 3.850324018404499*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Compute internal energy gradient wrt control:", "Subsection",
 CellChangeTimes->{{3.7171711972127666`*^9, 3.71717120142911*^9}, {
  3.7209943882500362`*^9, 3.7209944015165186`*^9}, {3.721049011972142*^9, 
  3.721049018596589*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"gradZ", "=", 
   RowBox[{"Table", "[", 
    RowBox[{"0.0", ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"Length", "[", "xv", "]"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"For", "[", 
  RowBox[{
   RowBox[{"i", "=", "1"}], ",", " ", 
   RowBox[{"i", "\[LessEqual]", " ", 
    RowBox[{"Length", "[", "connect", "]"}]}], ",", 
   RowBox[{"i", "++"}], ",", 
   RowBox[{"Block", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"i1", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"connect", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}], "+", "1"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"i2", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"connect", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "[", 
          RowBox[{"[", "2", "]"}], "]"}], "+", "1"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"i3", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"connect", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "[", 
          RowBox[{"[", "3", "]"}], "]"}], "+", "1"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"i4", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"connect", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "[", 
          RowBox[{"[", "4", "]"}], "]"}], "+", "1"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"ids", "=", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"ndofs", " ", 
            RowBox[{"(", 
             RowBox[{"i1", "-", "1"}], ")"}]}], "+", "1"}], ",", 
          RowBox[{
           RowBox[{"ndofs", 
            RowBox[{"(", " ", 
             RowBox[{"i2", "-", "1"}], ")"}]}], "+", "1"}], ",", 
          RowBox[{
           RowBox[{"ndofs", 
            RowBox[{"(", 
             RowBox[{"i3", "-", "1"}], ")"}]}], "+", "1"}], ",", 
          RowBox[{
           RowBox[{"ndofs", 
            RowBox[{"(", 
             RowBox[{"i4", "-", "1"}], ")"}]}], "+", "1"}]}], "}"}]}]}], 
      "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Kel", "=", 
       RowBox[{"gaussWeight", "*", 
        RowBox[{"Kmat", "[", 
         RowBox[{
          RowBox[{"xv", "[", 
           RowBox[{"[", "i1", "]"}], "]"}], ",", 
          RowBox[{"yv", "[", 
           RowBox[{"[", "i1", "]"}], "]"}], ",", 
          RowBox[{"zv", "[", 
           RowBox[{"[", "i1", "]"}], "]"}], ",", 
          RowBox[{"xv", "[", 
           RowBox[{"[", "i2", "]"}], "]"}], ",", 
          RowBox[{"yv", "[", 
           RowBox[{"[", "i2", "]"}], "]"}], ",", 
          RowBox[{"zv", "[", 
           RowBox[{"[", "i2", "]"}], "]"}], ",", 
          RowBox[{"xv", "[", 
           RowBox[{"[", "i3", "]"}], "]"}], ",", 
          RowBox[{"yv", "[", 
           RowBox[{"[", "i3", "]"}], "]"}], ",", 
          RowBox[{"zv", "[", 
           RowBox[{"[", "i3", "]"}], "]"}], ",", 
          RowBox[{"xv", "[", 
           RowBox[{"[", "i4", "]"}], "]"}], ",", 
          RowBox[{"yv", "[", 
           RowBox[{"[", "i4", "]"}], "]"}], ",", 
          RowBox[{"zv", "[", 
           RowBox[{"[", "i4", "]"}], "]"}], ",", 
          RowBox[{"1", "*", 
           SuperscriptBox["10", "2"]}]}], "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"disp", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"uv", "[", 
          RowBox[{"[", 
           RowBox[{"ids", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "]"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", "4"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"energyInc", "=", " ", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"\[Rho]1", "+", "\[Rho]2", "+", "\[Rho]3", "+", "\[Rho]4"}], 
         ")"}], 
        RowBox[{
         RowBox[{"disp", ".", 
          RowBox[{"(", 
           RowBox[{"Kel", ".", "disp"}], ")"}]}], "/", "4.0"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"d\[Rho]", "=", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"D", "[", 
            RowBox[{"energyInc", ",", "\[Rho]1"}], "]"}], ",", 
           RowBox[{"D", "[", 
            RowBox[{"energyInc", ",", "\[Rho]2"}], "]"}], ",", 
           RowBox[{"D", "[", 
            RowBox[{"energyInc", ",", "\[Rho]3"}], "]"}], ",", 
           RowBox[{"D", "[", 
            RowBox[{"energyInc", ",", "\[Rho]4"}], "]"}]}], "}"}], "/.", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"\[Rho]1", "\[Rule]", "1.0"}], ",", 
           RowBox[{"\[Rho]2", "\[Rule]", "1.0"}], ",", 
           RowBox[{"\[Rho]3", "\[Rule]", "1.0"}], ",", 
           RowBox[{"\[Rho]4", "\[Rule]", "1.0"}]}], "}"}]}], ")"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"gradZ", "[", 
        RowBox[{"[", "i1", "]"}], "]"}], "+=", 
       RowBox[{"d\[Rho]", "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"gradZ", "[", 
        RowBox[{"[", "i2", "]"}], "]"}], "+=", 
       RowBox[{"d\[Rho]", "[", 
        RowBox[{"[", "2", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"gradZ", "[", 
        RowBox[{"[", "i3", "]"}], "]"}], "+=", 
       RowBox[{"d\[Rho]", "[", 
        RowBox[{"[", "3", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"gradZ", "[", 
        RowBox[{"[", "i4", "]"}], "]"}], "+=", 
       RowBox[{"d\[Rho]", "[", 
        RowBox[{"[", "4", "]"}], "]"}]}], ";"}]}], "\[IndentingNewLine]", 
    "]"}]}], "]"}]}], "Input",
 CellChangeTimes->CompressedData["
1:eJwdz3lIkwEABfA1Y1mYKWWZY7aVJnNkhgdpy5yOZfqJwyGVpbNhZKaJ5rFU
SFeZNCd5zJwGakksHeY0j2mztOURChJiXkWIGDryCJvaZd/7/nj8/noPHkeW
EnmVTqPR/MlAzYK90l1vFsj3aIuhU+nuMuh99oQaMo4zquB730NPoJjprYel
Xry3sMXhiwlOmIf6ochoNQaFqn8LcK5xdRk2ip6uwjzmkAWOjNatwysr9Tt4
pM4pdBs4rs6wg+GmKE/oI8wIgIlEjBDub5RFwGnJDTFUq4lY2PwphpKRPCWD
ft2pSXBmIj0drr1Iz4S8tmAVzPdTFEOPi0WlkHjOroTlfJ/UBewp69NgmcE1
C3YJuuSwPVBpgU3jv+mLpMbODww4P8nZCTvEx/bCvvWyA3DZ1pIHi95k3Yfe
/iLNEum7/MeUIV5nmpZJz8ulevisKbAd3rYSUtqFZU9CyQPuNMzetLNeIaWV
VFEGp04nwrWK6CToJnfbtkrKH62lvGySvQxtMQviTp9shtGsyh5YOePWC8vF
lnl4tMDnG9waOMIKIxWF9rLh2IjBBf4YdnCF/DuP1AT6zIgK+FBTUA0XWcJa
uJ3Z/wrOVQV0QKJuqRdmcqz74C+xThVO6hwpK4YV3fYamBvaQLlh4F64Tpqg
HJBBun29AnqKhu9BvxCNCmoHqyuhriHBKZE0jRvFhIUeWjbc4Dpy4GHnS4ok
0muts5Rdd6VqmNfWVgNpPx2lN/HruyoOWif7yyGxqKUMKklmf+0k92Z8OVD8
UVJzymAWOOwS66Cu1aUFxmcTRlhijJ2CRI/VZzjG+7sEFZJz+/ikUltmThTp
bGEQ5Zb+oKn5tVlgcytiEObG52xCT5b7H/gfoxHq+w==
  "]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"SetPrecision", "[", 
  RowBox[{"gradZ", ",", "16"}], "]"}]], "Input",
 CellChangeTimes->{{3.7209949856957116`*^9, 3.7209949866369324`*^9}, {
  3.720995044627005*^9, 3.720995050464894*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "11.375`16.", ",", "15.16666666666666429819088079966604709625`16.", ",", 
   "3.79166666666666607454772019991651177406`16.", ",", 
   "15.16666666666666607454772019991651177406`16.", ",", 
   "22.74999999999999289457264239899814128876`16.", ",", 
   "7.58333333333333126091702069970779120922`16.", ",", 
   "3.79166666666666696272613990004174411297`16.", ",", 
   "7.58333333333333303727386009995825588703`16.", ",", 
   "3.79166666666666607454772019991651177406`16.", ",", 
   "15.16666666666666962726139900041744112968`16.", ",", 
   "22.75000000000000355271367880050092935562`16.", ",", 
   "7.58333333333333392545227980008348822594`16.", ",", "22.75`16.", ",", 
   "45.50000000000001421085471520200371742249`16.", ",", 
   "22.75000000000000355271367880050092935562`16.", ",", 
   "7.58333333333333214909544039983302354813`16.", ",", "22.75`16.", ",", 
   "15.16666666666666785090455960016697645187`16.", ",", 
   "3.79166666666666740681534975010436028242`16.", ",", 
   "7.58333333333333658998753890045918524265`16.", ",", 
   "3.79166666666666740681534975010436028242`16.", ",", 
   "7.58333333333333392545227980008348822594`16.", ",", 
   "22.75000000000001065814103640150278806686`16.", ",", 
   "15.16666666666667495633191720116883516312`16.", ",", 
   "3.79166666666666563045851034985389560461`16.", ",", 
   "15.16666666666666785090455960016697645187`16.", ",", 
   "11.37500000000000710542735760100185871124`16."}], "}"}]], "Output",
 CellChangeTimes->{3.720994987716754*^9, 3.7209950515695486`*^9, 
  3.721047011769689*^9, 3.7210616304729853`*^9, 3.7228072763612566`*^9, 
  3.723905146881833*^9, 3.849128482801592*^9, 3.850324018472683*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Compute internal energy gradient wrt state:", "Subsection",
 CellChangeTimes->{{3.7171711972127666`*^9, 3.71717120142911*^9}, {
  3.7209943882500362`*^9, 3.7209944015165186`*^9}, {3.721049011972142*^9, 
  3.721049018596589*^9}, {3.7210490655350704`*^9, 3.7210490675964766`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"gradU", "=", 
   RowBox[{"Table", "[", 
    RowBox[{"0.0", ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"Length", "[", "xv", "]"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"For", "[", 
  RowBox[{
   RowBox[{"i", "=", "1"}], ",", " ", 
   RowBox[{"i", "\[LessEqual]", " ", 
    RowBox[{"Length", "[", "connect", "]"}]}], ",", 
   RowBox[{"i", "++"}], ",", 
   RowBox[{"Block", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"i1", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"connect", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}], "+", "1"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"i2", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"connect", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "[", 
          RowBox[{"[", "2", "]"}], "]"}], "+", "1"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"i3", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"connect", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "[", 
          RowBox[{"[", "3", "]"}], "]"}], "+", "1"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"i4", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"connect", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "[", 
          RowBox[{"[", "4", "]"}], "]"}], "+", "1"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"ids", "=", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"ndofs", " ", 
            RowBox[{"(", 
             RowBox[{"i1", "-", "1"}], ")"}]}], "+", "1"}], ",", 
          RowBox[{
           RowBox[{"ndofs", 
            RowBox[{"(", " ", 
             RowBox[{"i2", "-", "1"}], ")"}]}], "+", "1"}], ",", 
          RowBox[{
           RowBox[{"ndofs", 
            RowBox[{"(", 
             RowBox[{"i3", "-", "1"}], ")"}]}], "+", "1"}], ",", 
          RowBox[{
           RowBox[{"ndofs", 
            RowBox[{"(", 
             RowBox[{"i4", "-", "1"}], ")"}]}], "+", "1"}]}], "}"}]}]}], 
      "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Kel", "=", 
       RowBox[{"gaussWeight", "*", 
        RowBox[{"Kmat", "[", 
         RowBox[{
          RowBox[{"xv", "[", 
           RowBox[{"[", "i1", "]"}], "]"}], ",", 
          RowBox[{"yv", "[", 
           RowBox[{"[", "i1", "]"}], "]"}], ",", 
          RowBox[{"zv", "[", 
           RowBox[{"[", "i1", "]"}], "]"}], ",", 
          RowBox[{"xv", "[", 
           RowBox[{"[", "i2", "]"}], "]"}], ",", 
          RowBox[{"yv", "[", 
           RowBox[{"[", "i2", "]"}], "]"}], ",", 
          RowBox[{"zv", "[", 
           RowBox[{"[", "i2", "]"}], "]"}], ",", 
          RowBox[{"xv", "[", 
           RowBox[{"[", "i3", "]"}], "]"}], ",", 
          RowBox[{"yv", "[", 
           RowBox[{"[", "i3", "]"}], "]"}], ",", 
          RowBox[{"zv", "[", 
           RowBox[{"[", "i3", "]"}], "]"}], ",", 
          RowBox[{"xv", "[", 
           RowBox[{"[", "i4", "]"}], "]"}], ",", 
          RowBox[{"yv", "[", 
           RowBox[{"[", "i4", "]"}], "]"}], ",", 
          RowBox[{"zv", "[", 
           RowBox[{"[", "i4", "]"}], "]"}], ",", 
          RowBox[{"1", "*", 
           SuperscriptBox["10", "2"]}]}], "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"temperature", "=", 
       RowBox[{"{", 
        RowBox[{"u1", ",", "u2", ",", "u3", ",", "u4"}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"energyInc", "=", 
       RowBox[{"temperature", ".", 
        RowBox[{"(", 
         RowBox[{"Kel", ".", "temperature"}], ")"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"du", "=", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"D", "[", 
            RowBox[{"energyInc", ",", "u1"}], "]"}], ",", 
           RowBox[{"D", "[", 
            RowBox[{"energyInc", ",", "u2"}], "]"}], ",", 
           RowBox[{"D", "[", 
            RowBox[{"energyInc", ",", "u3"}], "]"}], ",", 
           RowBox[{"D", "[", 
            RowBox[{"energyInc", ",", "u4"}], "]"}]}], "}"}], "/.", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"u1", "\[Rule]", 
            RowBox[{"uv", "[", 
             RowBox[{"[", 
              RowBox[{"ids", "[", 
               RowBox[{"[", "1", "]"}], "]"}], "]"}], "]"}]}], ",", 
           RowBox[{"u2", "\[Rule]", 
            RowBox[{"uv", "[", 
             RowBox[{"[", 
              RowBox[{"ids", "[", 
               RowBox[{"[", "2", "]"}], "]"}], "]"}], "]"}]}], ",", 
           RowBox[{"u3", "\[Rule]", 
            RowBox[{"uv", "[", 
             RowBox[{"[", 
              RowBox[{"ids", "[", 
               RowBox[{"[", "3", "]"}], "]"}], "]"}], "]"}]}], ",", 
           RowBox[{"u4", "\[Rule]", 
            RowBox[{"uv", "[", 
             RowBox[{"[", 
              RowBox[{"ids", "[", 
               RowBox[{"[", "4", "]"}], "]"}], "]"}], "]"}]}]}], "}"}]}], 
        ")"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"j", "=", "1"}], ",", 
        RowBox[{"j", "\[LessEqual]", "4"}], ",", 
        RowBox[{"j", "++"}], ",", 
        RowBox[{
         RowBox[{"gradU", "[", 
          RowBox[{"[", 
           RowBox[{"ids", "[", 
            RowBox[{"[", "j", "]"}], "]"}], "]"}], "]"}], "+=", 
         RowBox[{"du", "[", 
          RowBox[{"[", "j", "]"}], "]"}]}]}], "]"}], ";"}]}], 
    "\[IndentingNewLine]", "]"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.7167647605597653`*^9, 3.7167647892518883`*^9}, {
   3.7167648244240847`*^9, 3.716764841539942*^9}, {3.71676488019324*^9, 
   3.7167648969754357`*^9}, {3.716765065628334*^9, 3.716765185350045*^9}, {
   3.7167652229401484`*^9, 3.7167652383100395`*^9}, {3.7167653441168547`*^9, 
   3.7167655199547443`*^9}, {3.7167655675522327`*^9, 
   3.7167655810711265`*^9}, {3.716765622284607*^9, 3.7167656290567384`*^9}, {
   3.716765757154343*^9, 3.716765792076064*^9}, {3.7167658276745405`*^9, 
   3.7167660826802125`*^9}, {3.716766195664576*^9, 3.716766242915578*^9}, {
   3.7167663310833845`*^9, 3.7167663393539863`*^9}, {3.7167664503932595`*^9, 
   3.716766450932579*^9}, {3.7167664868258085`*^9, 3.7167665635541043`*^9}, {
   3.716766627651472*^9, 3.716766643645746*^9}, {3.716766826115865*^9, 
   3.7167668360695195`*^9}, {3.716766868385886*^9, 3.7167669130203*^9}, {
   3.717155721663645*^9, 3.7171557331420517`*^9}, {3.717155769178903*^9, 
   3.7171557818205233`*^9}, {3.7171567883516493`*^9, 3.717156887869956*^9}, {
   3.717156918335051*^9, 3.717156937057849*^9}, {3.717157017416103*^9, 
   3.717157052623994*^9}, {3.717157895689323*^9, 3.717157931742132*^9}, {
   3.717166282194605*^9, 3.71716628473459*^9}, {3.71716849797501*^9, 
   3.71716852298344*^9}, {3.717168562021318*^9, 3.717168562125424*^9}, {
   3.717168843821663*^9, 3.717168857297769*^9}, {3.7171692165304537`*^9, 
   3.7171692208302*^9}, {3.717170006857576*^9, 3.717170018830927*^9}, {
   3.717171209233417*^9, 3.717171213025419*^9}, {3.7173548750864697`*^9, 
   3.717354881757492*^9}, {3.717354996753583*^9, 3.717355017245678*^9}, {
   3.717355319697336*^9, 3.7173553216726255`*^9}, {3.7173557531181636`*^9, 
   3.7173557820403166`*^9}, {3.7173558138063755`*^9, 
   3.7173558166812677`*^9}, {3.7173587645155315`*^9, 
   3.7173587704721184`*^9}, {3.7173588122062426`*^9, 
   3.7173588501286516`*^9}, {3.717359014190798*^9, 3.7173590339564075`*^9}, {
   3.7173591194571896`*^9, 3.7173591202540846`*^9}, {3.717360749384885*^9, 
   3.717360755072524*^9}, {3.7173608405541487`*^9, 3.7173608453215923`*^9}, {
   3.7174176653039513`*^9, 3.7174177502357674`*^9}, {3.717418005127076*^9, 
   3.717418022383568*^9}, {3.7174180927900662`*^9, 3.717418180868244*^9}, {
   3.717419219270834*^9, 3.7174192266613092`*^9}, {3.71741926925568*^9, 
   3.717419272755123*^9}, {3.7174241468474283`*^9, 3.7174241510843997`*^9}, {
   3.71742429898483*^9, 3.717424381678406*^9}, {3.717427960779907*^9, 
   3.7174279724352093`*^9}, {3.7174281618258095`*^9, 
   3.7174281652786007`*^9}, {3.7208066594239817`*^9, 
   3.7208066657144737`*^9}, {3.720994042619423*^9, 3.7209941465012307`*^9}, {
   3.7209941931469326`*^9, 3.7209942823899403`*^9}, {3.7209945149606404`*^9, 
   3.7209945361169796`*^9}, {3.7209946799116*^9, 3.720994978291444*^9}, {
   3.7210470008455043`*^9, 3.7210470020792093`*^9}, {3.7210490923010983`*^9, 
   3.7210491222796535`*^9}, {3.7210491757545376`*^9, 
   3.7210493138722425`*^9}, {3.721049409321796*^9, 3.721049640653741*^9}, 
   3.721049765856733*^9, {3.722783246074026*^9, 3.7227833650180407`*^9}, {
   3.722783412917161*^9, 3.7227834229606285`*^9}, {3.7239053583333063`*^9, 
   3.723905370489643*^9}, 3.7239054138328657`*^9, {3.723905451130167*^9, 
   3.7239054513957033`*^9}, {3.723905619700385*^9, 3.723905620482182*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"SetPrecision", "[", 
  RowBox[{"gradU", ",", "16"}], "]"}]], "Input",
 CellChangeTimes->{{3.7209949856957116`*^9, 3.7209949866369324`*^9}, {
  3.720995044627005*^9, 3.720995050464894*^9}, {3.7210497813919053`*^9, 
  3.7210497819111586`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"-", "43.3333333333333285963817615993320941925`16."}], ",", 
   RowBox[{"-", "60.`16."}], ",", 
   RowBox[{"-", "16.66666666666666429819088079966604709625`16."}], ",", 
   RowBox[{"-", "49.99999999999999289457264239899814128876`16."}], ",", 
   RowBox[{"-", "90.00000000000001421085471520200371742249`16."}], ",", 
   RowBox[{"-", "39.99999999999998578914528479799628257751`16."}], ",", 
   RowBox[{"-", "6.66666666666666429819088079966604709625`16."}], ",", 
   RowBox[{"-", "30.`16."}], ",", 
   RowBox[{"-", "23.33333333333333570180911920033395290375`16."}], ",", 
   RowBox[{"-", "20.00000000000000710542735760100185871124`16."}], ",", 
   RowBox[{"-", "29.99999999999999289457264239899814128876`16."}], ",", 
   RowBox[{"-", "9.99999999999998578914528479799628257751`16."}], ",", 
   RowBox[{"-", "10.00000000000000710542735760100185871124`16."}], ",", 
   "1.42108547152020037174224853515625`16.*^-14", ",", 
   "9.99999999999996092014953319448977708817`16.", ",", "10.`16.", ",", 
   "30.00000000000003197442310920450836420059`16.", ",", 
   "19.99999999999998223643160599749535322189`16.", ",", 
   "23.33333333333333570180911920033395290375`16.", ",", 
   "29.99999999999996092014953319448977708817`16.", ",", 
   "6.6666666666666714036182384006679058075`16.", ",", 
   "39.99999999999999289457264239899814128876`16.", ",", 
   "90.00000000000008526512829121202230453491`16.", ",", "50.`16.", ",", 
   "16.66666666666663587648145039565861225128`16.", ",", 
   "59.99999999999997157829056959599256515503`16.", ",", 
   "43.33333333333334991266383440233767032623`16."}], "}"}]], "Output",
 CellChangeTimes->{3.720994987716754*^9, 3.7209950515695486`*^9, 
  3.721047011769689*^9, 3.721049783085235*^9, 3.7210616458831215`*^9, 
  3.7227834338392105`*^9, 3.7239051557725883`*^9, 3.723906649502516*^9, 
  3.849128405502068*^9, 3.850324018540496*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Compute internal energy gradient wrt config:", "Subsection",
 CellChangeTimes->{{3.7171711972127666`*^9, 3.71717120142911*^9}, {
  3.7209943882500362`*^9, 3.7209944015165186`*^9}, {3.721049011972142*^9, 
  3.721049018596589*^9}, {3.7210490655350704`*^9, 3.7210490675964766`*^9}, {
  3.7239058454513345`*^9, 3.7239058473711505`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"gradX", "=", 
   RowBox[{"Table", "[", 
    RowBox[{"0.0", ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"ndims", " ", 
        RowBox[{"Length", "[", "xv", "]"}]}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"For", "[", 
  RowBox[{
   RowBox[{"i", "=", "1"}], ",", " ", 
   RowBox[{"i", "\[LessEqual]", " ", 
    RowBox[{"Length", "[", "connect", "]"}]}], ",", 
   RowBox[{"i", "++"}], ",", 
   RowBox[{"Block", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"i1", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"connect", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}], "+", "1"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"i2", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"connect", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "[", 
          RowBox[{"[", "2", "]"}], "]"}], "+", "1"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"i3", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"connect", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "[", 
          RowBox[{"[", "3", "]"}], "]"}], "+", "1"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"i4", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"connect", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "[", 
          RowBox[{"[", "4", "]"}], "]"}], "+", "1"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"dofIds", "=", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"ndofs", " ", 
            RowBox[{"(", 
             RowBox[{"i1", "-", "1"}], ")"}]}], "+", "1"}], ",", 
          RowBox[{
           RowBox[{"ndofs", 
            RowBox[{"(", " ", 
             RowBox[{"i2", "-", "1"}], ")"}]}], "+", "1"}], ",", 
          RowBox[{
           RowBox[{"ndofs", 
            RowBox[{"(", 
             RowBox[{"i3", "-", "1"}], ")"}]}], "+", "1"}], ",", 
          RowBox[{
           RowBox[{"ndofs", 
            RowBox[{"(", 
             RowBox[{"i4", "-", "1"}], ")"}]}], "+", "1"}]}], "}"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"gradIds", "=", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"ndims", " ", 
            RowBox[{"(", 
             RowBox[{"i1", "-", "1"}], ")"}]}], "+", "1"}], ",", " ", 
          RowBox[{
           RowBox[{"ndims", 
            RowBox[{"(", " ", 
             RowBox[{"i1", "-", "1"}], ")"}]}], "+", "2"}], ",", " ", 
          RowBox[{
           RowBox[{"ndims", 
            RowBox[{"(", " ", 
             RowBox[{"i1", "-", "1"}], ")"}]}], "+", "3"}], ",", 
          RowBox[{
           RowBox[{"ndims", 
            RowBox[{"(", " ", 
             RowBox[{"i2", "-", "1"}], ")"}]}], "+", "1"}], ",", 
          RowBox[{
           RowBox[{"ndims", 
            RowBox[{"(", 
             RowBox[{"i2", "-", "1"}], ")"}]}], "+", "2"}], ",", " ", 
          RowBox[{
           RowBox[{"ndims", 
            RowBox[{"(", " ", 
             RowBox[{"i2", "-", "1"}], ")"}]}], "+", "3"}], ",", 
          RowBox[{
           RowBox[{"ndims", 
            RowBox[{"(", 
             RowBox[{"i3", "-", "1"}], ")"}]}], "+", "1"}], ",", 
          RowBox[{
           RowBox[{"ndims", " ", 
            RowBox[{"(", 
             RowBox[{"i3", "-", "1"}], ")"}]}], "+", "2"}], ",", " ", 
          RowBox[{
           RowBox[{"ndims", 
            RowBox[{"(", " ", 
             RowBox[{"i3", "-", "1"}], ")"}]}], "+", "3"}], ",", 
          RowBox[{
           RowBox[{"ndims", 
            RowBox[{"(", 
             RowBox[{"i4", "-", "1"}], ")"}]}], "+", "1"}], ",", 
          RowBox[{
           RowBox[{"ndims", 
            RowBox[{"(", 
             RowBox[{"i4", "-", "1"}], ")"}]}], "+", "2"}], ",", " ", 
          RowBox[{
           RowBox[{"ndims", 
            RowBox[{"(", " ", 
             RowBox[{"i4", "-", "1"}], ")"}]}], "+", "3"}]}], "}"}]}]}], 
      "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Kel", "=", 
       RowBox[{"gaussWeight", "*", 
        RowBox[{"KmatNoAbs", "[", 
         RowBox[{
         "x1", ",", "x2", ",", "x3", ",", "x4", ",", "x5", ",", "x6", ",", 
          "x7", ",", "x8", ",", "x9", ",", "x10", ",", "x11", ",", "x12", ",", 
          RowBox[{"1", "*", 
           SuperscriptBox["10", "2"]}]}], "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"temperature", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"uv", "[", 
          RowBox[{"[", 
           RowBox[{"dofIds", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "]"}], "]"}], ",", 
         RowBox[{"uv", "[", 
          RowBox[{"[", 
           RowBox[{"dofIds", "[", 
            RowBox[{"[", "2", "]"}], "]"}], "]"}], "]"}], ",", 
         RowBox[{"uv", "[", 
          RowBox[{"[", 
           RowBox[{"dofIds", "[", 
            RowBox[{"[", "3", "]"}], "]"}], "]"}], "]"}], ",", 
         RowBox[{"uv", "[", 
          RowBox[{"[", 
           RowBox[{"dofIds", "[", 
            RowBox[{"[", "4", "]"}], "]"}], "]"}], "]"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"energyInc", "=", 
       RowBox[{"temperature", ".", 
        RowBox[{"(", 
         RowBox[{"Kel", ".", "temperature"}], ")"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"du", "=", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"D", "[", 
            RowBox[{"energyInc", ",", "x1"}], "]"}], ",", 
           RowBox[{"D", "[", 
            RowBox[{"energyInc", ",", "x2"}], "]"}], ",", 
           RowBox[{"D", "[", 
            RowBox[{"energyInc", ",", "x3"}], "]"}], ",", 
           RowBox[{"D", "[", 
            RowBox[{"energyInc", ",", "x4"}], "]"}], ",", 
           RowBox[{"D", "[", 
            RowBox[{"energyInc", ",", "x5"}], "]"}], ",", 
           RowBox[{"D", "[", 
            RowBox[{"energyInc", ",", "x6"}], "]"}], ",", 
           RowBox[{"D", "[", 
            RowBox[{"energyInc", ",", "x7"}], "]"}], ",", 
           RowBox[{"D", "[", 
            RowBox[{"energyInc", ",", "x8"}], "]"}], ",", 
           RowBox[{"D", "[", 
            RowBox[{"energyInc", ",", "x9"}], "]"}], ",", 
           RowBox[{"D", "[", 
            RowBox[{"energyInc", ",", "x10"}], "]"}], ",", 
           RowBox[{"D", "[", 
            RowBox[{"energyInc", ",", "x11"}], "]"}], ",", 
           RowBox[{"D", "[", 
            RowBox[{"energyInc", ",", "x12"}], "]"}]}], "}"}], "/.", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"x1", "\[Rule]", 
            RowBox[{"xv", "[", 
             RowBox[{"[", "i1", "]"}], "]"}]}], ",", 
           RowBox[{"x2", "\[Rule]", 
            RowBox[{"yv", "[", 
             RowBox[{"[", "i1", "]"}], "]"}]}], ",", 
           RowBox[{"x3", "\[Rule]", 
            RowBox[{"zv", "[", 
             RowBox[{"[", "i1", "]"}], "]"}]}], ",", 
           RowBox[{"x4", "\[Rule]", 
            RowBox[{"xv", "[", 
             RowBox[{"[", "i2", "]"}], "]"}]}], ",", 
           RowBox[{"x5", "\[Rule]", 
            RowBox[{"yv", "[", 
             RowBox[{"[", "i2", "]"}], "]"}]}], ",", 
           RowBox[{"x6", "\[Rule]", 
            RowBox[{"zv", "[", 
             RowBox[{"[", "i2", "]"}], "]"}]}], ",", 
           RowBox[{"x7", "\[Rule]", 
            RowBox[{"xv", "[", 
             RowBox[{"[", "i3", "]"}], "]"}]}], ",", 
           RowBox[{"x8", "\[Rule]", 
            RowBox[{"yv", "[", 
             RowBox[{"[", "i3", "]"}], "]"}]}], ",", 
           RowBox[{"x9", "\[Rule]", 
            RowBox[{"zv", "[", 
             RowBox[{"[", "i3", "]"}], "]"}]}], ",", 
           RowBox[{"x10", "\[Rule]", 
            RowBox[{"xv", "[", 
             RowBox[{"[", "i4", "]"}], "]"}]}], ",", 
           RowBox[{"x11", "\[Rule]", 
            RowBox[{"yv", "[", 
             RowBox[{"[", "i4", "]"}], "]"}]}], ",", 
           RowBox[{"x12", "\[Rule]", 
            RowBox[{"zv", "[", 
             RowBox[{"[", "i4", "]"}], "]"}]}]}], "}"}]}], ")"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Detj", "[", 
          RowBox[{
           RowBox[{"xv", "[", 
            RowBox[{"[", "i1", "]"}], "]"}], ",", 
           RowBox[{"yv", "[", 
            RowBox[{"[", "i1", "]"}], "]"}], ",", 
           RowBox[{"zv", "[", 
            RowBox[{"[", "i1", "]"}], "]"}], ",", 
           RowBox[{"xv", "[", 
            RowBox[{"[", "i2", "]"}], "]"}], ",", 
           RowBox[{"yv", "[", 
            RowBox[{"[", "i2", "]"}], "]"}], ",", 
           RowBox[{"zv", "[", 
            RowBox[{"[", "i2", "]"}], "]"}], ",", 
           RowBox[{"xv", "[", 
            RowBox[{"[", "i3", "]"}], "]"}], ",", 
           RowBox[{"yv", "[", 
            RowBox[{"[", "i3", "]"}], "]"}], ",", 
           RowBox[{"zv", "[", 
            RowBox[{"[", "i3", "]"}], "]"}], ",", 
           RowBox[{"xv", "[", 
            RowBox[{"[", "i4", "]"}], "]"}], ",", 
           RowBox[{"yv", "[", 
            RowBox[{"[", "i4", "]"}], "]"}], ",", 
           RowBox[{"zv", "[", 
            RowBox[{"[", "i4", "]"}], "]"}]}], "]"}], "\[GreaterEqual]", 
         "0.0"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"For", "[", 
          RowBox[{
           RowBox[{"j", "=", "1"}], ",", 
           RowBox[{"j", "\[LessEqual]", "12"}], ",", 
           RowBox[{"j", "++"}], ",", 
           RowBox[{
            RowBox[{"gradX", "[", 
             RowBox[{"[", 
              RowBox[{"gradIds", "[", 
               RowBox[{"[", "j", "]"}], "]"}], "]"}], "]"}], "+=", 
            RowBox[{"du", "[", 
             RowBox[{"[", "j", "]"}], "]"}]}]}], "]"}], ";"}], ",", 
        RowBox[{
         RowBox[{"For", "[", 
          RowBox[{
           RowBox[{"j", "=", "1"}], ",", 
           RowBox[{"j", "\[LessEqual]", "12"}], ",", 
           RowBox[{"j", "++"}], ",", 
           RowBox[{
            RowBox[{"gradX", "[", 
             RowBox[{"[", 
              RowBox[{"gradIds", "[", 
               RowBox[{"[", "j", "]"}], "]"}], "]"}], "]"}], "-=", 
            RowBox[{"du", "[", 
             RowBox[{"[", "j", "]"}], "]"}]}]}], "]"}], ";"}]}], "]"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.7167647605597653`*^9, 3.7167647892518883`*^9}, {
   3.7167648244240847`*^9, 3.716764841539942*^9}, {3.71676488019324*^9, 
   3.7167648969754357`*^9}, {3.716765065628334*^9, 3.716765185350045*^9}, {
   3.7167652229401484`*^9, 3.7167652383100395`*^9}, {3.7167653441168547`*^9, 
   3.7167655199547443`*^9}, {3.7167655675522327`*^9, 
   3.7167655810711265`*^9}, {3.716765622284607*^9, 3.7167656290567384`*^9}, {
   3.716765757154343*^9, 3.716765792076064*^9}, {3.7167658276745405`*^9, 
   3.7167660826802125`*^9}, {3.716766195664576*^9, 3.716766242915578*^9}, {
   3.7167663310833845`*^9, 3.7167663393539863`*^9}, {3.7167664503932595`*^9, 
   3.716766450932579*^9}, {3.7167664868258085`*^9, 3.7167665635541043`*^9}, {
   3.716766627651472*^9, 3.716766643645746*^9}, {3.716766826115865*^9, 
   3.7167668360695195`*^9}, {3.716766868385886*^9, 3.7167669130203*^9}, {
   3.717155721663645*^9, 3.7171557331420517`*^9}, {3.717155769178903*^9, 
   3.7171557818205233`*^9}, {3.7171567883516493`*^9, 3.717156887869956*^9}, {
   3.717156918335051*^9, 3.717156937057849*^9}, {3.717157017416103*^9, 
   3.717157052623994*^9}, {3.717157895689323*^9, 3.717157931742132*^9}, {
   3.717166282194605*^9, 3.71716628473459*^9}, {3.71716849797501*^9, 
   3.71716852298344*^9}, {3.717168562021318*^9, 3.717168562125424*^9}, {
   3.717168843821663*^9, 3.717168857297769*^9}, {3.7171692165304537`*^9, 
   3.7171692208302*^9}, {3.717170006857576*^9, 3.717170018830927*^9}, {
   3.717171209233417*^9, 3.717171213025419*^9}, {3.7173548750864697`*^9, 
   3.717354881757492*^9}, {3.717354996753583*^9, 3.717355017245678*^9}, {
   3.717355319697336*^9, 3.7173553216726255`*^9}, {3.7173557531181636`*^9, 
   3.7173557820403166`*^9}, {3.7173558138063755`*^9, 
   3.7173558166812677`*^9}, {3.7173587645155315`*^9, 
   3.7173587704721184`*^9}, {3.7173588122062426`*^9, 
   3.7173588501286516`*^9}, {3.717359014190798*^9, 3.7173590339564075`*^9}, {
   3.7173591194571896`*^9, 3.7173591202540846`*^9}, {3.717360749384885*^9, 
   3.717360755072524*^9}, {3.7173608405541487`*^9, 3.7173608453215923`*^9}, {
   3.7174176653039513`*^9, 3.7174177502357674`*^9}, {3.717418005127076*^9, 
   3.717418022383568*^9}, {3.7174180927900662`*^9, 3.717418180868244*^9}, {
   3.717419219270834*^9, 3.7174192266613092`*^9}, {3.71741926925568*^9, 
   3.717419272755123*^9}, {3.7174241468474283`*^9, 3.7174241510843997`*^9}, {
   3.71742429898483*^9, 3.717424381678406*^9}, {3.717427960779907*^9, 
   3.7174279724352093`*^9}, {3.7174281618258095`*^9, 
   3.7174281652786007`*^9}, {3.7208066594239817`*^9, 
   3.7208066657144737`*^9}, {3.720994042619423*^9, 3.7209941465012307`*^9}, {
   3.7209941931469326`*^9, 3.7209942823899403`*^9}, {3.7209945149606404`*^9, 
   3.7209945361169796`*^9}, {3.7209946799116*^9, 3.720994978291444*^9}, {
   3.7210470008455043`*^9, 3.7210470020792093`*^9}, {3.7210490923010983`*^9, 
   3.7210491222796535`*^9}, {3.7210491757545376`*^9, 
   3.7210493138722425`*^9}, {3.721049409321796*^9, 3.721049640653741*^9}, 
   3.721049765856733*^9, {3.722783246074026*^9, 3.7227833650180407`*^9}, {
   3.722783412917161*^9, 3.7227834229606285`*^9}, {3.7239053583333063`*^9, 
   3.723905370489643*^9}, 3.7239054138328657`*^9, {3.723905451130167*^9, 
   3.7239054513957033`*^9}, {3.7239056114192367`*^9, 3.723905741700754*^9}, {
   3.723905782528951*^9, 3.723905813903674*^9}, {3.723905859188613*^9, 
   3.7239058606412*^9}, {3.7239061096076617`*^9, 3.7239061103097553`*^9}, {
   3.723906240146721*^9, 3.7239064310961733`*^9}, {3.723906479643185*^9, 
   3.723906486002944*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"SetPrecision", "[", 
  RowBox[{"gradX", ",", "16"}], "]"}]], "Input",
 CellChangeTimes->{{3.7209949856957116`*^9, 3.7209949866369324`*^9}, {
  3.720995044627005*^9, 3.720995050464894*^9}, {3.7210497813919053`*^9, 
  3.7210497819111586`*^9}, {3.723906514799513*^9, 3.723906515345868*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"47.66666666666665719276352319866418838501`16.", ",", 
   RowBox[{"-", "4.33333333333332504366808279883116483688`16."}], ",", 
   RowBox[{"-", "21.66666666666666785090455960016697645187`16."}], ",", 
   "62.50000000000002842170943040400743484497`16.", ",", 
   RowBox[{"-", "9.50000000000002664535259100375697016716`16."}], ",", 
   "12.00000000000000177635683940025046467781`16.", ",", 
   "14.83333333333333570180911920033395290375`16.", ",", 
   RowBox[{"-", "5.16666666666666785090455960016697645187`16."}], ",", 
   "33.6666666666666714036182384006679058075`16.", ",", "44.5`16.", ",", 
   "29.99999999999999289457264239899814128876`16.", ",", 
   RowBox[{"-", "35.5`16."}], ",", 
   "71.00000000000001421085471520200371742249`16.", ",", 
   "54.00000000000000710542735760100185871124`16.", ",", 
   "18.00000000000001421085471520200371742249`16.", ",", 
   "26.49999999999999289457264239899814128876`16.", ",", 
   "23.99999999999999644728632119949907064438`16.", ",", 
   "53.50000000000001421085471520200371742249`16.", ",", 
   RowBox[{"-", "3.16666666666666429819088079966604709625`16."}], ",", 
   "34.33333333333333570180911920033395290375`16.", ",", 
   RowBox[{"-", "13.83333333333333214909544039983302354813`16."}], ",", 
   "8.49999999999998756550212419824674725533`16.", ",", 
   "63.50000000000001421085471520200371742249`16.", ",", 
   "5.99999999999999289457264239899814128876`16.", ",", 
   "11.66666666666666074547720199916511774063`16.", ",", 
   "29.16666666666666785090455960016697645187`16.", ",", 
   "19.8333333333333285963817615993320941925`16.", ",", 
   "36.00000000000002842170943040400743484497`16.", ",", 
   RowBox[{"-", "33.49999999999998578914528479799628257751`16."}], ",", 
   RowBox[{"-", "41.50000000000000710542735760100185871124`16."}], ",", 
   "53.99999999999994315658113919198513031006`16.", ",", 
   RowBox[{"-", "73.00000000000002842170943040400743484497`16."}], ",", 
   "6.0000000000000159872115546022541821003`16.", ",", 
   "17.99999999999999289457264239899814128876`16.", ",", 
   RowBox[{"-", "39.50000000000001421085471520200371742249`16."}], ",", 
   "47.50000000000001421085471520200371742249`16.", ",", 
   "18.00000000000000710542735760100185871124`16.", ",", 
   "6.00000000000005329070518200751394033432`16.", ",", 
   RowBox[{"-", "89.00000000000002842170943040400743484497`16."}], ",", 
   RowBox[{"-", "5.684341886080801486968994140625`16.*^-14"}], ",", 
   RowBox[{"-", "3.9079850466805510222911834716796875`16.*^-14"}], ",", 
   RowBox[{"-", "1.59872115546022541821002960205078125`16.*^-14"}], ",", 
   RowBox[{"-", "17.99999999999998934185896359849721193314`16."}], ",", 
   RowBox[{"-", "5.99999999999998223643160599749535322189`16."}], ",", 
   "89.00000000000005684341886080801486968994`16.", ",", 
   RowBox[{"-", "17.99999999999999289457264239899814128876`16."}], ",", 
   "39.49999999999998578914528479799628257751`16.", ",", 
   RowBox[{"-", "47.50000000000001421085471520200371742249`16."}], ",", 
   RowBox[{"-", "54.00000000000003552713678800500929355621`16."}], ",", 
   "73.00000000000004263256414560601115226746`16.", ",", 
   RowBox[{"-", "6.00000000000002842170943040400743484497`16."}], ",", 
   RowBox[{"-", "36.00000000000000710542735760100185871124`16."}], ",", 
   "33.50000000000000710542735760100185871124`16.", ",", 
   "41.50000000000000710542735760100185871124`16.", ",", 
   RowBox[{"-", "11.66666666666662877105409279465675354004`16."}], ",", 
   RowBox[{"-", "29.16666666666673179975077800918370485306`16."}], ",", 
   RowBox[{"-", "19.8333333333333783343732648063451051712`16."}], ",", 
   RowBox[{"-", "8.49999999999987920773492078296840190887`16."}], ",", 
   RowBox[{"-", "63.5000000000000994759830064140260219574`16."}], ",", 
   RowBox[{"-", "5.99999999999996269650637259474024176598`16."}], ",", 
   "3.1666666666666714036182384006679058075`16.", ",", 
   RowBox[{"-", "34.33333333333331438552704639732837677002`16."}], ",", 
   "13.8333333333333605708048708038404583931`16.", ",", 
   RowBox[{"-", "26.5000000000000497379915032070130109787`16."}], ",", 
   RowBox[{"-", "23.99999999999997513100424839649349451065`16."}], ",", 
   RowBox[{"-", "53.50000000000007105427357601001858711243`16."}], ",", 
   RowBox[{"-", "70.99999999999997157829056959599256515503`16."}], ",", 
   RowBox[{"-", "54.00000000000000710542735760100185871124`16."}], ",", 
   RowBox[{"-", "18.00000000000008526512829121202230453491`16."}], ",", 
   RowBox[{"-", "44.50000000000002842170943040400743484497`16."}], ",", 
   RowBox[{"-", "30.00000000000000710542735760100185871124`16."}], ",", 
   "35.5000000000000497379915032070130109787`16.", ",", 
   RowBox[{"-", "14.83333333333334635995015560183674097061`16."}], ",", 
   "5.16666666666664120555196859641000628471`16.", ",", 
   RowBox[{"-", "33.66666666666651508421637117862701416016`16."}], ",", 
   RowBox[{"-", "62.5`16."}], ",", 
   "9.50000000000001776356839400250464677811`16.", ",", 
   RowBox[{"-", "12.00000000000000532907051820075139403343`16."}], ",", 
   RowBox[{"-", "47.66666666666666429819088079966604709625`16."}], ",", 
   "4.33333333333334280723647680133581161499`16.", ",", 
   "21.66666666666667850904559600166976451874`16."}], "}"}]], "Output",
 CellChangeTimes->{
  3.720994987716754*^9, 3.7209950515695486`*^9, 3.721047011769689*^9, 
   3.721049783085235*^9, 3.7210616458831215`*^9, 3.7227834338392105`*^9, 
   3.7239051557725883`*^9, 3.7239065166905165`*^9, {3.849128546553343*^9, 
   3.849128560634379*^9}, 3.8503240247271442`*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Compute the internal energy for arbitrary solution:", "Subsection",
 CellChangeTimes->{{3.720811509811389*^9, 3.7208115304201703`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"uArb", "=", 
   RowBox[{"{", 
    RowBox[{
    "0.001", ",", "0.0", ",", "0.0", ",", "0.0", ",", "0.0", ",", "0.0", ",", 
     "0.0", ",", "0.0", ",", "0.0", ",", "0.0", ",", "0.0", ",", "0.0"}], 
    "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"SetPrecision", "[", 
  RowBox[{
   RowBox[{"D", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"\[Rho]1", "+", "\[Rho]2", "+", "\[Rho]3", "+", "\[Rho]4"}], 
       ")"}], 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"uArb", ".", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Klocal", "[", 
            RowBox[{"[", "1", "]"}], "]"}], ".", "uArb"}], ")"}]}], ")"}], 
       "/", "4.0"}]}], ",", "\[Rho]1"}], "]"}], ",", "16"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"SetPrecision", "[", 
  RowBox[{
   RowBox[{"D", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"\[Rho]1", "+", "\[Rho]2", "+", "\[Rho]3", "+", "\[Rho]4"}], 
       ")"}], 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"uArb", ".", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Klocal", "[", 
            RowBox[{"[", "17", "]"}], "]"}], ".", "uArb"}], ")"}]}], ")"}], 
       "/", "4.0"}]}], ",", "\[Rho]1"}], "]"}], ",", "16"}], "]"}]}], "Input",
 CellChangeTimes->{{3.720811532920601*^9, 3.720811686564997*^9}, {
  3.7208118405336432`*^9, 3.7208118968613443`*^9}}],

Cell[BoxData[
 TemplateBox[{
  "Dot","dotsh",
   "\"Tensors \\!\\(\\*RowBox[{\\\"{\\\", RowBox[{RowBox[{\\\"{\\\", RowBox[{\
\\\"8.333333333333332`\\\", \\\",\\\", \\\"0.`\\\", \\\",\\\", \
RowBox[{\\\"-\\\", \\\"8.333333333333332`\\\"}], \\\",\\\", \\\"0.`\\\"}], \\\
\"}\\\"}], \\\",\\\", RowBox[{\\\"{\\\", RowBox[{\\\"0.`\\\", \\\",\\\", \
\\\"16.666666666666664`\\\", \\\",\\\", RowBox[{\\\"-\\\", \
\\\"8.333333333333332`\\\"}], \\\",\\\", RowBox[{\\\"-\\\", \
\\\"8.333333333333332`\\\"}]}], \\\"}\\\"}], \\\",\\\", RowBox[{\\\"{\\\", \
RowBox[{RowBox[{\\\"-\\\", \\\"8.333333333333332`\\\"}], \\\",\\\", \
RowBox[{\\\"-\\\", \\\"8.333333333333332`\\\"}], \\\",\\\", \
\\\"16.666666666666664`\\\", \\\",\\\", \\\"0.`\\\"}], \\\"}\\\"}], \
\\\",\\\", RowBox[{\\\"{\\\", RowBox[{\\\"0.`\\\", \\\",\\\", RowBox[{\\\"-\\\
\", \\\"8.333333333333332`\\\"}], \\\",\\\", \\\"0.`\\\", \\\",\\\", \
\\\"8.333333333333332`\\\"}], \\\"}\\\"}]}], \\\"}\\\"}]\\) and \
\\!\\(\\*RowBox[{\\\"{\\\", RowBox[{\\\"0.001`\\\", \\\",\\\", \\\"0.`\\\", \
\\\",\\\", \\\"0.`\\\", \\\",\\\", \\\"0.`\\\", \\\",\\\", \\\"0.`\\\", \\\",\
\\\", \\\"0.`\\\", \\\",\\\", \\\"0.`\\\", \\\",\\\", \\\"0.`\\\", \\\",\\\", \
\\\"0.`\\\", \\\",\\\", \\\"0.`\\\", \\\",\\\", \\\"0.`\\\", \\\",\\\", \
\\\"0.`\\\"}], \\\"}\\\"}]\\) have incompatible shapes.\"",2,87,1,
   27290366765787030343,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.850324024743836*^9}],

Cell[BoxData[
 TemplateBox[{
  "Dot","dotsh",
   "\"Tensors \\!\\(\\*RowBox[{\\\"{\\\", RowBox[{\\\"0.001`\\\", \\\",\\\", \
\\\"0.`\\\", \\\",\\\", \\\"0.`\\\", \\\",\\\", \\\"0.`\\\", \\\",\\\", \
\\\"0.`\\\", \\\",\\\", \\\"0.`\\\", \\\",\\\", \\\"0.`\\\", \\\",\\\", \
\\\"0.`\\\", \\\",\\\", \\\"0.`\\\", \\\",\\\", \\\"0.`\\\", \\\",\\\", \
\\\"0.`\\\", \\\",\\\", \\\"0.`\\\"}], \\\"}\\\"}]\\) and \\!\\(\\*RowBox[{\\\
\"{\\\", RowBox[{RowBox[{\\\"{\\\", RowBox[{\\\"8.333333333333332`\\\", \\\",\
\\\", \\\"0.`\\\", \\\",\\\", RowBox[{\\\"-\\\", \
\\\"8.333333333333332`\\\"}], \\\",\\\", \\\"0.`\\\"}], \\\"}\\\"}], \
\\\",\\\", RowBox[{\\\"{\\\", RowBox[{\\\"0.`\\\", \\\",\\\", \
\\\"16.666666666666664`\\\", \\\",\\\", RowBox[{\\\"-\\\", \
\\\"8.333333333333332`\\\"}], \\\",\\\", RowBox[{\\\"-\\\", \
\\\"8.333333333333332`\\\"}]}], \\\"}\\\"}], \\\",\\\", RowBox[{\\\"{\\\", \
RowBox[{RowBox[{\\\"-\\\", \\\"8.333333333333332`\\\"}], \\\",\\\", \
RowBox[{\\\"-\\\", \\\"8.333333333333332`\\\"}], \\\",\\\", \
\\\"16.666666666666664`\\\", \\\",\\\", \\\"0.`\\\"}], \\\"}\\\"}], \
\\\",\\\", RowBox[{\\\"{\\\", RowBox[{\\\"0.`\\\", \\\",\\\", RowBox[{\\\"-\\\
\", \\\"8.333333333333332`\\\"}], \\\",\\\", \\\"0.`\\\", \\\",\\\", \
\\\"8.333333333333332`\\\"}], \\\"}\\\"}]}], \\\"}\\\"}]\\) have incompatible \
shapes.\"",2,87,2,27290366765787030343,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.8503240247873497`*^9}],

Cell[BoxData[
 TemplateBox[{
  "Dot","dotsh",
   "\"Tensors \\!\\(\\*RowBox[{\\\"{\\\", RowBox[{RowBox[{\\\"{\\\", RowBox[{\
\\\"8.333333333333332`\\\", \\\",\\\", \\\"0.`\\\", \\\",\\\", \
RowBox[{\\\"-\\\", \\\"8.333333333333332`\\\"}], \\\",\\\", \\\"0.`\\\"}], \\\
\"}\\\"}], \\\",\\\", RowBox[{\\\"{\\\", RowBox[{\\\"0.`\\\", \\\",\\\", \
\\\"16.666666666666664`\\\", \\\",\\\", RowBox[{\\\"-\\\", \
\\\"8.333333333333332`\\\"}], \\\",\\\", RowBox[{\\\"-\\\", \
\\\"8.333333333333332`\\\"}]}], \\\"}\\\"}], \\\",\\\", RowBox[{\\\"{\\\", \
RowBox[{RowBox[{\\\"-\\\", \\\"8.333333333333332`\\\"}], \\\",\\\", \
RowBox[{\\\"-\\\", \\\"8.333333333333332`\\\"}], \\\",\\\", \
\\\"16.666666666666664`\\\", \\\",\\\", \\\"0.`\\\"}], \\\"}\\\"}], \
\\\",\\\", RowBox[{\\\"{\\\", RowBox[{\\\"0.`\\\", \\\",\\\", RowBox[{\\\"-\\\
\", \\\"8.333333333333332`\\\"}], \\\",\\\", \\\"0.`\\\", \\\",\\\", \
\\\"8.333333333333332`\\\"}], \\\"}\\\"}]}], \\\"}\\\"}]\\) and \
\\!\\(\\*RowBox[{\\\"{\\\", RowBox[{\\\"0.001`\\\", \\\",\\\", \\\"0.`\\\", \
\\\",\\\", \\\"0.`\\\", \\\",\\\", \\\"0.`\\\", \\\",\\\", \\\"0.`\\\", \\\",\
\\\", \\\"0.`\\\", \\\",\\\", \\\"0.`\\\", \\\",\\\", \\\"0.`\\\", \\\",\\\", \
\\\"0.`\\\", \\\",\\\", \\\"0.`\\\", \\\",\\\", \\\"0.`\\\", \\\",\\\", \
\\\"0.`\\\"}], \\\"}\\\"}]\\) have incompatible shapes.\"",2,87,3,
   27290366765787030343,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.8503240247917233`*^9}],

Cell[BoxData[
 TemplateBox[{
  "General","stop",
   "\"Further output of \\!\\(\\*StyleBox[RowBox[{\\\"Dot\\\", \\\"::\\\", \\\
\"dotsh\\\"}], \\\"MessageName\\\"]\\) will be suppressed during this \
calculation.\"",2,87,4,27290366765787030343,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.850324024796095*^9}],

Cell[BoxData[
 RowBox[{"0.25`16.", " ", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
    "0.00100000000000000002081668171172168513`16.", ",", "0", ",", "0", ",", 
     "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
     "0", ",", "0"}], "}"}], ".", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"8.33333333333333214909544039983302354813`16.", ",", "0", ",", 
       RowBox[{"-", "8.33333333333333214909544039983302354813`16."}], ",", 
       "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "16.66666666666666429819088079966604709625`16.", ",", 
       RowBox[{"-", "8.33333333333333214909544039983302354813`16."}], ",", 
       RowBox[{"-", "8.33333333333333214909544039983302354813`16."}]}], "}"}],
      ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "8.33333333333333214909544039983302354813`16."}], ",", 
       RowBox[{"-", "8.33333333333333214909544039983302354813`16."}], ",", 
       "16.66666666666666429819088079966604709625`16.", ",", "0"}], "}"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", 
       RowBox[{"-", "8.33333333333333214909544039983302354813`16."}], ",", 
       "0", ",", "8.33333333333333214909544039983302354813`16."}], "}"}]}], 
    "}"}], ".", 
   RowBox[{"{", 
    RowBox[{
    "0.00100000000000000002081668171172168513`16.", ",", "0", ",", "0", ",", 
     "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
     "0", ",", "0"}], "}"}]}]}]], "Output",
 CellChangeTimes->{{3.720811580513815*^9, 3.7208116173419356`*^9}, 
   3.720811690752289*^9, {3.720811848767852*^9, 3.720811898751934*^9}, 
   3.8503240248003073`*^9}],

Cell[BoxData[
 TemplateBox[{
  "Dot","dotsh",
   "\"Tensors \\!\\(\\*RowBox[{\\\"{\\\", RowBox[{RowBox[{\\\"{\\\", RowBox[{\
\\\"8.333333333333332`\\\", \\\",\\\", \\\"0.`\\\", \\\",\\\", \
RowBox[{\\\"-\\\", \\\"8.333333333333332`\\\"}], \\\",\\\", \\\"0.`\\\"}], \\\
\"}\\\"}], \\\",\\\", RowBox[{\\\"{\\\", RowBox[{\\\"0.`\\\", \\\",\\\", \
\\\"16.666666666666664`\\\", \\\",\\\", RowBox[{\\\"-\\\", \
\\\"8.333333333333332`\\\"}], \\\",\\\", RowBox[{\\\"-\\\", \
\\\"8.333333333333332`\\\"}]}], \\\"}\\\"}], \\\",\\\", RowBox[{\\\"{\\\", \
RowBox[{RowBox[{\\\"-\\\", \\\"8.333333333333332`\\\"}], \\\",\\\", \
RowBox[{\\\"-\\\", \\\"8.333333333333332`\\\"}], \\\",\\\", \
\\\"16.666666666666664`\\\", \\\",\\\", \\\"0.`\\\"}], \\\"}\\\"}], \
\\\",\\\", RowBox[{\\\"{\\\", RowBox[{\\\"0.`\\\", \\\",\\\", RowBox[{\\\"-\\\
\", \\\"8.333333333333332`\\\"}], \\\",\\\", \\\"0.`\\\", \\\",\\\", \
\\\"8.333333333333332`\\\"}], \\\"}\\\"}]}], \\\"}\\\"}]\\) and \
\\!\\(\\*RowBox[{\\\"{\\\", RowBox[{\\\"0.001`\\\", \\\",\\\", \\\"0.`\\\", \
\\\",\\\", \\\"0.`\\\", \\\",\\\", \\\"0.`\\\", \\\",\\\", \\\"0.`\\\", \\\",\
\\\", \\\"0.`\\\", \\\",\\\", \\\"0.`\\\", \\\",\\\", \\\"0.`\\\", \\\",\\\", \
\\\"0.`\\\", \\\",\\\", \\\"0.`\\\", \\\",\\\", \\\"0.`\\\", \\\",\\\", \
\\\"0.`\\\"}], \\\"}\\\"}]\\) have incompatible shapes.\"",2,88,5,
   27290366765787030343,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.850324024801075*^9}],

Cell[BoxData[
 TemplateBox[{
  "Dot","dotsh",
   "\"Tensors \\!\\(\\*RowBox[{\\\"{\\\", RowBox[{\\\"0.001`\\\", \\\",\\\", \
\\\"0.`\\\", \\\",\\\", \\\"0.`\\\", \\\",\\\", \\\"0.`\\\", \\\",\\\", \
\\\"0.`\\\", \\\",\\\", \\\"0.`\\\", \\\",\\\", \\\"0.`\\\", \\\",\\\", \
\\\"0.`\\\", \\\",\\\", \\\"0.`\\\", \\\",\\\", \\\"0.`\\\", \\\",\\\", \
\\\"0.`\\\", \\\",\\\", \\\"0.`\\\"}], \\\"}\\\"}]\\) and \\!\\(\\*RowBox[{\\\
\"{\\\", RowBox[{RowBox[{\\\"{\\\", RowBox[{\\\"8.333333333333332`\\\", \\\",\
\\\", \\\"0.`\\\", \\\",\\\", RowBox[{\\\"-\\\", \
\\\"8.333333333333332`\\\"}], \\\",\\\", \\\"0.`\\\"}], \\\"}\\\"}], \
\\\",\\\", RowBox[{\\\"{\\\", RowBox[{\\\"0.`\\\", \\\",\\\", \
\\\"16.666666666666664`\\\", \\\",\\\", RowBox[{\\\"-\\\", \
\\\"8.333333333333332`\\\"}], \\\",\\\", RowBox[{\\\"-\\\", \
\\\"8.333333333333332`\\\"}]}], \\\"}\\\"}], \\\",\\\", RowBox[{\\\"{\\\", \
RowBox[{RowBox[{\\\"-\\\", \\\"8.333333333333332`\\\"}], \\\",\\\", \
RowBox[{\\\"-\\\", \\\"8.333333333333332`\\\"}], \\\",\\\", \
\\\"16.666666666666664`\\\", \\\",\\\", \\\"0.`\\\"}], \\\"}\\\"}], \
\\\",\\\", RowBox[{\\\"{\\\", RowBox[{\\\"0.`\\\", \\\",\\\", RowBox[{\\\"-\\\
\", \\\"8.333333333333332`\\\"}], \\\",\\\", \\\"0.`\\\", \\\",\\\", \
\\\"8.333333333333332`\\\"}], \\\"}\\\"}]}], \\\"}\\\"}]\\) have incompatible \
shapes.\"",2,88,6,27290366765787030343,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.850324024804854*^9}],

Cell[BoxData[
 TemplateBox[{
  "Dot","dotsh",
   "\"Tensors \\!\\(\\*RowBox[{\\\"{\\\", RowBox[{RowBox[{\\\"{\\\", RowBox[{\
\\\"8.333333333333332`\\\", \\\",\\\", \\\"0.`\\\", \\\",\\\", \
RowBox[{\\\"-\\\", \\\"8.333333333333332`\\\"}], \\\",\\\", \\\"0.`\\\"}], \\\
\"}\\\"}], \\\",\\\", RowBox[{\\\"{\\\", RowBox[{\\\"0.`\\\", \\\",\\\", \
\\\"16.666666666666664`\\\", \\\",\\\", RowBox[{\\\"-\\\", \
\\\"8.333333333333332`\\\"}], \\\",\\\", RowBox[{\\\"-\\\", \
\\\"8.333333333333332`\\\"}]}], \\\"}\\\"}], \\\",\\\", RowBox[{\\\"{\\\", \
RowBox[{RowBox[{\\\"-\\\", \\\"8.333333333333332`\\\"}], \\\",\\\", \
RowBox[{\\\"-\\\", \\\"8.333333333333332`\\\"}], \\\",\\\", \
\\\"16.666666666666664`\\\", \\\",\\\", \\\"0.`\\\"}], \\\"}\\\"}], \
\\\",\\\", RowBox[{\\\"{\\\", RowBox[{\\\"0.`\\\", \\\",\\\", RowBox[{\\\"-\\\
\", \\\"8.333333333333332`\\\"}], \\\",\\\", \\\"0.`\\\", \\\",\\\", \
\\\"8.333333333333332`\\\"}], \\\"}\\\"}]}], \\\"}\\\"}]\\) and \
\\!\\(\\*RowBox[{\\\"{\\\", RowBox[{\\\"0.001`\\\", \\\",\\\", \\\"0.`\\\", \
\\\",\\\", \\\"0.`\\\", \\\",\\\", \\\"0.`\\\", \\\",\\\", \\\"0.`\\\", \\\",\
\\\", \\\"0.`\\\", \\\",\\\", \\\"0.`\\\", \\\",\\\", \\\"0.`\\\", \\\",\\\", \
\\\"0.`\\\", \\\",\\\", \\\"0.`\\\", \\\",\\\", \\\"0.`\\\", \\\",\\\", \
\\\"0.`\\\"}], \\\"}\\\"}]\\) have incompatible shapes.\"",2,88,7,
   27290366765787030343,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.850324024808628*^9}],

Cell[BoxData[
 TemplateBox[{
  "General","stop",
   "\"Further output of \\!\\(\\*StyleBox[RowBox[{\\\"Dot\\\", \\\"::\\\", \\\
\"dotsh\\\"}], \\\"MessageName\\\"]\\) will be suppressed during this \
calculation.\"",2,88,8,27290366765787030343,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.850324024812608*^9}],

Cell[BoxData[
 RowBox[{"0.25`16.", " ", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
    "0.00100000000000000002081668171172168513`16.", ",", "0", ",", "0", ",", 
     "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
     "0", ",", "0"}], "}"}], ".", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"8.33333333333333214909544039983302354813`16.", ",", "0", ",", 
       RowBox[{"-", "8.33333333333333214909544039983302354813`16."}], ",", 
       "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "16.66666666666666429819088079966604709625`16.", ",", 
       RowBox[{"-", "8.33333333333333214909544039983302354813`16."}], ",", 
       RowBox[{"-", "8.33333333333333214909544039983302354813`16."}]}], "}"}],
      ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "8.33333333333333214909544039983302354813`16."}], ",", 
       RowBox[{"-", "8.33333333333333214909544039983302354813`16."}], ",", 
       "16.66666666666666429819088079966604709625`16.", ",", "0"}], "}"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", 
       RowBox[{"-", "8.33333333333333214909544039983302354813`16."}], ",", 
       "0", ",", "8.33333333333333214909544039983302354813`16."}], "}"}]}], 
    "}"}], ".", 
   RowBox[{"{", 
    RowBox[{
    "0.00100000000000000002081668171172168513`16.", ",", "0", ",", "0", ",", 
     "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
     "0", ",", "0"}], "}"}]}]}]], "Output",
 CellChangeTimes->{{3.720811580513815*^9, 3.7208116173419356`*^9}, 
   3.720811690752289*^9, {3.720811848767852*^9, 3.720811898751934*^9}, 
   3.850324024816512*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Constraint the global stiffness.  The nodes on the X=0 face are 1 through 9, \
so dof ids are 1 through 27:\
\>", "Subsection",
 CellChangeTimes->{{3.7174287806081066`*^9, 3.7174288331081657`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"constrainedDofs", "=", 
   RowBox[{"Table", "[", 
    RowBox[{"i", ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", "27"}], "}"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.717426338419407*^9, 3.7174263549663415`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"For", "[", 
   RowBox[{
    RowBox[{"i", "=", "1"}], ",", 
    RowBox[{"i", "\[LessEqual]", 
     RowBox[{"Length", "[", "constrainedDofs", "]"}]}], ",", 
    RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"k", "=", "1"}], ",", 
       RowBox[{"k", "\[LessEqual]", "ndofsTotal"}], ",", 
       RowBox[{"k", "++"}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{"Kglobal", "[", 
          RowBox[{"[", "i", "]"}], "]"}], "[", 
         RowBox[{"[", "k", "]"}], "]"}], "=", "0"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"k", "=", "1"}], ",", 
       RowBox[{"k", "\[LessEqual]", "ndofsTotal"}], ",", 
       RowBox[{"k", "++"}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{"Kglobal", "[", 
          RowBox[{"[", "k", "]"}], "]"}], "[", 
         RowBox[{"[", "i", "]"}], "]"}], "=", "0"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"Kglobal", "[", 
        RowBox[{"[", "i", "]"}], "]"}], "[", 
       RowBox[{"[", "i", "]"}], "]"}], "=", "1"}]}]}], "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.7174263658722477`*^9, 3.7174264552946367`*^9}, {
  3.71742650013837*^9, 3.717426545029602*^9}, {3.7174279818249474`*^9, 
  3.7174280132318506`*^9}, {3.7174280475758295`*^9, 3.7174281166844635`*^9}, {
  3.7174281501537457`*^9, 3.7174281535437164`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Constraint the global forcing.  The nodes on the X=0 face are 1 through 9, so \
dof ids are 1 through 27:\
\>", "Subsection",
 CellChangeTimes->{{3.7174287806081066`*^9, 3.7174288331081657`*^9}, {
  3.720278267655209*^9, 3.720278271710693*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"constrainedDofs", "=", 
   RowBox[{"Table", "[", 
    RowBox[{"i", ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", "27"}], "}"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.717426338419407*^9, 3.7174263549663415`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"For", "[", 
   RowBox[{
    RowBox[{"i", "=", "1"}], ",", 
    RowBox[{"i", "\[LessEqual]", 
     RowBox[{"Length", "[", "constrainedDofs", "]"}]}], ",", 
    RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Fglobal", "[", 
      RowBox[{"[", "i", "]"}], "]"}], "=", "0"}]}], "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.7174263658722477`*^9, 3.7174264552946367`*^9}, {
  3.71742650013837*^9, 3.717426545029602*^9}, {3.7174279818249474`*^9, 
  3.7174280132318506`*^9}, {3.7174280475758295`*^9, 3.7174281166844635`*^9}, {
  3.7174281501537457`*^9, 3.7174281535437164`*^9}, {3.720278288403862*^9, 
  3.720278311282126*^9}}],

Cell[BoxData[
 TemplateBox[{
  "Set","noval",
   "\"Symbol \\!\\(\\*RowBox[{\\\"Fglobal\\\"}]\\) in part assignment does \
not have an immediate value.\"",2,92,9,27290366765787030343,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.850324024847658*^9}],

Cell[BoxData[
 TemplateBox[{
  "Set","noval",
   "\"Symbol \\!\\(\\*RowBox[{\\\"Fglobal\\\"}]\\) in part assignment does \
not have an immediate value.\"",2,92,10,27290366765787030343,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.8503240248522053`*^9}],

Cell[BoxData[
 TemplateBox[{
  "Set","noval",
   "\"Symbol \\!\\(\\*RowBox[{\\\"Fglobal\\\"}]\\) in part assignment does \
not have an immediate value.\"",2,92,11,27290366765787030343,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.85032402485574*^9}],

Cell[BoxData[
 TemplateBox[{
  "General","stop",
   "\"Further output of \\!\\(\\*StyleBox[RowBox[{\\\"Set\\\", \\\"::\\\", \\\
\"noval\\\"}], \\\"MessageName\\\"]\\) will be suppressed during this \
calculation.\"",2,92,12,27290366765787030343,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.850324024859294*^9}]
}, Open  ]]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1090, 1023},
WindowMargins->{{582, 248}, {0, 30}},
PrintingCopies->1,
PrintingPageRange->{Automatic, Automatic},
PrivateNotebookOptions->{"VersionedStylesheet"->{"Default.nb"[8.] -> False}},
FrontEndVersion->"11.0 for Linux x86 (64-bit) (July 28, 2016)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 234, 7, 93, "Title"],
Cell[CellGroupData[{
Cell[839, 33, 212, 3, 45, "Subsection"],
Cell[1054, 38, 363, 8, 32, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1454, 51, 1142, 36, 75, "Subsection"],
Cell[2599, 89, 1472, 47, 248, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[4108, 141, 294, 10, 50, "Subsection"],
Cell[CellGroupData[{
Cell[4427, 155, 1232, 34, 32, "Input"],
Cell[5662, 191, 1420, 35, 83, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[7131, 232, 126, 1, 44, "Subsection"],
Cell[7260, 235, 164, 4, 32, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[7461, 244, 124, 1, 44, "Subsection"],
Cell[7588, 247, 324, 7, 32, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[7949, 259, 676, 23, 75, "Subsection"],
Cell[8628, 284, 643, 16, 32, "Input"],
Cell[9274, 302, 710, 12, 32, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[10021, 319, 113, 1, 45, "Subsection"],
Cell[10137, 322, 547, 9, 30, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[10721, 336, 114, 1, 44, "Subsection"],
Cell[CellGroupData[{
Cell[10860, 341, 644, 16, 32, "Input"],
Cell[11507, 359, 1130, 25, 83, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[12686, 390, 310, 6, 71, "Subsection"],
Cell[12999, 398, 2165, 49, 101, "Input"],
Cell[15167, 449, 467, 13, 52, "Input"],
Cell[15637, 464, 949, 25, 33, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[16623, 494, 223, 4, 45, "Subsection"],
Cell[16849, 500, 4474, 105, 172, "Input"],
Cell[21326, 607, 1983, 37, 132, "Input"],
Cell[CellGroupData[{
Cell[23334, 648, 282, 7, 35, "Input"],
Cell[23619, 657, 653, 11, 32, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[24309, 673, 446, 10, 35, "Input"],
Cell[24758, 685, 845, 14, 52, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[25640, 704, 3706, 106, 111, "Input"],
Cell[29349, 812, 1208, 29, 83, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[30606, 847, 119, 1, 45, "Subsection"],
Cell[30728, 850, 1134, 27, 114, "Input"],
Cell[31865, 879, 5411, 144, 351, "Input"],
Cell[CellGroupData[{
Cell[37301, 1027, 133, 2, 32, "Input"],
Cell[37437, 1031, 10929, 196, 539, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[48403, 1232, 1616, 44, 100, "Input"],
Cell[50022, 1278, 1400, 29, 129, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[51471, 1313, 346, 4, 43, "Subsection"],
Cell[51820, 1319, 1089, 25, 95, "Input"],
Cell[52912, 1346, 6796, 148, 272, "Input"],
Cell[CellGroupData[{
Cell[59733, 1498, 672, 16, 35, "Input"],
Cell[60408, 1516, 38086, 968, 654, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[98543, 2490, 163, 2, 45, "Subsection"],
Cell[CellGroupData[{
Cell[98731, 2496, 8629, 191, 423, "Input"],
Cell[107363, 2689, 465, 6, 30, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[107877, 2701, 183, 2, 45, "Subsection"],
Cell[108063, 2705, 12128, 280, 566, "Input"],
Cell[CellGroupData[{
Cell[120216, 2989, 275, 5, 32, "Input"],
Cell[120494, 2996, 2111, 34, 133, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[122654, 3036, 237, 3, 45, "Subsection"],
Cell[122894, 3041, 11947, 269, 627, "Input"],
Cell[CellGroupData[{
Cell[134866, 3314, 321, 5, 32, "Input"],
Cell[135190, 3321, 1899, 34, 109, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[137138, 3361, 280, 3, 45, "Subsection"],
Cell[137421, 3366, 16536, 384, 728, "Input"],
Cell[CellGroupData[{
Cell[153982, 3754, 370, 6, 32, "Input"],
Cell[154355, 3762, 5729, 93, 346, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[160133, 3861, 258, 3, 45, "Subsection"],
Cell[160394, 3866, 5318, 142, 351, "Input"],
Cell[CellGroupData[{
Cell[165737, 4012, 268, 5, 35, "Input"],
Cell[166008, 4019, 1968, 33, 133, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[168025, 4058, 327, 4, 45, "Subsection"],
Cell[168355, 4064, 9827, 220, 512, "Input"],
Cell[178185, 4286, 495, 8, 35, "Input"],
Cell[CellGroupData[{
Cell[178705, 4298, 1749, 45, 100, "Input"],
Cell[180457, 4345, 1802, 35, 169, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[182308, 4386, 417, 5, 70, "Subsection"],
Cell[182728, 4393, 16155, 369, 838, "Input"],
Cell[CellGroupData[{
Cell[198908, 4766, 1961, 54, 155, "Input"],
Cell[200872, 4822, 895, 17, 71, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[201816, 4845, 166, 2, 45, "Subsection"],
Cell[201985, 4849, 4697, 124, 323, "Input"],
Cell[CellGroupData[{
Cell[206707, 4977, 167, 3, 32, "Input"],
Cell[206877, 4982, 283, 3, 30, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[207209, 4991, 236, 3, 45, "Subsection"],
Cell[207448, 4996, 6655, 176, 464, "Input"],
Cell[CellGroupData[{
Cell[214128, 5176, 212, 4, 32, "Input"],
Cell[214343, 5182, 1695, 29, 109, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[216087, 5217, 284, 3, 45, "Subsection"],
Cell[216374, 5222, 8884, 202, 392, "Input"],
Cell[CellGroupData[{
Cell[225283, 5428, 265, 5, 32, "Input"],
Cell[225551, 5435, 1903, 31, 133, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[227503, 5472, 338, 4, 45, "Subsection"],
Cell[227844, 5478, 13910, 329, 545, "Input"],
Cell[CellGroupData[{
Cell[241779, 5811, 311, 5, 32, "Input"],
Cell[242093, 5818, 5525, 86, 346, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[247667, 5910, 141, 1, 45, "Subsection"],
Cell[CellGroupData[{
Cell[247833, 5915, 1414, 42, 72, "Input"],
Cell[249250, 5959, 1456, 23, 59, "Message"],
Cell[250709, 5984, 1456, 23, 59, "Message"],
Cell[252168, 6009, 1458, 23, 59, "Message"],
Cell[253629, 6034, 336, 7, 23, "Message"],
Cell[253968, 6043, 1648, 37, 92, "Output"],
Cell[255619, 6082, 1456, 23, 59, "Message"],
Cell[257078, 6107, 1454, 23, 59, "Message"],
Cell[258535, 6132, 1456, 23, 59, "Message"],
Cell[259994, 6157, 336, 7, 23, "Message"],
Cell[260333, 6166, 1646, 37, 92, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[262028, 6209, 207, 4, 45, "Subsection"],
Cell[262238, 6215, 271, 7, 35, "Input"],
Cell[262512, 6224, 1482, 39, 107, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[264031, 6268, 254, 5, 45, "Subsection"],
Cell[264288, 6275, 271, 7, 35, "Input"],
Cell[CellGroupData[{
Cell[264584, 6286, 685, 15, 59, "Input"],
Cell[265272, 6303, 275, 6, 23, "Message"],
Cell[265550, 6311, 278, 6, 23, "Message"],
Cell[265831, 6319, 275, 6, 23, "Message"],
Cell[266109, 6327, 337, 7, 23, "Message"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}
]
*)

